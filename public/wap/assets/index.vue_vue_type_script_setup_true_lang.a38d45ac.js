import{d as e,r as t,j as o,Z as r,o as l,c as a,w as s,f as i,Q as d,n,O as u,P as p,a6 as x,u as c,b as g,aR as m,i as h,a_ as v,K as f,N as y,ag as _,ba as w,b4 as b,b5 as R,g as k,h as S,a5 as C,E as B,y as G,z as F,a as W,s as A,B as H,D as j}from"./index-9317da28.js";import{_ as $}from"./u--image.5461b7b7.js";import{_ as D}from"./_plugin-vue_export-helper.1b428a4d.js";import{a as E}from"./goods.f92b6713.js";const N=D(e({__name:"x-skeleton",props:{type:{type:String,default:"",required:!0},loading:{type:Boolean,default:!0},animate:{type:Boolean,default:!0},animateTime:{type:Number,default:1.8},fadeOut:{type:Boolean,default:!0},fadeOutTime:{type:Number,default:.5},bgColor:{type:String,default:"#EAEDF5"},highlightBgColor:{type:String,default:"#F9FAFF"},config:{type:Object,default:()=>({})}},setup(e){const v=e,f=t(v.config||{}),y=t(v.loading),_=t(!1);t(0);const w=o((()=>{var e;return new Array(Number((null==(e=f.value)?void 0:e.gridRows)||[]))})),b=o((()=>{var e;return new Array(Number((null==(e=f.value)?void 0:e.gridColumns)||[]))})),R=o((()=>{var e;if(!(null==(e=f.value)?void 0:e.textShow))return[];/%$/.test(f.value.textHeight)&&console.error("x-skeleton: textHeight参数不支持百分比单位");const t=[];for(let o=0;o<f.value.textRows;o++){const{gridRows:e,textWidth:r,textHeight:l}=f.value;let a={},s=S(r)?r[o]||(o===e-1?"70%":"100%"):o===e-1?"70%":r,i=S(l)?l[o]||"30rpx":l;/%$/.test(s)?a.width=s:a.width=C(s),a.height=C(i),t.push(a)}return t})),k=o((()=>["animateTime","fadeOutTime","bgColor","highlightBgColor"].map((e=>e.indexOf("Time")>-1?`--${e}:${v[e]}s`:`--${e}:${v[e]}`)).join(";")));r((()=>v.loading),(e=>{e?y.value=!0:v.fadeOut?(_.value=!0,setTimeout((()=>{y.value=!1,_.value=!1}),1e3*v.fadeOutTime)):y.value=!1}),{immediate:!0}),r((()=>v.type),(e=>{var t;f.value="banner"===e?(t=v.config,{padding:"20rpx",gridRows:1,gridColumns:1,gridRowsGap:"40rpx",gridColumnsGap:"24rpx",itemDirection:"row",itemGap:"30rpx",itemAlign:"center",headShow:!0,headWidth:"100%",headHeight:"300rpx",headBorderRadius:"20rpx",textShow:!1,textRows:3,textRowsGap:"20rpx",textWidth:"100%",textHeight:"30rpx",textBorderRadius:"6rpx",...t}):"info"===e?function(e){return{padding:"20rpx",gridRows:1,gridColumns:1,gridRowsGap:"50rpx",gridColumnsGap:"24rpx",itemDirection:"row",itemGap:"30rpx",itemAlign:"flex-start",headShow:!0,headWidth:"100rpx",headHeight:"100rpx",headBorderRadius:"50%",textShow:!0,textRows:4,textRowsGap:"30rpx",textWidth:["50%","100%","100%","80%"],textHeight:["40rpx","24rpx","24rpx","24rpx"],textBorderRadius:"6rpx",...e}}(v.config):"text"===e?function(e){return{padding:"20rpx",gridRows:1,gridColumns:1,gridRowsGap:"50rpx",gridColumnsGap:"24rpx",itemDirection:"row",itemGap:"30rpx",itemAlign:"flex-start",headShow:!1,headWidth:"100rpx",headHeight:"100rpx",headBorderRadius:"50%",textShow:!0,textRows:4,textRowsGap:"30rpx",textWidth:["50%","100%","100%","80%"],textHeight:"30rpx",textBorderRadius:"6rpx",...e}}(v.config):"menu"===e?function(e){return{padding:"20rpx",gridRows:2,gridColumns:5,gridRowsGap:"40rpx",gridColumnsGap:"40rpx",itemDirection:"column",itemGap:"16rpx",itemAlign:"center",headShow:!0,headWidth:"100rpx",headHeight:"100rpx",headBorderRadius:"50%",textShow:!0,textRows:1,textRowsGap:"0rpx",textWidth:"100%",textHeight:"24rpx",textBorderRadius:"6rpx",...e}}(v.config):"list"===e?function(e){return{padding:"20rpx",gridRows:2,gridColumns:1,gridRowsGap:"50rpx",gridColumnsGap:"24rpx",itemDirection:"row",itemGap:"30rpx",itemAlign:"flex-start",headShow:!0,headWidth:"200rpx",headHeight:"200rpx",headBorderRadius:"16rpx",textShow:!0,textRows:4,textRowsGap:"30rpx",textWidth:["50%","100%","100%","80%"],textHeight:["38rpx","24rpx","24rpx","24rpx"],textBorderRadius:"6rpx",...e}}(v.config):"waterfall"===e?function(e){return{padding:"20rpx",gridRows:2,gridColumns:2,gridRowsGap:"40rpx",gridColumnsGap:"24rpx",itemDirection:"column",itemGap:"16rpx",itemAlign:"center",headShow:!0,headWidth:"100%",headHeight:"400rpx",headBorderRadius:"12rpx",textShow:!0,textRows:3,textRowsGap:"12rpx",textWidth:["40%","85%","60%"],textHeight:["30rpx","20rpx","20rpx"],textBorderRadius:"6rpx",...e}}(v.config):v.config||{}}),{immediate:!0});const S=e=>"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e),C=(e="auto",t="px")=>(e=String(e),/^[\+-]?(\d+\.?\d*|\.\d+|\d\.\d+e\+\d+)$/.test(e)?`${e}${t}`:e);return(t,o)=>{const r=h;return l(),a(r,{class:"x-skeleton",style:n(c(k))},{default:s((()=>[i(" 骨架屏 "),y.value?(l(),a(r,{key:0,class:d(["x-skeleton__wrapper",[_.value&&"fade-out"]]),style:n({padding:f.value.padding})},{default:s((()=>[(l(!0),u(p,null,x(c(w),((t,o)=>(l(),a(r,{key:o,class:"x-skeleton__wrapper__rows",style:n({marginBottom:o<c(w).length-1?f.value.gridRowsGap:0})},{default:s((()=>[(l(!0),u(p,null,x(c(b),((t,o)=>(l(),a(r,{key:o,class:"x-skeleton__wrapper__columns",style:n({flexDirection:f.value.itemDirection,alignItems:f.value.itemAlign,marginRight:o<c(b).length-1?f.value.gridColumnsGap:0})},{default:s((()=>[f.value.headShow?(l(),a(r,{key:0,class:d(["x-skeleton__wrapper__head",[e.animate&&"animate"]]),style:n({width:f.value.headWidth,height:f.value.headHeight,borderRadius:f.value.headBorderRadius,marginRight:"row"==f.value.itemDirection&&f.value.textShow?f.value.itemGap:0,marginBottom:"column"==f.value.itemDirection&&f.value.textShow?f.value.itemGap:0})},null,8,["class","style"])):i("v-if",!0),f.value.textShow?(l(),a(r,{key:1,class:"x-skeleton__wrapper__text"},{default:s((()=>[(l(!0),u(p,null,x(c(R),((t,o)=>(l(),a(r,{key:o,class:d(["x-skeleton__wrapper__text__row",[e.animate&&"animate"]]),style:n({width:t.width,height:t.height,borderRadius:f.value.textBorderRadius,marginBottom:o<c(R).length-1?f.value.textRowsGap:0})},null,8,["class","style"])))),128))])),_:1})):i("v-if",!0)])),_:2},1032,["style"])))),128))])),_:2},1032,["style"])))),128))])),_:1},8,["class","style"])):(l(),u(p,{key:1},[i(" 插槽 "),g(r,null,{default:s((()=>[m(t.$slots,"default",{},void 0,!0)])),_:3})],2112))])),_:3},8,["style"])}}}),[["__scopeId","data-v-838e8cea"]]),O=e({__name:"index",props:["component","index","pullDownRefreshCount","value"],emits:["loadingFn"],setup(e,{emit:m}){const D=e,O=v(),T=f({type:"",loading:"decorate"!=O.mode,config:{}}),I=t([]),P=o((()=>D.value?D.value:"decorate"==O.mode?O.value[D.index]:D.component)),U=o((()=>{var e="";return e+="position:relative;",P.value.componentStartBgColor&&(P.value.componentStartBgColor&&P.value.componentEndBgColor?e+=`background:linear-gradient(${P.value.componentGradientAngle},${P.value.componentStartBgColor},${P.value.componentEndBgColor});`:e+="background-color:"+P.value.componentStartBgColor+";"),P.value.componentBgUrl&&(e+=`background-image:url('${B(P.value.componentBgUrl)}');`,e+="background-size: cover;background-repeat: no-repeat;"),P.value.topRounded&&(e+="border-top-left-radius:"+2*P.value.topRounded+"rpx;"),P.value.topRounded&&(e+="border-top-right-radius:"+2*P.value.topRounded+"rpx;"),P.value.bottomRounded&&(e+="border-bottom-left-radius:"+2*P.value.bottomRounded+"rpx;"),P.value.bottomRounded&&(e+="border-bottom-right-radius:"+2*P.value.bottomRounded+"rpx;"),e})),z=o((()=>{var e="";return P.value.componentBgUrl&&(e+="position:absolute;top:0;width:100%;",e+=`background: rgba(0,0,0,${P.value.componentBgAlpha/10});`,e+=`height:${J.value}px;`,P.value.topRounded&&(e+="border-top-left-radius:"+2*P.value.topRounded+"rpx;"),P.value.topRounded&&(e+="border-top-right-radius:"+2*P.value.topRounded+"rpx;"),P.value.bottomRounded&&(e+="border-bottom-left-radius:"+2*P.value.bottomRounded+"rpx;"),P.value.bottomRounded&&(e+="border-bottom-right-radius:"+2*P.value.bottomRounded+"rpx;")),e})),V=o((()=>{var e="";return P.value.elementBgColor&&(e+="background-color:"+P.value.elementBgColor+";"),P.value.topElementRounded&&(e+="border-top-left-radius:"+2*P.value.topElementRounded+"rpx;"),P.value.topElementRounded&&(e+="border-top-right-radius:"+2*P.value.topElementRounded+"rpx;"),P.value.bottomElementRounded&&(e+="border-bottom-left-radius:"+2*P.value.bottomElementRounded+"rpx;"),P.value.bottomElementRounded&&(e+="border-bottom-right-radius:"+2*P.value.bottomElementRounded+"rpx;"),"style-2"==P.value.style&&(P.value.margin&&P.value.margin.both?e+="width: calc((100vw - "+4*P.value.margin.both+"rpx - 20rpx) / 2);":e+="width: calc((100vw - 20rpx) / 2 );"),e})),q=o((()=>{var e="";return P.value.margin&&P.value.margin.both?e+="calc((100vw - "+4*P.value.margin.both+"rpx - 20rpx) / 2)":e+="calc((100vw - 20rpx) / 2 )",e})),K=o((()=>{var e="";return e+="padding:0 20rpx;",P.value.margin&&P.value.margin.both?e+="width: calc(100vw - "+(4*P.value.margin.both+40)+"rpx);":e+="box-sizing: border-box; width: 100vw;",e})),L=t(""),Q=()=>{L.value="margin-right:14rpx;"};r((()=>D.pullDownRefreshCount),((e,t)=>{}));const Z=R(),J=t(0);y((()=>{M(),"decorate"==O.mode?r((()=>P.value),((e,t)=>{e&&"GoodsList"==e.componentName&&_((()=>{b().in(Z).select(".diy-shop-goods-list").boundingClientRect((e=>{J.value=e.height})).exec(),"style-3"==P.value.style&&Q()}))})):r((()=>P.value),((e,t)=>{M()}),{deep:!0})}));const M=()=>{if("decorate"==O.mode){let e={goods_cover_thumb_mid:"",goods_name:"商品名称",sale_num:"100",unit:"件",goodsSku:{price:100}};I.value.push(e),I.value.push(e),_((()=>{"style-3"==P.value.style&&Q()}))}else"style-1"==P.value.style?(T.type="list",T.type="list",T.config={textRows:2}):"style-2"==P.value.style?(T.type="waterfall",T.config={headHeight:"320rpx",gridRows:1,textRows:2,textWidth:["100%","80%"]}):"style-3"==P.value.style&&(T.type="waterfall",T.config={gridRows:1,gridColumns:3,headHeight:"200rpx",textRows:2,textWidth:["100%","80%"]}),(()=>{let e={num:"all"==P.value.source||"category"==P.value.source?P.value.num:"",goods_ids:"custom"==P.value.source?P.value.goods_ids:"",goods_category:"category"==P.value.source?P.value.goods_category:"",order:P.value.sortWay};E(e).then((e=>{I.value=e.data,T.loading=!1,m("loadingFn",e.data),P.value.componentBgUrl&&setTimeout((()=>{b().in(Z).select(".diy-shop-goods-list").boundingClientRect((e=>{J.value=e.height})).exec()}),1e3),_((()=>{setTimeout((()=>{"style-3"==P.value.style&&Q()}),500)}))}))})()},X=e=>{W({url:"/addon/shop/pages/goods/detail",param:{goods_id:e.goods_id}})},Y=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&A()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},ee=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&A()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const o=h,r=H,m=k(S("u--image"),$),v=j,f=C,y=k(S("x-skeleton"),N);return l(),a(y,{type:T.type,loading:T.loading,config:T.config},{default:s((()=>[g(o,{style:n(c(U))},{default:s((()=>[g(o,{style:n(c(z))},null,8,["style"]),w("div",{class:"diy-shop-goods-list relative flex flex-wrap justify-between"},["style-1"==c(P).style?(l(!0),u(p,{key:0},x(I.value,((e,t)=>(l(),a(o,{class:d(["bg-white w-full flex p-[20rpx] mx-[20rpx] overflow-hidden",{"mt-[20rpx]":t>-10,"mb-[20rpx]":t+1==I.value.length}]),style:n(c(V)),key:e.goods_id,onClick:t=>X(e)},{default:s((()=>[g(m,{radius:"var(--goods-rounded-big)",width:"200rpx",height:"200rpx",src:c(B)(e.goods_cover_thumb_mid||""),model:"aspectFill"},{error:s((()=>[g(r,{class:"w-[200rpx] h-[200rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:c(B)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),g(o,{class:"flex-1 flex flex-col ml-[20rpx] py-[6rpx]"},{default:s((()=>[g(o,{class:"text-[28rpx] leading-[40rpx] text-[#303133] multi-hidden mb-[10rpx]",style:n({color:c(P).goodsNameStyle.color,fontWeight:c(P).goodsNameStyle.fontWeight})},{default:s((()=>[G(F(e.goods_name),1)])),_:2},1032,["style"]),g(o,{class:"mt-auto flex justify-between items-center items-baseline"},{default:s((()=>[g(o,{class:"font-bold text-[var(--price-text-color)] price-font flex items-baseline",style:n({color:c(P).priceStyle.mainColor})},{default:s((()=>[g(v,{class:"text-[24rpx] font-500 mr-[4rpx]"},{default:s((()=>[G("￥")])),_:1}),g(v,{class:"text-[40rpx] font-500"},{default:s((()=>[G(F(parseFloat(ee(e)).toFixed(2)),1)])),_:2},1024),"member_price"==Y(e)?(l(),a(r,{key:0,class:"h-[26rpx] ml-[6rpx]",src:c(B)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0),"discount_price"==Y(e)?(l(),a(r,{key:1,class:"h-[26rpx] ml-[6rpx]",src:c(B)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0)])),_:2},1032,["style"]),g(v,{class:"text-[22rpx] text-[var(--text-color-light9)]",style:n({color:c(P).saleStyle.color})},{default:s((()=>[G("已售"+F(e.sale_num)+F(e.unit||"件"),1)])),_:2},1032,["style"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","style","onClick"])))),128)):i("v-if",!0),"style-2"==c(P).style?(l(!0),u(p,{key:1},x(I.value,((e,t)=>(l(),a(o,{class:d(["flex flex-col bg-[#fff] box-border rounded-[var(--rounded-mid)] overflow-hidden",{"mt-[24rpx]":t>1}]),style:n(c(V)),key:e.goods_id,onClick:t=>X(e)},{default:s((()=>[g(m,{width:c(q),height:c(q),src:c(B)(e.goods_cover_thumb_mid||""),model:"aspectFill"},{error:s((()=>[g(r,{style:n({width:c(q),height:c(q)}),src:c(B)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["style","src"])])),_:2},1032,["width","height","src"]),g(o,{class:"px-[16rpx] flex-1 pt-[16rpx] pb-[20rpx] flex flex-col justify-between"},{default:s((()=>[g(o,{class:"text-[#303133] leading-[40rpx] text-[28rpx] multi-hidden",style:n({color:c(P).goodsNameStyle.color,fontWeight:c(P).goodsNameStyle.fontWeight})},{default:s((()=>[G(F(e.goods_name),1)])),_:2},1032,["style"]),g(o,{class:"flex justify-between flex-wrap items-baseline mt-[28rpx]"},{default:s((()=>[g(o,{class:"text-[var(--price-text-color)] price-font flex items-baseline",style:n({color:c(P).priceStyle.mainColor})},{default:s((()=>[g(v,{class:"text-[24rpx] font-400"},{default:s((()=>[G("￥")])),_:1}),g(v,{class:"text-[40rpx] font-500"},{default:s((()=>[G(F(parseFloat(ee(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),g(v,{class:"text-[24rpx] font-500"},{default:s((()=>[G("."+F(parseFloat(ee(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==Y(e)?(l(),a(r,{key:0,class:"h-[24rpx] ml-[6rpx]",src:c(B)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0),"discount_price"==Y(e)?(l(),a(r,{key:1,class:"h-[24rpx] ml-[6rpx]",src:c(B)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0)])),_:2},1032,["style"]),g(v,{class:"text-[22rpx] text-[var(--text-color-light9)]",style:n({color:c(P).saleStyle.color})},{default:s((()=>[G("已售"+F(e.sale_num)+F(e.unit||"件"),1)])),_:2},1032,["style"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","style","onClick"])))),128)):i("v-if",!0),"style-3"==c(P).style?(l(),a(o,{key:2,style:n(c(K))},{default:s((()=>[g(f,{id:"warpStyle3-"+c(P).id,class:"whitespace-nowrap min-h-[290rpx]","scroll-x":!0},{default:s((()=>[(l(!0),u(p,null,x(I.value,((e,t)=>(l(),a(o,{id:"item"+t+c(P).id,class:d(["w-[214rpx] mb-[6rpx] rounded-[var(--rounded-mid)] inline-block bg-[#fff] box-border overflow-hidden",{"!mr-[0rpx]":t==I.value.length-1}]),style:n(c(V)+L.value),key:e.goods_id,onClick:t=>X(e)},{default:s((()=>[g(m,{width:"214rpx",height:"160rpx",src:c(B)(e.goods_cover_thumb_mid||""),model:"aspectFill"},{error:s((()=>[g(r,{class:"w-[214rpx] h-[160rpx]",src:c(B)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),g(o,{class:"px-[10rpx] pt-[16rpx] pb-[10rpx]"},{default:s((()=>[g(o,{class:"text-[26rpx] text-[#303133] truncate",style:n({color:c(P).goodsNameStyle.color,fontWeight:c(P).goodsNameStyle.fontWeight})},{default:s((()=>[G(F(e.goods_name),1)])),_:2},1032,["style"]),g(o,{class:"text-[var(--price-text-color)] pt-[16rpx] pb-[6rpx] font-bold price-font flex items-baseline leading-[1] overflow-hidden",style:n({color:c(P).priceStyle.mainColor})},{default:s((()=>[g(o,null,{default:s((()=>[g(v,{class:"text-[20rpx] font-400 mr-[2rpx]"},{default:s((()=>[G("￥")])),_:1}),g(v,{class:"text-[36rpx] font-500"},{default:s((()=>[G(F(parseFloat(ee(e)).toFixed(2)),1)])),_:2},1024)])),_:2},1024),"member_price"==Y(e)?(l(),a(r,{key:0,class:"h-[24rpx] ml-[6rpx]",src:c(B)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0),"discount_price"==Y(e)?(l(),a(r,{key:1,class:"h-[24rpx] ml-[6rpx]",src:c(B)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0)])),_:2},1032,["style"])])),_:2},1024)])),_:2},1032,["id","class","style","onClick"])))),128))])),_:1},8,["id"])])),_:1},8,["style"])):i("v-if",!0)])])),_:1},8,["style"])])),_:1},8,["type","loading","config"])}}});export{N as _,O as a};
