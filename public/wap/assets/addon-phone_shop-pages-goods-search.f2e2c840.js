import{d as a,r as e,p as s,x as t,an as o,o as l,c,w as i,b as n,f as r,y as u,n as d,U as h,ad as y,V as f,c0 as g,k as m,a as x,bf as v,bk as p,ab as _,g as S,h as k,D as C,i as b,z as H,b7 as V,_ as z}from"./index-71c7df08.js";const A=z(a({__name:"search",setup(a){const z=e(""),A=e([]),U=e(!1);s((a=>{!uni.getStorageSync("goodsSearchHistory")&&uni.setStorageSync("goodsSearchHistory",[])})),t((()=>{j(),o((()=>{I()}))}));const j=()=>{A.value=uni.getStorageSync("goodsSearchHistory").reverse()},w=()=>{g({title:"提示",content:"确认删除全部历史记录？",confirmColor:m().themeColor["--primary-color"],success:a=>{a.confirm&&(uni.setStorageSync("goodsSearchHistory",[]),j())}})},D=()=>{if(""!=z.value.trim()){let a=uni.getStorageSync("goodsSearchHistory"),e=[];a.length?(e=a.filter((a=>a!=z.value.trim())),e.push(z.value.trim())):e.push(z.value.trim()),uni.setStorageSync("goodsSearchHistory",e),x({url:"/addon/phone_shop/pages/goods/list",param:{goods_name:z.value.trim()},mode:"navigateTo"})}},I=()=>{v().in(this).select("#history-list").boundingClientRect((a=>{a&&a.height>2*p(70)+2*p(35)&&(U.value=!0)})).exec()};return(a,e)=>{const s=_,t=S(k("u-icon"),V),o=C,g=b;return l(),c(g,{style:d(a.themeColor())},{default:i((()=>[n(g,{class:"cate-search"},{default:i((()=>[n(g,{class:"search-box"},{default:i((()=>[n(s,{class:"uni-input text-[24rpx]",maxlength:"50",modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=a=>z.value=a),"confirm-type":"search",focus:"",onConfirm:e[1]||(e[1]=a=>D()),placeholder:"搜索商品"},null,8,["modelValue"]),z.value?(l(),c(t,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:e[2]||(e[2]=a=>z.value="")})):r("v-if",!0),n(o,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 !text-[32rpx]",onClick:e[3]||(e[3]=a=>D())})])),_:1})])),_:1}),n(g,{class:"search-content"},{default:i((()=>[r(" 历史搜索 "),A.value.length?(l(),c(g,{key:0,class:"history"},{default:i((()=>[n(g,{class:"history-box"},{default:i((()=>[n(g,{class:"history-top"},{default:i((()=>[n(g,{class:"title"},{default:i((()=>[u("历史搜索")])),_:1}),n(g,{class:"icon nc-iconfont nc-icon-shanchu-yuangaizhiV6xx text-[28rpx] text-[#999]",onClick:w})])),_:1}),n(g,{class:"history-bottom",id:"history-list",style:d({maxHeight:U.value?"168rpx":"100%"})},{default:i((()=>[(l(!0),h(f,null,y(A.value,((a,e)=>(l(),c(g,{class:"history-li",key:e,onClick:e=>{return s=a,z.value=s,void D();var s}},{default:i((()=>[n(g,null,{default:i((()=>[u(H(a),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),U.value?(l(),c(g,{key:0,class:"history-li history_more",onClick:e[4]||(e[4]=a=>U.value=!1)},{default:i((()=>[n(g,null,{default:i((()=>[n(o,{class:"text-[30rpx] nc-iconfont nc-icon-xiaV6xx"})])),_:1})])),_:1})):r("v-if",!0)])),_:1},8,["style"])])),_:1})])),_:1})):r("v-if",!0)])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-16af90c7"]]);export{A as default};
