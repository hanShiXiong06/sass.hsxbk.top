import{d as e,r as t,T as o,o as l,c as r,w as a,u as s,b as i,A as d,f as c,U as u,ad as n,V as p,W as x,a as f,D as g,ab as _,i as v,ac as m,g as b,h,y as k,z as y,E as C,B as w,bl as S,_ as j,j as V,a4 as F,s as I,t as N,C as B,aV as R,bY as E,aA as L,l as U,e as z,v as O,n as T,ae as M,af as $,H,p as P,x as D,L as A}from"./index-71c7df08.js";import{_ as W}from"./tabbar.a37cc2d9.js";import{_ as Y}from"./loading-page.vue_vue_type_script_setup_true_lang.c7dc2256.js";import{b as J,i as K,c as Q,j as q}from"./goods.3be4f1b5.js";import{M as G}from"./mescroll-empty.95b8c17e.js";import{M as X}from"./mescroll-body.49de0f6f.js";import{u as Z}from"./useMescroll.26ccf5de.js";import{u as ee}from"./cart.9b3f86c4.js";import{f as te}from"./cloneDeep.77735539.js";import{b as oe}from"./bind-mobile.b7e673b6.js";import"./mescroll-i18n.00218d15.js";/* empty css                                                                       */import"./sms-code.vue_vue_type_script_setup_true_lang.e09e1c1f.js";/* empty css                                                                    */const le=j(e({__name:"category-template-two-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const j=e;let V=j.config,F=j.categoryId;const I=t(""),N=t(!0);o((()=>{R()}));const B=t([]),R=()=>{N.value=!0,J().then((e=>{if(B.value=e.data,F)for(let t=0;t<B.value.length;t++){if(B.value[t].category_id==F){E.value=t;break}if(B.value[t].child_list)for(let e=0;e<B.value[t].child_list.length;e++)if(B.value[t].child_list[e].category_id==F){E.value=t;break}}N.value=!1})).catch((()=>{N.value=!1}))},E=t(0),L=()=>{I.value&&f({url:"/addon/shop/pages/goods/list",param:{goods_name:encodeURIComponent(I.value)}})};return(e,t)=>{const o=g,j=_,F=v,R=m,U=w,z=b(h("u--image"),S),O=b(h("tabbar"),W),T=b(h("loading-page"),Y);return l(),r(F,{class:"bg-[var(--page-bg-color)] overflow-hidden min-h-screen"},{default:a((()=>[B.value.length?(l(),r(F,{key:0,class:"mescroll-box"},{default:a((()=>[s(V).search.control?(l(),r(F,{key:0,class:"search-box box-border z-10 fixed top-0 left-0 right-0 h-[100rpx] bg-[#fff]"},{default:a((()=>[i(F,{class:"flex-1 search-input"},{default:a((()=>[i(o,{onClick:d(L,["stop"]),class:"nc-iconfont nc-icon-sousuo-duanV6xx1 btn"},null,8,["onClick"]),i(j,{class:"input",type:"text",modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=e=>I.value=e),placeholder:s(V).search.title,placeholderClass:"text-[var(--text-color-light9)]",onConfirm:L},null,8,["modelValue","placeholder"]),I.value?(l(),r(o,{key:0,class:"nc-iconfont nc-icon-cuohaoV6xx1 clear",onClick:t[1]||(t[1]=e=>I.value="")})):c("v-if",!0)])),_:1})])),_:1})):c("v-if",!0),i(F,{class:x(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[100rpx]":s(V).search.control}])},{default:a((()=>[i(R,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(F,{class:"bg-[var(--temp-bg)]"},{default:a((()=>[(l(!0),u(p,null,n(B.value,((e,t)=>(l(),r(F,{class:x(["tab-item truncate",{"tab-item-active":t==E.value,"rounded-br-[12rpx]":E.value-1===t,"rounded-tr-[12rpx]":E.value+1===t}]),key:t,onClick:e=>(e=>{E.value=e})(t)},{default:a((()=>[i(F,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(R,{class:"h-[100vh]","scroll-y":!0},{default:a((()=>[i(F,{class:x(["pl-[188rpx] scroll-ios pt-[20rpx] pr-[20rpx]",{"!pt-[120rpx]":s(V).search.control}])},{default:a((()=>{var e,t;return[(null==(e=B.value[E.value])?void 0:e.child_list)&&!N.value?(l(),r(F,{key:0,class:"bg-[#fff] grid grid-cols-3 gap-x-[50rpx] gap-y-[32rpx] py-[32rpx] px-[24rpx] rounded-[var(--rounded-big)]"},{default:a((()=>{var e;return[(l(!0),u(p,null,n(null==(e=B.value[E.value])?void 0:e.child_list,((e,t)=>(l(),r(F,{key:e.category_id,onClick:t=>{return o=e.category_id,void f({url:"/addon/shop/pages/goods/list",param:{curr_goods_category:o}});var o},class:"flex items-center justify-center flex-col"},{default:a((()=>[i(z,{radius:"var(--goods-rounded-big)",width:"120rpx",height:"120rpx",src:s(C)(e.image?e.image:""),model:"aspectFill"},{error:a((()=>[i(U,{class:"rounded-[var(--goods-rounded-big)] overflow-hidden w-[120rpx] h-[120rpx]",src:s(C)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(F,{class:"text-[24rpx] text-center mt-[16rpx] leading-[34rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))]})),_:1})):c("v-if",!0),(null==(t=B.value[E.value])?void 0:t.child_list)||N.value?c("v-if",!0):(l(),r(G,{key:1,class:"part",option:{tip:"暂无商品分类"}}))]})),_:1},8,["class"])])),_:1})])),_:1})):c("v-if",!0),i(O),B.value.length||N.value?c("v-if",!0):(l(),r(G,{key:1,option:{tip:"暂无商品分类"}})),i(T,{loading:N.value},null,8,["loading"])])),_:1})}}}),[["__scopeId","data-v-f0126b10"]]),re=j(e({__name:"add-cart-popup",setup(e,{expose:o}){const f=ee(),j=V((()=>f.cartList)),U=t(!1),z=t({skuId:"",name:[]}),O=t({}),T=t({}),M=t(1),$=()=>{setTimeout((()=>{M.value>=T.value.stock&&(M.value=T.value.stock)}),0)},H=()=>{setTimeout((()=>{(!M.value||M.value<=0)&&(M.value=1),M.value>=T.value.stock&&(M.value=T.value.stock)}),0)},P=()=>{U.value=!1},D=V((()=>{let e=te(O.value);return Object.keys(e).length&&(Object.keys(z.value.name).length||(z.value.name=e.sku_spec_format.split(",")),e.goodsSpec.forEach(((e,t)=>{let o=e.spec_values.split(",");e.values=[],o.forEach(((o,l)=>{e.values[l]={},e.values[l].name=o,e.values[l].selected=!1,e.values[l].disabled=!1,z.value.name.forEach(((r,a)=>{a==t&&r==o&&(e.values[l].selected=!0)}))}))})),A(),e.skuList&&Object.keys(e.skuList).length&&e.skuList.forEach((e=>{e.sku_id==z.value.skuId&&(T.value=e)}))),e}));F((()=>T.value),((e,t)=>{j.value["goods_"+T.value.goods_id]&&j.value["goods_"+T.value.goods_id]["sku_"+T.value.sku_id]?(M.value=R(j.value["goods_"+T.value.goods_id]["sku_"+T.value.sku_id].num),T.value.cart_id=R(j.value["goods_"+T.value.goods_id]["sku_"+T.value.sku_id].id)):(M.value=1,T.value.cart_id="")}));const A=()=>{O.value.skuList.forEach(((e,t)=>{let o=e.sku_spec_format.split(",");z.value.name.every((e=>o.includes(e)))&&(z.value.skuId=e.sku_id)}))},W=()=>{if(0==M.value)f.reduce({id:T.value.cart_id||"",goods_id:T.value.goods_id,sale_price:T.value.sale_price,sku_id:T.value.sku_id});else{let e=0;e=D.value.goods.is_discount&&T.value.sale_price!=T.value.price?T.value.sale_price?T.value.sale_price:T.value.price:D.value.goods.member_discount&&I()&&T.value.member_price!=T.value.price&&T.value.member_price?T.value.member_price:T.value.price,f.increase({id:T.value.cart_id||"",goods_id:T.value.goods_id,sku_id:T.value.sku_id,stock:T.value.stock,sale_price:e,num:M.value},0,(()=>{N({title:"加入购物车成功",icon:"none"})}))}U.value=!1},Y=e=>{let t="0.00";return t=D.value.goods.is_discount&&e.sale_price!=e.price?e.sale_price?e.sale_price:e.price:D.value.goods.member_discount&&I()&&e.member_price!=e.price&&e.member_price?e.member_price:e.price,t},J=e=>{let t="";return t=D.value.goods.is_discount&&e.sale_price!=e.price?"discount_price":D.value.goods.member_discount&&I()&&e.member_price!=e.price?"member_price":"",t};return o({open:e=>{(e=>{K(e).then((t=>{O.value=t.data,z.value.sku_id=e,O.value.skuList&&Object.keys(O.value.skuList).length&&O.value.skuList.forEach((t=>{t.sku_id==e&&(T.value=t,z.value.name=t.sku_spec_format.split(","))})),U.value=!0}))})(e)}}),(e,t)=>{const o=w,f=b(h("u--image"),S),V=g,F=v,I=_,N=b(h("u-number-box"),E),R=m,O=B,A=b(h("u-popup"),L);return l(),r(F,{onTouchmove:t[5]||(t[5]=d((()=>{}),["prevent","stop"]))},{default:a((()=>[i(A,{show:U.value,onClose:P,mode:"bottom"},{default:a((()=>[Object.keys(s(D)).length?(l(),r(F,{key:0,onTouchmove:t[4]||(t[4]=d((()=>{}),["prevent","stop"])),class:"rounded-t-[20rpx] overflow-hidden bg-[#fff] py-[32rpx] relative"},{default:a((()=>[i(F,{class:"flex mb-[58rpx] px-[32rpx]"},{default:a((()=>[i(f,{width:"180rpx",height:"180rpx",radius:"var(--goods-rounded-big)",src:s(C)(T.value.sku_image),model:"aspectFill"},{error:a((()=>[i(o,{class:"w-[180rpx] h-[180rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:s(C)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:1},8,["radius","src"]),i(F,{class:"flex flex-1 flex-col justify-between ml-[20rpx] py-[10rpx]"},{default:a((()=>[i(F,{class:"w-[100%]"},{default:a((()=>[i(F,{class:"text-[var(--price-text-color)] flex items-baseline"},{default:a((()=>[i(V,{class:"text-[32rpx] font-bold price-font mr-[4rpx]"},{default:a((()=>[k("￥")])),_:1}),i(V,{class:"text-[48rpx] price-font"},{default:a((()=>[k(y(parseFloat(Y(T.value)).toFixed(2).split(".")[0]),1)])),_:1}),i(V,{class:"text-[32rpx] price-font"},{default:a((()=>[k("."+y(parseFloat(Y(T.value)).toFixed(2).split(".")[1]),1)])),_:1}),i(o,{class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"]),"discount_price"==J(T.value)?(l(),r(o,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0)])),_:1}),i(F,{class:"text-[26rpx] leading-[32rpx] text-[#303133] mt-[12rpx]"},{default:a((()=>[k("库存"+y(T.value.stock)+y(s(D).goods.unit),1)])),_:1})])),_:1}),s(D).goodsSpec&&s(D).goodsSpec.length?(l(),r(F,{key:0,class:"w-[100%] text-[26rpx] leading-[30rpx] text-[var(--text-color-light6)] multi-hidden max-h-[60rpx]"},{default:a((()=>[k("已选规格："+y(T.value.sku_spec_format),1)])),_:1})):c("v-if",!0)])),_:1})])),_:1}),i(R,{class:"h-[500rpx] box-border px-[32rpx] mb-[30rpx]","scroll-y":"true"},{default:a((()=>[(l(!0),u(p,null,n(s(D).goodsSpec,((e,t)=>(l(),r(F,{class:x({"mt-[36rpx]":0!=t}),key:t},{default:a((()=>[i(F,{class:"text-[26rpx] leading-[36rpx] mb-[24rpx]"},{default:a((()=>[k(y(e.spec_name),1)])),_:2},1024),i(F,{class:"flex flex-wrap"},{default:a((()=>[(l(!0),u(p,null,n(e.values,((e,o)=>(l(),r(F,{class:x(["box-border bg-[#f2f2f2] text-[24rpx] px-[44rpx] text-center h-[56rpx] leading-[52rpx] mr-[20rpx] mb-[20rpx] border-1 border-solid rounded-[50rpx] border-[#f2f2f2]",{"!border-[var(--primary-color)] text-[var(--primary-color)] !bg-[var(--primary-color-light)]":e.selected}]),key:o,onClick:o=>((e,t)=>{z.value.name[t]=e.name,M.value=1})(e,t)},{default:a((()=>[k(y(e.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1032,["class"])))),128)),i(F,{class:"flex justify-between items-center mt-[8rpx]"},{default:a((()=>[i(F,{class:"text-[26rpx]"},{default:a((()=>[k("购买数量")])),_:1}),s(j)["goods_"+T.value.goods_id]&&s(j)["goods_"+T.value.goods_id]["sku_"+T.value.sku_id]?(l(),r(N,{key:0,modelValue:M.value,"onUpdate:modelValue":t[1]||(t[1]=e=>M.value=e),min:0,max:T.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(V,{class:x(["text-[34rpx] nc-iconfont nc-icon-jianV6xx font-500",{"!text-[var(--text-color-light9)]":M.value<=0}])},null,8,["class"])])),input:a((()=>[i(I,{class:"text-[#303133] text-[28rpx] mx-[10rpx] w-[80rpx] h-[44rpx] bg-[var(--temp-bg)] leading-[44rpx] text-center rounded-[6rpx]",type:"number",onInput:$,onBlur:H,modelValue:M.value,"onUpdate:modelValue":t[0]||(t[0]=e=>M.value=e)},null,8,["modelValue"])])),plus:a((()=>[i(V,{class:x(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx font-500",{"!text-[var(--text-color-light9)]":M.value===T.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"])):(l(),r(N,{key:1,modelValue:M.value,"onUpdate:modelValue":t[3]||(t[3]=e=>M.value=e),min:1,max:T.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(V,{class:x(["text-[34rpx] nc-iconfont nc-icon-jianV6xx font-500",{"!text-[var(--text-color-light9)]":M.value<=1}])},null,8,["class"])])),input:a((()=>[i(I,{class:"text-[#303133] text-[28rpx] mx-[10rpx] w-[80rpx] h-[44rpx] bg-[var(--temp-bg)] leading-[44rpx] text-center rounded-[6rpx]",type:"number",onInput:$,onBlur:H,modelValue:M.value,"onUpdate:modelValue":t[2]||(t[2]=e=>M.value=e)},null,8,["modelValue"])])),plus:a((()=>[i(V,{class:x(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx font-500",{"!text-[var(--text-color-light9)]":M.value===T.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"]))])),_:1})])),_:1}),i(F,{class:"px-[20rpx]"},{default:a((()=>[T.value.stock>0?(l(),r(O,{key:0,class:"!h-[80rpx] font-500 primary-btn-bg leading-[80rpx] text-[26rpx] rounded-[50rpx]",type:"primary",onClick:W},{default:a((()=>[k("确定")])),_:1})):(l(),r(O,{key:1,class:"!h-[80rpx] leading-[80rpx] font-500 text-[26rpx] text-[#fff] bg-[#ccc] rounded-[50rpx]"},{default:a((()=>[k("已售罄")])),_:1}))])),_:1})])),_:1})):c("v-if",!0)])),_:1},8,["show"])])),_:1})}}}),[["__scopeId","data-v-0900eb62"]]),ae=j(e({__name:"category-template-one-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const j=e,F=ee();F.getList();const R=V((()=>F.cartList)),E=V((()=>F.totalNum)),L=V((()=>F.totalMoney)),P=U(),D=V((()=>P.info)),{mescrollInit:A,getMescroll:K}=Z($,M);let q=j.config,le=j.categoryId;const ae=t([]),se=t(""),ie=t(!0),de=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const ce=e=>{de.value=!1,Q({page:e.num,limit:e.size,goods_category:le}).then((t=>{let o=t.data.data;1==e.num&&(ae.value=[]),ae.value=ae.value.concat(o),ie.value=!1,e.endSuccess(o.length),ae.value.length||(de.value=!0)})).catch((()=>{ie.value=!1,de.value=!0,e.endErr()}))},ue=e=>{f({url:"/addon/shop/pages/goods/detail",param:{goods_id:e}})};o((()=>{_e()}));const ne=t(""),pe=t(!1),xe=t(!1),fe=(e,t)=>{if(pe.value||xe.value)return!1;pe.value=!0,xe.value=!0;let o={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:Se(e),stock:e.goodsSku.stock};e.id&&(o.num=e.num,o.id=e.id),F.increase(o,1,(()=>{xe.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),o=e.getBoundingClientRect().left,l=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;ne.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{ne.value=`top: ${l+e.offsetHeight/2-r.offsetHeight/2}px; left: ${o+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{ne.value="",pe.value=!1}),1020)}),100)},ge=t([]),_e=()=>{ie.value=!0,J().then((e=>{if(ge.value=e.data,le)for(let t=0;t<ge.value.length;t++){if(ge.value[t].category_id==le){ve.value=t;break}if(ge.value[t].child_list)for(let e=0;e<ge.value[t].child_list.length;e++)if(ge.value[t].child_list[e].category_id==le){ve.value=t;break}}else le=e.data[0].category_id;ie.value=!1})).catch((()=>{ie.value=!1}))},ve=t(0),me=()=>{se.value&&f({url:"/addon/shop/pages/goods/list",param:{goods_name:encodeURIComponent(se.value)}})},be=t(),he=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return ue(e.goodsSku.goods_id);if("cart"!==q.cart.event)return ue(e.goodsSku.goods_id);if(!D.value)return H().setLoginBack({url:"/addon/shop/pages/goods/category"}),!1;if(e.goodsSku.sku_spec_format)be.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void N({title:"商品库存不足",icon:"none"});fe(e,t)}},ke=()=>{f({url:"/addon/shop/pages/goods/cart"})},ye=t(null);t(uni.getStorageSync("isbindmobile"));const Ce=()=>{if(uni.getStorageSync("isbindmobile"))return ye.value.open(),!1;if(!E.value)return void N({title:"还没有选择商品",icon:"none"});const e=[];Object.values(R.value).forEach((t=>{Object.keys(t).forEach((o=>{"totalNum"!=o&&"totalMoney"!=o&&e.push(t[o].id)}))})),0!=e.length&&uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/shop/pages/order/payment"})}})},we=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&I()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},Se=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&I()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const o=g,f=_,j=v,V=m,I=w,U=b(h("u--image"),S),M=B,$=b(h("loading-page"),Y),H=b(h("tabbar"),W);return l(),r(j,{class:"min-h-screen bg-[var(--page-bg-color)] overflow-hidden"},{default:a((()=>[ge.value.length?(l(),r(j,{key:0,class:x(["mescroll-box bg-[var(--page-bg-color)]",{cart:s(q).cart.control&&"cart"===s(q).cart.event,detail:!(s(q).cart.control&&"cart"===s(q).cart.event)}])},{default:a((()=>[i(X,{ref:"mescrollRef",down:{use:!1},onInit:s(A),onUp:ce},{default:a((()=>[s(q).search.control?(l(),r(j,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[100rpx] box-border"},{default:a((()=>[i(j,{class:"flex-1 search-input"},{default:a((()=>[i(o,{onClick:d(me,["stop"]),class:"nc-iconfont nc-icon-sousuo-duanV6xx1 btn"},null,8,["onClick"]),i(f,{class:"input",type:"text",modelValue:se.value,"onUpdate:modelValue":t[0]||(t[0]=e=>se.value=e),placeholder:s(q).search.title,onConfirm:me,placeholderClass:"text-[var(--text-color-light9)]"},null,8,["modelValue","placeholder"]),se.value?(l(),r(o,{key:0,class:"nc-iconfont nc-icon-cuohaoV6xx1 clear",onClick:t[1]||(t[1]=e=>se.value="")})):c("v-if",!0)])),_:1})])),_:1})):c("v-if",!0),i(j,{class:x(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[100rpx]":s(q).search.control,"pb-[98rpx]":s(q).cart.control&&"cart"===s(q).cart.event}])},{default:a((()=>[i(V,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(j,{class:"bg-[var(--temp-bg)]"},{default:a((()=>[(l(!0),u(p,null,n(ge.value,((e,t)=>(l(),r(j,{class:x(["tab-item truncate",{"tab-item-active":t==ve.value,"rounded-br-[12rpx]":ve.value-1===t,"rounded-tr-[12rpx]":ve.value+1===t}]),key:t,onClick:o=>((e,t)=>{ve.value=e,le=t.category_id,ae.value=[],K().resetUpScroll()})(t,e)},{default:a((()=>[i(j,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(j,{class:x(["flex justify-center flex-wrap pl-[188rpx] pb-[20rpx]",{" pt-[120rpx]":s(q).search.control," pt-[20rpx]":!s(q).search.control}])},{default:a((()=>[(l(!0),u(p,null,n(ae.value,((e,t)=>(l(),r(j,{key:e.goods_id,class:x(["box-border bg-white w-full flex mr-[20rpx] py-[24rpx] px-[20rpx] rounded-[var(--rounded-small)]",{"mt-[16rpx]":t}]),onClick:d((t=>ue(e.goods_id)),["stop"])},{default:a((()=>[i(U,{width:"168rpx",height:"168rpx",radius:"var(--goods-rounded-small)",src:s(C)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(I,{class:"w-[168rpx] h-[168rpx]",src:s(C)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(j,{class:"flex flex-1 ml-[20rpx] flex-wrap flex-col"},{default:a((()=>[i(j,{class:"max-h-[80rpx] text-[26rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),i(j,{class:"flex-1 flex items-end justify-between"},{default:a((()=>[i(j,{class:"text-[var(--price-text-color)] price-font -mb-[8rpx]"},{default:a((()=>[i(o,{class:"text-[24rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(o,{class:"text-[40rpx] font-500"},{default:a((()=>[k(y(parseFloat(Se(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(o,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(Se(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==we(e)?(l(),r(I,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0),"discount_price"==we(e)?(l(),r(I,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(q).cart.control&&"cart"===s(q).cart.event?(l(),r(j,{key:0,class:"flex items-center"},{default:a((()=>[i(o,{class:"text-[32rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:d((t=>(e=>{if(xe.value)return!1;xe.value=!0,F.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{xe.value=!1}))})(s(R)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(o,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(o,{class:"text-[32rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:d((o=>((e,t,o)=>{if(parseInt(t.num)>=parseInt(t.stock))return void N({title:"商品库存不足",icon:"none"});let l=te(e);l.num=t.num,l.id=t.id,fe(l,o)})(e,s(R)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(q).cart.event||"real"==e.goods_type?(l(),u(p,{key:1},[s(q).cart.control&&"style-1"===s(q).cart.style?(l(),r(j,{key:0,class:"h-[44rpx] relative"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"w-[102rpx] box-border text-center text-[#fff] primary-btn-bg h-[46rpx] text-[22rpx] leading-[46rpx] rounded-[100rpx]",onClick:d((o=>he(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(q).cart.text),1)])),_:2},1032,["id","onClick"]),s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(R)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(q).cart.control&&"style-2"===s(q).cart.style?(l(),r(j,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(o,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:d((o=>he(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(R)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(q).cart.control&&"style-3"===s(q).cart.style?(l(),r(j,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(o,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:d((o=>he(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(R)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(q).cart.control&&"style-4"===s(q).cart.style?(l(),r(j,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:d((o=>he(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(R)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0)],64)):c("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),ae.value.length||ie.value||!de.value?c("v-if",!0):(l(),r(G,{key:0,class:"part",option:{tip:"暂无商品"}}))])),_:1},8,["class"]),i(re,{ref_key:"cartRef",ref:be},null,512)])),_:1},8,["onInit"]),s(q).cart.control&&"cart"===s(q).cart.event?(l(),r(j,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios border-[0] border-t-[2rpx] border-solid border-[#f6f6f6]"},{default:a((()=>[i(j,{class:"flex items-center"},{default:a((()=>[i(j,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(j,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:d(ke,["stop"])},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(E)?(l(),r(j,{key:0,class:x(["border-[1rpx] border-solid border-[#fff]",["absolute left-[40rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[26rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(E)>9?"px-[10rpx]":""]])},{default:a((()=>[k(y(s(E)>99?"99+":s(E)),1)])),_:1},8,["class"])):c("v-if",!0)])),_:1}),i(o,{class:"text-[26rpx] font-500 text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(j,{class:"text-[var(--price-text-color)] price-font font-bold flex items-baseline"},{default:a((()=>[i(o,{class:"text-[26rpx] mr-[6rpx]"},{default:a((()=>[k("￥")])),_:1}),i(o,{class:"text-[44rpx]"},{default:a((()=>[k(y(parseFloat(s(L))),1)])),_:1})])),_:1})])),_:1}),i(M,{class:"w-[180rpx] h-[70rpx] text-[26rpx] leading-[70rpx] font-500 !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",onClick:Ce},{default:a((()=>[k("去结算")])),_:1})])),_:1})):c("v-if",!0)])),_:1},8,["class"])):c("v-if",!0),z(i(j,{style:T(ne.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[O,ne.value]]),ge.value.length||ie.value?c("v-if",!0):(l(),r(G,{key:1,option:{tip:"暂无商品分类"}})),i($,{loading:ie.value},null,8,["loading"]),i(H),c(" 强制绑定手机号 "),i(oe,{ref_key:"bindMobileRef",ref:ye},null,512)])),_:1})}}}),[["__scopeId","data-v-5d802cbc"]]),se=j(e({__name:"category-template-two-two",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const j=e,F=ee();F.getList();const R=V((()=>F.cartList)),E=V((()=>F.totalNum)),P=V((()=>F.totalMoney)),D=U(),A=V((()=>D.info)),{mescrollInit:K,getMescroll:q}=Z($,M);let le=j.config,ae=j.categoryId;const se=t([]),ie=t(""),de=t(!0),ce=t(!1),ue=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const ne=e=>{ce.value=!1,Q({page:e.num,limit:e.size,goods_category:ae}).then((t=>{let o=t.data.data;1==e.num&&(se.value=[]),se.value=se.value.concat(o),de.value=!1,e.endSuccess(o.length),se.value.length||(ce.value=!0)})).catch((()=>{de.value=!1,ce.value=!0,e.endErr()}))},pe=e=>{f({url:"/addon/shop/pages/goods/detail",param:{goods_id:e}})};o((()=>{me()}));const xe=t(""),fe=t(!1),ge=t(!1),_e=(e,t)=>{if(fe.value||ge.value)return!1;fe.value=!0,ge.value=!0;let o={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:Ie(e),stock:e.goodsSku.stock};e.id&&(o.num=e.num,o.id=e.id),F.increase(o,1,(()=>{ge.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),o=e.getBoundingClientRect().left,l=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;xe.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{xe.value=`top: ${l+e.offsetHeight/2-r.offsetHeight/2}px; left: ${o+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{xe.value="",fe.value=!1}),1020)}),100)};t({allActive:-1,data:{category_name:"全部",category_id:""}});const ve=t([]),me=()=>{de.value=!0,J().then((e=>{ve.value=e.data;for(let t=0;t<ve.value.length;t++)if(ve.value[t].child_list){let e={category_name:"全部",category_id:ve.value[t].category_id};ve.value[t].child_list.unshift(e)}if(ae)for(let t=0;t<ve.value.length;t++){if(ve.value[t].category_id==ae){be.value=t;break}if(ve.value[t].child_list)for(let e=0;e<ve.value[t].child_list.length;e++)if(ve.value[t].child_list[e].category_id==ae){be.value=t,he.value=e;break}}else ae=e.data[0].category_id;de.value=!1})).catch((()=>{de.value=!1}))},be=t(0),he=t(0),ke=(e,t)=>{he.value=e,ae=t.category_id,ue.value=!1,se.value=[],q().resetUpScroll()},ye=()=>{ie.value&&f({url:"/addon/shop/pages/goods/list",param:{goods_name:encodeURIComponent(ie.value)}})},Ce=t(),we=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return pe(e.goodsSku.goods_id);if("cart"!==le.cart.event)return pe(e.goods_id);if(!A.value)return H().setLoginBack({url:"/addon/shop/pages/goods/category"}),!1;if(e.goodsSku.sku_spec_format)Ce.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void N({title:"商品库存不足",icon:"none"});_e(e,t)}},Se=()=>{f({url:"/addon/shop/pages/goods/cart"})},je=t(null);t(uni.getStorageSync("isbindmobile"));const Ve=()=>{if(uni.getStorageSync("isbindmobile"))return je.value.open(),!1;if(!E.value)return void N({title:"还没有选择商品",icon:"none"});const e=[];Object.values(R.value).forEach((t=>{Object.keys(t).forEach((o=>{"totalNum"!=o&&"totalMoney"!=o&&e.push(t[o].id)}))})),0!=e.length&&uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/shop/pages/order/payment"})}})},Fe=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&I()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},Ie=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&I()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const o=g,f=_,j=v,V=m,I=b(h("u-popup"),L),U=w,M=b(h("u--image"),S),$=B,H=b(h("loading-page"),Y),D=b(h("tabbar"),W);return l(),r(j,{class:"min-h-screen bg-[var(--page-bg-color)] overflow-hidden"},{default:a((()=>[ve.value.length?(l(),r(j,{key:0,class:x(["mescroll-box bg-[#f6f6f6]",{cart:s(le).cart.control&&"cart"===s(le).cart.event,detail:!(s(le).cart.control&&"cart"===s(le).cart.event)}])},{default:a((()=>[i(X,{ref:"mescrollRef",down:{use:!1},onInit:s(K),onUp:ne},{default:a((()=>{var e,g,_,v,m,b;return[s(le).search.control?(l(),r(j,{key:0,class:"box-border search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[96rpx]"},{default:a((()=>[i(j,{class:"flex-1 search-input"},{default:a((()=>[i(o,{onClick:d(ye,["stop"]),class:"nc-iconfont nc-icon-sousuo-duanV6xx1 btn"},null,8,["onClick"]),i(f,{class:"input",type:"text",modelValue:ie.value,"onUpdate:modelValue":t[0]||(t[0]=e=>ie.value=e),placeholder:s(le).search.title,placeholderClass:"text-[var(--text-color-light9)]",onConfirm:ye},null,8,["modelValue","placeholder"]),ie.value?(l(),r(o,{key:0,class:"nc-iconfont nc-icon-cuohaoV6xx1 clear",onClick:t[1]||(t[1]=e=>ie.value="")})):c("v-if",!0)])),_:1})])),_:1})):c("v-if",!0),i(j,{class:x(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[96rpx]":s(le).search.control,"pb-[98rpx]":s(le).cart.control&&"cart"===s(le).cart.event}])},{default:a((()=>[i(V,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(j,{class:"bg-[var(--temp-bg)]"},{default:a((()=>[(l(!0),u(p,null,n(ve.value,((e,t)=>(l(),r(j,{class:x(["tab-item truncate",{"tab-item-active ":t==be.value,"rounded-br-[12rpx]":!(be.value-1!==t||ve.value[be.value].child_list&&ve.value[be.value].child_list.length),"rounded-tr-[12rpx]":!(be.value+1!==t||ve.value[be.value].child_list&&ve.value[be.value].child_list.length)}]),key:t,onClick:o=>((e,t)=>{be.value=e,t.child_list&&t.child_list.length?ke(0,t.child_list[0]):(ae=t.category_id,se.value=[],q().resetUpScroll())})(t,e)},{default:a((()=>[i(j,{class:"text-box truncate px-[24rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),(null==(e=ve.value[be.value])?void 0:e.child_list)&&(null==(g=ve.value[be.value])?void 0:g.child_list.length)?(l(),r(j,{key:1,class:x(["flex items-center h-[98rpx] pl-[24rpx] pr-[48rpx] py-[20rpx] z-10 bg-white fixed left-[168rpx] right-0 box-border top-0",{"!top-[94rpx]":s(le).search.control}])},{default:a((()=>[ue.value?(l(),u(p,{key:1},[i(j,{class:"flex-1 h-[48rpx] text-[28rpx] text-[var(--text-color-light9)] pr-[24rpx] leading-[48rpx]"},{default:a((()=>[k("全部分类")])),_:1}),i(o,{class:"absolute right-[24rpx] nc-iconfont nc-icon-shangV6xx-1 text-[#333] text-[30rpx]",onClick:t[3]||(t[3]=e=>ue.value=!1)})],64)):(l(),u(p,{key:0},[i(V,{"scroll-x":!0,"scroll-with-animation":"","scroll-into-view":"id"+(he.value?he.value-1:0),class:"flex-1 h-[54rpx] scroll-Y box-border pr-[24rpx] bg-white"},{default:a((()=>[i(j,{class:"flex items-center h-[54rpx] box-border"},{default:a((()=>{var e;return[(l(!0),u(p,null,n(null==(e=ve.value[be.value])?void 0:e.child_list,((e,t)=>(l(),r(o,{class:x(["w-[150rpx] flex-shrink-0 px-[14rpx] h-[54rpx] truncate text-center !leading-[50rpx] !text-[24rpx] border-[2rpx] border-solid !rounded-[100rpx] box-border text-[#333] box-border",{"bg-[var(--primary-color-light)] font-500 text-[var(--primary-color)] border-[var(--primary-color)]":t===he.value,"border-[var(--temp-bg)]  bg-[var(--temp-bg)]":t!=he.value," ml-[24rpx]":0!=t}]),key:ve.value[be.value].category_id,id:"id"+t,onClick:o=>ke(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","id","onClick"])))),128))]})),_:1})])),_:1},8,["scroll-into-view"]),i(j,{class:"absolute right-[24rpx] nc-iconfont nc-icon-xiaV6xx text-[30rpx] w-[30rpx] h-[30rpx] text-center transform",onClick:t[2]||(t[2]=e=>ue.value=!0)})],64))])),_:1},8,["class"])):c("v-if",!0),i(j,{class:x(["labelPopup",{active:s(le).search.control}])},{default:a((()=>[i(I,{show:ue.value,mode:"top",onClose:t[5]||(t[5]=e=>ue.value=!1)},{default:a((()=>[i(j,{class:"flex flex-wrap pt-[20rpx] pb-[24rpx]",onTouchmove:t[4]||(t[4]=d((()=>{}),["prevent","stop"]))},{default:a((()=>{var e;return[(l(!0),u(p,null,n(null==(e=ve.value[be.value])?void 0:e.child_list,((e,t)=>(l(),r(o,{class:x(["px-[14rpx] flex-shrink-0 w-[160rpx] box-border ml-[20rpx] mb-[26rpx] h-[60rpx] text-center leading-[56rpx] text-[26rpx] border-[2rpx] border-solid !rounded-[100rpx] text-[#333] truncate",{"bg-[var(--primary-color-light)] font-500 text-[var(--primary-color)] border-[var(--primary-color)]":t===he.value,"border-[var(--temp-bg)]  bg-[var(--temp-bg)]":t!=he.value}]),key:ve.value[be.value].category_id,onClick:o=>ke(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1},8,["show"])])),_:1},8,["class"]),i(j,{class:x(["flex justify-center flex-wrap pl-[168rpx] pt-[20rpx] pb-[20rpx]",{"!pt-[214rpx]":s(le).search.control&&(null==(_=ve.value[be.value])?void 0:_.child_list)&&(null==(v=ve.value[be.value])?void 0:v.child_list.length),"pt-[120rpx]":s(le).search.control&&(!ve.value[be.value].child_list||!ve.value[be.value].child_list.length),"pt-[118rpx]":(null==(m=ve.value[be.value])?void 0:m.child_list)&&(null==(b=ve.value[be.value])?void 0:b.child_list.length)&&!s(le).search.control}])},{default:a((()=>[(l(!0),u(p,null,n(se.value,((e,t)=>(l(),r(j,{key:e.goods_id,class:x(["w-[536rpx] box-border bg-white w-full flex mx-[20rpx] py-[24rpx] px-[20rpx] rounded-[var(--rounded-small)]",{"mt-[20rpx]":t}]),onClick:d((t=>pe(e.goods_id)),["stop"])},{default:a((()=>[i(j,{class:"mr-[20rpx] rounded-[var(--goods-rounded-small)] overflow-hidden"},{default:a((()=>[i(M,{width:"168rpx",height:"168rpx",radius:"var(--goods-rounded-small)",src:s(C)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(U,{class:"w-[168rpx] h-[168rpx]",src:s(C)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["radius","src"])])),_:2},1024),i(j,{class:"flex flex-1 flex-wrap flex-col"},{default:a((()=>[i(j,{class:"max-h-[80rpx] text-[26rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),i(j,{class:"flex items-end justify-between flex-1"},{default:a((()=>[i(j,{class:"text-[var(--price-text-color)] price-font -mb-[8rpx]"},{default:a((()=>[i(o,{class:"text-[24rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(o,{class:"text-[40rpx] font-500"},{default:a((()=>[k(y(parseFloat(Ie(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(o,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(Ie(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==Fe(e)?(l(),r(U,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0),"discount_price"==Fe(e)?(l(),r(U,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(le).cart.control&&"cart"===s(le).cart.event?(l(),r(j,{key:0,class:"flex items-center"},{default:a((()=>[i(o,{class:"text-[32rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:d((t=>(e=>{if(ge.value)return!1;ge.value=!0,F.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{ge.value=!1}))})(s(R)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(o,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(o,{class:"text-[32rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:d((o=>((e,t,o)=>{if(parseInt(t.num)>=parseInt(t.stock))return void N({title:"商品库存不足",icon:"none"});let l=te(e);l.num=t.num,l.id=t.id,_e(l,o)})(e,s(R)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(le).cart.event||"real"==e.goods_type?(l(),u(p,{key:1},[s(le).cart.control&&"style-1"===s(le).cart.style?(l(),r(j,{key:0,class:"h-[44rpx] relative pl-[20rpx]"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"w-[102rpx] box-border text-center text-[#fff] primary-btn-bg h-[46rpx] text-[22rpx] leading-[46rpx] rounded-[100rpx]",onClick:d((o=>we(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(le).cart.text),1)])),_:2},1032,["id","onClick"]),s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(R)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(le).cart.control&&"style-2"===s(le).cart.style?(l(),r(j,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(o,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:d((o=>we(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(R)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(le).cart.control&&"style-3"===s(le).cart.style?(l(),r(j,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(o,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:d((o=>we(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(R)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(le).cart.control&&"style-4"===s(le).cart.style?(l(),r(j,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:d((o=>we(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(R)["goods_"+e.goods_id]&&s(R)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(R)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(R)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0)],64)):c("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),se.value.length||de.value||!ce.value?c("v-if",!0):(l(),r(G,{key:0,class:"part",option:{tip:"暂无商品"}}))])),_:1},8,["class"]),i(re,{ref_key:"cartRef",ref:Ce},null,512)]})),_:1},8,["onInit"]),s(le).cart.control&&"cart"===s(le).cart.event?(l(),r(j,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios border-[0] border-t-[2rpx] border-solid border-[#f6f6f6]"},{default:a((()=>[i(j,{class:"flex items-center"},{default:a((()=>[i(j,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(j,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:d(Se,["stop"])},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(E)?(l(),r(j,{key:0,class:x(["border-[1rpx] border-solid border-[#fff]",["absolute left-[40rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[26rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(E)>9?"px-[10rpx]":""]])},{default:a((()=>[k(y(s(E)>99?"99+":s(E)),1)])),_:1},8,["class"])):c("v-if",!0)])),_:1}),i(o,{class:"text-[26rpx] text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(j,{class:"text-[var(--price-text-color)] price-font font-bold flex items-baseline"},{default:a((()=>[i(o,{class:"text-[26rpx] mr-[6rpx]"},{default:a((()=>[k("￥")])),_:1}),i(o,{class:"text-[44rpx]"},{default:a((()=>[k(y(parseFloat(s(P))),1)])),_:1})])),_:1})])),_:1}),i($,{class:"w-[180rpx] h-[70rpx] text-[26rpx] leading-[70rpx] font-500 !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",onClick:Ve},{default:a((()=>[k("去结算")])),_:1})])),_:1})):c("v-if",!0)])),_:1},8,["class"])):c("v-if",!0),z(i(j,{style:T(xe.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[O,xe.value]]),ve.value.length||de.value?c("v-if",!0):(l(),r(j,{key:1,class:"flex justify-center items-center w-[100%]"},{default:a((()=>[i(G,{option:{tip:"暂无商品分类"}})])),_:1})),i(H,{loading:de.value},null,8,["loading"]),i(D),c(" 强制绑定手机号 "),i(oe,{ref_key:"bindMobileRef",ref:je},null,512)])),_:1})}}}),[["__scopeId","data-v-a9a24e15"]]),ie=j(e({__name:"category",setup(e){const o=ee(),s=t({}),i=t(0);return P((e=>{i.value=e.category_id||0,q().then((e=>{s.value=e.data,A({title:s.value.page_title})}))})),D((()=>{o.getList()})),(e,t)=>{const o=v;return l(),r(o,{style:T(e.themeColor())},{default:a((()=>[1===s.value.level&&"style-1"===s.value.template?(l(),r(ae,{key:0,class:"category",categoryId:i.value,config:s.value},null,8,["categoryId","config"])):c("v-if",!0),2===s.value.level&&"style-1"===s.value.template?(l(),r(le,{key:1,categoryId:i.value,config:s.value},null,8,["categoryId","config"])):c("v-if",!0),2===s.value.level&&"style-2"===s.value.template?(l(),r(se,{key:2,class:"category",categoryId:i.value,config:s.value},null,8,["categoryId","config"])):c("v-if",!0)])),_:1},8,["style"])}}}),[["__scopeId","data-v-13799c8c"]]);export{ie as default};
