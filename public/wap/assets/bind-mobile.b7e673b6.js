import{d as e,r as l,l as a,j as o,N as t,T as r,F as s,o as i,c as n,w as d,b as u,y as p,z as m,u as c,A as b,f as g,W as x,t as _,O as f,i as v,ab as y,g as h,h as k,D as S,C as w,a as V,k as C,R as A,I as j,J as T,S as I,aA as P,_ as O}from"./index-71c7df08.js";import{_ as U}from"./sms-code.vue_vue_type_script_setup_true_lang.e09e1c1f.js";/* empty css                                                                    */const z=O(e({__name:"bind-mobile",setup(e,{expose:O}){const z=l(!1),B=a(),q=o((()=>B.info)),E=o((()=>C().login)),J=l(!1),M=l(!1),R=t({mobile:"",mobile_code:"",mobile_key:""}),D=l(!0);r((()=>{setTimeout((()=>{D.value=!1}),800),uni.getStorageSync("openid")&&Object.assign(R,{openid:uni.getStorageSync("openid")}),uni.getStorageSync("pid")&&Object.assign(R,{pid:uni.getStorageSync("pid")}),uni.getStorageSync("unionid")&&Object.assign(R,{unionid:uni.getStorageSync("unionid")})}));const F={mobile:[{type:"string",required:!0,message:s("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,l,a){/^1[3-9]\d{9}$/.test(l)?a():a(new Error("请输入正确的手机号"))},message:s("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:s("codePlaceholder"),trigger:["blur","change"]}},K=()=>{M.value=!M.value},N=l(null),W=()=>{N.value.validate().then((()=>{M.value||!E.value.agreement_show?J.value||(J.value=!0,f(R).then((e=>{B.getMemberInfo(),q.value.mobile&&uni.removeStorageSync("isbindmobile"),z.value=!1})).catch((()=>{J.value=!1}))):_({title:s("isAgreeTips"),icon:"none"})}))};return O({open:()=>{z.value=!0}}),(e,l)=>{const a=v,o=y,t=h(k("u-form-item"),A),r=h(k("sms-code"),U),_=h(k("u-checkbox"),j),f=h(k("u-checkbox-group"),T),C=S,O=w,B=h(k("u-form"),I),q=h(k("u-popup"),P);return i(),n(q,{show:z.value,onClose:l[7]||(l[7]=e=>z.value=!1),mode:"center",round:10,closeable:!0,safeAreaInsetBottom:!1,zIndex:"10086"},{default:d((()=>[u(a,{onTouchmove:l[6]||(l[6]=b((()=>{}),["prevent","stop"])),class:"max-w-[550rpx] w-[550rpx] box-border"},{default:d((()=>[u(a,{class:"text-center py-[var(--pad-top-m)] text-[32rpx] font-500 leading-[46rpx]"},{default:d((()=>[p(m(c(s)("bindMobile")),1)])),_:1}),u(a,{class:"px-[var(--pad-sidebar-m)] pb-[var(--pad-top-m)]"},{default:d((()=>[u(B,{labelPosition:"left",model:R,errorType:"toast",rules:F,ref_key:"formRef",ref:N},{default:d((()=>[u(t,{label:"",prop:"mobile",borderBottom:!0},{default:d((()=>[u(o,{modelValue:R.mobile,"onUpdate:modelValue":l[0]||(l[0]=e=>R.mobile=e),type:"number",maxlength:"11",placeholder:c(s)("mobilePlaceholder"),class:"w-full h-[50rpx] leading-[50rpx] !bg-transparent !px-[20rpx] text-[26rpx] text-[#333]",disabled:D.value,"placeholder-class":"bind-mobile"},null,8,["modelValue","placeholder","disabled"])])),_:1}),u(a,{class:"mt-[20rpx]"},{default:d((()=>[u(t,{label:"",prop:"mobile_code",borderBottom:!0},{right:d((()=>[c(E).agreement_show?(i(),n(r,{key:0,mobile:R.mobile,type:"login",modelValue:R.mobile_key,"onUpdate:modelValue":l[2]||(l[2]=e=>R.mobile_key=e),isAgree:M.value},null,8,["mobile","modelValue","isAgree"])):(i(),n(r,{key:1,mobile:R.mobile,type:"login",modelValue:R.mobile_key,"onUpdate:modelValue":l[3]||(l[3]=e=>R.mobile_key=e)},null,8,["mobile","modelValue"]))])),default:d((()=>[u(o,{modelValue:R.mobile_code,"onUpdate:modelValue":l[1]||(l[1]=e=>R.mobile_code=e),type:"number",maxlength:"6",placeholder:c(s)("codePlaceholder"),class:"box-border w-full h-[50rpx] leading-[50rpx] !bg-transparent !px-[20rpx] text-[26rpx] text-[#333]",disabled:D.value,"placeholder-class":"bind-mobile"},null,8,["modelValue","placeholder","disabled"])])),_:1})])),_:1}),c(E).agreement_show?(i(),n(a,{key:0,class:"flex items-center mt-[30rpx] pl-[10rpx] py-[10rpx]",onClick:b(K,["stop"])},{default:d((()=>[u(f,{onChange:K},{default:d((()=>[u(_,{activeColor:"var(--primary-color)",checked:M.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),u(a,{class:"text-[24rpx] text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:d((()=>[u(C,null,{default:d((()=>[p(m(c(s)("agreeTips")),1)])),_:1}),u(C,{onClick:l[4]||(l[4]=b((e=>c(V)({url:"/app/pages/auth/agreement?key=privacy"})),["stop"])),class:"text-primary"},{default:d((()=>[p("《"+m(c(s)("privacyAgreement"))+"》",1)])),_:1}),u(C,null,{default:d((()=>[p(m(c(s)("and")),1)])),_:1}),u(C,{onClick:l[5]||(l[5]=b((e=>c(V)({url:"/app/pages/auth/agreement?key=service"})),["stop"])),class:"text-primary"},{default:d((()=>[p("《"+m(c(s)("userAgreement"))+"》",1)])),_:1})])),_:1})])),_:1},8,["onClick"])):g("v-if",!0),u(a,{class:"mt-[100rpx]"},{default:d((()=>[u(O,{class:x(["primary-btn-bg text-[26rpx] !text-[#fff] !h-[80rpx] leading-[80rpx] rounded-full font-500",{"opacity-50":J.value}]),disabled:J.value,onClick:W},{default:d((()=>[p(m(c(s)("bind")),1)])),_:1},8,["class","disabled"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-8e7c2d98"]]);export{z as b};
