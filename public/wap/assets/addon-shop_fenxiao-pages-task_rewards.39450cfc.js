import{d as t,j as a,r as e,p as s,K as l,o as r,c as o,w as i,u as d,b as n,O as u,a6 as m,P as c,f as p,n as _,a7 as x,a8 as f,B as v,i as g,g as b,h as k,E as h,Q as y,y as w,z as j,a0 as F,a as T,D as C}from"./index-9317da28.js";import{_ as P}from"./u-count-down.cf30baaa.js";import{_ as D}from"./u-line-progress.65774fcf.js";import{_ as E}from"./loading-page.vue_vue_type_script_setup_true_lang.c92b07c2.js";import{g as z,a as S}from"./task.4b9c3bc2.js";import{M as A}from"./mescroll-body.c2f6fcce.js";import{M as H}from"./mescroll-empty.82e9c349.js";import{u as I}from"./useMescroll.26ccf5de.js";import{t as M}from"./topTabbar.9a918190.js";import{_ as O}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-page.de89bca9.js";import"./u-loading-icon.aabe3d05.js";/* empty css                                                                       */import"./u-transition.65be38eb.js";import"./mescroll-i18n.f3c5a2b0.js";const $=O(t({__name:"task_rewards",setup(t){const{mescrollInit:O,getMescroll:$}=I(f,x),B=M();B.setTopTabbarParam({title:"任务奖励"});let Q={};const U=a((()=>Object.keys(Q).length?"588rpx":"414rpx")),K=e(""),L=e(!0);s((async()=>{await z().then((t=>{K.value=t.data.is_open,0==K.value&&B.setTopTabbarParam({title:"任务奖励",topStatusBar:{textColor:"#333",bgColor:"#fff"}}),L.value=!1}))}));const N=e(!0),R=e(!0),Y=e([{label:"未开始",value:1},{label:"进行中",value:2},{label:"已结束",value:3}]),q=l({data:[],searchParam:{status:2}}),G=t=>{R.value=!0,S({page:t.num,limit:t.size,...q.searchParam}).then((a=>{let e=a.data.data.map((t=>(1===t.status?(t.time=new Date(t.start_time).getTime()-(new Date).getTime(),t.time=t.time<0?"":t.time):2===t.status&&(2!=t.time_type?(t.time=new Date(t.end_time).getTime()-(new Date).getTime(),t.time=t.time<0?"":t.time):t.time=""),t)));1==t.num&&(q.data=[]),q.data=q.data.concat(e),N.value=!1,R.value=!1,t.endSuccess(e.length)})).catch((()=>{N.value=!1,R.value=!1,t.endErr()}))};return(t,a)=>{const e=v,s=g,l=b(k("u-count-down"),P),x=C,f=b(k("u-line-progress"),D),z=b(k("loading-page"),E);return r(),o(s,{class:"bg-[var(--page-bg-color)] min-h-[100vh]",style:_(t.themeColor())},{default:i((()=>[1!=K.value||L.value?p("v-if",!0):(r(),o(A,{key:0,ref:"mescrollRef",top:d(U),down:{use:!1},onInit:d(O),onUp:G},{default:i((()=>[N.value?p("v-if",!0):(r(),o(s,{key:0,class:"fixed top-0 left-0 right-0 z-10"},{default:i((()=>[n(e,{class:"w-[100vw] min-h-[100%] h-[100%] align-middle",mode:"widthFix",src:d(h)("addon/shop_fenxiao/task_header_h5.png")},null,8,["src"]),n(s,{class:"tab-style-2 rounded-tl-[var(--rounded-big)] rounded-tr-[var(--rounded-big)] relative z-10 -mt-[70rpx] !p-[0]"},{default:i((()=>[n(s,{class:"tab-content !justify-around"},{default:i((()=>[(r(!0),u(c,null,m(Y.value,((t,a)=>(r(),o(s,{class:y(["tab-items",{"class-select":q.searchParam.status===t.value}]),onClick:a=>{return e=t.value,q.searchParam.status=e,q.data=[],void $().resetUpScroll();var e}},{default:i((()=>[w(j(t.label),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1})),q.data.length?(r(),o(s,{key:1,class:"py-[var(--top-m)] sidebar-marign box-border relative z-2"},{default:i((()=>[(r(!0),u(c,null,m(q.data,((t,a)=>(r(),o(s,{key:a,class:y(["card-template overflow-hidden",{"mt-[20rpx]":a}]),onClick:a=>(t=>{T({url:"/addon/shop_fenxiao/pages/task_detail",param:{id:t.id}})})(t)},{default:i((()=>[n(s,{class:"flex box-border"},{default:i((()=>[n(s,{class:"w-[200rpx] h-[200rpx] relative overflow-hidden"},{default:i((()=>[t.cover_thumb_mid?(r(),o(e,{key:0,class:"w-[200rpx] h-[200rpx] flex-shrink-0 rounded-[var(--goods-rounded-big)]",mode:"aspectFill",src:d(h)(t.cover_thumb_mid),onError:a=>t.cover_thumb_mid="addon/shop_fenxiao/task.png"},null,8,["src","onError"])):(r(),o(e,{key:1,class:"w-[200rpx] h-[200rpx] flex-shrink-0 rounded-[var(--goods-rounded-big)]",mode:"aspectFit",src:d(h)("addon/shop_fenxiao/task.png")},null,8,["src"])),n(s,{class:y(["absolute top-0 right-0 task rounded-tr-[var(--goods-rounded-big)] rounded-bl-[var(--goods-rounded-big)] px-[16rpx] leading-[30rpx] h-[36rpx] text-[#fff] flex-center",{"bg-[#EF000C]":2===t.status,"bg-[#FF6A1A]":1===t.status}])},{default:i((()=>[2===t.status?(r(),u(c,{key:0},["2"!=t.time_type?(r(),o(l,{key:0,time:t.time,format:"HH:mm:ss",autoStart:"",millisecond:""},null,8,["time"])):p("v-if",!0),"2"===t.time_type?(r(),o(x,{key:1,class:"text-[22rpx]"},{default:i((()=>[w("长期有效")])),_:1})):p("v-if",!0)],64)):p("v-if",!0),1===t.status?(r(),o(l,{key:1,time:t.time,format:"HH:mm:ss",autoStart:"",millisecond:""},null,8,["time"])):p("v-if",!0)])),_:2},1032,["class"])])),_:2},1024),n(s,{class:"flex-1 flex flex-col ml-[20rpx] py-[6rpx]"},{default:i((()=>[n(s,{class:"leading-[40rpx] flex items-center justify-between"},{default:i((()=>[n(x,{class:"text-[28rpx] text-[#333] truncate max-w-[380rpx]"},{default:i((()=>[w(j(t.name),1)])),_:2},1024),n(x,{class:y(["text-[26rpx] ml-[6rpx]",{"!text-[var(--primary-color)]":2===t.status,"!text-[#FF6A1A]":1===t.status," text-[var(--text-color-light9)]":3===t.status}])},{default:i((()=>[w(j(t.status_name),1)])),_:2},1032,["class"])])),_:2},1024),n(s,{class:"mt-[auto]"},{default:i((()=>[n(f,{percentage:t.task_member&&t.task_member.task_data.show_progress.rate||2,showText:!1,"active-color":"var(--primary-color)",inactiveColor:"#FFF1ED",height:"10rpx"},null,8,["percentage"]),n(s,{class:"flex items-center justify-between mt-[10rpx]"},{default:i((()=>[n(s,{class:"flex items-baseline"},{default:i((()=>[n(x,{class:"text-[#303133] text-[24rpx] leading-[34rpx]"},{default:i((()=>[w("奖励佣金")])),_:1}),n(x,{class:y(["text-[var(--price-text-color)] text-[26rpx] ml-[4rpx] leading-[36rpx] font-500",{"!text-[var(--text-color-light6)]":3===t.status}])},{default:i((()=>{var a;return[w(j(d(F)(null==(a=t.rules[0].reward)?void 0:a.commission))+"元",1)]})),_:2},1032,["class"])])),_:2},1024),n(s,{class:"text-[24rpx]"},{default:i((()=>[t.task_member?(r(),o(s,{key:0},{default:i((()=>[n(x,{class:y(["text-[var(--price-text-color)] text-[26rpx]",{"!text-[var(--text-color-light9)]":3===t.status}])},{default:i((()=>[w(j(`${"元"==t.task_member.task_data.util?d(F)(t.task_member.task_data.now_data):t.task_member.task_data.now_data}/`),1)])),_:2},1032,["class"]),n(x,{class:"text-[var(--text-color-light6)] text-[24rpx]"},{default:i((()=>[w(j(`${"元"==t.task_member.task_data.util?d(F)(t.task_member.task_data.end_data):t.task_member.task_data.end_data}${t.task_member.task_data.util}`),1)])),_:2},1024)])),_:2},1024)):(r(),o(s,{key:1},{default:i((()=>[n(x,{class:y(["text-[var(--primary-color)] text-[26rpx]",{"!text-[var(--text-color-light9)]":3===t.status}])},{default:i((()=>[w(" 0")])),_:2},1032,["class"]),n(x,{class:"text-[var(--text-color-light6)] text-[24rpx]"},{default:i((()=>[w("/"+j("元"==t.task_data.util?d(F)(t.task_data.end_data):t.task_data.end_data)+j(t.task_data.util),1)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):p("v-if",!0),q.data.length||N.value||R.value?p("v-if",!0):(r(),o(H,{key:2,option:{icon:d(h)("static/resource/images/empty.png")}},null,8,["option"]))])),_:1},8,["top","onInit"])),0!=K.value||L.value?p("v-if",!0):(r(),o(s,{key:1,class:"pt-[var(--top-m)] footer"},{default:i((()=>[n(H,{option:{icon:d(h)("static/resource/images/empty.png"),tip:"任务奖励设置未开启"}},null,8,["option"])])),_:1})),n(z,{loading:L.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-c49dd482"]]);export{$ as default};
