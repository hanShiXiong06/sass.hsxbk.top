import{bt as e,d as t,j as a,r as s,o as l,c as o,w as r,b as i,u as n,f as c,n as u,P as d,a7 as p,Q as v,a8 as f,a9 as x,E as g,bs as _,bi as m,s as h,H as b,b_ as y,G as k,g as w,h as j,B as F,i as G,a6 as z,R as S,y as C,z as T,a as E,t as M,D as U}from"./index-7bf68536.js";import{_ as I}from"./u-swiper.f792d47e.js";import{_ as N}from"./u--image.b3bf1d5c.js";import{_ as O}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{M as P}from"./mescroll-body.b6d57b41.js";import{M as q}from"./mescroll-empty.fcefb74e.js";import{u as B}from"./useMescroll.26ccf5de.js";import{t as H}from"./topTabbar.f3f9eebd.js";import{u as L}from"./useGoods.e187513d.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.b37701e7.js";import"./u-image.e46f68ef.js";import"./u-icon.0c1c54c7.js";import"./u-transition.cdf87992.js";import"./u-loading-page.566c330a.js";import"./mescroll-i18n.14e7fe02.js";/* empty css                                                                       */const D=R(t({__name:"list",setup(t){let R={};const D=L(),Q=a((()=>Object.keys(R).length?k(Number(R.height))+k(R.top)+k(8)+368+"rpx":"490rpx")),{mescrollInit:V,downCallback:$,getMescroll:A}=B(x,f),J=s([]),K=s([]),W=s(0),X=s(""),Y=s([]),Z=s(!0),ee=s(!0);H().setTopTabbarParam({title:"限时折扣"});const te=s([]);ee.value=!0,e.get("shop/discount/config").then((e=>{J.value=e.data,te.value=J.value.map((e=>g(e.imageUrl))),ee.value=!1})).catch((()=>{ee.value=!1}));var ae;(ae={limit:4},e.get("shop/discount",ae)).then((e=>{K.value=e.data,ie(),K.value&&K.value.length?se(e.data[0]):Z.value=!1}));const se=e=>{var t;W.value=e.active_id,X.value=e.active_status_name,null==(t=A())||t.resetUpScroll(),_({scrollTop:0,duration:1})},le=t=>{if(0==K.value.length)return;Z.value=!0,function(t){return e.get("shop/discount/goods",t)}({page:t.num,limit:t.size,active_id:W.value}).then((e=>{let a=e.data.data.map((e=>e));1==t.num&&(Y.value=[]),Y.value=Y.value.concat(a),t.endSuccess(a.length),Z.value=!1})).catch((()=>{Z.value=!1,t.endErr()}))},oe=e=>{let t=J.value[e].toLink;if(Object.keys(t).length){if(!t.name)return;if("app/pages/member/index"==m()&&!h())return void b().setLoginBack({url:t.url});y(t)}},re=s(""),ie=()=>{re.value=Object.keys(R).length?k(Number(R.height))+k(R.top)+k(8)+368+(K.value.length?70:0)+"rpx":K.value.length?"560rpx":"490rpx"};return(e,t)=>{const a=w(j("u-swiper"),I),s=F,f=G,x=U,_=z,m=w(j("u--image"),N),h=w(j("loading-page"),O);return l(),o(f,{class:"discount bg-[var(--page-bg-color)] min-h-[100vh]",style:u(e.themeColor())},{default:r((()=>[i(f,{class:"fixed top-0 left-0 w-full z-10 text-[0]"},{default:r((()=>[J.value.length?(l(),o(a,{key:0,list:te.value,indicator:J.value.length,indicatorStyle:{bottom:"60rpx"},autoplay:!0,height:n(Q),onClick:oe},null,8,["list","indicator","height"])):c("v-if",!0),ee.value||J.value.length?c("v-if",!0):(l(),o(s,{key:1,src:n(g)("addon/shop/discount/discount_banner.png"),mode:"scaleToFill",class:"w-full",style:u({height:n(Q)}),"show-menu-by-longpress":!0},null,8,["src","style"])),K.value.length?(l(),o(f,{key:2,class:"relative w-full h-[110rpx] mt-[-40rpx] z-5"},{default:r((()=>[i(f,{class:"bg-[#f24f3d] w-[750rpx] rounded-tl-[24rpx] rounded-tr-[24rpx] h-[96rpx] absolute left-0 bottom-0"}),i(_,{"scroll-x":!0,class:"h-[110rpx] absolute left-0 bottom-0 z-5"},{default:r((()=>[i(f,{class:"flex items-end h-[100%]",style:u({width:187.5*K.value.length+"rpx"})},{default:r((()=>[(l(!0),d(v,null,p(K.value,((e,t)=>(l(),o(f,{class:"w-[187.5rpx] h-[100rpx] relative flex-shrink-0",onClick:t=>se(e)},{default:r((()=>[i(f,{class:"w-full absolute left-0 top-0 z-10 text-[#fff] text-center pt-[14rpx]"},{default:r((()=>[i(f,{class:S(["text-[28rpx] leading-[39rpx] font-500 px-[10rpx] h-[39rpx] overflow-hidden",{"!text-[#333]":W.value==e.active_id}])},{default:r((()=>[C(T(e.active_desc),1)])),_:2},1032,["class"]),i(f,{class:"flex justify-center w-full"},{default:r((()=>[i(x,{class:S(["text-[22rpx] h-[36rpx] flex-center mt-[5rpx]",{"active flex items-center justify-center":W.value==e.active_id}])},{default:r((()=>[C(T("not_active"==e.active_status?"预告":e.active_status_name),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),W.value==e.active_id?(l(),d(v,{key:0},[K.value.length<4?(l(),o(s,{key:0,class:S(["absolute bottom-0 z-5 h-[110rpx] z-5",{"left-0 w-[230rpx]":0==t,"left-[-41.25rpx] w-[270rpx]":0!=t}]),src:n(g)(0==t?"addon/shop/discount/nav-left.png":"addon/shop/discount/nav-center.png")},null,8,["class","src"])):c("v-if",!0),K.value.length>=4?(l(),o(s,{key:1,class:S(["absolute bottom-0 z-5 h-[110rpx] z-5",{"left-0 w-[230rpx]":0==t,"left-[-41.25rpx] w-[270rpx]":0!=t&&t!=K.value.length-1,"right-0 w-[230rpx]":t==K.value.length-1}]),src:n(g)(0==t?"addon/shop/discount/nav-left.png":t==K.value.length-1?"addon/shop/discount/nav-right.png":"addon/shop/discount/nav-center.png")},null,8,["class","src"])):c("v-if",!0)],64)):c("v-if",!0)])),_:2},1032,["onClick"])))),256))])),_:1},8,["style"])])),_:1})])),_:1})):c("v-if",!0)])),_:1}),K.value.length?(l(),o(P,{key:0,ref:"mescrollRef",top:re.value,onInit:n(V),down:{use:!1},onUp:le},{default:r((()=>[i(f,{class:"sidebar-margin py-[var(--top-m)] bg-[#F4F6F8]"},{default:r((()=>[(l(!0),d(v,null,p(Y.value,((e,t)=>(l(),o(f,{key:t,class:S(["bg-[#fff] p-[20rpx] flex rounded-[var(--rounded-big)]",{"mb-[var(--top-m)]":t<Y.value.length-1}]),onClick:t=>(e=>{"active"==e.activeGoods.active_goods_status?E({url:"/addon/shop/pages/goods/detail",param:{sku_id:e.goodsSku.sku_id,type:"discount"}}):M({title:`活动${e.activeGoods.active_goods_status_name}`,icon:"none"})})(e)},{default:r((()=>[i(f,{class:"w-[240rpx] h-[240rpx] rounded-[var(--goods-rounded-big)] overflow-hidden"},{default:r((()=>[i(m,{width:"240rpx",height:"240rpx",radius:"var(--goods-rounded-big)",src:n(g)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:r((()=>[i(s,{class:"rounded-[var(--goods-rounded-big)] overflow-hidden w-[240rpx] h-[240rpx]",src:n(g)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["radius","src"])])),_:2},1024),i(f,{class:"ml-[20rpx] flex-1 flex flex-col justify-between"},{default:r((()=>[i(f,{class:"text-[28rpx] leading-[1.4] multi-hidden"},{default:r((()=>[C(T(e.goods_name),1)])),_:2},1024),e.goods_label_name&&e.goods_label_name.length?(l(),o(f,{key:0,class:"flex flex-wrap mb-[auto]"},{default:r((()=>[(l(!0),d(v,null,p(e.goods_label_name,((e,t)=>(l(),d(v,null,["icon"==e.style_type&&e.icon?(l(),o(s,{key:0,class:"img-tag",src:n(g)(e.icon),mode:"heightFix",onError:t=>n(D).error(e,"icon")},null,8,["src","onError"])):"diy"!=e.style_type&&e.icon?c("v-if",!0):(l(),o(f,{key:1,class:"base-tag",style:u(n(D).baseTagStyle(e))},{default:r((()=>[C(T(e.label_name),1)])),_:2},1032,["style"]))],64)))),256))])),_:2},1024)):c("v-if",!0),i(f,{class:S(["relative overflow-hidden w-full h-[88rpx] flex justify-between mt-[20rpx] rounded-[100rpx]",{"bg-[var(--primary-color-light)]":"active"==e.activeGoods.active_goods_status,"bg-[#FFF6F1]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[i(f,{class:"mr-[20rpx] pl-[30rpx] flex-1 flex flex-col justify-center"},{default:r((()=>[i(f,{class:S(["text-[var(--price-text-color)] flex items-baseline",{"!text-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[i(x,{class:"text-[26rpx] leading-[26rpx] font-500 mr-[4rpx] price-font"},{default:r((()=>[C("￥")])),_:1}),i(x,{class:"text-[44rpx] leading-[40rpx] font-500 price-font"},{default:r((()=>[C(T(parseFloat(e.goodsSku.active_discount_price).toFixed(2).split(".")[0])+".",1)])),_:2},1024),i(x,{class:"text-[26rpx] leading-[28rpx] font-500 price-font"},{default:r((()=>[C(T(parseFloat(e.goodsSku.active_discount_price).toFixed(2).split(".")[1]),1)])),_:2},1024),e.goodsSku.active_discount_rate<10?(l(),o(f,{key:0,class:S(["px-[4rpx] border-[1rpx] border-[var(--primary-color)] border-solid text-[18rpx] ml-[6rpx] rounded-[4rpx] leading-[24rpx] transform translate-y-[-4rpx]",{"!border-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[C(T(e.goodsSku.active_discount_rate)+"折",1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1032,["class"]),i(f,{class:"flex items-center mt-[4rpx]"},{default:r((()=>[i(f,{class:S(["w-[20rpx] h-[20rpx] mr-[4rpx] rounded-[20rpx] text-[#fff] bg-[var(--primary-color)] flex items-center justify-center",{"!bg-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[i(x,{class:"text-[10rpx] nc-icon-biaoqianV6mm1 nc-iconfont"})])),_:2},1032,["class"]),i(f,{class:S(["text-[18rpx] font-400 text-[var(--price-text-color)] leading-[24rpx]",{"!text-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[C("已省"+T(e.goodsSku.active_reduce_money)+"元",1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),"active"!=e.activeGoods.active_goods_status?(l(),o(f,{key:0,class:"discount-btn text-[#ff763b] iconfont iconUnion"},{default:r((()=>[i(x,{class:"desc"},{default:r((()=>[C(T(e.activeGoods.active_goods_status_name),1)])),_:2},1024)])),_:2},1024)):(l(),o(f,{key:1,class:"discount-btn text-[#fb3f15] iconfont iconUnion"},{default:r((()=>[i(x,{class:"icon iconfont iconqiang"}),i(x,{class:"arrow iconxiayibu iconfont"})])),_:1}))])),_:2},1032,["class"])])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),Y.value.length||Z.value?c("v-if",!0):(l(),o(q,{key:0,option:{tip:"暂无商品，请看看其他商品吧！"}}))])),_:1})])),_:1},8,["top","onInit"])):c("v-if",!0),K.value.length||Z.value?c("v-if",!0):(l(),o(f,{key:1,class:"h-[calc(100vh-550rpx)] fixed left-0 right-0",style:u({top:re.value})},{default:r((()=>[c(' <u-empty text="暂无活动，请看看其他商品吧！" width="347rpx" height="265rpx" :icon="img(\'static/resource/images/system/empty.png\')"/>\r\n\t\t\t<button shape="circle" plain="true" class="w-[220rpx] mt-[42rpx] text-[28rpx] h-[66rpx] leading-[62rpx] !text-[var()] !border-[var(--primary-color)] border-[2rpx] rounded-full" @click="redirect({ url: \'/addon/shop/pages/goods/list\' })">去逛逛</button> '),i(q,{option:{tip:"暂无商品，请看看其他商品吧！",btnText:"去逛逛"},onEmptyclick:t[0]||(t[0]=e=>n(E)({url:"/addon/shop/pages/goods/list"}))})])),_:1},8,["style"])),i(h,{loading:ee.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-175aad4a"]]);export{D as default};
