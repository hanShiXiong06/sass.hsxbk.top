import{d as e,r as t,j as l,o as a,c as r,w as s,u as o,b as n,aN as d,x as i,y as u,f,H as c,E as x,G as _,F as m,n as p,a as y,C as b,g as h,h as v,i as g,N as k,V as w,bv as j,c8 as A}from"./index-e6ce9fbf.js";import{_ as C}from"./u-count-down.3d2f8c99.js";import{_ as B}from"./u-form.f2229701.js";import{_ as E}from"./u--form.134798dd.js";import{_ as F}from"./u-button.7a41d301.js";import{_ as S}from"./pay.16fd6339.js";import{_ as D,a as z}from"./u-steps.fa645337.js";import{_ as H}from"./u-popup.b16d6e1d.js";import{_ as W}from"./u-loading-page.76c2d95f.js";import{C as I,D as V,E as M,F as L,A as N,B as O}from"./tourism.b22998fc.js";import{_ as P}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.c5d9cd81.js";import"./u-line.ebbd60c6.js";import"./u-loading-icon.39fd4711.js";import"./u-image.c9386d77.js";import"./u-transition.6919b33f.js";import"./pay.f23cf994.js";import"./u-text.9aefeac5.js";import"./u-safe-bottom.1ba5bfba.js";const q=P(e({__name:"detail",setup(e){let P=t({}),q=t(!0),G=t(""),R=t(""),T=t(1),$=t(!1),J=t(0);l((e=>{R.value=e.order_id,K(R.value)}));const K=e=>{q.value=!0,I(e).then((e=>{if(P.value=e.data,T.value=P.value.order_log.length?P.value.order_log.length-1:0,G.value=e.data.order_type,e.data.refund_id&&Y(e.data.refund_id),0==P.value.order_status_info.status){const e=(new Date).getTime()/1e3;J.value=1e3*(P.value.auto_close_time-e);let t=setInterval((()=>{J.value<=0&&clearInterval(t)}),1e3)}q.value=!1})).catch((()=>{q.value=!1}))};let Q=t(!1),U=t({}),X=t(1);const Y=e=>{V(e).then((e=>{U.value=e.data,X.value=e.data.refund_log.length?e.data.refund_log.length-1:0}))},Z=t(null),ee=(e,t="")=>{var l;"pay"==t?null==(l=Z.value)||l.open(e.order_type,e.order_id,`/addon/tourism/pages/order/detail?order_id=${e.order_id}`):"cancel"==t?(e=>{N(e).then((e=>{K(R.value)})).catch((()=>{K(R.value)}))})(e):"delete"==t?(e=>{O(e.order_id).then((e=>{y({url:"/addon/tourism/pages/order/list"})})).catch((()=>{K(R.value)}))})(e):"buy"==t?"scenic"==e.order_type?y({url:"/addon/tourism/pages/scenic/list"}):"way"==e.order_type?y({url:"/addon/tourism/pages/way/list"}):"hotel"==e.order_type&&y({url:"/addon/tourism/pages/hotel/list"}):"index"==t&&y({url:"/addon/tourism/pages/index",mode:"reLaunch"})},te=(e,t)=>{let l,a;-1!=e.indexOf("/")?l=e.split("/"):-1!=e.indexOf("-")&&(l=e.split("-"));const r=new Date(e).getDay(),s=["周日","周一","周二","周三","周四","周五","周六"];return a="yearMonthDay"==t?l[0]+"年"+l[1]+"月"+l[2]+"日":"yearMonthDayWeek"==t?l[0]+"年"+l[1]+"月"+l[2]+"日 "+s[r]:"monthDayWeek"==t?l[1]+"月"+l[2]+"日 "+s[r]:l[1]+"月"+l[2]+"日",a};return(e,t)=>{const l=b,y=h(v("u-count-down"),C),I=g,V=k,N=h(v("u-form-item"),B),O=h(v("u--form"),E),Y=h(v("u-button"),F),le=h(v("pay"),S),ae=h(v("u-steps-item"),D),re=h(v("u-steps"),z),se=h(v("u-popup"),H),oe=h(v("u-loading-page"),W);return a(),r(I,{style:p(e.themeColor())},{default:s((()=>[o(q)?f("v-if",!0):(a(),r(I,{key:0,class:"bg-[#f8f8f8] min-h-screen overflow-hidden"},{default:s((()=>[n(I,{class:"bg-linear h-[480rpx] text-white px-4 pt-5"},{default:s((()=>{var e;return[n(I,{class:"text-[42rpx] flex items-baseline",onClick:t[0]||(t[0]=e=>d($)?$.value=!0:$=!0)},{default:s((()=>[n(l,{class:"nc-iconfont nc-icon-shijianV6xx text-[42rpx] mr-1"}),n(l,{class:"font-bold"},{default:s((()=>{var e,t;return[i("订单"+u(null==(t=null==(e=o(P))?void 0:e.order_status_info)?void 0:t.name),1)]})),_:1}),o(J)>0&&0==o(P).order_status_info.status?(a(),r(I,{key:0,class:"text-xs flex items-center ml-[20rpx]"},{default:s((()=>[n(l,null,{default:s((()=>[i("剩余支付时间：")])),_:1}),n(y,{time:o(J),format:"HH:mm:ss"},null,8,["time"])])),_:1})):f("v-if",!0)])),_:1}),0==(null==(e=o(P))?void 0:e.order_status_info.status)?(a(),r(I,{key:0,class:"text-xs mt-3"},{default:s((()=>{var e,t;return[i("您的订单"+u(null==(t=null==(e=o(P))?void 0:e.order_status_info)?void 0:t.name)+"，欢迎再次预订！",1)]})),_:1})):(a(),r(I,{key:1,class:"text-xs mt-3"},{default:s((()=>{var e,t;return[i("您的订单"+u(null==(t=null==(e=o(P))?void 0:e.order_status_info)?void 0:t.name)+"，欢迎再次预订！",1)]})),_:1}))]})),_:1}),n(I,{class:"bg-white mx-3 py-4 px-3 rounded-md -mt-[340rpx] box-border"},{default:s((()=>[n(I,{class:c(["flex",{"pb-4 border-0 border-b-1 border-dashed border-[#EAEAEA] mb-4":["1","10"].includes(o(P).order_status)}])},{default:s((()=>[n(V,{class:"w-[124rpx] h-[124rpx] mr-2 rounded",src:o(w)(o(P).goods_image)},null,8,["src"]),n(I,{class:"flex-1 flex flex-col"},{default:s((()=>[n(I,{class:"text-[#1A2336] text-[30rpx] truncate font-bold w-[514rpx]"},{default:s((()=>[i(u(o(P)[o(G)][o(G)+"_name"])+"【"+u(o(P).goods_name)+"】",1)])),_:1}),n(I,{class:"flex items-center text-[#7F7F85] text-xs mt-[12rpx]"},{default:s((()=>[n(l,{class:"mr-1"},{default:s((()=>[i(u(te(o(P).start_time,"yearMonthDayWeek")),1)])),_:1}),f(' <text class="mr-1">周日</text> '),n(l,null,{default:s((()=>[i("当日有效")])),_:1})])),_:1}),n(I,{class:"font-bold text-sm text-[#222] mt-auto price-font"},{default:s((()=>[i("￥"+u(o(P).order_money),1)])),_:1})])),_:1})])),_:1},8,["class"]),["1","10"].includes(o(P).order_status)?(a(),x(_,{key:0},[n(I,{class:"bg-[#F9FBFF] rounded-lg overflow-hidden mb-4"},{default:s((()=>["hotel"==o(G)?(a(),r(I,{key:0,class:"bg-[#EEF3FF] flex items-center text-sm py-3 justify-center triangle"},{default:s((()=>[i(" 请提醒商家 "),n(l,{class:"text-[#EA4B69]"},{default:s((()=>[i("【扫码核销】")])),_:1}),i(" 使用 ")])),_:1})):(a(),r(I,{key:1,class:"bg-[#EEF3FF] flex items-center text-sm py-3 justify-center triangle"},{default:s((()=>[i(" 凭 "),n(l,{class:"text-[#EA4B69]"},{default:s((()=>[i("【身份证】")])),_:1}),i(" 或 "),n(l,{class:"text-[#EA4B69]"},{default:s((()=>[i("【手机号】")])),_:1}),i(" 可直接入园 ")])),_:1})),n(I,{class:"flex flex-col items-center pb-4"},{default:s((()=>[n(V,{class:"w-[326rpx] h-[326rpx] mt-4 mb-4",src:o(P).verify_code_qrcode},null,8,["src"]),n(V,{class:"w-[524rpx] h-[128rpx] mb-3",src:o(P).verify_code_barcode},null,8,["src"]),n(I,{class:"text-[#666] text-xs"},{default:s((()=>[i("未消费前请不要将券码提供给商家")])),_:1})])),_:1})])),_:1}),n(I,null,{default:s((()=>[n(I,{class:"flex items-center justify-between"},{default:s((()=>[n(I,{class:"flex items-center"},{default:s((()=>[n(l,{class:"text-sm"},{default:s((()=>[i(u("hotel"==o(G)?"券码":"入园码")+" "+u(o(P).verify_code),1)])),_:1}),n(l,{class:"nc-iconfont nc-icon-fuzhiV6xx text-[32rpx] ml-2 text-[#636363]",onClick:t[1]||(t[1]=e=>o(j)(o(P).verify_code))})])),_:1}),n(l,{class:"text-[#696969] text-[26rpx]"},{default:s((()=>[i(u(o(P).order_status_info.name),1)])),_:1})])),_:1})])),_:1})],64)):f("v-if",!0)])),_:1}),n(I,{class:"mt-3 bg-white mx-3 px-3 py-4 rounded-md"},{default:s((()=>[n(I,{class:"text-[#1A2336] text-[30rpx] font-bold mb-4"},{default:s((()=>[i("订单信息")])),_:1}),"hotel"==o(G)?(a(),r(I,{key:0,class:"border-0 border-b-1 border-solid border-[#EAEAEA] mb-1 pb-4"},{default:s((()=>[n(I,{class:"flex items-center"},{default:s((()=>[n(I,{class:"flex flex-col items-center"},{default:s((()=>[n(l,{class:"text-[26rpx] text-[#1A2336]"},{default:s((()=>[i(u(te(o(P).start_time,"monthDayWeek")),1)])),_:1}),n(l,{class:"text-xs text-[#888] mt-1"},{default:s((()=>[i("14:00后入住")])),_:1})])),_:1}),n(I,{class:"ml-4 mr-4 relative w-[136rpx] text-center"},{default:s((()=>[n(l,{class:"text-white relative z-10 text-xs font-scale bg-[#1C283E] px-2 py-1 rounded-xl w-[90rpx] box-border break-keep"},{default:s((()=>[i("共"+u(o(P).days)+"晚",1)])),_:1}),n(l,{class:"iconfont iconzhixiang absolute left-0 right-0 text-[90rpx] top-[50%] translate-y text-[#ABABAB]"})])),_:1}),n(I,{class:"flex flex-col items-center"},{default:s((()=>[n(l,{class:"text-[26rpx] text-[#1A2336]"},{default:s((()=>[i(u(te(o(P).end_time,"monthDayWeek")),1)])),_:1}),n(l,{class:"text-xs text-[#888] mt-1"},{default:s((()=>[i("12:00前离店")])),_:1})])),_:1})])),_:1}),n(I,{class:"mt-4 text-[#1A2336] text-[26rpx] font-bold"},{default:s((()=>[i(u(o(P).hotel.hotel_name)+"（"+u(o(P).goods_name)+"） ",1)])),_:1}),n(I,{class:"mt-1 text-[#1A2336] text-[26rpx] font-bold flex items-center"},{default:s((()=>[n(l,{class:"nc-iconfont nc-icon-fengefuV6xx text-[32rpx]"}),n(l,null,{default:s((()=>[i("共"+u(o(P).num)+"间",1)])),_:1})])),_:1}),f(' <view class="mt-3 text-[#1A2336] text-[26rpx] font-bold">\r\n                        无早餐\r\n                    </view> ')])),_:1})):f("v-if",!0),n(O,{labelPosition:"left",ref:"form1",labelWidth:"90",labelStyle:{color:"#A3A3A3",fontSize:"14px"}},{default:s((()=>["hotel"==o(P).order_type?(a(!0),x(_,{key:0},m(o(P).buyer_info,((e,t)=>(a(),x(_,null,[e.name?(a(),r(N,{key:0,label:"联系人姓名",prop:"userInfo.name",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(e.name),1)])),_:2},1024)])),_:2},1024)):f("v-if",!0),e.id_card?(a(),r(N,{key:1,label:"身份证号",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(e.id_card),1)])),_:2},1024)])),_:2},1024)):f("v-if",!0)],64)))),256)):(a(),x(_,{key:1},[o(P).buyer_info.name?(a(),r(N,{key:0,label:"联系人姓名",prop:"userInfo.name",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(o(P).buyer_info.name),1)])),_:1})])),_:1})):f("v-if",!0),o(P).buyer_info.id_card?(a(),r(N,{key:1,label:"身份证号",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(o(P).buyer_info.id_card),1)])),_:1})])),_:1})):f("v-if",!0)],64)),o(P).mobile?(a(),r(N,{key:2,label:"联系电话",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(o(P).mobile),1)])),_:1})])),_:1})):f("v-if",!0),o(P).order_no?(a(),r(N,{key:3,label:"订单编号",borderBottom:""},{default:s((()=>[n(I,{class:"border-style w-full !border-0 flex justify-between items-end"},{default:s((()=>[n(l,null,{default:s((()=>[i(u(o(P).order_no),1)])),_:1}),n(l,{class:"text-xs text-[#7D7C82]",onClick:t[2]||(t[2]=e=>o(j)(o(P).order_no))},{default:s((()=>[i("复制")])),_:1})])),_:1})])),_:1})):f("v-if",!0),o(P).create_time?(a(),r(N,{key:4,label:"下单时间",borderBottom:""},{default:s((()=>[n(I,{class:"border-style !border-0"},{default:s((()=>[i(u(o(P).create_time),1)])),_:1})])),_:1})):f("v-if",!0),o(P).pay_time?(a(),r(N,{key:5,label:"支付时间",borderBottom:""},{default:s((()=>[n(I,{class:"border-style !border-0"},{default:s((()=>[i(u(o(P).pay_time),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1},512)])),_:1}),n(I,{class:"h-[160rpx] w-full"}),n(I,{class:"flex justify-end items-center bg-white px-3 py-1 fixed left-0 right-0 bottom-0 z-10"},{default:s((()=>[n(I,{class:"flex flex-col items-center justify-center mr-auto",onClick:t[3]||(t[3]=e=>ee(o(P),"index"))},{default:s((()=>[n(l,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[46rpx] text-[#333]"}),n(l,{class:"text-xs mt-[2rpx] font-scale"},{default:s((()=>[i("首页")])),_:1})])),_:1}),n(I,{class:"flex flex-wrap justify-end"},{default:s((()=>[(a(!0),x(_,null,m(o(P).order_status_info.member_action,((e,t)=>(a(),r(Y,{text:e.name,color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},type:"primary",onClick:t=>ee(o(P),e.key)},null,8,["text","onClick"])))),256)),o(P).is_enable_refund&&["","refund_refuse"].includes(o(P).refund_status)?(a(),r(Y,{key:0,text:"申请退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[4]||(t[4]=e=>(e=>{let t={order_id:e.order_id};M(t).then((e=>{K(R.value)}))})(o(P)))})):f("v-if",!0),o(P).refund_no?(a(),r(Y,{key:1,text:"查看退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[5]||(t[5]=e=>d(Q)?Q.value=!0:Q=!0)})):f("v-if",!0),o(P).refund_no&&"wait_refund"==o(P).refund_status?(a(),r(Y,{key:2,text:"取消退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[6]||(t[6]=e=>{return t=o(P),void L(t.refund_id).then((e=>{K(R.value)}));var t})})):f("v-if",!0)])),_:1})])),_:1}),n(le,{ref_key:"payRef",ref:Z,onClose:e.payClose},null,8,["onClose"]),n(se,{show:o($),onClose:t[7]||(t[7]=e=>d($)?$.value=!1:$=!1),closeable:!0},{default:s((()=>[n(I,{class:"text-center py-[30rpx] font-bold leading-none"},{default:s((()=>[n(l,null,{default:s((()=>[i("订单进度")])),_:1})])),_:1}),n(I,{class:"px-6 pb-5 pt-2"},{default:s((()=>[n(re,{current:o(T),direction:"column"},{default:s((()=>[(a(!0),x(_,null,m(o(P).order_log,((e,t)=>(a(),r(ae,{title:e.action,desc:e.action_time,key:t},null,8,["title","desc"])))),128))])),_:1},8,["current"])])),_:1})])),_:1},8,["show"]),n(se,{show:o(Q),onClose:t[8]||(t[8]=e=>d(Q)?Q.value=!1:Q=!1),closeable:!0},{default:s((()=>[o(U).refund_log?(a(),r(I,{key:0,class:"text-center py-[30rpx] font-bold leading-none"},{default:s((()=>[n(l,null,{default:s((()=>[i("退款进度")])),_:1})])),_:1})):f("v-if",!0),n(I,{class:"px-6 pb-5 pt-2"},{default:s((()=>[n(re,{current:o(X),direction:"column"},{default:s((()=>[(a(!0),x(_,null,m(o(U).refund_log,((e,t)=>(a(),r(ae,{title:e.action_name,desc:e.action_time,key:t},A({_:2},["refuse"==e.action?{name:"desc",fn:s((()=>[n(I,{class:"text-xs text-red"},{default:s((()=>[i("拒绝原因："+u(o(U).refuse_reason),1)])),_:1}),n(I,{class:"text-xs text-[#909193]"},{default:s((()=>[i(u(e.action_time),1)])),_:2},1024)])),key:"0"}:void 0,"completed"==e.action?{name:"desc",fn:s((()=>[n(I,{class:"text-xs text-red"},{default:s((()=>[i("退款方式：原路退款，退款金额："+u(o(U).money),1)])),_:1}),n(I,{class:"text-xs text-[#909193]"},{default:s((()=>[i(u(e.action_time),1)])),_:2},1024)])),key:"1"}:void 0]),1032,["title","desc"])))),128))])),_:1},8,["current"])])),_:1})])),_:1},8,["show"])])),_:1})),n(oe,{"bg-color":"rgb(248,248,248)",loading:o(q),fontSize:"16",color:"#333"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-fba7fd89"]]);export{q as default};
