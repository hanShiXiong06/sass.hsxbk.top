import{d as e,r as a,j as s,a9 as t,aj as o,o as l,c as i,w as n,b as c,f as r,x as u,n as d,E as h,F as y,G as f,b_ as g,a as m,b2 as x,b7 as v,a3 as p,g as _,h as S,C as k,i as C,y as b}from"./index-656dc629.js";import{_ as H}from"./u-icon.286409fc.js";import{_ as V}from"./_plugin-vue_export-helper.1b428a4d.js";const j=V(e({__name:"search",setup(e){const V=a(""),j=a([]),A=a(!1);s((e=>{!uni.getStorageSync("goodsSearchHistory")&&uni.setStorageSync("goodsSearchHistory",[])})),t((()=>{z(),o((()=>{F()}))}));const z=()=>{j.value=uni.getStorageSync("goodsSearchHistory").reverse()},w=()=>{g({title:"提示",content:"确认删除全部历史记录？",success:e=>{e.confirm&&(uni.setStorageSync("goodsSearchHistory",[]),z())}})},E=()=>{if(""!=V.value.trim()){let e=uni.getStorageSync("goodsSearchHistory"),a=[];e.length?(a=e.filter((e=>e!=V.value.trim())),a.push(V.value.trim())):a.push(V.value.trim()),uni.setStorageSync("goodsSearchHistory",a),m({url:"/addon/shop/pages/goods/list",param:{goods_name:V.value.trim()},mode:"navigateTo"})}},F=()=>{x().in(this).select("#history-list").boundingClientRect((e=>{e&&e.height>2*v(70)+2*v(35)&&(A.value=!0)})).exec()};return(e,a)=>{const s=p,t=_(S("u-icon"),H),o=k,g=C;return l(),i(g,{style:d(e.themeColor())},{default:n((()=>[c(g,{class:"cate-search"},{default:n((()=>[c(g,{class:"search-box"},{default:n((()=>[c(s,{class:"uni-input text-[24rpx]",maxlength:"50",modelValue:V.value,"onUpdate:modelValue":a[0]||(a[0]=e=>V.value=e),"confirm-type":"search",focus:"",onConfirm:a[1]||(a[1]=e=>E()),placeholder:"搜索商品"},null,8,["modelValue"]),V.value?(l(),i(t,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:a[2]||(a[2]=e=>V.value="")})):r("v-if",!0),c(o,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 !text-[26rpx]",onClick:a[3]||(a[3]=e=>E())})])),_:1})])),_:1}),c(g,{class:"search-content"},{default:n((()=>[r(" 历史搜索 "),j.value.length?(l(),i(g,{key:0,class:"history"},{default:n((()=>[c(g,{class:"history-box"},{default:n((()=>[c(g,{class:"history-top"},{default:n((()=>[c(g,{class:"title"},{default:n((()=>[u("历史搜索")])),_:1}),c(g,{class:"icon nc-iconfont nc-icon-shanchu-yuangaizhiV6xx text-[28rpx] text-[#999]",onClick:w})])),_:1}),c(g,{class:"history-bottom",id:"history-list",style:d({maxHeight:A.value?"168rpx":"100%"})},{default:n((()=>[(l(!0),h(f,null,y(j.value,((e,a)=>(l(),i(g,{class:"history-li",key:a,onClick:a=>{return s=e,V.value=s,void E();var s}},{default:n((()=>[c(g,null,{default:n((()=>[u(b(e),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),A.value?(l(),i(g,{key:0,class:"history-li history_more",onClick:a[4]||(a[4]=e=>A.value=!1)},{default:n((()=>[c(g,null,{default:n((()=>[c(o,{class:"text-[30rpx] nc-iconfont nc-icon-xiaV6xx"})])),_:1})])),_:1})):r("v-if",!0)])),_:1},8,["style"])])),_:1})])),_:1})):r("v-if",!0)])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-51de4576"]]);export{j as default};
