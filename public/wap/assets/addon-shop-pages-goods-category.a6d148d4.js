import{d as e,r as t,N as o,o as l,c as r,w as a,u as s,b as i,A as d,f as c,O as u,a6 as n,P as p,Q as x,a as f,D as g,a4 as _,i as v,a5 as m,g as b,h,y as k,z as y,E as C,B as w,j as S,Z as j,s as F,t as I,C as V,aL as N,l as E,e as L,v as R,n as B,a7 as z,a8 as O,H as U,p as M,x as T,J as $}from"./index-9317da28.js";import{_ as H}from"./u--image.5461b7b7.js";import{_ as P}from"./tabbar.31005363.js";import{_ as D}from"./loading-page.vue_vue_type_script_setup_true_lang.c92b07c2.js";import{b as A,i as Q,c as W,j as q}from"./goods.f92b6713.js";import{M as J}from"./mescroll-empty.82e9c349.js";import{_ as X}from"./_plugin-vue_export-helper.1b428a4d.js";import{M as Y}from"./mescroll-body.c2f6fcce.js";import{u as Z}from"./useMescroll.26ccf5de.js";import{_ as G}from"./u-number-box.3146e59e.js";import{_ as K}from"./u-popup.1f2ebcae.js";import{u as ee}from"./cart.c72e93d2.js";import{c as te}from"./cloneDeep.fb425223.js";import{b as oe}from"./bind-mobile.7937266a.js";import"./u-image.74ac23f6.js";import"./u-icon.5e775659.js";import"./u-transition.65be38eb.js";import"./u-badge.4fd7810d.js";import"./u-tabbar.c8394bc9.js";import"./u-safe-bottom.3546c5bb.js";import"./u-loading-page.de89bca9.js";import"./u-loading-icon.aabe3d05.js";/* empty css                                                                       */import"./mescroll-i18n.f3c5a2b0.js";import"./isArrayLike.512b2e7f.js";import"./u-form-item.83fe1c60.js";import"./u-line.30917996.js";/* empty css                                                               */import"./u-form.cfe692b2.js";import"./sms-code.vue_vue_type_script_setup_true_lang.ef47410d.js";/* empty css                                                               */import"./u-input.e030155a.js";/* empty css                                                                */import"./u-modal.42c2671a.js";/* empty css                                                                */import"./u-checkbox-group.2c561dd7.js";/* empty css                                                                         *//* empty css                                                                    */const le=X(e({__name:"category-template-two-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const S=e;let j=S.config,F=S.categoryId;const I=t(""),V=t(!0);o((()=>{E()}));const N=t([]),E=()=>{V.value=!0,A().then((e=>{if(N.value=e.data,F)for(let t=0;t<N.value.length;t++){if(N.value[t].category_id==F){L.value=t;break}if(N.value[t].child_list)for(let e=0;e<N.value[t].child_list.length;e++)if(N.value[t].child_list[e].category_id==F){L.value=t;break}}V.value=!1})).catch((()=>{V.value=!1}))},L=t(0),R=()=>{I.value&&f({url:"/addon/shop/pages/goods/list",param:{goods_name:encodeURIComponent(I.value)}})};return(e,t)=>{const o=g,S=_,F=v,E=m,B=w,z=b(h("u--image"),H),O=b(h("tabbar"),P),U=b(h("loading-page"),D);return l(),r(F,{class:"bg-[var(--page-bg-color)] overflow-hidden min-h-screen"},{default:a((()=>[N.value.length?(l(),r(F,{key:0,class:"mescroll-box"},{default:a((()=>[s(j).search.control?(l(),r(F,{key:0,class:"search-box box-border z-10 fixed top-0 left-0 right-0 h-[100rpx] bg-[#fff]"},{default:a((()=>[i(F,{class:"flex-1 search-input"},{default:a((()=>[i(o,{onClick:d(R,["stop"]),class:"nc-iconfont nc-icon-sousuo-duanV6xx1 btn"},null,8,["onClick"]),i(S,{class:"input",type:"text",modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=e=>I.value=e),placeholder:s(j).search.title,placeholderClass:"text-[var(--text-color-light9)]",onConfirm:R},null,8,["modelValue","placeholder"]),I.value?(l(),r(o,{key:0,class:"nc-iconfont nc-icon-cuohaoV6xx1 clear",onClick:t[1]||(t[1]=e=>I.value="")})):c("v-if",!0)])),_:1})])),_:1})):c("v-if",!0),i(F,{class:x(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[100rpx]":s(j).search.control}])},{default:a((()=>[i(E,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(F,{class:"bg-[var(--temp-bg)]"},{default:a((()=>[(l(!0),u(p,null,n(N.value,((e,t)=>(l(),r(F,{class:x(["tab-item truncate",{"tab-item-active":t==L.value,"rounded-br-[12rpx]":L.value-1===t,"rounded-tr-[12rpx]":L.value+1===t}]),key:t,onClick:e=>((e,t)=>{L.value=e})(t)},{default:a((()=>[i(F,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(E,{class:"h-[100vh]","scroll-y":!0},{default:a((()=>[i(F,{class:x(["pl-[188rpx] scroll-ios pt-[20rpx] pr-[20rpx]",{"!pt-[120rpx]":s(j).search.control}])},{default:a((()=>{var e,t;return[(null==(e=N.value[L.value])?void 0:e.child_list)&&!V.value?(l(),r(F,{key:0,class:"bg-[#fff] grid grid-cols-3 gap-x-[50rpx] gap-y-[32rpx] py-[32rpx] px-[24rpx] rounded-[var(--rounded-big)]"},{default:a((()=>{var e;return[(l(!0),u(p,null,n(null==(e=N.value[L.value])?void 0:e.child_list,((e,t)=>(l(),r(F,{key:e.category_id,onClick:t=>{return o=e.category_id,void f({url:"/addon/shop/pages/goods/list",param:{curr_goods_category:o}});var o},class:"flex items-center justify-center flex-col"},{default:a((()=>[i(z,{radius:"var(--goods-rounded-big)",width:"120rpx",height:"120rpx",src:s(C)(e.image?e.image:""),model:"aspectFill"},{error:a((()=>[i(B,{class:"rounded-[var(--goods-rounded-big)] overflow-hidden w-[120rpx] h-[120rpx]",src:s(C)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(F,{class:"text-[24rpx] text-center mt-[16rpx] leading-[34rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))]})),_:1})):c("v-if",!0),(null==(t=N.value[L.value])?void 0:t.child_list)||V.value?c("v-if",!0):(l(),r(J,{key:1,class:"part",option:{tip:"暂无商品分类"}}))]})),_:1},8,["class"])])),_:1})])),_:1})):c("v-if",!0),i(O),N.value.length||V.value?c("v-if",!0):(l(),r(J,{key:1,option:{tip:"暂无商品分类"}})),i(U,{loading:V.value},null,8,["loading"])])),_:1})}}}),[["__scopeId","data-v-f0126b10"]]),re=X(e({__name:"add-cart-popup",setup(e,{expose:o}){const f=ee(),_=S((()=>f.cartList)),E=t(!1),L=t({skuId:"",name:[]}),R=t({}),B=t({}),z=t(1),O=()=>{E.value=!1},U=S((()=>{let e=te(R.value);return Object.keys(e).length&&(Object.keys(L.value.name).length||(L.value.name=e.sku_spec_format.split(",")),e.goodsSpec.forEach(((e,t)=>{let o=e.spec_values.split(",");e.values=[],o.forEach(((o,l)=>{e.values[l]={},e.values[l].name=o,e.values[l].selected=!1,e.values[l].disabled=!1,L.value.name.forEach(((r,a)=>{a==t&&r==o&&(e.values[l].selected=!0)}))}))})),M(),e.skuList&&Object.keys(e.skuList).length&&e.skuList.forEach((e=>{e.sku_id==L.value.skuId&&(B.value=e)}))),e}));j((()=>B.value),((e,t)=>{_.value["goods_"+B.value.goods_id]&&_.value["goods_"+B.value.goods_id]["sku_"+B.value.sku_id]?(z.value=N(_.value["goods_"+B.value.goods_id]["sku_"+B.value.sku_id].num),B.value.cart_id=N(_.value["goods_"+B.value.goods_id]["sku_"+B.value.sku_id].id)):(z.value=1,B.value.cart_id="")}));const M=()=>{R.value.skuList.forEach(((e,t)=>{let o=e.sku_spec_format.split(",");L.value.name.every((e=>o.includes(e)))&&(L.value.skuId=e.sku_id)}))},T=()=>{if(0==z.value)f.reduce({id:B.value.cart_id||"",goods_id:B.value.goods_id,sale_price:B.value.sale_price,sku_id:B.value.sku_id});else{let e=0;e=U.value.goods.is_discount&&B.value.sale_price!=B.value.price?B.value.sale_price?B.value.sale_price:B.value.price:U.value.goods.member_discount&&F()&&B.value.member_price!=B.value.price&&B.value.member_price?B.value.member_price:B.value.price,f.increase({id:B.value.cart_id||"",goods_id:B.value.goods_id,sku_id:B.value.sku_id,stock:B.value.stock,sale_price:e,num:z.value},0,(()=>{I({title:"加入购物车成功",icon:"none"})}))}E.value=!1},$=e=>{let t="0.00";return t=U.value.goods.is_discount&&e.sale_price!=e.price?e.sale_price?e.sale_price:e.price:U.value.goods.member_discount&&F()&&e.member_price!=e.price&&e.member_price?e.member_price:e.price,t},P=e=>{let t="";return t=U.value.goods.is_discount&&e.sale_price!=e.price?"discount_price":U.value.goods.member_discount&&F()&&e.member_price!=e.price?"member_price":"",t};return o({open:e=>{(e=>{Q(e).then((t=>{R.value=t.data,L.value.sku_id=e,R.value.skuList&&Object.keys(R.value.skuList).length&&R.value.skuList.forEach((t=>{t.sku_id==e&&(B.value=t,L.value.name=t.sku_spec_format.split(","))})),E.value=!0}))})(e)}}),(e,t)=>{const o=w,f=b(h("u--image"),H),S=v,j=g,F=b(h("u-number-box"),G),I=m,N=V,R=b(h("u-popup"),K);return l(),r(S,{onTouchmove:t[3]||(t[3]=d((()=>{}),["prevent","stop"]))},{default:a((()=>[i(R,{show:E.value,onClose:O,mode:"bottom"},{default:a((()=>[Object.keys(s(U)).length?(l(),r(S,{key:0,onTouchmove:t[2]||(t[2]=d((()=>{}),["prevent","stop"])),class:"rounded-t-[20rpx] overflow-hidden bg-[#fff] py-[32rpx] relative"},{default:a((()=>[i(S,{class:"flex mb-[58rpx] px-[32rpx]"},{default:a((()=>[i(S,{class:"rounded-[var(--goods-rounded-big)] overflow-hidden"},{default:a((()=>[i(f,{width:"180rpx",height:"180rpx",src:s(C)(B.value.sku_image),model:"aspectFill"},{error:a((()=>[i(o,{class:"w-[180rpx] h-[180rpx]",src:s(C)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:1},8,["src"])])),_:1}),i(S,{class:"flex flex-1 flex-col ml-[20rpx] py-[10rpx]"},{default:a((()=>[i(S,{class:"w-[100%]"},{default:a((()=>[i(S,{class:"text-[var(--price-text-color)] flex items-baseline"},{default:a((()=>[i(j,{class:"text-[28rpx] font-bold price-font mr-[4rpx]"},{default:a((()=>[k("￥")])),_:1}),i(j,{class:"text-[42rpx] font-bold price-font"},{default:a((()=>[k(y(parseFloat($(B.value)).toFixed(2).split(".")[0]),1)])),_:1}),i(j,{class:"text-[28rpx] font-bold price-font"},{default:a((()=>[k("."+y(parseFloat($(B.value)).toFixed(2).split(".")[1]),1)])),_:1}),"member_price"==P(B.value)?(l(),r(o,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0),"discount_price"==P(B.value)?(l(),r(o,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0)])),_:1}),i(S,{class:"text-[24rpx] leading-[32rpx] text-[#303133] mt-[12rpx]"},{default:a((()=>[k("库存"+y(B.value.stock)+y(s(U).goods.unit),1)])),_:1})])),_:1}),s(U).goodsSpec&&s(U).goodsSpec.length?(l(),r(S,{key:0,class:"w-[100%] mt-auto",style:{"max-height":"calc(204rpx - 126rpx)",overflow:"hidden"}},{default:a((()=>[i(j,{class:"text-[24rpx] leading-[30rpx] text-[var(--text-color-light6)]"},{default:a((()=>[k("已选规格："+y(B.value.sku_spec_format),1)])),_:1})])),_:1})):c("v-if",!0)])),_:1})])),_:1}),i(I,{class:"h-[500rpx] box-border px-[32rpx] mb-[30rpx]","scroll-y":"true"},{default:a((()=>[(l(!0),u(p,null,n(s(U).goodsSpec,((e,t)=>(l(),r(S,{class:x({"mt-[36rpx]":0!=t}),key:t},{default:a((()=>[i(S,{class:"text-[26rpx] leading-[36rpx] mb-[24rpx]"},{default:a((()=>[k(y(e.spec_name),1)])),_:2},1024),i(S,{class:"flex flex-wrap"},{default:a((()=>[(l(!0),u(p,null,n(e.values,((e,o)=>(l(),r(S,{class:x(["box-border bg-[#f2f2f2] text-[24rpx] px-[44rpx] text-center h-[56rpx] leading-[52rpx] mr-[20rpx] mb-[20rpx] border-1 border-solid rounded-[50rpx] border-[#f2f2f2]",{"!border-[var(--primary-color)] text-[var(--primary-color)] !bg-[var(--primary-color-light)]":e.selected}]),key:o,onClick:o=>((e,t)=>{L.value.name[t]=e.name,z.value=1})(e,t)},{default:a((()=>[k(y(e.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1032,["class"])))),128)),i(S,{class:"flex justify-between items-center mt-[8rpx]"},{default:a((()=>[i(S,{class:"text-[26rpx]"},{default:a((()=>[k("购买数量")])),_:1}),s(_)["goods_"+B.value.goods_id]&&s(_)["goods_"+B.value.goods_id]["sku_"+B.value.sku_id]?(l(),r(F,{key:0,modelValue:z.value,"onUpdate:modelValue":t[0]||(t[0]=e=>z.value=e),min:0,max:B.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(j,{class:x(["text-[34rpx] nc-iconfont nc-icon-jianV6xx font-500",{"!text-[var(--text-color-light9)]":0===z.value}])},null,8,["class"])])),input:a((()=>[i(j,{class:"text-[#303133] text-[28rpx] mx-[10rpx] min-w-[72rpx] h-[44rpx] bg-[#F1F2F5] leading-[44rpx] text-center rounded-[6rpx]"},{default:a((()=>[k(y(z.value),1)])),_:1})])),plus:a((()=>[i(j,{class:x(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx font-500",{"!text-[var(--text-color-light9)]":z.value===B.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"])):(l(),r(F,{key:1,modelValue:z.value,"onUpdate:modelValue":t[1]||(t[1]=e=>z.value=e),min:1,max:B.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(j,{class:x(["text-[34rpx] nc-iconfont nc-icon-jianV6xx font-500",{"!text-[var(--text-color-light9)]":1===z.value}])},null,8,["class"])])),input:a((()=>[i(j,{class:"text-[#303133] text-[28rpx] mx-[10rpx] min-w-[72rpx] h-[44rpx] bg-[#F1F2F5] leading-[44rpx] text-center rounded-[6rpx]"},{default:a((()=>[k(y(z.value),1)])),_:1})])),plus:a((()=>[i(j,{class:x(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx font-500",{"!text-[var(--text-color-light9)]":z.value===B.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"]))])),_:1})])),_:1}),i(S,{class:"px-[20rpx]"},{default:a((()=>[B.value.stock>0?(l(),r(N,{key:0,class:"!h-[80rpx] font-500 primary-btn-bg leading-[80rpx] text-[26rpx] rounded-[50rpx]",type:"primary",onClick:T},{default:a((()=>[k("确定")])),_:1})):(l(),r(N,{key:1,class:"!h-[80rpx] leading-[80rpx] font-500 text-[26rpx] text-[#fff] bg-[#ccc] rounded-[50rpx]"},{default:a((()=>[k("已售罄")])),_:1}))])),_:1})])),_:1})):c("v-if",!0)])),_:1},8,["show"])])),_:1})}}}),[["__scopeId","data-v-4ddd67ae"]]),ae=X(e({__name:"category-template-one-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const j=e,N=ee();N.getList();const M=S((()=>N.cartList)),T=S((()=>N.totalNum)),$=S((()=>N.totalMoney)),Q=E(),q=S((()=>Q.info)),{mescrollInit:X,getMescroll:G}=Z(O,z);let K=j.config,le=j.categoryId;const ae=t([]),se=t(""),ie=t(!0),de=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const ce=e=>{de.value=!1,W({page:e.num,limit:e.size,goods_category:le}).then((t=>{let o=t.data.data;1==e.num&&(ae.value=[]),ae.value=ae.value.concat(o),ie.value=!1,e.endSuccess(o.length),ae.value.length||(de.value=!0)})).catch((()=>{ie.value=!1,de.value=!0,e.endErr()}))},ue=e=>{f({url:"/addon/shop/pages/goods/detail",param:{goods_id:e}})};o((()=>{_e()}));const ne=t(""),pe=t(!1),xe=t(!1),fe=(e,t)=>{if(pe.value||xe.value)return!1;pe.value=!0,xe.value=!0;let o={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:Se(e),stock:e.goodsSku.stock};e.id&&(o.num=e.num,o.id=e.id),N.increase(o,1,(()=>{xe.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),o=e.getBoundingClientRect().left,l=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;ne.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{ne.value=`top: ${l+e.offsetHeight/2-r.offsetHeight/2}px; left: ${o+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{ne.value="",pe.value=!1}),1020)}),100)},ge=t([]),_e=()=>{ie.value=!0,A().then((e=>{if(ge.value=e.data,le)for(let t=0;t<ge.value.length;t++){if(ge.value[t].category_id==le){ve.value=t;break}if(ge.value[t].child_list)for(let e=0;e<ge.value[t].child_list.length;e++)if(ge.value[t].child_list[e].category_id==le){ve.value=t;break}}else le=e.data[0].category_id;ie.value=!1})).catch((()=>{ie.value=!1}))},ve=t(0),me=()=>{se.value&&f({url:"/addon/shop/pages/goods/list",param:{goods_name:encodeURIComponent(se.value)}})},be=t(),he=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return ue(e.goodsSku.goods_id);if("cart"!==K.cart.event)return ue(e.goodsSku.goods_id);if(!q.value)return U().setLoginBack({url:"/addon/shop/pages/goods/category"}),!1;if(e.goodsSku.sku_spec_format)be.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void I({title:"商品库存不足",icon:"none"});fe(e,t)}},ke=()=>{f({url:"/addon/shop/pages/goods/cart"})},ye=t(null);t(uni.getStorageSync("isbindmobile"));const Ce=()=>{if(uni.getStorageSync("isbindmobile"))return ye.value.open(),!1;if(!T.value)return void I({title:"还没有选择商品",icon:"none"});const e=[];Object.values(M.value).forEach((t=>{Object.keys(t).forEach((o=>{"totalNum"!=o&&"totalMoney"!=o&&e.push(t[o].id)}))})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/shop/pages/order/payment"})}})},we=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},Se=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const o=g,f=_,S=v,j=m,F=w,E=b(h("u--image"),H),z=V,O=b(h("loading-page"),D),U=b(h("tabbar"),P);return l(),r(S,{class:"min-h-screen bg-[var(--page-bg-color)] overflow-hidden"},{default:a((()=>[ge.value.length?(l(),r(S,{key:0,class:x(["mescroll-box bg-[var(--page-bg-color)]",{cart:s(K).cart.control&&"cart"===s(K).cart.event,detail:!(s(K).cart.control&&"cart"===s(K).cart.event)}])},{default:a((()=>[i(Y,{ref:"mescrollRef",down:{use:!1},onInit:s(X),onUp:ce},{default:a((()=>[s(K).search.control?(l(),r(S,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[100rpx] box-border"},{default:a((()=>[i(S,{class:"flex-1 search-input"},{default:a((()=>[i(o,{onClick:d(me,["stop"]),class:"nc-iconfont nc-icon-sousuo-duanV6xx1 btn"},null,8,["onClick"]),i(f,{class:"input",type:"text",modelValue:se.value,"onUpdate:modelValue":t[0]||(t[0]=e=>se.value=e),placeholder:s(K).search.title,onConfirm:me,placeholderClass:"text-[var(--text-color-light9)]"},null,8,["modelValue","placeholder"]),se.value?(l(),r(o,{key:0,class:"nc-iconfont nc-icon-cuohaoV6xx1 clear",onClick:t[1]||(t[1]=e=>se.value="")})):c("v-if",!0)])),_:1})])),_:1})):c("v-if",!0),i(S,{class:x(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[100rpx]":s(K).search.control,"pb-[98rpx]":s(K).cart.control&&"cart"===s(K).cart.event}])},{default:a((()=>[i(j,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(S,{class:"bg-[var(--temp-bg)]"},{default:a((()=>[(l(!0),u(p,null,n(ge.value,((e,t)=>(l(),r(S,{class:x(["tab-item truncate",{"tab-item-active":t==ve.value,"rounded-br-[12rpx]":ve.value-1===t,"rounded-tr-[12rpx]":ve.value+1===t}]),key:t,onClick:o=>((e,t)=>{ve.value=e,le=t.category_id,ae.value=[],G().resetUpScroll()})(t,e)},{default:a((()=>[i(S,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(S,{class:x(["flex justify-center flex-wrap pl-[188rpx] pb-[20rpx]",{" pt-[120rpx]":s(K).search.control," pt-[20rpx]":!s(K).search.control}])},{default:a((()=>[(l(!0),u(p,null,n(ae.value,((e,t)=>(l(),r(S,{key:e.goods_id,class:x(["box-border bg-white w-full flex mr-[20rpx] py-[24rpx] px-[20rpx] rounded-[var(--rounded-small)]",{"mt-[16rpx]":t}]),onClick:d((t=>ue(e.goods_id)),["stop"])},{default:a((()=>[i(E,{width:"168rpx",height:"168rpx",radius:"var(--goods-rounded-small)",src:s(C)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(F,{class:"w-[168rpx] h-[168rpx]",src:s(C)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(S,{class:"flex flex-1 ml-[20rpx] flex-wrap flex-col"},{default:a((()=>[i(S,{class:"max-h-[80rpx] text-[26rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),i(S,{class:"flex-1 flex items-end justify-between"},{default:a((()=>[i(S,{class:"text-[var(--price-text-color)] price-font -mb-[8rpx]"},{default:a((()=>[i(o,{class:"text-[24rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(o,{class:"text-[40rpx] font-500"},{default:a((()=>[k(y(parseFloat(Se(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(o,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(Se(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==we(e)?(l(),r(F,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0),"discount_price"==we(e)?(l(),r(F,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(K).cart.control&&"cart"===s(K).cart.event?(l(),r(S,{key:0,class:"flex items-center"},{default:a((()=>[i(o,{class:"text-[32rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:d((t=>(e=>{if(xe.value)return!1;xe.value=!0,N.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{xe.value=!1}))})(s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(o,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(o,{class:"text-[32rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:d((o=>((e,t,o)=>{if(parseInt(t.num)>=parseInt(t.stock))return void I({title:"商品库存不足",icon:"none"});let l=te(e);l.num=t.num,l.id=t.id,fe(l,o)})(e,s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(K).cart.event||"real"==e.goods_type?(l(),u(p,{key:1},[s(K).cart.control&&"style-1"===s(K).cart.style?(l(),r(S,{key:0,class:"h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"w-[102rpx] box-border text-center text-[#fff] bg-color h-[46rpx] text-[22rpx] leading-[46rpx] rounded-[100rpx]",onClick:d((o=>he(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(K).cart.text),1)])),_:2},1032,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(S,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(K).cart.control&&"style-2"===s(K).cart.style?(l(),r(S,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(o,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:d((o=>he(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(S,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(K).cart.control&&"style-3"===s(K).cart.style?(l(),r(S,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(o,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:d((o=>he(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(S,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(K).cart.control&&"style-4"===s(K).cart.style?(l(),r(S,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:d((o=>he(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(S,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0)],64)):c("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),ae.value.length||ie.value||!de.value?c("v-if",!0):(l(),r(J,{key:0,class:"part",option:{tip:"暂无商品"}}))])),_:1},8,["class"]),i(re,{ref_key:"cartRef",ref:be},null,512)])),_:1},8,["onInit"]),s(K).cart.control&&"cart"===s(K).cart.event?(l(),r(S,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios border-[0] border-t-[2rpx] border-solid border-[#eee]"},{default:a((()=>[i(S,{class:"flex items-center"},{default:a((()=>[i(S,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(S,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:d(ke,["stop"])},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(T)?(l(),r(S,{key:0,class:x(["border-[1rpx] border-solid border-[#fff]",["absolute left-[40rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[26rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(T)>9?"px-[10rpx]":""]])},{default:a((()=>[k(y(s(T)>99?"99+":s(T)),1)])),_:1},8,["class"])):c("v-if",!0)])),_:1}),i(o,{class:"text-[26rpx] font-500 text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(S,{class:"text-[var(--price-text-color)] price-font font-bold flex items-baseline"},{default:a((()=>[i(o,{class:"text-[26rpx] mr-[6rpx]"},{default:a((()=>[k("￥")])),_:1}),i(o,{class:"text-[44rpx]"},{default:a((()=>[k(y(parseFloat(s($))),1)])),_:1})])),_:1})])),_:1}),i(z,{class:"w-[180rpx] h-[70rpx] text-[26rpx] leading-[70rpx] font-500 !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",onClick:Ce},{default:a((()=>[k("去结算")])),_:1})])),_:1})):c("v-if",!0)])),_:1},8,["class"])):c("v-if",!0),L(i(S,{style:B(ne.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[R,ne.value]]),ge.value.length||ie.value?c("v-if",!0):(l(),r(J,{key:1,option:{tip:"暂无商品分类"}})),i(O,{loading:ie.value},null,8,["loading"]),i(U),c(" 强制绑定手机号 "),i(oe,{ref_key:"bindMobileRef",ref:ye},null,512)])),_:1})}}}),[["__scopeId","data-v-ce17da2b"]]),se=X(e({__name:"category-template-two-two",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const j=e,N=ee();N.getList();const M=S((()=>N.cartList)),T=S((()=>N.totalNum)),$=S((()=>N.totalMoney)),Q=E(),q=S((()=>Q.info)),{mescrollInit:X,getMescroll:G}=Z(O,z);let le=j.config,ae=j.categoryId;const se=t([]),ie=t(""),de=t(!0),ce=t(!1),ue=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const ne=e=>{ce.value=!1,W({page:e.num,limit:e.size,goods_category:ae}).then((t=>{let o=t.data.data;1==e.num&&(se.value=[]),se.value=se.value.concat(o),de.value=!1,e.endSuccess(o.length),se.value.length||(ce.value=!0)})).catch((()=>{de.value=!1,ce.value=!0,e.endErr()}))},pe=e=>{f({url:"/addon/shop/pages/goods/detail",param:{goods_id:e}})};o((()=>{me()}));const xe=t(""),fe=t(!1),ge=t(!1),_e=(e,t)=>{if(fe.value||ge.value)return!1;fe.value=!0,ge.value=!0;let o={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:Ve(e),stock:e.goodsSku.stock};e.id&&(o.num=e.num,o.id=e.id),N.increase(o,1,(()=>{ge.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),o=e.getBoundingClientRect().left,l=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;xe.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{xe.value=`top: ${l+e.offsetHeight/2-r.offsetHeight/2}px; left: ${o+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{xe.value="",fe.value=!1}),1020)}),100)};t({allActive:-1,data:{category_name:"全部",category_id:""}});const ve=t([]),me=()=>{de.value=!0,A().then((e=>{ve.value=e.data;for(let t=0;t<ve.value.length;t++)if(ve.value[t].child_list){let e={category_name:"全部",category_id:ve.value[t].category_id};ve.value[t].child_list.unshift(e)}if(ae)for(let t=0;t<ve.value.length;t++){if(ve.value[t].category_id==ae){be.value=t;break}if(ve.value[t].child_list)for(let e=0;e<ve.value[t].child_list.length;e++)if(ve.value[t].child_list[e].category_id==ae){be.value=t,he.value=e;break}}else ae=e.data[0].category_id;de.value=!1})).catch((()=>{de.value=!1}))},be=t(0),he=t(0),ke=(e,t)=>{he.value=e,ae=t.category_id,ue.value=!1,se.value=[],G().resetUpScroll()},ye=()=>{ie.value&&f({url:"/addon/shop/pages/goods/list",param:{goods_name:encodeURIComponent(ie.value)}})},Ce=t(),we=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return pe(e.goodsSku.goods_id);if("cart"!==le.cart.event)return pe(e.goods_id);if(!q.value)return U().setLoginBack({url:"/addon/shop/pages/goods/category"}),!1;if(e.goodsSku.sku_spec_format)Ce.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void I({title:"商品库存不足",icon:"none"});_e(e,t)}},Se=()=>{f({url:"/addon/shop/pages/goods/cart"})},je=t(null);t(uni.getStorageSync("isbindmobile"));const Fe=()=>{if(uni.getStorageSync("isbindmobile"))return je.value.open(),!1;if(!T.value)return void I({title:"还没有选择商品",icon:"none"});const e=[];Object.values(M.value).forEach((t=>{Object.keys(t).forEach((o=>{"totalNum"!=o&&"totalMoney"!=o&&e.push(t[o].id)}))})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/shop/pages/order/payment"})}})},Ie=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},Ve=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const o=g,f=_,S=v,j=m,F=b(h("u-popup"),K),E=w,z=b(h("u--image"),H),O=V,U=b(h("loading-page"),D),A=b(h("tabbar"),P);return l(),r(S,{class:"min-h-screen bg-[var(--page-bg-color)] overflow-hidden"},{default:a((()=>[ve.value.length?(l(),r(S,{key:0,class:x(["mescroll-box bg-[#f6f6f6]",{cart:s(le).cart.control&&"cart"===s(le).cart.event,detail:!(s(le).cart.control&&"cart"===s(le).cart.event)}])},{default:a((()=>[i(Y,{ref:"mescrollRef",down:{use:!1},onInit:s(X),onUp:ne},{default:a((()=>{var e,g,_,v,m,b;return[s(le).search.control?(l(),r(S,{key:0,class:"box-border search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[96rpx]"},{default:a((()=>[i(S,{class:"flex-1 search-input"},{default:a((()=>[i(o,{onClick:d(ye,["stop"]),class:"nc-iconfont nc-icon-sousuo-duanV6xx1 btn"},null,8,["onClick"]),i(f,{class:"input",type:"text",modelValue:ie.value,"onUpdate:modelValue":t[0]||(t[0]=e=>ie.value=e),placeholder:s(le).search.title,placeholderClass:"text-[var(--text-color-light9)]",onConfirm:ye},null,8,["modelValue","placeholder"]),ie.value?(l(),r(o,{key:0,class:"nc-iconfont nc-icon-cuohaoV6xx1 clear",onClick:t[1]||(t[1]=e=>ie.value="")})):c("v-if",!0)])),_:1})])),_:1})):c("v-if",!0),i(S,{class:x(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[96rpx]":s(le).search.control,"pb-[98rpx]":s(le).cart.control&&"cart"===s(le).cart.event}])},{default:a((()=>[i(j,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(S,{class:"bg-[var(--temp-bg)]"},{default:a((()=>[(l(!0),u(p,null,n(ve.value,((e,t)=>(l(),r(S,{class:x(["tab-item truncate",{"tab-item-active ":t==be.value,"rounded-br-[12rpx]":!(be.value-1!==t||ve.value[be.value].child_list&&ve.value[be.value].child_list.length),"rounded-tr-[12rpx]":!(be.value+1!==t||ve.value[be.value].child_list&&ve.value[be.value].child_list.length)}]),key:t,onClick:o=>((e,t)=>{be.value=e,t.child_list&&t.child_list.length?ke(0,t.child_list[0]):(ae=t.category_id,se.value=[],G().resetUpScroll())})(t,e)},{default:a((()=>[i(S,{class:"text-box truncate px-[24rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),(null==(e=ve.value[be.value])?void 0:e.child_list)&&(null==(g=ve.value[be.value])?void 0:g.child_list.length)?(l(),r(S,{key:1,class:x(["flex items-center h-[98rpx] pl-[24rpx] pr-[48rpx] py-[20rpx] z-10 bg-white fixed left-[168rpx] right-0 box-border top-0",{"!top-[94rpx]":s(le).search.control}])},{default:a((()=>[ue.value?(l(),u(p,{key:1},[i(S,{class:"flex-1 h-[48rpx] text-[28rpx] text-[var(--text-color-light9)] pr-[24rpx] leading-[48rpx]"},{default:a((()=>[k("全部分类")])),_:1}),i(o,{class:"absolute right-[24rpx] nc-iconfont nc-icon-shangV6xx-1 text-[#333] text-[30rpx]",onClick:t[3]||(t[3]=e=>ue.value=!1)})],64)):(l(),u(p,{key:0},[i(j,{"scroll-x":!0,"scroll-with-animation":"","scroll-into-view":"id"+(he.value?he.value-1:0),class:"flex-1 h-[54rpx] scroll-Y box-border pr-[24rpx] bg-white"},{default:a((()=>[i(S,{class:"flex items-center h-[54rpx] box-border"},{default:a((()=>{var e;return[(l(!0),u(p,null,n(null==(e=ve.value[be.value])?void 0:e.child_list,((e,t)=>(l(),r(o,{class:x(["w-[150rpx] flex-shrink-0 px-[14rpx] h-[54rpx] truncate text-center !leading-[50rpx] !text-[24rpx] border-[2rpx] border-solid !rounded-[100rpx] box-border text-[#333] box-border",{"bg-[var(--primary-color-light)] font-500 text-[var(--primary-color)] border-[var(--primary-color)]":t===he.value,"border-[var(--temp-bg)]  bg-[var(--temp-bg)]":t!=he.value," ml-[24rpx]":0!=t}]),key:ve.value[be.value].category_id,id:"id"+t,onClick:o=>ke(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","id","onClick"])))),128))]})),_:1})])),_:1},8,["scroll-into-view"]),i(S,{class:"absolute right-[24rpx] nc-iconfont nc-icon-xiaV6xx text-[30rpx] w-[30rpx] h-[30rpx] text-center transform",onClick:t[2]||(t[2]=e=>ue.value=!0)})],64))])),_:1},8,["class"])):c("v-if",!0),i(S,{class:x(["labelPopup",{active:s(le).search.control}])},{default:a((()=>[i(F,{show:ue.value,mode:"top",onClose:t[5]||(t[5]=e=>ue.value=!1)},{default:a((()=>[i(S,{class:"flex flex-wrap pt-[20rpx] pb-[24rpx]",onTouchmove:t[4]||(t[4]=d((()=>{}),["prevent","stop"]))},{default:a((()=>{var e;return[(l(!0),u(p,null,n(null==(e=ve.value[be.value])?void 0:e.child_list,((e,t)=>(l(),r(o,{class:x(["px-[14rpx] flex-shrink-0 w-[160rpx] box-border ml-[20rpx] mb-[26rpx] h-[60rpx] text-center leading-[56rpx] text-[26rpx] border-[2rpx] border-solid !rounded-[100rpx] text-[#333] truncate",{"bg-[var(--primary-color-light)] font-500 text-[var(--primary-color)] border-[var(--primary-color)]":t===he.value,"border-[var(--temp-bg)]  bg-[var(--temp-bg)]":t!=he.value}]),key:ve.value[be.value].category_id,onClick:o=>ke(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1},8,["show"])])),_:1},8,["class"]),i(S,{class:x(["flex justify-center flex-wrap pl-[168rpx] pt-[20rpx] pb-[20rpx]",{"!pt-[214rpx]":s(le).search.control&&(null==(_=ve.value[be.value])?void 0:_.child_list)&&(null==(v=ve.value[be.value])?void 0:v.child_list.length),"pt-[120rpx]":s(le).search.control&&(!ve.value[be.value].child_list||!ve.value[be.value].child_list.length),"pt-[118rpx]":(null==(m=ve.value[be.value])?void 0:m.child_list)&&(null==(b=ve.value[be.value])?void 0:b.child_list.length)&&!s(le).search.control}])},{default:a((()=>[(l(!0),u(p,null,n(se.value,((e,t)=>(l(),r(S,{key:e.goods_id,class:x(["w-[536rpx] box-border bg-white w-full flex mx-[20rpx] py-[24rpx] px-[20rpx] rounded-[var(--rounded-small)]",{"mt-[20rpx]":t}]),onClick:d((t=>pe(e.goods_id)),["stop"])},{default:a((()=>[i(S,{class:"mr-[20rpx] rounded-[var(--goods-rounded-small)] overflow-hidden"},{default:a((()=>[i(z,{width:"168rpx",height:"168rpx",radius:"var(--goods-rounded-small)",src:s(C)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(E,{class:"w-[168rpx] h-[168rpx]",src:s(C)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["radius","src"])])),_:2},1024),i(S,{class:"flex flex-1 flex-wrap flex-col"},{default:a((()=>[i(S,{class:"max-h-[80rpx] text-[26rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),i(S,{class:"flex items-end justify-between flex-1"},{default:a((()=>[i(S,{class:"text-[var(--price-text-color)] price-font -mb-[8rpx]"},{default:a((()=>[i(o,{class:"text-[24rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(o,{class:"text-[40rpx] font-500"},{default:a((()=>[k(y(parseFloat(Ve(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(o,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(Ve(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==Ie(e)?(l(),r(E,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0),"discount_price"==Ie(e)?(l(),r(E,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(C)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):c("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(le).cart.control&&"cart"===s(le).cart.event?(l(),r(S,{key:0,class:"flex items-center"},{default:a((()=>[i(o,{class:"text-[32rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:d((t=>(e=>{if(ge.value)return!1;ge.value=!0,N.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{ge.value=!1}))})(s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(o,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(o,{class:"text-[32rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:d((o=>((e,t,o)=>{if(parseInt(t.num)>=parseInt(t.stock))return void I({title:"商品库存不足",icon:"none"});let l=te(e);l.num=t.num,l.id=t.id,_e(l,o)})(e,s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(le).cart.event||"real"==e.goods_type?(l(),u(p,{key:1},[s(le).cart.control&&"style-1"===s(le).cart.style?(l(),r(S,{key:0,class:"h-[44rpx] relative pl-[20rpx]"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"w-[102rpx] box-border text-center text-[#fff] bg-color h-[46rpx] text-[22rpx] leading-[46rpx] rounded-[100rpx]",onClick:d((o=>we(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(le).cart.text),1)])),_:2},1032,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(S,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(le).cart.control&&"style-2"===s(le).cart.style?(l(),r(S,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(o,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:d((o=>we(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(S,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(le).cart.control&&"style-3"===s(le).cart.style?(l(),r(S,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(o,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:d((o=>we(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(S,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0),s(le).cart.control&&"style-4"===s(le).cart.style?(l(),r(S,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:d((o=>we(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(S,{key:0,class:x(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1024)):c("v-if",!0)],64)):c("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),se.value.length||de.value||!ce.value?c("v-if",!0):(l(),r(J,{key:0,class:"part",option:{tip:"暂无商品"}}))])),_:1},8,["class"]),i(re,{ref_key:"cartRef",ref:Ce},null,512)]})),_:1},8,["onInit"]),s(le).cart.control&&"cart"===s(le).cart.event?(l(),r(S,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios border-[0] border-t-[2rpx] border-solid border-[#eee]"},{default:a((()=>[i(S,{class:"flex items-center"},{default:a((()=>[i(S,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(S,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:d(Se,["stop"])},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(T)?(l(),r(S,{key:0,class:x(["border-[1rpx] border-solid border-[#fff]",["absolute left-[40rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[26rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(T)>9?"px-[10rpx]":""]])},{default:a((()=>[k(y(s(T)>99?"99+":s(T)),1)])),_:1},8,["class"])):c("v-if",!0)])),_:1}),i(o,{class:"text-[26rpx] text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(S,{class:"text-[var(--price-text-color)] price-font font-bold flex items-baseline"},{default:a((()=>[i(o,{class:"text-[26rpx] mr-[6rpx]"},{default:a((()=>[k("￥")])),_:1}),i(o,{class:"text-[44rpx]"},{default:a((()=>[k(y(parseFloat(s($))),1)])),_:1})])),_:1})])),_:1}),i(O,{class:"w-[180rpx] h-[70rpx] text-[26rpx] leading-[70rpx] font-500 !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",onClick:Fe},{default:a((()=>[k("去结算")])),_:1})])),_:1})):c("v-if",!0)])),_:1},8,["class"])):c("v-if",!0),L(i(S,{style:B(xe.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(o,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[R,xe.value]]),ve.value.length||de.value?c("v-if",!0):(l(),r(S,{key:1,class:"flex justify-center items-center w-[100%]"},{default:a((()=>[i(J,{option:{tip:"暂无商品分类"}})])),_:1})),i(U,{loading:de.value},null,8,["loading"]),i(A),c(" 强制绑定手机号 "),i(oe,{ref_key:"bindMobileRef",ref:je},null,512)])),_:1})}}}),[["__scopeId","data-v-2ee56bc4"]]),ie=X(e({__name:"category",setup(e){const o=ee(),s=t({}),i=t(0);return M((e=>{i.value=e.category_id||0,q().then((e=>{s.value=e.data,$({title:s.value.page_title})}))})),T((()=>{o.getList()})),(e,t)=>{const o=v;return l(),r(o,{style:B(e.themeColor())},{default:a((()=>[1===s.value.level&&"style-1"===s.value.template?(l(),r(ae,{key:0,class:"category",categoryId:i.value,config:s.value},null,8,["categoryId","config"])):c("v-if",!0),2===s.value.level&&"style-1"===s.value.template?(l(),r(le,{key:1,categoryId:i.value,config:s.value},null,8,["categoryId","config"])):c("v-if",!0),2===s.value.level&&"style-2"===s.value.template?(l(),r(se,{key:2,class:"category",categoryId:i.value,config:s.value},null,8,["categoryId","config"])):c("v-if",!0)])),_:1},8,["style"])}}}),[["__scopeId","data-v-e8c48ef8"]]);export{ie as default};
