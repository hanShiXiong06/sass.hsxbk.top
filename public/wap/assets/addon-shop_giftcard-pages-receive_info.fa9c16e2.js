import{d as e,l as a,j as r,r as t,p as l,t as d,a as o,x as s,o as n,c as u,w as i,b as p,u as c,y as x,z as f,f as _,W as v,U as g,V as m,n as b,H as h,g as y,h as k,i as w,B as j,D as F,C,E as z,aw as S,_ as I}from"./index-71c7df08.js";import{_ as R}from"./uni-popup.402343c9.js";import{_ as T}from"./loading-page.vue_vue_type_script_setup_true_lang.c7dc2256.js";import{d as B,r as E}from"./card.1368a464.js";import{b as L}from"./bind-mobile.b7e673b6.js";import"./sms-code.vue_vue_type_script_setup_true_lang.e09e1c1f.js";/* empty css                                                                    */const O=I(e({__name:"receive_info",setup(e){const I=a(),O=r((()=>I.info)),V=t({}),D=t(!0),H=t(!1),J=t(""),K=t(null);t(uni.getStorageSync("isbindmobile")),l((e=>{e.give_id?(J.value=e.give_id,M(e.give_id)):(d({title:"礼品卡不存在",icon:"none"}),setTimeout((()=>{o({url:"/addon/shop_giftcard/pages/index",mode:"reLaunch"})}),600))})),s((()=>{Object.keys(V.value).length&&M(J.value)}));const M=e=>{D.value=!0,B(e).then((e=>{V.value=e.data,D.value=!1})).catch((()=>{D.value=!1}))},P=t(),U=()=>O.value?uni.getStorageSync("isbindmobile")?(K.value.open(),!1):void(H.value||(H.value=!0,E({give_id:J.value}).then((e=>{e.data&&P.value.open(),H.value=!1})).catch((()=>{H.value=!1})))):(h().setLoginBack({url:"/addon/shop_giftcard/pages/receive_info",param:{give_id:J.value}}),!1),W=()=>{P.value.close(),o({url:"/addon/shop_giftcard/pages/my_card_list",mode:"redirectTo"})},q=()=>{M(J.value),P.value.close()},A=e=>{let a="";return a="balance"==e.card_info.giftcard.card_right_type?"addon/shop_giftcard/diy/index/value_card.jpg":"addon/shop_giftcard/diy/index/redemption_card.jpg",a};return(e,a)=>{const r=y(k("u-avatar"),S),t=w,l=j,d=F,s=C,h=y(k("uni-popup"),R),I=y(k("loading-page"),T);return n(),u(t,{class:"min-h-[100vh]",style:b(e.themeColor())},{default:i((()=>[Object.keys(V.value).length?(n(),u(t,{key:0,class:"give-info-bg w-full h-[100vh]"},{default:i((()=>[p(t,{class:"pt-[183rpx]"},{default:i((()=>[p(t,{class:"rounded-[var(--rounded-big)] bg-[#fff] mx-[var(--sidebar-m)] px-[82rpx] pb-[140rpx]"},{default:i((()=>[p(t,{class:"relative w-full h-[125rpx]"},{default:i((()=>[p(t,{class:"p-[4rpx] bg-[#fff] box-border rounded-[100rpx] w-[200rpx] h-[200rpx] absolute top-[-100rpx] left-[50%] transform -translate-x-1/2"},{default:i((()=>[p(r,{src:c(z)(V.value.member.headimg),size:"192rpx",leftIcon:"none","default-url":c(z)("static/resource/images/default_headimg.png")},null,8,["src","default-url"])])),_:1})])),_:1}),p(t,{class:"text-center text-[30rpx] font-500 leading-[42rpx] truncate"},{default:i((()=>[x(f(V.value.member.nickname),1)])),_:1}),p(t,{class:"text-center text-[28rpx] font-500 leading-[39rpx] text-[var(--text-color-light6)] mt-[10rpx] truncate"},{default:i((()=>[x(f("赠送给您"+V.value.card_info.giftcard.card_name),1)])),_:1}),p(t,{class:"w-full flex justify-center mt-[60rpx]",onClick:a[1]||(a[1]=e=>{V.value&&"my"==V.value.to_have&&o({url:"/addon/shop_giftcard/pages/use_card",param:{card_id:V.value.card_id},mode:"redirectTo"})})},{default:i((()=>[V.value&&V.value.card_info&&V.value.card_info.card_cover?(n(),u(l,{key:0,class:"w-[546rpx] h-[330rpx] rounded-[var(--rounded-big)]",src:c(z)(V.value.card_info.card_cover),onError:a[0]||(a[0]=e=>V.value.card_info.card_cover=A(V.value)),mode:"aspectFill"},null,8,["src"])):(n(),u(l,{key:1,class:"w-[546rpx] h-[330rpx] rounded-[var(--rounded-big)]",src:c(z)(A(V.value)),mode:"aspectFill"},null,8,["src"]))])),_:1}),V.value.blessing?(n(),u(t,{key:0,class:"text-[28rpx] mx-auto mt-[40rpx] multi-hidden"},{default:i((()=>[p(d,{class:"text-[var(--text-color-light6)] leading-[39rpx] mb-[10rpx]"},{default:i((()=>[x("对方祝您：")])),_:1}),p(d,{class:"text-[#333] leading-[39rpx]"},{default:i((()=>[x(f(V.value.blessing),1)])),_:1})])),_:1})):_("v-if",!0),p(t,{class:"mt-[148rpx]"},{default:i((()=>["wait_give"==V.value.status?(n(),u(s,{key:0,class:v(["w-full h-[80rpx] font-500 text-[26rpx] leading-[80rpx] !text-[#fff] !bg-[var(--primary-color)] m-0 rounded-[var(--rounded-big)] remove-border",{"opacity-40":H.value}]),onClick:U},{default:i((()=>[x("立即领取")])),_:1},8,["class"])):(n(),g(m,{key:1},[V.value&&"my"==V.value.to_have?(n(),u(s,{key:0,class:"w-full h-[80rpx] font-500 text-[26rpx] leading-[80rpx] !text-[var(--text-color-light9)] !bg-[#F7F7F7] m-0 rounded-[var(--rounded-big)] remove-border"},{default:i((()=>[x("已领取")])),_:1})):(n(),u(s,{key:1,class:"w-full h-[80rpx] font-500 text-[26rpx] leading-[80rpx] !text-[var(--text-color-light9)] !bg-[#F7F7F7] m-0 rounded-[var(--rounded-big)] remove-border"},{default:i((()=>[x("该卡已被领取")])),_:1})),p(t,{class:"mt-[25rpx] text-[24rpx] text-center leading-[34rpx] !text-[var(--text-color-light9)]",onClick:W},{default:i((()=>[x("查看卡包")])),_:1})],64))])),_:1})])),_:1})])),_:1}),p(h,{ref_key:"popupRef",ref:P,type:"center","is-mask-click":!1},{default:i((()=>[p(t,{class:"bg-[#fff] w-[530rpx] min-h-[504rpx] rounded-[var(--rounded-big)] box-border p-[32rpx] relative",style:b({"background-image":"url("+c(z)("addon/shop_giftcard/popup_bg.png")+")",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"top"})},{default:i((()=>[p(l,{class:"w-[327rpx] h-[327rpx] rounded-[var(--rounded-mid)] absolute left-[50%] top-[-163.5rpx] transform -translate-x-1/2 z-10",src:c(z)("addon/shop_giftcard/popup_top.png"),mode:"aspectFill"},null,8,["src"]),p(t,{class:"text-[40rpx] leading-[56rpx] font-bold text-center pt-[174rpx]"},{default:i((()=>[x("恭喜您 领取成功！")])),_:1}),p(t,{class:"text-[24rpx] leading-[34rpx] text-center mt-[30rpx]"},{default:i((()=>[x("您已成功领取了1张礼品卡~")])),_:1}),p(s,{class:"w-[370rpx] h-[80rpx] font-500 text-[26rpx] leading-[80rpx] !text-[#fff] primary-btn-bg m-0 !mx-auto rounded-[40rpx] remove-border mt-[90rpx]",onClick:W},{default:i((()=>[x("去看看")])),_:1}),p(t,{class:"iconfont icona-guanbi-34V6xx text-[57rpx] text-[#fff] absolute left-[50%] bottom-[-117rpx] transform -translate-x-1/2 z-10",onClick:q})])),_:1},8,["style"])])),_:1},512)])),_:1})):_("v-if",!0),_(" 强制绑定手机号 "),p(L,{ref_key:"bindMobileRef",ref:K},null,512),p(I,{loading:D.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-f9eb6b9e"]]);export{O as default};
