import{d as e,l as a,j as t,r as l,p as s,o as r,c as o,w as n,P as i,b as c,n as u,u as p,y as d,z as m,Q as x,a7 as f,f as _,a8 as v,a9 as g,a as y,D as h,i as b,B as k,g as j,h as w,a1 as C,R as I,E as T,G as M}from"./index-7bf68536.js";import{_ as z}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{g as P,a as S,b as D,c as E}from"./sale.cd84b764.js";import{M as O}from"./mescroll-body.b6d57b41.js";import{M as R}from"./mescroll-empty.fcefb74e.js";import{u as B}from"./useMescroll.26ccf5de.js";import{t as U}from"./topTabbar.f3f9eebd.js";import{f as F}from"./cloneDeep.77735539.js";import{_ as G}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-page.566c330a.js";import"./u-loading-icon.b37701e7.js";import"./u-transition.cdf87992.js";import"./mescroll-i18n.14e7fe02.js";/* empty css                                                                       */const N=G(e({__name:"sale",setup(e){const G=a();let N={};const{mescrollInit:Q,downCallback:Y,getMescroll:q}=B(g,v),A=U();A.setTopTabbarParam({title:"销售奖励"});const H=t((()=>{let e={backgroundImage:"url("+T("addon/shop_fenxiao/sale/head_bg.png")+") ",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPositionY:"-170rpx"};return e})),J=t((()=>Object.keys(N).length?M(Number(N.height))+M(N.top)+M(8)+728+"rpx":"728rpx")),K=l(""),L=l(!0);s((async()=>{await P().then((e=>{K.value=e.data.is_open,0==K.value&&A.setTopTabbarParam({title:"销售奖励",topStatusBar:{textColor:"#333",bgColor:"#fff"}}),L.value=!1}))}));const V=l([{name:"全部",key:"all"},{name:"待发放",key:"0"},{name:"已发放",key:"1"}]),W=l("all"),X=l(0),Z=l(!0),$=l(!0),ee=l([]),ae=e=>{$.value=!0,S({page:e.num,limit:e.size,is_send:W.value}).then((a=>{let t=a.data.data;1==e.num&&(ee.value=[],"1"!=W.value&&te(t)),ee.value=ee.value.concat(t),$.value=!1,e.endSuccess(t.length)})).catch((()=>{Z.value=!1,$.value=!1,e.endErr()}))},te=async e=>{Z.value=!0;const a=await D();let t=e.map((e=>e.period_id));if(Object.keys(a.data).length&&(t.length&&-1==t.indexOf(a.data.id)||!t.length)){let e=F(a.data);e.reward_money=e.total_reward_money,e.period_id=e.id,e.order_money=e.total_order_money,ee.value.unshift(e)}Z.value=!1},le=l({});E().then((e=>{le.value=e.data}));const se=()=>{G.getMemberInfo((()=>{y({url:"/app/pages/member/commission"})}))};return(e,a)=>{const t=h,l=b,s=k,v=j(w("loading-page"),z);return r(),o(l,{class:"bg-[var(--page-bg-color)] min-h-[100vh]",style:u(e.themeColor())},{default:n((()=>[1!=K.value||L.value?_("v-if",!0):(r(),i(x,{key:0},[c(l,{class:"fixed w-full z-2 !bg-[var(--page-bg-color)]"},{default:n((()=>[c(l,{class:"w-full overflow-hidden",style:u(p(H))},{default:n((()=>[c(l,{class:"card-template sidebar-margin mt-[312rpx]"},{default:n((()=>[c(l,{class:"flex flex-col mb-[56rpx]",onClick:se},{default:n((()=>[c(t,{class:"text-[30rpx] h-[36rpx] leading-[36rpx] text-[#333] mb-[16rpx]"},{default:n((()=>[d("销售奖励（元）")])),_:1}),c(t,{class:"text-[48rpx] price-font text-[var(--price-text-color)] min-h-[58rpx]"},{default:n((()=>[d(m(p(C)(le.value.sale_commission)||0),1)])),_:1})])),_:1}),c(l,{class:"flex item-center justify-between"},{default:n((()=>[c(l,{class:"flex flex-col w-[50%]"},{default:n((()=>[c(t,{class:"text-[28rpx] h-[34rpx] text-[var(--text-color-light6)] mb-[10rpx]"},{default:n((()=>[d("待发放（元）")])),_:1}),c(t,{class:"text-[36rpx] min-h-[46rpx] text-[#333] price-font"},{default:n((()=>[d(m(p(C)(le.value.wait_sale_commission)||0),1)])),_:1})])),_:1}),c(l,{class:"flex flex-col w-[50%]"},{default:n((()=>[c(t,{class:"text-[28rpx] h-[34rpx] text-[var(--text-color-light6)] mb-[10rpx]"},{default:n((()=>[d("已发放（元）")])),_:1}),c(t,{class:"text-[36rpx] min-h-[46rpx] text-[#333] price-font"},{default:n((()=>[d(m(p(C)(le.value.sale_commission_send)||0),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),c(l,{class:"tab-style-1 mt-[40rpx]"},{default:n((()=>[c(l,{class:"tab-left"},{default:n((()=>[(r(!0),i(x,null,f(V.value,((e,a)=>(r(),o(l,{class:I(["tab-left-item",{"class-select":W.value===e.key}]),onClick:t=>((e,a)=>{W.value=e,X.value=a,ee.value=[],q().resetUpScroll()})(e.key,a)},{default:n((()=>[d(m(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1}),c(O,{ref:"mescrollRef",down:{use:!1},onInit:p(Q),onUp:ae,top:p(J)},{default:n((()=>[!ee.value.length||$.value||Z.value?_("v-if",!0):(r(!0),i(x,{key:0},f(ee.value,((e,a)=>(r(),o(l,{keys:a,class:"flex justify-between items-center card-template mt-[var(--top-m)] sidebar-margin",onClick:a=>{return t=e.period_id,void y({url:"/addon/shop_fenxiao/pages/sale_detail",param:{id:t}});var t}},{default:n((()=>[c(l,{class:"flex flex-col"},{default:n((()=>[e.is_settlement?(r(),o(l,{key:0,class:"text-[#333] text-[28rpx] flex items-center"},{default:n((()=>[c(t,{class:"text-[28rpx] mr-[6rpx]"},{default:n((()=>[d("结算时间")])),_:1}),c(t,null,{default:n((()=>[d(m(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)):(r(),o(l,{key:1,class:"text-[#333] text-[28rpx] flex items-center"},{default:n((()=>[c(t,{class:"text-[28rpx] mr-[6rpx]"},{default:n((()=>[d("预计结算时间")])),_:1}),c(t,null,{default:n((()=>[d(m(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)),c(l,{class:"mt-[16rpx] h-[34rpx] flex items-center text-[24rpx] text-[var(--text-color-light6)]"},{default:n((()=>[d(" 销售金额："+m(e.order_money),1)])),_:2},1024)])),_:2},1024),c(l,{class:I(["text-[28rpx] text-[var(--text-color-light6)]",{"text-[#333]":e.is_send,"text-[var(--primary-color)]":!e.is_send}])},{default:n((()=>[d(m(e.is_send?"已发放":"待发放"),1)])),_:2},1032,["class"])])),_:2},1032,["keys","onClick"])))),256)),ee.value.length||$.value||Z.value?_("v-if",!0):(r(),o(R,{key:1,option:{icon:p(T)("addon/shop_fenxiao/sale/empty.png"),tip:"暂无销售奖励记录",btnText:"去逛逛"},onEmptyclick:a[0]||(a[0]=e=>p(y)({url:"/addon/shop_fenxiao/pages/goods"}))},null,8,["option"]))])),_:1},8,["onInit","top"])],64)),0!=K.value||L.value?_("v-if",!0):(r(),o(l,{key:1,class:"h-[100vh] w-[100vw] overflow-hidden"},{default:n((()=>[c(l,{class:"empty-page"},{default:n((()=>[c(s,{class:"img",src:p(T)("static/resource/images/system/empty.png"),mode:"aspectFit"},null,8,["src"]),c(l,{class:"desc"},{default:n((()=>[d("销售奖励设置未开启")])),_:1})])),_:1})])),_:1})),c(v,{loading:L.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-0e0026c0"]]);export{N as default};
