import{d as e,r as l,l as a,j as o,K as r,N as t,F as s,o as i,c as n,w as d,b as p,y as u,z as m,u as c,A as b,f as g,t as x,L as _,i as f,a4 as h,g as v,h as y,D as k,C as S,a as j,k as w}from"./index-2882a2d8.js";import{_ as V}from"./u-form-item.03ed7ff5.js";import{_ as C}from"./sms-code.vue_vue_type_script_setup_true_lang.c0821f07.js";import{_ as T,a as A}from"./u-checkbox-group.5e46c6da.js";import{_ as P}from"./u-form.54744837.js";import{_ as I}from"./u-popup.2abbe959.js";/* empty css                                                                    */import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";const z=U(e({__name:"bind-mobile",setup(e,{expose:U}){const z=l(!1),B=a(),O=o((()=>B.info)),q=o((()=>w().login)),E=l(!1),M=l(!1),$=r({mobile:"",mobile_code:"",mobile_key:""}),D=l(!0);t((()=>{setTimeout((()=>{D.value=!1}),800),uni.getStorageSync("openid")&&Object.assign($,{openid:uni.getStorageSync("openid")}),uni.getStorageSync("pid")&&Object.assign($,{pid:uni.getStorageSync("pid")}),uni.getStorageSync("unionid")&&Object.assign($,{unionid:uni.getStorageSync("unionid")})}));const F={mobile:[{type:"string",required:!0,message:s("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,l,a){/^1[3-9]\d{9}$/.test(l)?a():a(new Error("请输入正确的手机号"))},message:s("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:s("codePlaceholder"),trigger:["blur","change"]}},K=()=>{M.value=!M.value},L=l(null),N=()=>{L.value.validate().then((()=>{M.value||!q.value.agreement_show?E.value||(E.value=!0,_($).then((e=>{B.getMemberInfo(),O.value.mobile&&uni.removeStorageSync("isbindmobile"),z.value=!1})).catch((()=>{E.value=!1}))):x({title:s("isAgreeTips"),icon:"none"})}))};return U({open:()=>{z.value=!0}}),(e,l)=>{const a=f,o=h,r=v(y("u-form-item"),V),t=v(y("sms-code"),C),x=v(y("u-checkbox"),T),_=v(y("u-checkbox-group"),A),w=k,U=S,B=v(y("u-form"),P),O=v(y("u-popup"),I);return i(),n(O,{show:z.value,onClose:l[7]||(l[7]=e=>z.value=!1),mode:"center",round:10,closeable:!0,safeAreaInsetBottom:!1,zIndex:"10086"},{default:d((()=>[p(a,{onTouchmove:l[6]||(l[6]=b((()=>{}),["prevent","stop"])),class:"max-w-[630rpx] w-[630rpx] box-border"},{default:d((()=>[p(a,{class:"text-center py-[50rpx] text-[32rpx] font-500 leading-[46rpx]"},{default:d((()=>[u(m(c(s)("bindMobile")),1)])),_:1}),p(a,{class:"px-[50rpx] pb-[50rpx]"},{default:d((()=>[p(B,{labelPosition:"left",model:$,errorType:"toast",rules:F,ref_key:"formRef",ref:L},{default:d((()=>[p(r,{label:"",prop:"mobile",borderBottom:!0},{default:d((()=>[p(o,{modelValue:$.mobile,"onUpdate:modelValue":l[0]||(l[0]=e=>$.mobile=e),type:"number",maxlength:"11",placeholder:c(s)("mobilePlaceholder"),class:"w-full h-[50rpx] leading-[50rpx] !bg-transparent !px-[20rpx] text-[26rpx] text-[#333]",disabled:D.value,"placeholder-class":"bind-mobile"},null,8,["modelValue","placeholder","disabled"])])),_:1}),p(a,{class:"mt-[20rpx]"},{default:d((()=>[p(r,{label:"",prop:"mobile_code",borderBottom:!0},{right:d((()=>[c(q).agreement_show?(i(),n(t,{key:0,mobile:$.mobile,type:"login",modelValue:$.mobile_key,"onUpdate:modelValue":l[2]||(l[2]=e=>$.mobile_key=e),isAgree:M.value},null,8,["mobile","modelValue","isAgree"])):(i(),n(t,{key:1,mobile:$.mobile,type:"login",modelValue:$.mobile_key,"onUpdate:modelValue":l[3]||(l[3]=e=>$.mobile_key=e)},null,8,["mobile","modelValue"]))])),default:d((()=>[p(o,{modelValue:$.mobile_code,"onUpdate:modelValue":l[1]||(l[1]=e=>$.mobile_code=e),type:"number",maxlength:"6",placeholder:c(s)("codePlaceholder"),class:"box-border w-full h-[50rpx] leading-[50rpx] !bg-transparent !px-[20rpx] text-[26rpx] text-[#333]",disabled:D.value,"placeholder-class":"bind-mobile"},null,8,["modelValue","placeholder","disabled"])])),_:1})])),_:1}),c(q).agreement_show?(i(),n(a,{key:0,class:"flex items-center mt-[20rpx] pl-[10rpx] py-[10rpx]",onClick:b(K,["stop"])},{default:d((()=>[p(_,{onChange:K},{default:d((()=>[p(x,{activeColor:"var(--primary-color)",checked:M.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),p(a,{class:"text-[24rpx] text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:d((()=>[p(w,null,{default:d((()=>[u(m(c(s)("agreeTips")),1)])),_:1}),p(w,{onClick:l[4]||(l[4]=b((e=>c(j)({url:"/app/pages/auth/agreement?key=privacy"})),["stop"])),class:"text-primary"},{default:d((()=>[u("《"+m(c(s)("privacyAgreement"))+"》",1)])),_:1}),p(w,null,{default:d((()=>[u(m(c(s)("and")),1)])),_:1}),p(w,{onClick:l[5]||(l[5]=b((e=>c(j)({url:"/app/pages/auth/agreement?key=service"})),["stop"])),class:"text-primary"},{default:d((()=>[u("《"+m(c(s)("userAgreement"))+"》",1)])),_:1})])),_:1})])),_:1},8,["onClick"])):g("v-if",!0),p(a,{class:"mt-[120rpx]"},{default:d((()=>[p(U,{class:"primary-btn-bg text-[26rpx] !text-[#fff] !h-[80rpx] leading-[80rpx] rounded-full font-500",loading:E.value,loadingText:c(s)("binding"),onClick:N},{default:d((()=>[u(m(c(s)("bind")),1)])),_:1},8,["loading","loadingText"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-697deefd"]]);export{z as b};
