import{d as e,r as t,p as l,o as a,c as r,w as s,u as o,b as n,bV as d,y as u,z as i,f,R as c,P as x,Q as _,a7 as p,n as m,a as y,D as b,g as v,h,i as g,B as k,E as w,be as j,bZ as A}from"./index-7bf68536.js";import{_ as C}from"./u-count-down.05562681.js";import{_ as B}from"./u-form.78a4f7c2.js";import{_ as E}from"./u--form.632a93a1.js";import{_ as F}from"./u-button.359d7329.js";import{_ as D}from"./pay.d2e850e8.js";import{_ as z,a as S}from"./u-steps.9fc55f35.js";import{_ as H}from"./u-popup.be4bfacd.js";import{_ as I}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{C as V,D as W,E as M,F as L,A as N,B as O}from"./tourism.3586533e.js";import{_ as P}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.0c1c54c7.js";import"./u-line.463a2a45.js";import"./u-loading-icon.b37701e7.js";import"./u-image.e46f68ef.js";import"./u-transition.cdf87992.js";import"./pay.2db06871.js";import"./u-text.df478cbc.js";import"./u-safe-bottom.908eeae4.js";import"./u-loading-page.566c330a.js";const R=P(e({__name:"detail",setup(e){let P=t({}),R=t(!0),q=t(""),Q=t(""),T=t(1),U=t(!1),Z=t(0);t(null),l((e=>{Q.value=e.order_id,$(Q.value)}));const $=e=>{R.value=!0,V(e).then((e=>{if(P.value=e.data,T.value=P.value.order_log.length?P.value.order_log.length-1:0,q.value=e.data.order_type,e.data.refund_id&&X(e.data.refund_id),0==P.value.order_status_info.status){const e=(new Date).getTime()/1e3;Z.value=1e3*(P.value.auto_close_time-e);let t=setInterval((()=>{Z.value<=0&&clearInterval(t)}),1e3)}R.value=!1})).catch((()=>{R.value=!1}))};let G=t(!1),J=t({}),K=t(1);const X=e=>{W(e).then((e=>{J.value=e.data,K.value=e.data.refund_log.length?e.data.refund_log.length-1:0}))},Y=t(null),ee=(e,t="")=>{var l;"pay"==t?null==(l=Y.value)||l.open(e.order_type,e.order_id,`/addon/tourism/pages/order/detail?order_id=${e.order_id}`):"cancel"==t?(e=>{N(e).then((e=>{$(Q.value)})).catch((()=>{$(Q.value)}))})(e):"delete"==t?(e=>{O(e.order_id).then((e=>{y({url:"/addon/tourism/pages/order/list"})})).catch((()=>{$(Q.value)}))})(e):"buy"==t?"scenic"==e.order_type?y({url:"/addon/tourism/pages/scenic/list"}):"way"==e.order_type?y({url:"/addon/tourism/pages/way/list"}):"hotel"==e.order_type&&y({url:"/addon/tourism/pages/hotel/list"}):"index"==t&&y({url:"/addon/tourism/pages/index",mode:"reLaunch"})},te=(e,t)=>{let l,a;-1!=e.indexOf("/")?l=e.split("/"):-1!=e.indexOf("-")&&(l=e.split("-"));const r=new Date(e).getDay(),s=["周日","周一","周二","周三","周四","周五","周六"];return a="yearMonthDay"==t?l[0]+"年"+l[1]+"月"+l[2]+"日":"yearMonthDayWeek"==t?l[0]+"年"+l[1]+"月"+l[2]+"日 "+s[r]:"monthDayWeek"==t?l[1]+"月"+l[2]+"日 "+s[r]:l[1]+"月"+l[2]+"日",a};return(e,t)=>{const l=b,y=v(h("u-count-down"),C),V=g,W=k,N=v(h("u-form-item"),B),O=v(h("u--form"),E),X=v(h("u-button"),F),le=v(h("pay"),D),ae=v(h("u-steps-item"),z),re=v(h("u-steps"),S),se=v(h("u-popup"),H),oe=v(h("loading-page"),I);return a(),r(V,{style:m(e.themeColor())},{default:s((()=>[o(R)?f("v-if",!0):(a(),r(V,{key:0,class:"bg-[#f8f8f8] min-h-screen overflow-hidden"},{default:s((()=>[n(V,{class:"bg-linear h-[480rpx] text-white px-4 pt-5"},{default:s((()=>{var e;return[n(V,{class:"text-[42rpx] flex items-baseline",onClick:t[0]||(t[0]=e=>d(U)?U.value=!0:U=!0)},{default:s((()=>[n(l,{class:"nc-iconfont nc-icon-a-shijianV6xx-36 text-[42rpx] mr-1"}),n(l,{class:"font-bold"},{default:s((()=>{var e,t;return[u("订单"+i(null==(t=null==(e=o(P))?void 0:e.order_status_info)?void 0:t.name),1)]})),_:1}),o(Z)>0&&0==o(P).order_status_info.status?(a(),r(V,{key:0,class:"text-xs flex items-center ml-[20rpx]"},{default:s((()=>[n(l,null,{default:s((()=>[u("剩余支付时间：")])),_:1}),n(y,{time:o(Z),format:"HH:mm:ss"},null,8,["time"])])),_:1})):f("v-if",!0)])),_:1}),0==(null==(e=o(P))?void 0:e.order_status_info.status)?(a(),r(V,{key:0,class:"text-xs mt-3"},{default:s((()=>{var e,t;return[u("您的订单"+i(null==(t=null==(e=o(P))?void 0:e.order_status_info)?void 0:t.name)+"，欢迎再次预订！",1)]})),_:1})):(a(),r(V,{key:1,class:"text-xs mt-3"},{default:s((()=>{var e,t;return[u("您的订单"+i(null==(t=null==(e=o(P))?void 0:e.order_status_info)?void 0:t.name)+"，欢迎再次预订！",1)]})),_:1}))]})),_:1}),n(V,{class:"bg-white mx-3 py-4 px-3 rounded-md -mt-[340rpx] box-border"},{default:s((()=>[n(V,{class:c(["flex",{"pb-4 border-0 border-b-1 border-dashed border-[#EAEAEA] mb-4":["1","10"].includes(o(P).order_status)}])},{default:s((()=>[n(W,{class:"w-[124rpx] h-[124rpx] mr-2 rounded",src:o(w)(o(P).goods_image)},null,8,["src"]),n(V,{class:"flex-1 flex flex-col"},{default:s((()=>[n(V,{class:"text-[#1A2336] text-[30rpx] truncate font-bold w-[514rpx]"},{default:s((()=>[u(i(o(P)[o(q)][o(q)+"_name"])+"【"+i(o(P).goods_name)+"】",1)])),_:1}),n(V,{class:"flex items-center text-[#7F7F85] text-xs mt-[12rpx]"},{default:s((()=>[n(l,{class:"mr-1"},{default:s((()=>[u(i(te(o(P).start_time,"yearMonthDayWeek")),1)])),_:1}),f(' <text class="mr-1">周日</text> '),n(l,null,{default:s((()=>[u("当日有效")])),_:1})])),_:1}),n(V,{class:"font-bold text-sm text-[#222] mt-auto price-font"},{default:s((()=>[u("￥"+i(o(P).order_money),1)])),_:1})])),_:1})])),_:1},8,["class"]),["1","10"].includes(o(P).order_status)?(a(),x(_,{key:0},[n(V,{class:"bg-[#F9FBFF] rounded-lg overflow-hidden mb-4"},{default:s((()=>["hotel"==o(q)?(a(),r(V,{key:0,class:"bg-[#EEF3FF] flex items-center text-sm py-3 justify-center triangle"},{default:s((()=>[u(" 请提醒商家 "),n(l,{class:"text-[#EA4B69]"},{default:s((()=>[u("【扫码核销】")])),_:1}),u(" 使用 ")])),_:1})):(a(),r(V,{key:1,class:"bg-[#EEF3FF] flex items-center text-sm py-3 justify-center triangle"},{default:s((()=>[u(" 凭 "),n(l,{class:"text-[#EA4B69]"},{default:s((()=>[u("【身份证】")])),_:1}),u(" 或 "),n(l,{class:"text-[#EA4B69]"},{default:s((()=>[u("【手机号】")])),_:1}),u(" 可直接入园 ")])),_:1})),n(V,{class:"flex flex-col items-center pb-4"},{default:s((()=>[n(W,{class:"w-[326rpx] h-[326rpx] mt-4 mb-4",src:o(P).verify_code_qrcode},null,8,["src"]),n(W,{class:"w-[524rpx] h-[128rpx] mb-3",src:o(P).verify_code_barcode},null,8,["src"]),n(V,{class:"text-[var(--text-color-light6)] text-xs"},{default:s((()=>[u("未消费前请不要将券码提供给商家")])),_:1})])),_:1})])),_:1}),n(V,null,{default:s((()=>[n(V,{class:"flex items-center justify-between"},{default:s((()=>[n(V,{class:"flex items-center"},{default:s((()=>[n(l,{class:"text-sm"},{default:s((()=>[u(i("hotel"==o(q)?"券码":"入园码")+" "+i(o(P).verify_code),1)])),_:1}),n(l,{class:"nc-iconfont nc-icon-fuzhiV6xx text-[32rpx] ml-2 text-[#636363]",onClick:t[1]||(t[1]=e=>o(j)(o(P).verify_code))})])),_:1}),n(l,{class:"text-[#696969] text-[26rpx]"},{default:s((()=>[u(i(o(P).order_status_info.name),1)])),_:1})])),_:1})])),_:1})],64)):f("v-if",!0)])),_:1}),n(V,{class:"mt-3 bg-white mx-3 px-3 py-4 rounded-md"},{default:s((()=>[n(V,{class:"text-[#1A2336] text-[30rpx] font-bold mb-4"},{default:s((()=>[u("订单信息")])),_:1}),"hotel"==o(q)?(a(),r(V,{key:0,class:"border-0 border-b-1 border-solid border-[#EAEAEA] mb-1 pb-4"},{default:s((()=>[n(V,{class:"flex items-center"},{default:s((()=>[n(V,{class:"flex flex-col items-center"},{default:s((()=>[n(l,{class:"text-[26rpx] text-[#1A2336]"},{default:s((()=>[u(i(te(o(P).start_time,"monthDayWeek")),1)])),_:1}),n(l,{class:"text-xs text-[#888] mt-1"},{default:s((()=>[u("14:00后入住")])),_:1})])),_:1}),n(V,{class:"ml-4 mr-4 relative w-[136rpx] text-center"},{default:s((()=>[n(l,{class:"text-white relative z-10 text-xs font-scale bg-[#1C283E] px-2 py-1 rounded-xl w-[90rpx] box-border break-keep"},{default:s((()=>[u("共"+i(o(P).days)+"晚",1)])),_:1}),n(l,{class:"iconfont iconzhixiang absolute left-0 right-0 text-[90rpx] top-[50%] translate-y text-[#ABABAB]"})])),_:1}),n(V,{class:"flex flex-col items-center"},{default:s((()=>[n(l,{class:"text-[26rpx] text-[#1A2336]"},{default:s((()=>[u(i(te(o(P).end_time,"monthDayWeek")),1)])),_:1}),n(l,{class:"text-xs text-[#888] mt-1"},{default:s((()=>[u("12:00前离店")])),_:1})])),_:1})])),_:1}),n(V,{class:"mt-4 text-[#1A2336] text-[26rpx] font-bold"},{default:s((()=>[u(i(o(P).hotel.hotel_name)+"（"+i(o(P).goods_name)+"） ",1)])),_:1}),n(V,{class:"mt-1 text-[#1A2336] text-[26rpx] font-bold flex items-center"},{default:s((()=>[n(l,{class:"nc-iconfont nc-icon-fengefuV6xx text-[32rpx]"}),n(l,null,{default:s((()=>[u("共"+i(o(P).num)+"间",1)])),_:1})])),_:1}),f(' <view class="mt-3 text-[#1A2336] text-[26rpx] font-bold">\r\n                        无早餐\r\n                    </view> ')])),_:1})):f("v-if",!0),n(O,{labelPosition:"left",ref:"form1",labelWidth:"90",labelStyle:{color:"#A3A3A3",fontSize:"14px"}},{default:s((()=>["hotel"==o(P).order_type?(a(!0),x(_,{key:0},p(o(P).buyer_info,((e,t)=>(a(),x(_,null,[e.name?(a(),r(N,{key:0,label:"联系人姓名",prop:"userInfo.name",borderBottom:""},{default:s((()=>[n(V,{class:"border-style"},{default:s((()=>[u(i(e.name),1)])),_:2},1024)])),_:2},1024)):f("v-if",!0),e.id_card?(a(),r(N,{key:1,label:"身份证号",borderBottom:""},{default:s((()=>[n(V,{class:"border-style"},{default:s((()=>[u(i(e.id_card),1)])),_:2},1024)])),_:2},1024)):f("v-if",!0)],64)))),256)):(a(),x(_,{key:1},[o(P).buyer_info.name?(a(),r(N,{key:0,label:"联系人姓名",prop:"userInfo.name",borderBottom:""},{default:s((()=>[n(V,{class:"border-style"},{default:s((()=>[u(i(o(P).buyer_info.name),1)])),_:1})])),_:1})):f("v-if",!0),o(P).buyer_info.id_card?(a(),r(N,{key:1,label:"身份证号",borderBottom:""},{default:s((()=>[n(V,{class:"border-style"},{default:s((()=>[u(i(o(P).buyer_info.id_card),1)])),_:1})])),_:1})):f("v-if",!0)],64)),o(P).mobile?(a(),r(N,{key:2,label:"联系电话",borderBottom:""},{default:s((()=>[n(V,{class:"border-style"},{default:s((()=>[u(i(o(P).mobile),1)])),_:1})])),_:1})):f("v-if",!0),o(P).order_no?(a(),r(N,{key:3,label:"订单编号",borderBottom:""},{default:s((()=>[n(V,{class:"border-style w-full !border-0 flex justify-between items-end"},{default:s((()=>[n(l,null,{default:s((()=>[u(i(o(P).order_no),1)])),_:1}),n(l,{class:"text-xs text-[#7D7C82]",onClick:t[2]||(t[2]=e=>o(j)(o(P).order_no))},{default:s((()=>[u("复制")])),_:1})])),_:1})])),_:1})):f("v-if",!0),o(P).create_time?(a(),r(N,{key:4,label:"下单时间",borderBottom:""},{default:s((()=>[n(V,{class:"border-style !border-0"},{default:s((()=>[u(i(o(P).create_time),1)])),_:1})])),_:1})):f("v-if",!0),o(P).pay_time?(a(),r(N,{key:5,label:"支付时间",borderBottom:""},{default:s((()=>[n(V,{class:"border-style !border-0"},{default:s((()=>[u(i(o(P).pay_time),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1},512)])),_:1}),n(V,{class:"h-[160rpx] w-full"}),n(V,{class:"flex justify-end items-center bg-white px-3 py-1 fixed left-0 right-0 bottom-0 z-10"},{default:s((()=>[n(V,{class:"flex flex-col items-center justify-center mr-auto",onClick:t[3]||(t[3]=e=>ee(o(P),"index"))},{default:s((()=>[n(l,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[46rpx] text-[#333]"}),n(l,{class:"text-xs mt-[2rpx] font-scale"},{default:s((()=>[u("首页")])),_:1})])),_:1}),n(V,{class:"flex flex-wrap justify-end"},{default:s((()=>[(a(!0),x(_,null,p(o(P).order_status_info.member_action,((e,t)=>(a(),r(X,{text:e.name,color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},type:"primary",onClick:t=>ee(o(P),e.key)},null,8,["text","onClick"])))),256)),o(P).is_enable_refund&&["","refund_refuse"].includes(o(P).refund_status)?(a(),r(X,{key:0,text:"申请退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[4]||(t[4]=e=>(e=>{let t={order_id:e.order_id};M(t).then((e=>{$(Q.value)}))})(o(P)))})):f("v-if",!0),o(P).refund_no?(a(),r(X,{key:1,text:"查看退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[5]||(t[5]=e=>d(G)?G.value=!0:G=!0)})):f("v-if",!0),o(P).refund_no&&"wait_refund"==o(P).refund_status?(a(),r(X,{key:2,text:"取消退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[6]||(t[6]=e=>{return t=o(P),void L(t.refund_id).then((e=>{$(Q.value)}));var t})})):f("v-if",!0)])),_:1})])),_:1}),n(le,{ref_key:"payRef",ref:Y,onClose:e.payClose},null,8,["onClose"]),n(se,{show:o(U),onClose:t[7]||(t[7]=e=>d(U)?U.value=!1:U=!1),closeable:!0},{default:s((()=>[n(V,{class:"text-center py-[30rpx] font-bold leading-none"},{default:s((()=>[n(l,null,{default:s((()=>[u("订单进度")])),_:1})])),_:1}),n(V,{class:"px-6 pb-5 pt-2"},{default:s((()=>[n(re,{current:o(T),direction:"column"},{default:s((()=>[(a(!0),x(_,null,p(o(P).order_log,((e,t)=>(a(),r(ae,{title:e.action,desc:e.action_time,key:t},null,8,["title","desc"])))),128))])),_:1},8,["current"])])),_:1})])),_:1},8,["show"]),n(se,{show:o(G),onClose:t[8]||(t[8]=e=>d(G)?G.value=!1:G=!1),closeable:!0},{default:s((()=>[o(J).refund_log?(a(),r(V,{key:0,class:"text-center py-[30rpx] font-bold leading-none"},{default:s((()=>[n(l,null,{default:s((()=>[u("退款进度")])),_:1})])),_:1})):f("v-if",!0),n(V,{class:"px-6 pb-5 pt-2"},{default:s((()=>[n(re,{current:o(K),direction:"column"},{default:s((()=>[(a(!0),x(_,null,p(o(J).refund_log,((e,t)=>(a(),r(ae,{title:e.action_name,desc:e.action_time,key:t},A({_:2},["refuse"==e.action?{name:"desc",fn:s((()=>[n(V,{class:"text-xs text-red"},{default:s((()=>[u("拒绝原因："+i(o(J).refuse_reason),1)])),_:1}),n(V,{class:"text-xs text-[#909193]"},{default:s((()=>[u(i(e.action_time),1)])),_:2},1024)])),key:"0"}:void 0,"completed"==e.action?{name:"desc",fn:s((()=>[n(V,{class:"text-xs text-red"},{default:s((()=>[u("退款方式：原路退款，退款金额："+i(o(J).money),1)])),_:1}),n(V,{class:"text-xs text-[#909193]"},{default:s((()=>[u(i(e.action_time),1)])),_:2},1024)])),key:"1"}:void 0]),1032,["title","desc"])))),128))])),_:1},8,["current"])])),_:1})])),_:1},8,["show"])])),_:1})),n(oe,{loading:o(R)},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-1b6be176"]]);export{R as default};
