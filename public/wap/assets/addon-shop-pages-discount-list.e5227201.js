import{bu as e,d as t,j as a,r as s,o as l,c as o,w as r,b as i,u as n,f as c,n as u,O as d,a6 as p,P as v,a7 as f,a8 as x,E as g,bt as _,bl as m,s as h,H as b,bY as y,G as k,g as w,h as j,B as F,i as G,a5 as z,Q as S,y as C,z as T,t as O,a as U,D as I}from"./index-9317da28.js";import{_ as M}from"./u-swiper.05fa8b7a.js";import{_ as N}from"./u--image.5461b7b7.js";import{_ as P}from"./loading-page.vue_vue_type_script_setup_true_lang.c92b07c2.js";import{M as q}from"./mescroll-body.c2f6fcce.js";import{M as B}from"./mescroll-empty.82e9c349.js";import{u as E}from"./useMescroll.26ccf5de.js";import{t as L}from"./topTabbar.9a918190.js";import{_ as Q}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.aabe3d05.js";/* empty css                                                                       */import"./u-image.74ac23f6.js";import"./u-icon.5e775659.js";import"./u-transition.65be38eb.js";import"./u-loading-page.de89bca9.js";import"./mescroll-i18n.f3c5a2b0.js";const Y=Q(t({__name:"list",setup(t){let Q={};const Y=a((()=>Object.keys(Q).length?k(Number(Q.height))+k(Q.top)+k(8)+368+"rpx":"490rpx")),{mescrollInit:D,downCallback:H,getMescroll:R}=E(x,f),V=s([]),$=s([]),A=s(0),J=s(""),K=s([]),W=s(!0),X=s(!0);L().setTopTabbarParam({title:"限时折扣"});const Z=s([]);X.value=!0,e.get("shop/discount/config").then((e=>{V.value=e.data,Z.value=V.value.map((e=>g(e.imageUrl))),X.value=!1})).catch((()=>{X.value=!1}));var ee;(ee={limit:4},e.get("shop/discount",ee)).then((e=>{$.value=e.data,oe(),$.value&&$.value.length?te(e.data[0]):W.value=!1}));const te=e=>{var t;A.value=e.active_id,J.value=e.active_status_name,null==(t=R())||t.resetUpScroll(),_({scrollTop:0,duration:1})},ae=t=>{if(0==$.value.length)return;W.value=!0,function(t){return e.get("shop/discount/goods",t)}({page:t.num,limit:t.size,active_id:A.value}).then((e=>{let a=e.data.data.map((e=>e));1==t.num&&(K.value=[]),K.value=K.value.concat(a),t.endSuccess(a.length),W.value=!1})).catch((()=>{W.value=!1,t.endErr()}))},se=e=>{let t=V.value[e].toLink;if(Object.keys(t).length){if(!t.name)return;if("app/pages/member/index"==m()&&!h())return void b().setLoginBack({url:t.url});y(t)}},le=s(""),oe=()=>{le.value=Object.keys(Q).length?k(Number(Q.height))+k(Q.top)+k(8)+368+($.value.length?70:0)+"rpx":$.value.length?"560rpx":"490rpx"};return(e,t)=>{const a=w(j("u-swiper"),M),s=F,f=G,x=I,_=z,m=w(j("u--image"),N),h=w(j("loading-page"),P);return l(),o(f,{class:"discount bg-[var(--page-bg-color)] min-h-[100vh]",style:u(e.themeColor())},{default:r((()=>[i(f,{class:"fixed top-0 left-0 w-full z-10 text-[0]"},{default:r((()=>[V.value.length?(l(),o(a,{key:0,list:Z.value,indicator:V.value.length,indicatorStyle:{bottom:"46rpx"},autoplay:!0,height:n(Y),onClick:se},null,8,["list","indicator","height"])):c("v-if",!0),X.value||V.value.length?c("v-if",!0):(l(),o(s,{key:1,src:n(g)("addon/shop/discount/discount_banner.png"),mode:"scaleToFill",class:"w-full",style:u({height:n(Y)}),"show-menu-by-longpress":!0},null,8,["src","style"])),$.value.length?(l(),o(f,{key:2,class:"relative w-full h-[110rpx] mt-[-40rpx] z-5"},{default:r((()=>[i(f,{class:"bg-[#f24f3d] w-[750rpx] rounded-tl-[24rpx] rounded-tr-[24rpx] h-[96rpx] absolute left-0 bottom-0"}),i(_,{"scroll-x":!0,class:"h-[110rpx] absolute left-0 bottom-0 z-5"},{default:r((()=>[i(f,{class:"flex items-end h-[100%]",style:u({width:187.5*$.value.length+"rpx"})},{default:r((()=>[(l(!0),d(v,null,p($.value,((e,t)=>(l(),o(f,{class:"w-[187.5rpx] h-[100rpx] relative flex-shrink-0",onClick:t=>te(e)},{default:r((()=>[i(f,{class:"w-full absolute left-0 top-0 z-10 text-[#fff] text-center pt-[14rpx]"},{default:r((()=>[i(f,{class:S(["text-[28rpx] leading-[39rpx] font-500 px-[10rpx] h-[39rpx] overflow-hidden",{"!text-[#333]":A.value==e.active_id}])},{default:r((()=>[C(T(e.active_desc),1)])),_:2},1032,["class"]),i(f,{class:"flex justify-center w-full"},{default:r((()=>[i(x,{class:S(["text-[22rpx] h-[36rpx] flex-center mt-[5rpx]",{"active flex items-center justify-center":A.value==e.active_id}])},{default:r((()=>[C(T("not_active"==e.active_status?"预告":e.active_status_name),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),A.value==e.active_id?(l(),d(v,{key:0},[$.value.length<4?(l(),o(s,{key:0,class:S(["absolute bottom-0 z-5 h-[110rpx] z-5",{"left-0 w-[230rpx]":0==t,"left-[-41.25rpx] w-[270rpx]":0!=t}]),src:n(g)(0==t?"addon/shop/discount/nav-left.png":"addon/shop/discount/nav-center.png")},null,8,["class","src"])):c("v-if",!0),$.value.length>=4?(l(),o(s,{key:1,class:S(["absolute bottom-0 z-5 h-[110rpx] z-5",{"left-0 w-[230rpx]":0==t,"left-[-41.25rpx] w-[270rpx]":0!=t&&t!=$.value.length-1,"right-0 w-[230rpx]":t==$.value.length-1}]),src:n(g)(0==t?"addon/shop/discount/nav-left.png":t==$.value.length-1?"addon/shop/discount/nav-right.png":"addon/shop/discount/nav-center.png")},null,8,["class","src"])):c("v-if",!0)],64)):c("v-if",!0)])),_:2},1032,["onClick"])))),256))])),_:1},8,["style"])])),_:1})])),_:1})):c("v-if",!0)])),_:1}),$.value.length?(l(),o(q,{key:0,ref:"mescrollRef",top:le.value,onInit:n(D),down:{use:!1},onUp:ae},{default:r((()=>[i(f,{class:"sidebar-marign py-[var(--top-m)] bg-[#F4F6F8]"},{default:r((()=>[(l(!0),d(v,null,p(K.value,((e,t)=>(l(),o(f,{key:t,class:S(["bg-[#fff] p-[20rpx] flex rounded-[var(--rounded-big)]",{"mb-[var(--top-m)]":t<K.value.length-1}]),onClick:t=>(e=>{"active"==e.activeGoods.active_goods_status?U({url:"/addon/shop/pages/goods/detail",param:{sku_id:e.goodsSku.sku_id}}):O({title:`活动${e.activeGoods.active_goods_status_name}`,icon:"none"})})(e)},{default:r((()=>[i(f,{class:"w-[240rpx] h-[240rpx] rounded-[var(--goods-rounded-big)] overflow-hidden"},{default:r((()=>[i(m,{width:"240rpx",height:"240rpx",radius:"var(--goods-rounded-big)",src:n(g)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:r((()=>[i(s,{class:"rounded-[var(--goods-rounded-big)] overflow-hidden w-[240rpx] h-[240rpx]",src:n(g)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["radius","src"])])),_:2},1024),i(f,{class:"ml-[20rpx] flex-1 flex flex-col justify-between"},{default:r((()=>[i(f,null,{default:r((()=>[i(f,{class:"text-[28rpx] leading-[1.4] multi-hidden"},{default:r((()=>[C(T(e.goods_name),1)])),_:2},1024),e.goods_label_name&&e.goods_label_name.length?(l(),o(f,{key:0,class:"mt-[16rpx] text-[var(--text-color-light9)] text-[24rpx] multi-hidden"},{default:r((()=>[C(T(e.goods_label_name.map((e=>e.label_name)).join(" | ")),1)])),_:2},1024)):c("v-if",!0)])),_:2},1024),i(f,{class:S(["relative overflow-hidden w-full h-[88rpx] flex justify-between rounded-[100rpx]",{"bg-[var(--primary-color-light)]":"active"==e.activeGoods.active_goods_status,"bg-[#FFF6F1]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[i(f,{class:"mr-[20rpx] pl-[30rpx] flex-1 flex flex-col justify-center"},{default:r((()=>[i(f,{class:S(["text-[var(--price-text-color)] flex items-baseline",{"!text-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[i(x,{class:"text-[26rpx] leading-[26rpx] font-500 mr-[4rpx] price-font"},{default:r((()=>[C("￥")])),_:1}),i(x,{class:"text-[44rpx] leading-[40rpx] font-500 price-font"},{default:r((()=>[C(T(parseFloat(e.goodsSku.active_discount_price).toFixed(2).split(".")[0])+".",1)])),_:2},1024),i(x,{class:"text-[26rpx] leading-[28rpx] font-500 price-font"},{default:r((()=>[C(T(parseFloat(e.goodsSku.active_discount_price).toFixed(2).split(".")[1]),1)])),_:2},1024),e.goodsSku.active_discount_rate<10?(l(),o(f,{key:0,class:S(["px-[4rpx] border-[1rpx] border-[var(--primary-color)] border-solid text-[18rpx] ml-[6rpx] rounded-[4rpx] leading-[24rpx] transform translate-y-[-4rpx]",{"!border-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[C(T(e.goodsSku.active_discount_rate)+"折",1)])),_:2},1032,["class"])):c("v-if",!0)])),_:2},1032,["class"]),i(f,{class:"flex items-center mt-[4rpx]"},{default:r((()=>[i(f,{class:S(["w-[20rpx] h-[20rpx] mr-[4rpx] rounded-[20rpx] text-[#fff] bg-[var(--primary-color)] flex items-center justify-center",{"!bg-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[i(x,{class:"text-[10rpx] nc-icon-biaoqianV6mm1 nc-iconfont"})])),_:2},1032,["class"]),i(f,{class:S(["text-[18rpx] font-400 text-[var(--price-text-color)] leading-[24rpx]",{"!text-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[C("已省"+T(e.goodsSku.active_reduce_money)+"元",1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),"active"!=e.activeGoods.active_goods_status?(l(),o(f,{key:0,class:"discount-btn text-[#ff763b] iconfont iconUnion"},{default:r((()=>[i(x,{class:"desc"},{default:r((()=>[C(T(e.activeGoods.active_goods_status_name),1)])),_:2},1024)])),_:2},1024)):(l(),o(f,{key:1,class:"discount-btn text-[#fb3f15] iconfont iconUnion"},{default:r((()=>[i(x,{class:"icon iconfont iconqiang"}),i(x,{class:"arrow iconxiayibu iconfont"})])),_:1}))])),_:2},1032,["class"])])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),K.value.length||W.value?c("v-if",!0):(l(),o(B,{key:0,option:{tip:"暂无商品，请看看其他商品吧！"}}))])),_:1})])),_:1},8,["top","onInit"])):c("v-if",!0),$.value.length||W.value?c("v-if",!0):(l(),o(f,{key:1,class:"h-[calc(100vh-550rpx)] fixed left-0 right-0",style:u({top:le.value})},{default:r((()=>[c(' <u-empty text="暂无活动，请看看其他商品吧！" width="347rpx" height="265rpx" :icon="img(\'static/resource/images/system/empty.png\')"/>\r\n\t\t\t<button shape="circle" plain="true" class="w-[220rpx] mt-[42rpx] text-[28rpx] h-[66rpx] leading-[62rpx] !text-[var()] !border-[var(--primary-color)] border-[2rpx] rounded-full" @click="redirect({ url: \'/addon/shop/pages/goods/list\' })">去逛逛</button> '),i(B,{option:{tip:"暂无商品，请看看其他商品吧！",btnText:"去逛逛"}})])),_:1},8,["style"])),i(h,{loading:X.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-9392c38a"]]);export{Y as default};
