import{d as e,r as t,K as a,g as l,h as r,o,c as s,w as n,b as d,A as u,y as p,O as i,P as c,a6 as x,Q as m,z as v,f,u as b,E as _,bb as h,t as g,i as y,D as k,a5 as V,C as w,bt as C,j,e as S,v as z,ag as M}from"./index-2882a2d8.js";import{_ as U}from"./u-loading-icon.a37f7e61.js";import{_ as O}from"./u-empty.662c89c7.js";import{_ as A}from"./u-popup.2abbe959.js";import{j as T}from"./order.74bd5d66.js";import{_ as $}from"./u-form-item.03ed7ff5.js";import{_ as q}from"./u-input.6410b5d0.js";import{_ as E}from"./u-form.54744837.js";const F=e({__name:"select-store",emits:["confirm"],setup(e,{expose:C,emit:j}){const S=t(!1),z=t(!1),M=t(!0),$=t([]),q=t(null),E=a({lat:0,lng:0}),F=()=>{j("confirm",q.value),S.value=!1},I=e=>{if((e=parseFloat(e))<1e3)return`${e}m`;return`${(e/1e3).toFixed(2)}km`};return C({open:()=>{z.value||(z.value=!0,h({type:"gcj02",success:e=>{E.lat=e.latitude,E.lng=e.longitude},fail:e=>{if(e.errno)if(104==e.errno){g({title:"用户未授权隐私权限，获取位置失败",icon:"none"})}else if(112==e.errno){g({title:"隐私协议中未声明，获取位置失败",icon:"none"})}if(e.errMsg)if(-1!=e.errMsg.indexOf("getLocation:fail")||-1!=e.errMsg.indexOf("deny")||-1!=e.errMsg.indexOf("denied")){g({title:"用户未授权获取位置权限，将无法提供距离最近的门店",icon:"none"})}else g({title:e.errMsg,icon:"none"})}}),setTimeout((()=>{T({latlng:E}).then((({data:e})=>{$.value=e,M.value=!1})).catch((()=>{M.value=!1}))}),1500)),S.value=!0}}),(e,t)=>{const a=y,h=k,g=l(r("u-loading-icon"),U),C=l(r("u-empty"),O),j=V,z=w,T=l(r("u-popup"),A);return o(),s(T,{show:S.value,onClose:t[1]||(t[1]=e=>S.value=!1),mode:"bottom",round:10},{default:n((()=>[d(a,{onTouchmove:t[0]||(t[0]=u((()=>{}),["prevent","stop"])),class:"popup-common"},{default:n((()=>[d(a,{class:"title"},{default:n((()=>[p("请选择自提点")])),_:1}),d(j,{"scroll-y":"true",class:"h-[50vh]"},{default:n((()=>[d(a,{class:"p-[var(--popup-sidebar-m)] pt-0 text-sm"},{default:n((()=>[(o(!0),i(c,null,x($.value,(e=>(o(),s(a,{class:m(["mt-[var(--top-m)] border-1 border-[#eee] border-solid rounded-[var(--rounded-mid)] px-[var(--pad-sidebar-m)] py-[var(--pad-top-m)] mb-[var(--top-m)]",{"!border-primary bg-[var(--primary-color-light2)]":q.value&&q.value.store_id==e.store_id}]),onClick:t=>{return a=e,void(q.value?q.value=q.value.store_id!=a.store_id?a:null:q.value=a);var a}},{default:n((()=>[d(a,{class:"flex"},{default:n((()=>[d(a,{class:"flex-1 w-0"},{default:n((()=>[d(h,{class:"text-[30rpx] text-[#333]"},{default:n((()=>[p(v(e.store_name),1)])),_:2},1024),d(h,{class:"text-[26rpx] ml-[12rpx] text-[var(--text-color-light6)]"},{default:n((()=>[p(v(e.store_mobile),1)])),_:2},1024)])),_:2},1024),e.distance?(o(),s(a,{key:0},{default:n((()=>[d(h,{class:"text-red text-[26rpx] font-normal"},{default:n((()=>[p(v(I(e.distance)),1)])),_:2},1024)])),_:2},1024)):f("v-if",!0)])),_:2},1024),d(a,{class:"mt-[20rpx] text-[26rpx]"},{default:n((()=>[p("门店地址："+v(e.full_address),1)])),_:2},1024),d(a,{class:"mt-[16rpx] text-[26rpx]"},{default:n((()=>[p("营业时间："+v(e.trade_time),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),256))])),_:1}),M.value?(o(),s(a,{key:0,class:"h-[50vh] flex items-center flex-col justify-center"},{default:n((()=>[d(g,{vertical:!0})])),_:1})):f("v-if",!0),M.value||$.value.length?f("v-if",!0):(o(),s(a,{key:1,class:"h-[50vh] flex items-center flex-col justify-center"},{default:n((()=>[d(C,{text:"没有可选择的自提点",icon:b(_)("static/resource/images/empty.png")},null,8,["icon"])])),_:1}))])),_:1}),d(a,{class:"btn-wrap"},{default:n((()=>[d(z,{class:"primary-btn-bg btn",onClick:F},{default:n((()=>[p("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])}}});const I=e({__name:"invoice",emits:["confirm"],setup(e,{expose:a,emit:_}){const h=t(!1),g=t({is_invoice:2,invoice_content:[]}),k=t(!1);t(!1);const U=t({header_type:1,header_name:"",type:"",name:"",tax_number:"",telephone:"",address:"",bank_name:"",bank_card_number:""}),O=j((()=>1==g.value.is_invoice));C.get("shop/config/invoice").then((({data:e})=>{g.value=e,e.invoice_content.length&&(U.value.name=e.invoice_content[0])})).catch();const T=e=>{M((()=>{U.value.tax_number=e.replace(/[^0-9a-zA-Z]/g,"")}))},F=t(null),I=j((()=>({header_name:{type:"string",required:k.value,message:"请输入发票抬头",trigger:["blur","change"]},tax_number:[{type:"string",required:k.value&&2==U.value.header_type,message:"请输入纳税人识别号",trigger:["blur","change"]},{validator(e,t,a){/^[0-9a-zA-Z]+$/.test(t)||2!=U.header_type?a():a(new Error("请输入正确的纳税人识别号"))}}]}))),P=()=>{F.value.validate().then((()=>{const e=k.value?U.value:{};_("confirm",e),h.value=!1}))};return a({open:()=>{h.value=!0},invoiceOpen:O}),(e,t)=>{const a=y,_=l(r("u-form-item"),$),C=l(r("u-input"),q),j=l(r("u-form"),E),M=V,O=w,Z=l(r("u-popup"),A);return o(),s(Z,{show:h.value,onClose:t[11]||(t[11]=e=>h.value=!1),mode:"bottom",round:10,safeAreaInsetBottom:!0},{default:n((()=>[d(a,{onTouchmove:t[10]||(t[10]=u((()=>{}),["prevent","stop"])),class:"popup-common"},{default:n((()=>[d(a,{class:"title"},{default:n((()=>[p("请填写发票信息")])),_:1}),d(M,{"scroll-y":!0,class:"h-[50vh]"},{default:n((()=>[d(a,{class:"px-[var(--popup-sidebar-m)] pb-[60rpx] pt-0 text-sm"},{default:n((()=>[d(j,{labelPosition:"left",model:U.value,labelWidth:"200rpx",labelStyle:{"font-size":"28rpx"},errorType:"toast",rules:b(I),ref_key:"formRef",ref:F},{default:n((()=>[d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"需要发票",leftIconStyle:"text-[28rpx]"},{default:n((()=>[d(a,{class:"flex"},{default:n((()=>[d(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] leading-[56rpx] mr-[20rpx] border-[2rpx] border-[var(--temp-bg)] bg-[var(--temp-bg)] border-solid text-[24rpx]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":!k.value}]),onClick:t[0]||(t[0]=e=>k.value=!1)},{default:n((()=>[p("不需要")])),_:1},8,["class"]),d(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] leading-[56rpx] border-[2rpx] border-[var(--temp-bg)] border-solid text-[24rpx] bg-[var(--temp-bg)]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":k.value}]),onClick:t[1]||(t[1]=e=>k.value=!0)},{default:n((()=>[p("需要")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),S(d(a,null,{default:n((()=>[d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"抬头类型"},{default:n((()=>[d(a,{class:"flex"},{default:n((()=>[d(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] mr-[20rpx] leading-[56rpx] border-[2rpx] border-[var(--temp-bg)] border-solid text-[24rpx] bg-[var(--temp-bg)]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":1==U.value.header_type}]),onClick:t[2]||(t[2]=e=>U.value.header_type=1)},{default:n((()=>[p("个人")])),_:1},8,["class"]),d(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] leading-[56rpx] border-[2rpx] border-[var(--temp-bg)] border-solid text-[24rpx] bg-[var(--temp-bg)]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":2==U.value.header_type}]),onClick:t[3]||(t[3]=e=>U.value.header_type=2)},{default:n((()=>[p("企业")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"发票内容",prop:"header_name"},{default:n((()=>[d(a,{class:"flex flex-wrap"},{default:n((()=>[(o(!0),i(c,null,x(g.value.invoice_content,((e,t)=>(o(),s(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] leading-[56rpx] border-[2rpx] border-[var(--temp-bg)] border-solid text-[24rpx] bg-[var(--temp-bg)]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":U.value.name==e,"mr-[20rpx]":g.value.invoice_content.length-1!=t}]),onClick:t=>U.value.name=e},{default:n((()=>[p(v(e),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"发票抬头",prop:"header_name"},{default:n((()=>[d(C,{fontSize:"28rpx",modelValue:U.value.header_name,"onUpdate:modelValue":t[4]||(t[4]=e=>U.value.header_name=e),modelModifiers:{trim:!0},border:"none","placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",clearable:"",placeholder:"请输入发票抬头"},null,8,["modelValue"])])),_:1})])),_:1}),2==U.value.header_type?(o(),s(a,{key:0},{default:n((()=>[d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"纳税人识别号",prop:"tax_number"},{default:n((()=>[d(C,{fontSize:"28rpx",modelValue:U.value.tax_number,"onUpdate:modelValue":t[5]||(t[5]=e=>U.value.tax_number=e),modelModifiers:{trim:!0},border:"none",clearable:"",placeholder:"请输入纳税人识别号","placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",onChange:T},null,8,["modelValue"])])),_:1})])),_:1}),f(' <view class="py-[20rpx] h-[48rpx] flex items-center">\r\n\t\t\t\t\t\t\t\t\t<text class="text-[30rpx]">更多选填内容</text>\r\n\t\t\t\t\t\t\t\t\t<text class="text-xs text-gray-subtitle ml-[10rpx]">注册地址、电话、开户银行及账号</text>\r\n\t\t\t\t\t\t\t\t\t<view class="text-xs text-right flex-1" @click="optionalShow = !optionalShow">\r\n\t\t\t\t\t\t\t\t\t\t<text>{{ optionalShow ? \'收起\' : \'展开\' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t<text class="text-[30rpx] nc-iconfont text-gray-subtitle ml-[5rpx]" :class="optionalShow ? \'nc-icon-shangV6xx-1\' : \'nc-icon-xiaV6xx\'"></text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view> '),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"注册地址"},{default:n((()=>[d(C,{fontSize:"28rpx",modelValue:U.value.address,"onUpdate:modelValue":t[6]||(t[6]=e=>U.value.address=e),"placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",border:"none",clearable:"",placeholder:"(选填)请输入企业注册地址"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"注册电话"},{default:n((()=>[d(C,{fontSize:"28rpx",modelValue:U.value.telephone,"onUpdate:modelValue":t[7]||(t[7]=e=>U.value.telephone=e),"placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",border:"none",clearable:"",placeholder:"(选填)请输入企业注册电话"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"开户银行"},{default:n((()=>[d(C,{fontSize:"28rpx",modelValue:U.value.bank_name,"onUpdate:modelValue":t[8]||(t[8]=e=>U.value.bank_name=e),"placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",border:"none",clearable:"",placeholder:"(选填)请输入企业开户银行"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"银行账号"},{default:n((()=>[d(C,{fontSize:"28rpx",modelValue:U.value.bank_card_number,"onUpdate:modelValue":t[9]||(t[9]=e=>U.value.bank_card_number=e),"placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",border:"none",clearable:"",placeholder:"(选填)请输入企业开户银行账号"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})):f("v-if",!0)])),_:1},512),[[z,k.value]])])),_:1},8,["model","rules"])])),_:1})])),_:1}),d(a,{class:"btn-wrap"},{default:n((()=>[d(O,{class:"primary-btn-bg btn",onClick:P},{default:n((()=>[p("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])}}});export{F as _,I as a};
