import{_ as e}from"./u-avatar.0bc202a4.js";import{d as a,l as r,j as t,r as l,p as o,F as u,K as i,x as s,o as n,c as d,w as p,b as c,u as v,y as m,z as _,f as x,R as f,n as g,H as b,a as h,g as y,h as j,i as k,B as w,D as T,C,E as F}from"./index-7bf68536.js";import{_ as z}from"./uni-popup.3d2f7726.js";import{_ as S}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{f as O,r as R}from"./card.83abd190.js";import{b as B}from"./bind-mobile.37d1c6df.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.0c1c54c7.js";import"./u-text.df478cbc.js";import"./u-loading-page.566c330a.js";import"./u-loading-icon.b37701e7.js";import"./u-transition.cdf87992.js";import"./u-form.78a4f7c2.js";import"./u-line.463a2a45.js";import"./sms-code.vue_vue_type_script_setup_true_lang.eace8f61.js";import"./u-input.09a5cedd.js";import"./u-modal.b47eb877.js";import"./u-popup.be4bfacd.js";import"./u-safe-bottom.908eeae4.js";import"./u-checkbox-group.b2a485bf.js";const I=E(a({__name:"receive_info",setup(a){const E=r(),I=t((()=>E.info)),L=l({}),A=l(!0),V=l(!1),Y=l(""),D=l(null);l(uni.getStorageSync("isbindmobile")),o((e=>{if(e.give_id)Y.value=e.give_id,G(e.give_id);else{let e={url:"/addon/shop_giftcard/pages/index",title:u("notCard"),mode:"reLaunch"};i(e)}})),s((()=>{Object.keys(L.value).length&&G(Y.value)}));const G=e=>{A.value=!0,O(e).then((e=>{if("receive_finish"==e.data.give_status){let a={url:"/addon/shop_giftcard/pages/index",title:e.data.message,mode:"reLaunch"};i(a)}else L.value=e.data;A.value=!1})).catch((()=>{A.value=!1}))},H=l(),K=()=>I.value?uni.getStorageSync("isbindmobile")?(D.value.open(),!1):void(V.value||A.value||(V.value=!0,R({give_id:Y.value}).then((e=>{e.data&&H.value.open(),V.value=!1})).catch((()=>{V.value=!1})))):(b().setLoginBack({url:"/addon/shop_giftcard/pages/receive_info",param:{give_id:Y.value}}),!1),M=()=>{H.value.close(),h({url:"/addon/shop_giftcard/pages/my_card_list",mode:"redirectTo"})},N=()=>{H.value.close(),G(Y.value)},P=e=>{let a="";return a="balance"==e.card_info.giftcard.card_right_type?"addon/shop_giftcard/diy/index/value_card.jpg":"addon/shop_giftcard/diy/index/redemption_card.jpg",a};return(a,r)=>{const t=y(j("u-avatar"),e),l=k,o=w,i=T,s=C,b=y(j("uni-popup"),z),O=y(j("loading-page"),S);return n(),d(l,{class:"min-h-[100vh]",style:g(a.themeColor())},{default:p((()=>[Object.keys(L.value).length?(n(),d(l,{key:0,class:"give-info-bg w-full h-[100vh]"},{default:p((()=>[c(l,{class:"pt-[183rpx]"},{default:p((()=>[c(l,{class:"rounded-[var(--rounded-big)] bg-[#fff] mx-[var(--sidebar-m)] px-[82rpx] pb-[140rpx]"},{default:p((()=>[c(l,{class:"relative w-full h-[125rpx]"},{default:p((()=>[c(l,{class:"p-[4rpx] bg-[#fff] box-border rounded-[100rpx] w-[200rpx] h-[200rpx] absolute top-[-100rpx] left-[50%] transform -translate-x-1/2"},{default:p((()=>[c(t,{src:v(F)(L.value.member.headimg),size:"192rpx",leftIcon:"none","default-url":v(F)("static/resource/images/default_headimg.png")},null,8,["src","default-url"])])),_:1})])),_:1}),c(l,{class:"text-center text-[30rpx] font-500 leading-[42rpx] truncate"},{default:p((()=>[m(_(L.value.member.nickname),1)])),_:1}),c(l,{class:"text-center text-[28rpx] font-500 leading-[39rpx] text-[var(--text-color-light6)] mt-[10rpx] truncate"},{default:p((()=>[m(_(v(u)("freeForYou")+L.value.card_info.giftcard.card_name),1)])),_:1}),c(l,{class:"w-full flex justify-center mt-[60rpx]",onClick:r[1]||(r[1]=e=>{L.value&&"my"==L.value.to_have&&h({url:"/addon/shop_giftcard/pages/card_bag",param:{card_bag_id:L.value.card_bag_id},mode:"redirectTo"})})},{default:p((()=>[L.value&&L.value.card_info&&L.value.card_info.card_cover?(n(),d(o,{key:0,class:"w-[546rpx] h-[330rpx] rounded-[var(--rounded-big)]",src:v(F)(L.value.card_info.card_cover),onError:r[0]||(r[0]=e=>L.value.card_info.card_cover=P(L.value)),mode:"aspectFill"},null,8,["src"])):(n(),d(o,{key:1,class:"w-[546rpx] h-[330rpx] rounded-[var(--rounded-big)]",src:v(F)(P(L.value)),mode:"aspectFill"},null,8,["src"]))])),_:1}),L.value.blessing?(n(),d(l,{key:0,class:"text-[28rpx] mx-auto mt-[40rpx] multi-hidden"},{default:p((()=>[c(i,{class:"text-[var(--text-color-light6)] leading-[39rpx] mb-[10rpx]"},{default:p((()=>[m(_(v(u)("receiveTipsOne"))+"：",1)])),_:1}),c(i,{class:"text-[#333] leading-[39rpx]"},{default:p((()=>[m(_(L.value.blessing),1)])),_:1})])),_:1})):x("v-if",!0),c(l,{class:"mt-[148rpx]"},{default:p((()=>[(L.value.give_num-L.value.total_receive_num>L.value.limit_num-L.value.receive_num?L.value.limit_num-L.value.receive_num>1:L.value.give_num-L.value.total_receive_num>1)?(n(),d(l,{key:0,class:"mb-[25rpx] text-[24rpx] text-center leading-[34rpx] !text-[var(--text-color-light9)]"},{default:p((()=>[m(_(v(u)("receiveTipsTwo"))+_(L.value.give_num-L.value.total_receive_num>L.value.limit_num-L.value.receive_num?L.value.limit_num-L.value.receive_num:L.value.give_num-L.value.total_receive_num)+_(v(u)("receiveTipsTwoAnd")),1)])),_:1})):x("v-if",!0),L.value.total_leave_num&&L.value.give_num>L.value.total_receive_num&&L.value.limit_num>L.value.receive_num?(n(),d(s,{key:1,class:f(["w-full h-[80rpx] font-500 text-[26rpx] leading-[80rpx] !text-[#fff] !bg-[var(--primary-color)] m-0 rounded-[40rpx] remove-border",{"opacity-40":V.value}]),onClick:K},{default:p((()=>[m(_(v(u)("GetItNow")),1)])),_:1},8,["class"])):(n(),d(s,{key:2,class:"w-full h-[ 280rpx] font-500 text-[26rpx] leading-[80rpx] !text-[var(--text-color-light9)] !bg-[#F7F7F7] m-0 rounded-[40rpx] remove-border"},{default:p((()=>[m(_(v(u)("alreadyClaimed")),1)])),_:1})),L.value.receive_num?(n(),d(l,{key:3,class:"mt-[25rpx] text-[24rpx] text-center leading-[34rpx] !text-[var(--text-color-light9)]",onClick:M},{default:p((()=>[m(_(v(u)("seeCardBag")),1)])),_:1})):x("v-if",!0)])),_:1})])),_:1})])),_:1})])),_:1})):x("v-if",!0),c(b,{ref_key:"popupRef",ref:H,type:"center","is-mask-click":!1},{default:p((()=>[c(l,{class:"bg-[#fff] w-[530rpx] min-h-[504rpx] rounded-[var(--rounded-big)] box-border p-[32rpx] relative",style:g({"background-image":"url("+v(F)("addon/shop_giftcard/popup_bg.png")+")",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"top"})},{default:p((()=>[c(o,{class:"w-[327rpx] h-[327rpx] rounded-[var(--rounded-mid)] absolute left-[50%] top-[-163.5rpx] transform -translate-x-1/2 z-10",src:v(F)("addon/shop_giftcard/popup_top.png"),mode:"aspectFill"},null,8,["src"]),c(l,{class:"text-[40rpx] leading-[56rpx] font-bold text-center pt-[174rpx]"},{default:p((()=>[m(_(v(u)("popupTipsOne")),1)])),_:1}),c(l,{class:"text-[24rpx] leading-[34rpx] text-center mt-[30rpx]"},{default:p((()=>[m(_(v(u)("popupTipsTwo")),1)])),_:1}),c(s,{class:"w-[370rpx] h-[80rpx] font-500 text-[26rpx] leading-[80rpx] !text-[#fff] primary-btn-bg m-0 !mx-auto rounded-[40rpx] remove-border mt-[90rpx]",onClick:M},{default:p((()=>[m(_(v(u)("gouToSee")),1)])),_:1}),c(l,{class:"nc-iconfont nc-icon-cuohaoV6xx text-[57rpx] text-[#fff] absolute left-[50%] bottom-[-117rpx] transform -translate-x-1/2 z-10",onClick:N})])),_:1},8,["style"])])),_:1},512),x(" 强制绑定手机号 "),c(B,{ref_key:"bindMobileRef",ref:D},null,512),c(O,{loading:A.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-d0a1f0d0"]]);export{I as default};
