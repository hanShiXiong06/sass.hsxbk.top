import{d as t,r as a,j as e,s,x as l,o,c as u,w as r,b as n,L as i,y as c,z as p,u as m,f as d,n as f,a as x,aT as y,D as _,i as v,g as j,h,Z as g}from"./index-d8a8f699.js";import{_ as b}from"./u-button.aa0eb212.js";import{_ as w}from"./u-loading-icon.6808ae8c.js";import{_ as C}from"./u-modal.3708081d.js";import{g as T}from"./pay.974edcbe.js";import"./u-icon.5ba98c98.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-line.d86b0940.js";import"./u-popup.0d48946e.js";import"./u-transition.db07fff7.js";import"./u-safe-bottom.a4431b09.js";const S=t({__name:"result",setup(t){const S=a(null),z=a(!1);let L="",k=0,F=0;e((t=>{L=t.trade_type,k=t.trade_id,P()}));const P=()=>{T(L,k).then((t=>{if(!uni.$u.test.isEmpty(t.data)){if(1==t.data.status&&F<5)return z.value=!0,F++,void setTimeout((()=>{P()}),1e3);S.value=t.data,z.value=!1,s({title:2==S.value.status?l("pay.paySuccess"):l("pay.payFail")})}}))},R=()=>{var t;const a=decodeURIComponent(uni.getStorageSync("payReturn"));x(a?{url:a,mode:"reLaunch"}:{url:y(),param:{code:null==(t=S.value)?void 0:t.out_trade_no},mode:"reLaunch"})};return(t,a)=>{const e=_,s=v,x=j(h("u-button"),b),y=j(h("u-loading-icon"),w),T=j(h("u-modal"),C);return o(),u(s,{style:f(t.themeColor())},{default:r((()=>[S.value?(o(),u(s,{key:0,class:"w-screen h-screen flex flex-col items-center"},{default:r((()=>[n(s,{class:"flex-1 flex flex-col items-center w-full pt-[100rpx]"},{default:r((()=>[n(e,{class:i(["iconfont text-2xl",2==S.value.status?"text-primary iconduigou":"iconzhifushibai text-red"])},null,8,["class"]),n(s,{class:"text-sm"},{default:r((()=>[c(p(2==S.value.status?m(l)("pay.paySuccess"):m(l)("pay.payFail")),1)])),_:1}),n(s,{class:"text-xl font-bold pt-[30rpx]"},{default:r((()=>[n(e,{class:"text-base"},{default:r((()=>[c(p(m(l)("currency")),1)])),_:1}),n(e,null,{default:r((()=>[c(p(m(g)(S.value.money)),1)])),_:1})])),_:1})])),_:1}),n(s,{class:"pb-[200rpx] w-[240rpx]"},{default:r((()=>[n(x,{type:"primary",text:2==S.value.status?m(l)("complete"):m(l)("close"),plain:!0,onClick:R},null,8,["text"])])),_:1})])),_:1})):d("v-if",!0),n(T,{show:z.value,showCancelButton:!0,confirmText:m(l)("pay.completePay"),cancelText:m(l)("pay.incompletePay"),onCancel:R,confirmColor:"var(--primary-color)"},{default:r((()=>[n(s,{class:"py-[20rpx]"},{default:r((()=>[n(y,{text:m(l)("pay.getting"),textSize:"16",mode:"circle",vertical:!0},null,8,["text"])])),_:1})])),_:1},8,["show","confirmText","cancelText"])])),_:1},8,["style"])}}});export{S as default};
