import{d as a,r as e,p as t,x as r,o as s,c as l,w as o,b as d,R as i,y as c,z as n,u,P as p,a7 as f,Q as _,f as g,n as x,a8 as v,a9 as m,s as b,i as h,a6 as y,g as k,h as j,F as w,E as C,A as S,a as F,B as E,D as z}from"./index-7bf68536.js";import{_ as I}from"./tabbar.e049672c.js";import{_ as M}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{g as U,b as D}from"./card.83abd190.js";import{M as A}from"./mescroll-body.b6d57b41.js";import{M as R}from"./mescroll-empty.fcefb74e.js";import{u as V}from"./useMescroll.26ccf5de.js";import{_ as B}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.0c1c54c7.js";import"./u-badge.d8d91719.js";import"./u-tabbar.d98653fa.js";import"./u-safe-bottom.908eeae4.js";import"./cloneDeep.77735539.js";import"./u-loading-page.566c330a.js";import"./u-loading-icon.b37701e7.js";import"./u-transition.cdf87992.js";import"./mescroll-i18n.14e7fe02.js";/* empty css                                                                       */const H=B(a({__name:"card_bag",setup(a){const{mescrollInit:B,downCallback:H,getMescroll:J}=V(m,v),P=e([]),Q=e(!0),T=e(!0),q=e({}),G=e(""),K=e("");t((a=>{G.value=a.card_bag_id||"",K.value=a.order_id||"",O.value=a.status||"",L()})),r((()=>{J()&&J().resetUpScroll()}));const L=()=>{T.value=!1,q.value={},U().then((a=>{q.value=a.data,T.value=!0})).catch((()=>{T.value=!0}))},N=a=>{if(!b())return a.endSuccess(0),void(Q.value=!1);Q.value=!0;let e={page:a.num,limit:a.size,status:O.value,card_bag_id:G.value,order_id:K.value};D(e).then((e=>{let t=e.data.data;1==a.num&&(P.value=[]),P.value=P.value.concat(t),a.endSuccess(t.length),Q.value=!1})).catch((()=>{Q.value=!1,a.endErr()}))},O=e(""),W=a=>{O.value=a,J().resetUpScroll()},X=a=>{let e="";return e="balance"==a.giftcard.card_right_type?"addon/shop_giftcard/diy/index/value_card.jpg":"addon/shop_giftcard/diy/index/redemption_card.jpg",e},Y=(a,e)=>{"use"==a?F({url:"/addon/shop_giftcard/pages/use_card",param:{card_id:e}}):(uni.getStorageSync("give_id")&&uni.removeStorageSync("give_id"),F({url:"/addon/shop_giftcard/pages/give",param:{card_id:e}}))};return(a,e)=>{const t=h,r=y,v=E,m=z,b=k(j("tabbar"),I),F=k(j("loading-page"),M);return s(),l(t,{class:"bg-[#f8f8f8] min-h-[100vh]",style:x(a.themeColor())},{default:o((()=>[T.value?(s(),l(t,{key:0,class:"fixed left-0 top-0 right-0 z-10"},{default:o((()=>[d(r,{"scroll-x":!0,class:"tab-style-2"},{default:o((()=>[d(t,{class:"tab-content"},{default:o((()=>[d(t,{class:i(["tab-items",{"class-select":""===O.value}]),onClick:e[0]||(e[0]=a=>W(""))},{default:o((()=>[c(n(u(w)("all")),1)])),_:1},8,["class"]),(s(!0),p(_,null,f(q.value,((a,e)=>(s(),l(t,{class:i(["tab-items",{"class-select":O.value===e}]),onClick:a=>W(e)},{default:o((()=>[c(n(a),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1})):g("v-if",!0),d(A,{ref:"mescrollRef",top:"88rpx",onInit:u(B),down:{use:!1},onUp:N},{default:o((()=>[P.value.length?(s(),l(t,{key:0,class:"sidebar-margin pt-[var(--top-m)]"},{default:o((()=>[(s(!0),p(_,null,f(P.value,((a,e)=>(s(),l(t,{onClick:e=>Y("use",a.card_id),class:"h-[430rpx] mb-[var(--top-m)] rounded-[var(--rounded-big)] overflow-hidden box-border relative"},{default:o((()=>[a.card_cover?(s(),l(v,{key:0,class:"w-[100%] h-[100%] rounded-[var(--goods-rounded-big)] overflow-hidden",src:u(C)(a.card_cover||""),onError:e=>a.card_cover=X(a),mode:"aspectFill"},null,8,["src","onError"])):(s(),l(v,{key:1,class:"w-[100%] h-[100%] rounded-[var(--goods-rounded-big)] overflow-hidden",src:u(C)(X(a)),mode:"aspectFill"},null,8,["src"])),d(t,{class:"flex flex-col justify-between w-full h-[430rpx] mb-[var(--top-m)] rounded-[var(--rounded-big)] overflow-hidden box-border absolute left-0 top-0 z-5"},{default:o((()=>[d(t,{class:"flex justify-between py-[var(--pad-top-m)] px-[var(--pad-sidebar-m)]"},{default:o((()=>[d(t,{class:"flex h-[38rpx] px-[10rpx] bg-[rgba(255,255,255,0.9)] rounded-[19rpx]"},{default:o((()=>[d(m,{class:i(["mr-[8rpx] iconfont !text-[24rpx] !leading-[38rpx]",{"iconchuzhikaV6mm !text-[#EF000C]":"balance"==a.giftcard.card_right_type,"iconduihuankaV6mm-1 !text-[#FF7700]":"goods"==a.giftcard.card_right_type}])},null,8,["class"]),"balance"==a.giftcard.card_right_type?(s(),l(m,{key:0,class:"!text-[26rpx] font-500 !leading-[38rpx]"},{default:o((()=>[c(n(a.balance),1)])),_:2},1024)):g("v-if",!0),d(m,{class:"!text-[22rpx] font-400 !leading-[38rpx]"},{default:o((()=>["balance"==a.giftcard.card_right_type?(s(),l(m,{key:0},{default:o((()=>[c(n(u(w)("yuan")),1)])),_:1})):g("v-if",!0),c(n(a.giftcard.card_right_type_name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(t,{class:"flex justify-between px-[var(--pad-sidebar-m)] mt-auto mb-[var(--pad-top-m)]"},{default:o((()=>[d(t,{class:"h-[36rpx] leading-[36rpx] text-[26rpx] font-800 text-stroke"},{default:o((()=>[c(n(a.card_no),1)])),_:2},1024)])),_:2},1024),d(t,{class:"flex items-center justify-between bg-[rgba(255,255,255,0.9)] h-[80rpx] px-[var(--pad-sidebar-m)] box-border"},{default:o((()=>["to_use"==a.status&&a.giftcard.is_give?(s(),p(_,{key:0},[d(t,{class:"h-[70rpx] leading-[70rpx] text-[24rpx] font-500 text-center w-[calc(50%-1rpx)]",onClick:S((e=>Y("give",a.card_id)),["stop"])},{default:o((()=>[c(n(u(w)("giftToFriends")),1)])),_:2},1032,["onClick"]),d(t,{class:"w-[2rpx] h-[24rpx] bg-[var(--text-color-light9)] rounded-[2rpx]"})],64)):g("v-if",!0),"to_use"==a.status||"can_use"==a.status?(s(),l(t,{key:1,class:"flex-1 h-[70rpx] leading-[70rpx] text-[24rpx] font-500 text-center min-w-[calc(50%-1rpx)]",onClick:S((e=>Y("use",a.card_id)),["stop"])},{default:o((()=>[c(n(u(w)("canUse")),1)])),_:2},1032,["onClick"])):g("v-if",!0),"used"==a.status?(s(),l(t,{key:2,class:"flex-1 h-[70rpx] leading-[70rpx] text-[24rpx] font-500 text-center min-w-[calc(50%-1rpx)]",onClick:S((e=>Y("use",a.card_id)),["stop"])},{default:o((()=>[c(n(u(w)("used")),1)])),_:2},1032,["onClick"])):g("v-if",!0),"invalid"==a.status?(s(),l(t,{key:3,class:"flex-1 h-[70rpx] leading-[70rpx] text-[24rpx] font-500 text-center min-w-[calc(50%-1rpx)]",onClick:S((e=>Y("use",a.card_id)),["stop"])},{default:o((()=>[c(n(u(w)("invalid")),1)])),_:2},1032,["onClick"])):g("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),256))])),_:1})):g("v-if",!0),P.value.length||Q.value?g("v-if",!0):(s(),l(R,{key:1,option:{tip:u(w)("cardEmpty"),icon:u(C)("addon/shop_giftcard/empty.png")}},null,8,["option"])),d(b)])),_:1},8,["onInit"]),d(F,{loading:Q.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-86864021"]]);export{H as default};
