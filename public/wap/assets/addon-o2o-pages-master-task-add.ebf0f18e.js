import{d as e,m as a,o as l,c as r,w as t,E as o,F as u,u as s,G as i,b as m,x as d,y as n,f as p,I as c,au as f,g as x,h as _,i as g,H as v,V as b,_ as h,C as y,r as j,j as V,p as S,n as C,a as k,t as w}from"./index-905183d4.js";import{_ as I}from"./u-input.07f64251.js";import{_ as E,a as F}from"./u-form.7ae4e9da.js";import{_ as N}from"./u-button.d3798ecb.js";import{_ as q}from"./u-loading-page.7aa0a449.js";import{e as P,h as z}from"./o2o.0090c994.js";import{_ as A}from"./u-icon.86a2aad0.js";import{_ as O}from"./u--image.b5d65e0e.js";import{_ as R}from"./u-upload.54f0d339.js";import{_ as T}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-line.9e44f7cf.js";import"./u-loading-icon.c376267d.js";import"./u-transition.dbaca185.js";import"./u-image.44c969ef.js";/* empty css                                                                 */const U=e({__name:"upload-img",props:{modelValue:{type:String||Array},maxCount:{type:Number,default:9},multiple:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:j}){const V=e,S=a({get:()=>V.modelValue,set(e){j("update:modelValue",e)}}),C=a((()=>V.maxCount)),k=e=>{V.multiple?e.file.forEach((e=>{w({file:e})})):w(e)},w=e=>{var a;if((null==(a=S.value)?void 0:a.length)>=C.value)return c({title:`最多允许上传${C.value}张图片`,icon:"none"}),!1;f({filePath:e.file.url,name:"file"}).then((e=>{var a;(null==(a=S.value)?void 0:a.length)<C.value&&S.value.push(e.data.url)})).catch((()=>{}))};return(e,a)=>{const c=x(_("u-icon"),A),f=x(_("u--image"),O),j=y,w=g,I=x(_("u-upload"),R);return l(),r(w,{class:"flex flex-wrap"},{default:t((()=>[(l(!0),o(i,null,u(s(S),((e,a)=>(l(),r(w,{class:v(["mb-[18rpx] relative",(a+1)%3==0?"":"mr-[18rpx]"])},{default:t((()=>[m(f,{class:"rounded-[10rpx] overflow-hidden",width:"168rpx",height:"168rpx",src:s(b)(e||""),model:"aspectFill"},{error:t((()=>[m(c,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"]),m(j,{class:"nc-iconfont nc-icon-guanbiV6xx text-[32rpx] absolute top-0 right-[0rpx] text-[#fff] bg-[#888] rounded-bl-[16rpx]",onClick:h((e=>(e=>{S.value.splice(e,1)})(a)),["stop"])},null,8,["onClick"])])),_:2},1032,["class"])))),256)),s(S).length<s(C)?(l(),r(w,{key:0,class:"w-[168rpx] h-[168rpx]"},{default:t((()=>[m(I,{onAfterRead:k,maxCount:s(C),multiple:V.multiple},{default:t((()=>[m(w,{class:"flex items-center justify-center w-[168rpx] h-[168rpx] border-[2rpx] border-dashed border-[#ebebec] text-center text-[#888]"},{default:t((()=>[m(w,null,{default:t((()=>[m(w,{class:"nc-iconfont nc-icon-xiangjiV6xx text-[50rpx]"}),m(w,{class:"text-[24rpx] mt-[10rpx]"},{default:t((()=>[d(n(s(S).length)+"/"+n(s(C)),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["maxCount","multiple"])])),_:1})):p("v-if",!0)])),_:1})}}}),J=T(e({__name:"add",setup(e){const a=j(!1),o=j({order_id:"",order_item_id:"",item_name:"",price:0,images:[],item_images:""});V((e=>{Object.keys(o.value).forEach((a=>{if(null!=e[a]&&(o.value[a]=e[a]),"images"==a){o.value[a]=[];let l=e.item_images?e.item_images:null;o.value[a]=l?e.item_images.split(","):[]}}))}));const u=j(null),i=S({item_name:[{required:!0,message:"请输入服务项目",trigger:"blur"}],price:[{required:!0,validator:(e,a,l)=>{""===a||null==a?l(new Error("请输入价格")):Number(a)<=0?l(new Error("价格需大于0")):l()},trigger:"blur"}]});return(e,p)=>{const c=g,f=x(_("u-input"),I),v=x(_("u-form-item"),E),b=y,h=x(_("u-button"),N),j=x(_("u-form"),F),V=x(_("u-loading-page"),q);return l(),r(c,{class:"bg-[#F5F6FA] min-h-screen overflow-hidden",style:C(e.themeColor())},{default:t((()=>[m(c,{class:"mx-[30rpx] my-[20rpx] bg-[#fff] rounded-[16rpx]"},{default:t((()=>[m(c,{class:"text-[34rpx] p-[36rpx] border"},{default:t((()=>[d(n(o.value.order_item_id?s(w)("editServiceItem"):s(w)("addServiceItem")),1)])),_:1}),m(j,{labelPosition:"left",model:o.value,errorType:"toast",rules:i,ref_key:"serviceRef",ref:u,labelWidth:100,class:"px-[30rpx]",labelStyle:{paddingLeft:"30rpx",fontSize:"28rpx"}},{default:t((()=>[m(v,{label:s(w)("serviceItem"),prop:"item_name",required:""},{default:t((()=>[m(f,{modelValue:o.value.item_name,"onUpdate:modelValue":p[0]||(p[0]=e=>o.value.item_name=e),modelModifiers:{trim:!0},border:"surround",clearable:"",placeholder:s(w)("serviceItemPlaceholder"),maxlength:"50"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),m(v,{label:s(w)("price"),prop:"price",required:""},{default:t((()=>[m(f,{modelValue:o.value.price,"onUpdate:modelValue":p[1]||(p[1]=e=>o.value.price=e),border:"surround",clearable:"",placeholder:s(w)("pricePlaceholder"),type:"number",maxlength:"6"},{suffix:t((()=>[m(b,null,{default:t((()=>[d(n(s(w)("yuan")),1)])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"]),m(v,{label:s(w)("serviceImg"),prop:"images",class:"form-images"},{default:t((()=>[m(c,{class:"px-[30rpx]"},{default:t((()=>[m(U,{class:"mt-[20rpx]",modelValue:o.value.images,"onUpdate:modelValue":p[2]||(p[2]=e=>o.value.images=e),"max-count":6,multiple:!1},null,8,["modelValue"])])),_:1})])),_:1},8,["label"]),m(v,{class:"mt-[30rpx]"},{default:t((()=>[m(h,{text:s(w)("save"),onClick:p[3]||(p[3]=e=>(async()=>{u.value.validate().then((()=>{if(a.value)return;a.value=!0;const e=JSON.parse(JSON.stringify(o.value));e.item_images=e.images.toString(),(o.value.order_item_id?P:z)(e).then((e=>{a.value=!1,k({url:"/addon/o2o/pages/master/task/detail",param:{order_id:o.value.order_id}})})).catch((()=>{a.value=!1}))}))})()),customStyle:{borderRadius:"38rpx",color:"#fff",margin:"30rpx 0",backgroundColor:"var(--primary-color)"}},null,8,["text","customStyle"])])),_:1})])),_:1},8,["model","rules"])])),_:1}),m(V,{"bg-color":"rgb(248,248,248)",loading:a.value,fontSize:"14",color:"#333",loadingText:s(w)("loading")},null,8,["loading","loadingText"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-a11dfb8e"]]);export{J as default};
