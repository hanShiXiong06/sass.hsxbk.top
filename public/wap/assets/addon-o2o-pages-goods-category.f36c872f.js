import{d as e,r as a,p as l,o as t,c as r,w as o,b as s,f as i,u as n,c5 as c,O as u,a6 as p,P as d,y as x,z as f,n as m,a7 as _,a8 as g,a4 as v,D as b,i as h,a5 as y,g as k,h as w,F as j,Q as C,A as E,E as F,a as z,s as V,B as M,C as I}from"./index-9317da28.js";import{_ as P}from"./u-popup.1f2ebcae.js";import{_ as S}from"./u-icon.5e775659.js";import{_ as U}from"./u--image.5461b7b7.js";import{_ as D}from"./u-loading-page.de89bca9.js";import{_ as O}from"./tabbar.31005363.js";import{a as A,b as B}from"./goods.ad1c2fa3.js";import{M as Q}from"./mescroll-body.c2f6fcce.js";import{M as K}from"./mescroll-empty.82e9c349.js";import{u as N}from"./useMescroll.26ccf5de.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-transition.65be38eb.js";import"./u-safe-bottom.3546c5bb.js";import"./u-image.74ac23f6.js";import"./u-loading-icon.aabe3d05.js";/* empty css                                                                       */import"./u-badge.4fd7810d.js";import"./u-tabbar.c8394bc9.js";import"./mescroll-i18n.f3c5a2b0.js";const q=R(e({__name:"category",setup(e){const{mescrollInit:R,downCallback:q,getMescroll:G}=N(g,_);let H=a([]),J=a(""),L=a(""),T=a(!0),W=a(!1),X=a(!1);const Y=e=>{T.value=!0,W.value=!1;let a={page:e.num,limit:e.size,goods_category:L.value,goods_name:J.value};B(a).then((a=>{let l=a.data.data;1==e.num&&(H.value=[]),H.value=H.value.concat(l),T.value=!1,e.endSuccess(l.length),H.value.length||(W.value=!0)})).catch((()=>{T.value=!1,W.value=!0,e.endErr()}))};l((()=>{$()}));const Z=a([]),$=()=>{T.value=!0,A().then((e=>{Z.value=e.data,e.data[0].children&&e.data[0].children.length?L.value=e.data[0].children[0].category_id:L.value=e.data[0].category_id,T.value=!1})).catch((()=>{T.value=!1}))},ee=a(0),ae=a(0),le=(e,a)=>{ae.value=e,L.value=a.category_id,X.value=!1,G().resetUpScroll()};a(!0);const te=()=>{G().resetUpScroll()};let re=e=>{let a="";return a=e.member_discount&&V()?"member_price":"",a},oe=e=>{let a="0.00";return a=e.member_discount&&V()?e.goods_sku.member_price||"0.00":e.goods_sku.price||"0.00",parseFloat(a).toFixed(2)};return(e,a)=>{const l=v,_=b,g=h,V=y,A=k(w("u-popup"),P),B=k(w("u-icon"),S),N=k(w("u--image"),U),$=M,se=I,ie=k(w("u-loading-page"),D),ne=k(w("tabbar"),O);return t(),r(g,{class:"min-h-screen category",style:m(e.themeColor())},{default:o((()=>[Z.value.length?(t(),r(g,{key:0,class:"mescroll-box bg-[#f8f8f8]"},{default:o((()=>{var e;return[s(Q,{ref:"mescrollRef",top:(null==(e=Z.value[ee.value])?void 0:e.children)?"187rpx":"105rpx",down:{use:!1},onInit:n(R),onDown:n(q),onUp:Y},{default:o((()=>{var e;return[i(" 头部搜索 "),s(g,{class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0"},{default:o((()=>[s(l,{class:"search-ipt text-sm",type:"text",modelValue:n(J),"onUpdate:modelValue":a[0]||(a[0]=e=>c(J)?J.value=e:J=e),placeholder:n(j)("searchKeywordPlaceholder")},null,8,["modelValue","placeholder"]),s(g,{class:"flex items-center z-2 h-[66rpx] absolute right-[48rpx] top-[18rpx]"},{default:o((()=>[s(_,{class:"nc-iconfont nc-icon-sousuoV6xx text-[30rpx]",onClick:te})])),_:1})])),_:1}),i(" 左侧切换 "),s(g,{class:"tabs-box z-10 fixed left-0 bg-[#fff] bottom-[100rpx] top-[105rpx] pb-ios"},{default:o((()=>[s(V,{"scroll-y":!0,class:"h-[100%]"},{default:o((()=>[(t(!0),u(d,null,p(Z.value,((e,a)=>(t(),r(g,{class:C(["tab-item",{"tab-item-active":a==ee.value}]),key:e.site_id,onClick:l=>((e,a)=>{ee.value=e,a.children&&a.children.length?le(0,a.children[0]):(L.value=a.category_id,G().resetUpScroll())})(a,e)},{default:o((()=>[s(g,{class:"text-box"},{default:o((()=>[x(f(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),i(" 二级菜单点击 "),(null==(e=Z.value[ee.value])?void 0:e.children)?(t(),r(g,{key:0,class:"sort-tabs flex items-center h-[92rpx] px-[24rpx] py-[20rpx] bg-[#fff] fixed left-[182rpx] right-0 top-[105rpx] box-border z-10"},{default:o((()=>[n(X)?(t(),u(d,{key:1},[s(g,{class:"flex-1 h-[48rpx] text-[22rpx] text-[#E2E2E2] px-[24rpx] leading-[48rpx]"},{default:o((()=>[x(f(n(j)("allCategory")),1)])),_:1}),s(_,{class:"nc-iconfont nc-icon-shangV6xx-1 transform text-[32rpx] rotate-180",onClick:a[2]||(a[2]=e=>c(X)?X.value=!1:X=!1)})],64)):(t(),u(d,{key:0},[s(V,{"scroll-x":!0,"scroll-with-animation":"","scroll-into-view":"id"+(ae.value?ae.value-1:0),class:"flex-1 box-border px-[24rpx] bg-white"},{default:o((()=>[s(g,{class:"h-[55rpx] items-center flex"},{default:o((()=>{var e;return[(t(!0),u(d,null,p(null==(e=Z.value[ee.value])?void 0:e.children,((e,a)=>(t(),r(_,{class:C(["flex-shrink-0 px-[24rpx] h-[48rpx] text-[22rpx] leading-[48rpx] border-[2rpx] border-[#E2E2E2] border-solid rounded-[24rpx] border-box mr-[20rpx]",{"sub-tab-active":a===ae.value}]),key:Z.value[ee.value].category_id,id:"id"+a,onClick:l=>le(a,e)},{default:o((()=>[x(f(e.category_name),1)])),_:2},1032,["class","id","onClick"])))),128))]})),_:1})])),_:1},8,["scroll-into-view"]),s(_,{class:"nc-iconfont nc-icon-shangV6xx-1 text-[32rpx]",onClick:a[1]||(a[1]=e=>c(X)?X.value=!0:X=!0)})],64))])),_:1})):i("v-if",!0),s(g,{class:"labelPopup"},{default:o((()=>[s(A,{show:n(X),mode:"top",onClose:a[3]||(a[3]=e=>c(X)?X.value=!1:X=!1),duration:"80"},{default:o((()=>[s(g,{class:"flex flex-wrap py-[24rpx]"},{default:o((()=>{var e;return[(t(!0),u(d,null,p(null==(e=Z.value[ee.value])?void 0:e.children,((e,a)=>(t(),r(_,{class:C(["flex-shrink-0 w-[160rpx] ml-[22rpx] mb-[24rpx] text-center h-[48rpx] text-[22rpx] leading-[48rpx] border-solid rounded-[24rpx] border-[2rpx] box-border border-[#E2E2E2]",{"sub-tab-active":a===ae.value}]),key:Z.value[ee.value].category_id,onClick:l=>le(a,e)},{default:o((()=>[x(f(e.category_name),1)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1},8,["show"])])),_:1}),s(g,{class:"pl-[182rpx] pt-[20rpx]",style:{width:"calc(100% - 182rpx)"}},{default:o((()=>[(t(!0),u(d,null,p(n(H),((e,a)=>(t(),r(g,{class:C(["bg-white flex px-[20rpx] py-[20rpx] mx-[16rpx] border-0 border-solid border-[#F0F0F0] rounded-[12rpx] box-border",{"mt-[16rpx]":a}]),key:e.goods_id,onClick:E((a=>{z({url:"/addon/o2o/pages/goods/detail",param:{sku_id:e.goods_sku.sku_id}})}),["stop"])},{default:o((()=>[s(N,{width:"200rpx",height:"200rpx",radius:"10rpx",src:n(F)(e.cover_thumb_small),mode:"aspectFill"},{error:o((()=>[s(B,{name:"photo",color:"#999",size:"80"})])),_:2},1032,["src"]),s(g,{class:"flex flex-col flex-1 justify-between ml-[14rpx]"},{default:o((()=>[s(g,{class:"w-[278rpx] h-[80rpx] leading-[40rpx] multi-hidden text-[#303133] text-[30rpx]"},{default:o((()=>[x(f(e.goods_name),1)])),_:2},1024),s(g,{class:"flex items-center mt-2 text-[#F55246] text-xs"},{default:o((()=>[s(g,{class:"text-[var(--price-text-color)]"},{default:o((()=>[s(_,{class:"text-[28rpx] price-font"},{default:o((()=>[x("￥")])),_:1}),s(_,{class:"text-[28rpx] price-font"},{default:o((()=>[x(f(n(oe)(e)),1)])),_:2},1024),"member_price"==n(re)(e)?(t(),r($,{key:0,class:"h-[24rpx] ml-[10rpx] w-[60rpx]",src:n(F)("addon/o2o/VIP.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0)])),_:2},1024)])),_:2},1024),s(g,{class:"flex items-center mt-auto justify-between"},{default:o((()=>[s(_,{class:"text-[22rpx] text-[#888]"},{default:o((()=>[x(f(n(j)("soldOut"))+" "+f(e.sale_num),1)])),_:2},1024),s(se,{class:"text-[#fff] bg-[var(--primary-color)] self-end rounded-3xl text-[26rpx] min-w-[110rpx] h-[44rpx] leading-[44rpx] mx-0 mt-auto"},{default:o((()=>[x(f(n(j)("reserveBtn")),1)])),_:1})])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),n(H).length||n(T)||!n(W)?i("v-if",!0):(t(),r(K,{key:0,option:{icon:n(F)("static/resource/images/empty.png"),tip:n(j)("nothingMore")}},null,8,["option"]))])),_:1})]})),_:1},8,["top","onInit","onDown"])]})),_:1})):i("v-if",!0),Z.value.length||n(T)?i("v-if",!0):(t(),r(g,{key:1,class:"flex justify-center w-[100%]"},{default:o((()=>[s(K,{option:{icon:n(F)("static/resource/images/empty.png"),tip:n(j)("nothingMore")}},null,8,["option"])])),_:1})),s(ie,{"bg-color":"rgb(248,248,248)",loading:n(T),"loading-text":"加载中...",fontSize:"14",color:"#333"},null,8,["loading"]),s(ne)])),_:1},8,["style"])}}}),[["__scopeId","data-v-8fe4aa7a"]]);export{q as default};
