import{d as e,r as a,x as l,o as t,c as s,w as o,b as r,u as n,y as i,z as p,P as u,Q as c,R as d,f as x,a7 as f,n as _,a as v,t as m,B as g,i as h,D as b,g as y,h as k,C as w,E as j,F,A as I,a1 as C}from"./index-7bf68536.js";import{_ as O}from"./u--image.b3bf1d5c.js";import{_ as N,a as M}from"./u-checkbox-group.b2a485bf.js";import{j as z,k as B,b as E,l as S,m as T}from"./fenxiao.745a840a.js";import{_ as V}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-image.e46f68ef.js";import"./u-icon.0c1c54c7.js";import"./u-transition.cdf87992.js";const A=V(e({__name:"apply",setup(e){const V=a({}),A=a({}),D=a(!1),H=a({memberInfo:!1,applyInfo:!1,config:!1,check:!1}),P=()=>{z().then((e=>{A.value=Object.assign(A.value,e.data),A.value.is_fenxiao&&v({url:"/addon/shop_fenxiao/pages/index",mode:"redirectTo",param:{}}),H.value.memberInfo=!0})).catch((()=>{H.value.memberInfo=!0}))},Q=()=>{B().then((e=>{A.value.status=e.data.status||0,3===A.value.status&&(A.value.refuse_reason=e.data.refuse_reason||""),H.value.applyInfo=!0})).catch((()=>{H.value.applyInfo=!0}))},R=()=>{E().then((e=>{V.value=Object.assign(V.value,e.data.fenxiao_config),"1"!=V.value.is_show_apply&&(D.value=!0),H.value.config=!0})).catch((()=>{H.value.config=!0}))},Z=()=>{S().then((e=>{if(V.value=Object.assign(V.value,e.data.condition_data),"3"===V.value.fenxiao_condition){let e=0;Object.values(V.value.goods_list).forEach(((a,l)=>{a.is_buy&&(e+=1)})),V.value.goods_sum=e}V.value.is_allow_apply=e.data.is_allow_apply,H.value.check=!0})).catch((()=>{H.value.check=!0}))};l((()=>{H.value={memberInfo:!1,applyInfo:!1,config:!1,check:!1},V.value={},A.value={},P(),Q(),R(),Z()}));const q=()=>{D.value=!D.value},G=a(!1),J=()=>D.value?!G.value&&(G.value=!0,void T().then((e=>{G.value=!1,H.value={memberInfo:!1,applyInfo:!1,config:!1,check:!1},V.value={},A.value={},P(),Q(),R(),Z()})).catch((()=>{G.value=!1}))):(m({title:"请阅读并同意《分销申请协议》",icon:"none"}),!1);return(e,a)=>{const l=g,m=h,z=b,B=y(k("u--image"),O),E=y(k("u-checkbox"),N),S=y(k("u-checkbox-group"),M),T=w;return Object.values(H.value).every((e=>e))?(t(),s(m,{key:0,class:"bg-[var(--page-bg-color)] overflow-hidden min-h-[100vh]",style:_(e.themeColor())},{default:o((()=>["0"==V.value.is_fenxiao?(t(),s(m,{key:0,class:"empty-page"},{default:o((()=>[r(l,{class:"img",mode:"aspectFit",src:n(j)("addon/shop_fenxiao/unopened-fenxiao.png")},null,8,["src"]),r(m,{class:"desc"},{default:o((()=>[i(p(n(F)("fenxiaoNotOpen")),1)])),_:1})])),_:1})):3==V.value.apply_type?(t(),s(m,{key:1,class:"empty-page"},{default:o((()=>[r(l,{class:"img",mode:"aspectFit",src:n(j)("addon/shop_fenxiao/unopened-fenxiao.png")},null,8,["src"]),r(m,{class:"desc"},{default:o((()=>[i("请联系客服成为分销商")])),_:1})])),_:1})):(t(),u(c,{key:2},[0===A.value.status&&Object.keys(V.value).length&&"3"!=V.value.apply_type?(t(),u(c,{key:0},[r(l,{class:"w-[100vw] min-h-[100%] h-[100%]",mode:"widthFix",src:n(j)(V.value.apply_head||"")},null,8,["src"]),r(m,{class:"bg-[#fff] relative sidebar-margin mt-[-60rpx] rounded-[var(--rounded-big)] h-[100rpx] flex justify-between items-center px-[30rpx]"},{default:o((()=>[r(z,{class:"text-[30rpx] font-500 text-[#333]"},{default:o((()=>[i(p(n(F)("referrer")),1)])),_:1}),r(z,{class:d(["text-[28rpx]",{"text-[var(--text-color-light6)]":A.value.bindFenxiaoMember,"text-[var(--text-color-light9)]":!A.value.bindFenxiaoMember}])},{default:o((()=>[i(p(A.value.bindFenxiaoMember?A.value.bindFenxiaoMember.nickname:n(F)("notHave")),1)])),_:1},8,["class"])])),_:1}),["1","2","3"].indexOf(V.value.fenxiao_condition)>-1?(t(),s(m,{key:0,class:"apply-condition z-10 rounded-[var(--rounded-big)] mt-[var(--top-m)] box-border sidebar-margin"},{default:o((()=>[r(m,{class:"apply-condition-wrap z-10 rounded-[var(--rounded-big)] px-[10rpx] pb-[10rpx] box-border"},{default:o((()=>[r(m,{class:"flex items-center justify-between h-[40rpx] px-[20rpx] pt-[26rpx] pb-[14rpx]"},{default:o((()=>[r(m,{class:"text-[30rpx] font-500 text-[#fff]"},{default:o((()=>[i("申请条件")])),_:1}),"1"===V.value.fenxiao_condition?(t(),s(m,{key:0,class:"flex items-baseline text-[26rpx] text-[#fff]"},{default:o((()=>[r(z,null,{default:o((()=>[i("累计消费")])),_:1}),r(z,{class:"text-[30rpx] price-font mx-[6rpx]"},{default:o((()=>[i(p(V.value.order_count),1)])),_:1}),r(z,null,{default:o((()=>[i("次")])),_:1})])),_:1})):x("v-if",!0),"2"===V.value.fenxiao_condition?(t(),s(m,{key:1,class:"flex items-baseline text-[26rpx] text-[#fff]"},{default:o((()=>[r(z,null,{default:o((()=>[i("累计消费")])),_:1}),r(z,{class:"text-[30rpx] price-font mx-[6rpx]"},{default:o((()=>[i(p(V.value.order_sum),1)])),_:1}),r(z,null,{default:o((()=>[i("元")])),_:1})])),_:1})):x("v-if",!0),"3"===V.value.fenxiao_condition?(t(),s(m,{key:2,class:"flex items-baseline text-[24rpx] text-[#fff]"},{default:o((()=>[r(z,null,{default:o((()=>[i("已购买")])),_:1}),r(z,{class:"text-[30rpx] price-font mx-[6rpx]"},{default:o((()=>[i(p(V.value.goods_sum?V.value.goods_sum:0),1)])),_:1}),r(z,null,{default:o((()=>[i("个商品")])),_:1})])),_:1})):x("v-if",!0)])),_:1}),r(m,{class:"bg-[#fff] px-[var(--pad-sidebar-m)] py-[var(--pad-top-m)] rounded-[var(--rounded-mid)]"},{default:o((()=>["1"===V.value.fenxiao_condition?(t(),s(m,{key:0,class:"flex items-center"},{default:o((()=>[r(l,{class:"w-[32rpx] h-[32rpx] mr-[20rpx]",src:n(j)("addon/shop/apply/tiaojian.png")},null,8,["src"]),r(m,{class:"text-[26rpx] text-[#333]"},{default:o((()=>[i(" 累计消费"),r(z,{class:"price-font text-[28rpx] mx-[5rpx]"},{default:o((()=>[i(p(V.value.consume_count),1)])),_:1}),i("次可申请分销商 ")])),_:1})])),_:1})):x("v-if",!0),"2"===V.value.fenxiao_condition?(t(),s(m,{key:1,class:"flex items-center"},{default:o((()=>[r(l,{class:"w-[32rpx] h-[32rpx] mr-[20rpx]",src:n(j)("addon/shop/apply/tiaojian.png")},null,8,["src"]),r(m,{class:"text-[26rpx] text-[#333]"},{default:o((()=>[i(" 累计消费"),r(z,{class:"price-font text-[28rpx] mx-[5rpx]"},{default:o((()=>[i(p(V.value.consume_money),1)])),_:1}),i("元可申请分销商 ")])),_:1})])),_:1})):x("v-if",!0),"3"===V.value.fenxiao_condition?(t(),u(c,{key:2},[r(m,{class:"flex items-center pb-[10rpx]"},{default:o((()=>[r(l,{class:"w-[32rpx] h-[32rpx] mr-[20rpx]",src:n(j)("addon/shop/apply/tiaojian.png")},null,8,["src"]),r(z,{class:"text-[28rpx]"},{default:o((()=>[i("商品任选其一购买即可成为分销商")])),_:1})])),_:1}),(t(!0),u(c,null,f(V.value.goods_list,((e,a,u)=>(t(),s(m,{class:"flex py-[30rpx] relative fenxiao-goods-item",key:u,onClick:I((a=>{return l=e.goods_id,void v({url:"/addon/shop/pages/goods/detail",param:{goods_id:l}});var l}),["stop"])},{default:o((()=>[r(B,{width:"200rpx",height:"200rpx",radius:"var(--goods-rounded-big)",class:"overflow-hidden",src:n(j)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:o((()=>[r(l,{class:"w-[200rpx] h-[200rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:n(j)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),r(m,{class:"flex flex-1 flex-col justify-between py-[6rpx] ml-[20rpx] goods-item-content"},{default:o((()=>[r(m,{class:"multi-hidden text-[26rpx] font-500 leading-[1.4]"},{default:o((()=>[i(p(e.goods_name),1)])),_:2},1024),r(m,{class:"flex items-end justify-between"},{default:o((()=>[r(m,{class:"text-[var(--price-text-color)] inline-block price-font leading-[1]"},{default:o((()=>[r(z,{class:"text-[24rpx]"},{default:o((()=>[i("￥")])),_:1}),r(z,{class:"text-[40rpx]"},{default:o((()=>[i(p(parseFloat(n(C)(e.goods_sku.price)).toFixed(2).toString().split(".")[0]),1)])),_:2},1024),r(z,{class:"text-[24rpx]"},{default:o((()=>[i("."+p(parseFloat(n(C)(e.goods_sku.price)).toFixed(2).toString().split(".")[1]),1)])),_:2},1024)])),_:2},1024),r(z,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 text-[#fff] text-[28rpx] bg-[#FE4C19] h-[48rpx] w-[48rpx] text-center leading-[48rpx] rounded-[50rpx]"})])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))],64)):x("v-if",!0)])),_:1})])),_:1})])),_:1})):x("v-if",!0),r(m,{class:"fixed btn-wrap flex justify-center flex-col bottom-[0] left-[0] right-[0] items-center bg-[#fff] py-[30rpx]"},{default:o((()=>[r(m,{class:d(["w-[690rpx] h-[80rpx] text-[26rpx] rounded-[100rpx] text-center leading-[80rpx]",{"bg-[#FFB4B1] text-[#fff]":!Number(V.value.is_allow_apply),"primary-btn-bg text-[#fff]":Number(V.value.is_allow_apply)}]),disabled:!Number(V.value.is_allow_apply),onClick:J},{default:o((()=>[i(p(Number(V.value.is_allow_apply)?"申请成为分销商":"尚未达到申请条件"),1)])),_:1},8,["class","disabled"]),"1"===V.value.is_show_apply?(t(),s(m,{key:0,class:"flex justify-center items-baseline mt-[20rpx] -mb-[10rpx]"},{default:o((()=>[r(S,null,{default:o((()=>[r(E,{activeColor:"var(--primary-color)",checked:D.value,shape:"circle",size:"14",onChange:q,customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),r(m,{class:"text-xs text-gray-400 flex items-center flex-wrap"},{default:o((()=>[r(z,null,{default:o((()=>[i("我已阅读并了解")])),_:1}),r(z,{onClick:a[0]||(a[0]=e=>n(v)({url:"/app/pages/auth/agreement?key=fenxiao_service"})),class:"text-primary"},{default:o((()=>[i("《分销申请协议》")])),_:1})])),_:1})])),_:1})):x("v-if",!0)])),_:1}),r(m,{class:d(["pt-[170rpx]",{"h-[50rpx]":"1"===V.value.is_show_apply}])},null,8,["class"])],64)):x("v-if",!0),1===A.value.status?(t(),s(m,{key:1,class:"empty-page"},{default:o((()=>[r(B,{class:"img",width:"400rpx",height:"300rpx",src:n(j)("addon/shop_fenxiao/fenxiao.png"),model:"aspectFill"},null,8,["src"]),r(m,{class:"desc"},{default:o((()=>[i("您已提交分销商申请，等待平台审核")])),_:1})])),_:1})):x("v-if",!0),3===A.value.status?(t(),s(m,{key:2,class:"empty-page h-[auto] min-h-[710rpx] pt-[100rpx] pb-[80rpx]"},{default:o((()=>[r(z,{class:"iconfont icona-guanbi-34V6mm !text-[120rpx] text-[red] mb-[60rpx]"}),r(m,{class:"desc !text-[34rpx] !text-[#333]"},{default:o((()=>[i("您提交的分销商申请已被拒绝")])),_:1}),r(m,{class:"text-[28rpx] px-[40rpx] mt-[40rpx] leading-[1.3] text-[var(--text-color-light6)]"},{default:o((()=>[i("拒绝原因："+p(A.value.refuse_reason),1)])),_:1}),r(T,{class:"primary-btn-bg mt-[140rpx] h-[80rpx] flex-center text-[26rpx] rounded-[100rpx] w-[420rpx] text-[#fff]","hover-class":"none",onClick:a[1]||(a[1]=e=>A.value.status=0)},{default:o((()=>[i("重新申请")])),_:1})])),_:1})):x("v-if",!0)],64)),x(' <loading-page :loading="loading"></loading-page> ')])),_:1},8,["style"])):x("v-if",!0)}}}),[["__scopeId","data-v-9946cf82"]]);export{A as default};
