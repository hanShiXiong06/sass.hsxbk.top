import{d as e,r as t,l as a,j as s,o as l,c as i,w as r,b as n,u as o,y as d,z as c,P as u,a7 as h,Q as p,R as f,A as m,H as g,a as x,i as b,B as k,g as _,h as v,D as y,a6 as w,E as C,s as S,b7 as D,n as T,aS as V,f as j,bd as I,ch as R,a5 as $,bj as N,p as F,t as O,F as L}from"./index-7bf68536.js";import{_ as P}from"./u-swiper.f792d47e.js";import{_ as A}from"./u-parse.525658f5.js";import{_ as E}from"./u-button.359d7329.js";import{_ as B}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{c as W}from"./goods.6e957cea.js";import{_ as K}from"./u--image.b3bf1d5c.js";import{_ as H}from"./u-number-box.30c0ab2e.js";import{_ as U}from"./u-popup.be4bfacd.js";import{f as M}from"./cloneDeep.77735539.js";import{_ as z}from"./_plugin-vue_export-helper.1b428a4d.js";import{s as G}from"./share-poster.5efeffe7.js";import"./u-loading-icon.b37701e7.js";import"./u-icon.0c1c54c7.js";import"./u-loading-page.566c330a.js";import"./u-transition.cdf87992.js";import"./u-image.e46f68ef.js";import"./u-safe-bottom.908eeae4.js";/* empty css                                                                     */const J=e({__name:"ns-goods-sku",props:["goodsDetail"],emits:["change"],setup(e,{expose:D,emit:T}){const V=e,j=t(!1),I=t(null),R=t({sku_id:"",name:""}),$=t(1),N=a(),F=s((()=>N.info)),O=()=>{j.value=!1},L=s((()=>{let e=M(V.goodsDetail);return Object.keys(e).length&&(R.value.sku_id=e.sku_id,e.skuList.map(((e,t)=>(e.selected=!1,e.sku_id==R.value.sku_id&&(e.selected=!0),e))),P(),e.skuList&&Object.keys(e.skuList).length&&e.skuList.forEach(((t,a)=>{t.sku_id==R.value.sku_id&&(e.detail=t)}))),e})),P=()=>{V.goodsDetail.skuList.forEach(((e,t)=>{e.sku_id==R.value.sku_id&&T("change",e.sku_id)}))},A=()=>{if(!F.value)return g().setLoginBack({url:"/addon/o2o/pages/goods/detail",param:{sku_id:L.value.sku_id}}),!1;if(!L.value.goods.status)return!1;var e={sku_id:L.value.sku_id,num:$.value};uni.setStorage({key:"o2oCreateData",data:{sku:e},success:()=>{x({url:"/addon/o2o/pages/order/payment",param:{id:L.value.goods_id}})}}),O()};D({open:(e="")=>{$.value=V.goodsDetail.min_buy,j.value=!0,I.value=e}});const B=s((()=>{let e="0.00";return e=Object.keys(L.value).length&&Object.keys(L.value.goods).length&&L.value.goods.member_discount&&S()?L.value.member_price:L.value.price,parseFloat(e).toFixed(2)}));return(e,t)=>{const a=b,s=k,g=_(v("u--image"),K),x=y,S=_(v("u-number-box"),H),D=w,T=_(v("u-button"),E),V=_(v("u-popup"),U);return l(),i(a,{onTouchmove:t[1]||(t[1]=m((()=>{}),["prevent","stop"]))},{default:r((()=>[n(V,{show:j.value,onClose:O,mode:"bottom"},{default:r((()=>[n(a,{class:"rounded-t-[20rpx] overflow-hidden bg-[#fff] p-[32rpx] relative"},{default:r((()=>[n(a,{class:"absolute right-[37rpx] nc-iconfont nc-icon-guanbiV6xx text-[40rpx]",onClick:O}),n(a,{class:"flex mb-[58rpx]"},{default:r((()=>[n(a,{class:"rounded-[8rpx] overflow-hidden"},{default:r((()=>[n(g,{width:"204rpx",height:"204rpx",src:o(C)(o(L).detail.sku_image),model:"aspectFill"},{error:r((()=>[n(s,{class:"w-[204rpx] h-[204rpx]",src:o(C)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:1},8,["src"])])),_:1}),n(a,{class:"flex flex-1 flex-col justify-between ml-[20rpx]"},{default:r((()=>[n(a,{class:"w-[100%]"},{default:r((()=>[n(a,{class:"text-[var(--price-text-color)]"},{default:r((()=>[n(x,{class:"text-[28rpx] font-bold"},{default:r((()=>[d("￥")])),_:1}),n(x,{class:"text-[28rpx] mr-[10rpx] font-bold"},{default:r((()=>[d(c(o(B)),1)])),_:1})])),_:1})])),_:1}),n(a,{class:"w-[100%]",style:{"max-height":"calc(204rpx - 92rpx)"}},{default:r((()=>[n(x,{class:"text-[24rpx] leading-[38rpx] text-[var(--text-color-light6)] multi-hidden"},{default:r((()=>[d("已选规格："+c(o(L).detail.sku_name),1)])),_:1})])),_:1})])),_:1})])),_:1}),n(D,{class:"h-[500rpx]","scroll-y":"true"},{default:r((()=>[n(a,{class:"mb-[20rpx]"},{default:r((()=>[n(a,{class:"flex flex-wrap"},{default:r((()=>[(l(!0),u(p,null,h(o(L).skuList,((e,t)=>(l(),i(a,{key:t,class:f(["box-border max-w-[680px] truncate text-[24rpx] px-[15rpx] text-center leading-[42rpx] mr-[20rpx] mb-[20rpx] border-1 border-solid rounded-[8rpx] border-[#888]",{"!border-[var(--primary-color)] text-[var(--primary-color)] bg-[var(--primary-color-light)]":e.selected}]),onClick:t=>{return a=e,R.value.sku_id=a.sku_id,R.value.name=a.sku_name,$.value=a.min_buy,void P();var a}},{default:r((()=>[d(c(e.sku_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),n(a,{class:"flex justify-between"},{default:r((()=>[n(a,{class:"text-[26rpx] leading-[36rpx] mb-[30rpx]"},{default:r((()=>[d("购买数量")])),_:1}),n(S,{min:o(L).min_buy,integer:"",step:1,"input-width":"98rpx",modelValue:$.value,"onUpdate:modelValue":t[0]||(t[0]=e=>$.value=e),"input-height":"54rpx"},{minus:r((()=>[n(x,{class:f(["text-[44rpx] nc-iconfont nc-icon-jianshaoV6xx text-[var(--primary-color)]",{"!text-[#c8c9cc]":$.value===o(L).min_buy}])},null,8,["class"])])),input:r((()=>[n(x,{class:"text-[#333] fext-[23rpx] font-500 mx-[16rpx]"},{default:r((()=>[d(c($.value),1)])),_:1})])),plus:r((()=>[n(x,{class:"text-[44rpx] nc-iconfont nc-icon-tianjiaV6mm text-[var(--primary-color)]"})])),_:1},8,["min","modelValue"])])),_:1})])),_:1}),n(T,{text:o(L).goods.status?"确定":"已下架",class:"!h-[80rpx] !text-[30rpx] !m-0 !mt-[30rpx]",shape:"circle",color:o(L).goods.status?"var( --primary-color)":"#999",onClick:A},null,8,["text","color"])])),_:1})])),_:1},8,["show"])])),_:1})}}});const Q=z({name:"uniTable",options:{virtualHost:!0},emits:["selection-change"],props:{data:{type:Array,default:()=>[]},border:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1},type:{type:String,default:""},emptyText:{type:String,default:"没有更多数据"},loading:{type:Boolean,default:!1},rowKey:{type:String,default:""}},data:()=>({noData:!0,minWidth:0,multiTableHeads:[]}),watch:{loading(e){},data(e){this.theadChildren,this.theadChildren&&this.theadChildren.rowspan,this.noData=!1}},created(){this.trChildren=[],this.thChildren=[],this.theadChildren=null,this.backData=[],this.backIndexData=[]},methods:{isNodata(){this.theadChildren;let e=1;this.theadChildren&&(e=this.theadChildren.rowspan),this.noData=this.trChildren.length-e<=0},selectionAll(){let e=1,t=this.theadChildren;this.theadChildren?e=t.rowspan-1:t=this.trChildren[0];let a=this.data&&this.data.length>0;t.checked=!0,t.indeterminate=!1,this.trChildren.forEach(((t,s)=>{if(!t.disabled){if(t.checked=!0,a&&t.keyValue){const e=this.data.find((e=>e[this.rowKey]===t.keyValue));this.backData.find((t=>t[this.rowKey]===e[this.rowKey]))||this.backData.push(e)}s>e-1&&-1===this.backIndexData.indexOf(s-e)&&this.backIndexData.push(s-e)}})),this.$emit("selection-change",{detail:{value:this.backData,index:this.backIndexData}})},toggleRowSelection(e,t){e=[].concat(e),this.trChildren.forEach(((a,s)=>{const l=e.findIndex((e=>"number"==typeof e?e===s-1:e[this.rowKey]===a.keyValue));let i=a.checked;-1!==l&&(a.checked="boolean"==typeof t?t:!a.checked,i!==a.checked&&this.check(a.rowData||a,a.checked,a.rowData?a.keyValue:null,!0))})),this.$emit("selection-change",{detail:{value:this.backData,index:this.backIndexData}})},clearSelection(){let e=this.theadChildren;this.theadChildren||(e=this.trChildren[0]),e.checked=!1,e.indeterminate=!1,this.trChildren.forEach((e=>{e.checked=!1})),this.backData=[],this.backIndexData=[],this.$emit("selection-change",{detail:{value:[],index:[]}})},toggleAllSelection(){let e=[],t=1,a=this.theadChildren;this.theadChildren?t=a.rowspan-1:a=this.trChildren[0],this.trChildren.forEach(((a,s)=>{a.disabled||s>t-1&&e.push(s-t)})),this.toggleRowSelection(e)},check(e,t,a,s){let l=this.theadChildren;this.theadChildren||(l=this.trChildren[0]);let i=this.trChildren.findIndex(((t,a)=>e===t));if(i<0&&(i=this.data.findIndex((e=>e[this.rowKey]===a))+1),this.trChildren.filter((e=>!e.disabled&&e.keyValue)).length,0===i)return void(t?this.selectionAll():this.clearSelection());if(t)a&&this.backData.push(e),this.backIndexData.push(i-1);else{const e=this.backData.findIndex((e=>e[this.rowKey]===a)),t=this.backIndexData.findIndex((e=>e===i-1));a&&this.backData.splice(e,1),this.backIndexData.splice(t,1)}this.trChildren.find(((e,t)=>t>0&&!e.checked&&!e.disabled))?(l.indeterminate=!0,l.checked=!1):(l.indeterminate=!1,l.checked=!0),0===this.backIndexData.length&&(l.indeterminate=!1),s||this.$emit("selection-change",{detail:{value:this.backData,index:this.backIndexData}})}}},[["render",function(e,t,a,s,n,o){const d=b;return l(),i(d,{class:f(["uni-table-scroll",{"table--border":a.border,"border-none":!n.noData}])},{default:r((()=>[D("table",{class:f(["uni-table",{"table--stripe":a.stripe}]),border:"0",cellpadding:"0",cellspacing:"0",style:T({"min-width":n.minWidth+"px"})},[V(e.$slots,"default",{},void 0,!0),n.noData?(l(),u("tr",{key:0,class:"uni-table-loading"},[D("td",{class:f(["uni-table-text",{"empty-border":a.border}])},c(a.emptyText),3)])):j("v-if",!0),a.loading?(l(),i(d,{key:1,class:f(["uni-table-mask",{"empty-border":a.border}])},{default:r((()=>[D("div",{class:"uni-table--loader"})])),_:1},8,["class"])):j("v-if",!0)],6)])),_:3},8,["class"])}],["__scopeId","data-v-77ce1604"]]);const q=z({name:"TableCheckbox",emits:["checkboxSelected"],props:{indeterminate:{type:Boolean,default:!1},checked:{type:[Boolean,String],default:!1},disabled:{type:Boolean,default:!1},index:{type:Number,default:-1},cellData:{type:Object,default:()=>({})}},watch:{checked(e){"boolean"==typeof this.checked?this.isChecked=e:this.isChecked=!0},indeterminate(e){this.isIndeterminate=e}},data:()=>({isChecked:!1,isDisabled:!1,isIndeterminate:!1}),created(){"boolean"==typeof this.checked&&(this.isChecked=this.checked),this.isDisabled=this.disabled},methods:{selected(){this.isDisabled||(this.isIndeterminate=!1,this.isChecked=!this.isChecked,this.$emit("checkboxSelected",{checked:this.isChecked,data:this.cellData}))}}},[["render",function(e,t,a,s,o,d){const c=b;return l(),i(c,{class:"uni-table-checkbox",onClick:d.selected},{default:r((()=>[a.indeterminate?(l(),i(c,{key:1,class:"checkbox__inner checkbox--indeterminate"},{default:r((()=>[n(c,{class:"checkbox__inner-icon"})])),_:1})):(l(),i(c,{key:0,class:f(["checkbox__inner",{"is-checked":o.isChecked,"is-disable":o.isDisabled}])},{default:r((()=>[n(c,{class:"checkbox__inner-icon"})])),_:1},8,["class"]))])),_:1},8,["onClick"])}],["__scopeId","data-v-8af00625"]]);const X=z({name:"uniTr",components:{tableCheckbox:q},props:{disabled:{type:Boolean,default:!1},keyValue:{type:[String,Number],default:""}},options:{virtualHost:!0},data:()=>({value:!1,border:!1,selection:!1,widthThArr:[],ishead:!0,checked:!1,indeterminate:!1}),created(){this.root=this.getTable(),this.head=this.getTable("uniThead"),this.head&&(this.ishead=!1,this.head.init(this)),this.border=this.root.border,this.selection=this.root.type,this.root.trChildren.push(this);const e=this.root.data.find((e=>e[this.root.rowKey]===this.keyValue));e&&(this.rowData=e),this.root.isNodata()},mounted(){if(this.widthThArr.length>0){const e="selection"===this.selection?50:0;this.root.minWidth=Number(this.widthThArr.reduce(((e,t)=>Number(e)+Number(t))))+e}},unmounted(){const e=this.root.trChildren.findIndex((e=>e===this));this.root.trChildren.splice(e,1),this.root.isNodata()},methods:{minWidthUpdate(e){if(this.widthThArr.push(e),this.widthThArr.length>0){const e="selection"===this.selection?50:0;this.root.minWidth=Number(this.widthThArr.reduce(((e,t)=>Number(e)+Number(t))))+e}},checkboxSelected(e){let t=this.root.data.find((e=>e[this.root.rowKey]===this.keyValue));this.checked=e.checked,this.root.check(t||this,e.checked,t?this.keyValue:null)},change(e){this.root.trChildren.forEach((t=>{t===this&&this.root.check(this,e.detail.value.length>0)}))},getTable(e="uniTable"){let t=this.$parent,a=t.$options.name;for(;a!==e;){if(t=t.$parent,!t)return!1;a=t.$options.name}return t}}},[["render",function(e,t,a,s,i,r){const o=I("table-checkbox");return l(),u("tr",{class:"uni-table-tr"},["selection"===i.selection&&i.ishead?(l(),u("th",{key:0,class:f(["checkbox",{"tr-table--border":i.border}])},[n(o,{checked:i.checked,indeterminate:i.indeterminate,disabled:a.disabled,onCheckboxSelected:r.checkboxSelected},null,8,["checked","indeterminate","disabled","onCheckboxSelected"])],2)):j("v-if",!0),V(e.$slots,"default",{},void 0,!0),j(' <uni-th class="th-fixed">123</uni-th> ')])}],["__scopeId","data-v-dc00fea3"]]),Y={reset:"重置",search:"搜索",submit:"确定",filter:"筛选",gt:"大于等于",lt:"小于等于",date:"日期范围"},Z="select",ee="search",te="range",ae="date",se="timestamp";const le=z({name:"uniTh",options:{virtualHost:!0},components:{dropdown:z({name:"FilterDropdown",emits:["change"],components:{checkBox:q},options:{virtualHost:!0},props:{filterType:{type:String,default:Z},filterData:{type:Array,default:()=>[]},mode:{type:String,default:"default"},map:{type:Object,default:()=>({text:"text",value:"value"})},filterDefaultValue:{type:[Array,String],default:()=>""}},computed:{canReset(){return this.isSearch?this.filterValue.length>0:this.isSelect?this.checkedValues.length>0:this.isRange?this.gtValue.length>0&&this.ltValue.length>0:!!this.isDate&&this.dateSelect.length>0},isSelect(){return this.filterType===Z},isSearch(){return this.filterType===ee},isRange(){return this.filterType===te},isDate(){return this.filterType===ae||this.filterType===se}},watch:{filterData(e){this._copyFilters()},indeterminate(e){this.isIndeterminate=e}},data(){return{resource:Y,enabled:!0,isOpened:!1,dataList:[],filterValue:this.filterDefaultValue,checkedValues:[],gtValue:"",ltValue:"",dateRange:[],dateSelect:[]}},created(){this._copyFilters()},methods:{_copyFilters(){let e=M(this.filterData);for(let t=0;t<e.length;t++)void 0===e[t].checked&&(e[t].checked=!1);this.dataList=e},openPopup(){this.isOpened=!0,this.isDate&&this.$nextTick((()=>{this.dateRange.length||this.resetDate(),this.$refs.datetimepicker.show()}))},closePopup(){this.isOpened=!1},handleClose(e){this.closePopup()},resetDate(){let e=(new Date).toISOString().split("T")[0];this.dateRange=[e+" 0:00:00",e+" 23:59:59"]},onDropdown(e){this.openPopup()},onItemClick(e,t){let a=this.dataList,s=a[t];void 0===s.checked?a[t].checked=!0:a[t].checked=!s.checked;let l=[];for(let i=0;i<a.length;i++){const e=a[i];e.checked&&l.push(e.value)}this.checkedValues=l},datetimechange(e){this.closePopup(),this.dateRange=e,this.dateSelect=e,this.$emit("change",{filterType:this.filterType,filter:e})},timepickerclose(e){this.closePopup()},handleSelectSubmit(){this.closePopup(),this.$emit("change",{filterType:this.filterType,filter:this.checkedValues})},handleSelectReset(){if(this.canReset){var e=this.dataList;for(let t=0;t<e.length;t++){let a=e[t];this.$set(a,"checked",!1)}this.checkedValues=[],this.handleSelectSubmit()}},handleSearchSubmit(){this.closePopup(),this.$emit("change",{filterType:this.filterType,filter:this.filterValue})},handleSearchReset(){this.canReset&&(this.filterValue="",this.handleSearchSubmit())},handleRangeSubmit(e){this.closePopup(),this.$emit("change",{filterType:this.filterType,filter:!0===e?[]:[parseInt(this.gtValue),parseInt(this.ltValue)]})},handleRangeReset(){this.canReset&&(this.gtValue="",this.ltValue="",this.handleRangeSubmit(!0))}}},[["render",function(e,t,a,s,o,g){const x=b,k=I("check-box"),_=y,v=R,w=$,C=I("uni-datetime-picker");return l(),i(x,{class:"uni-filter-dropdown"},{default:r((()=>[n(x,{class:"dropdown-btn",onClick:g.onDropdown},{default:r((()=>[g.isSelect||g.isRange?(l(),i(x,{key:0,class:f(["icon-select",{active:g.canReset}])},null,8,["class"])):j("v-if",!0),g.isSearch?(l(),i(x,{key:1,class:f(["icon-search",{active:g.canReset}])},{default:r((()=>[n(x,{class:"icon-search-0"}),n(x,{class:"icon-search-1"})])),_:1},8,["class"])):j("v-if",!0),g.isDate?(l(),i(x,{key:2,class:f(["icon-calendar",{active:g.canReset}])},{default:r((()=>[n(x,{class:"icon-calendar-0"}),n(x,{class:"icon-calendar-1"})])),_:1},8,["class"])):j("v-if",!0)])),_:1},8,["onClick"]),o.isOpened?(l(),i(x,{key:0,class:"uni-dropdown-cover",onClick:g.handleClose},null,8,["onClick"])):j("v-if",!0),o.isOpened?(l(),i(x,{key:1,class:"dropdown-popup dropdown-popup-right",onClick:t[3]||(t[3]=m((()=>{}),["stop"]))},{default:r((()=>[j(" select"),g.isSelect?(l(),i(x,{key:0,class:"list"},{default:r((()=>[(l(!0),u(p,null,h(o.dataList,((e,t)=>(l(),i(v,{class:"flex-r a-i-c list-item",key:t,onClick:e=>g.onItemClick(e,t)},{default:r((()=>[n(k,{class:"check",checked:e.checked},null,8,["checked"]),n(x,{class:"checklist-content"},{default:r((()=>[n(_,{class:"checklist-text",style:T(e.styleIconText)},{default:r((()=>[d(c(e[a.map.text]),1)])),_:2},1032,["style"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):j("v-if",!0),g.isSelect?(l(),i(x,{key:1,class:"flex-r opera-area"},{default:r((()=>[n(x,{class:f(["flex-f btn btn-default",{disable:!g.canReset}]),onClick:g.handleSelectReset},{default:r((()=>[d(c(o.resource.reset),1)])),_:1},8,["class","onClick"]),n(x,{class:"flex-f btn btn-submit",onClick:g.handleSelectSubmit},{default:r((()=>[d(c(o.resource.submit),1)])),_:1},8,["onClick"])])),_:1})):j("v-if",!0),j(" search "),g.isSearch?(l(),i(x,{key:2,class:"search-area"},{default:r((()=>[n(w,{class:"search-input",modelValue:o.filterValue,"onUpdate:modelValue":t[0]||(t[0]=e=>o.filterValue=e)},null,8,["modelValue"])])),_:1})):j("v-if",!0),g.isSearch?(l(),i(x,{key:3,class:"flex-r opera-area"},{default:r((()=>[n(x,{class:"flex-f btn btn-submit",onClick:g.handleSearchSubmit},{default:r((()=>[d(c(o.resource.search),1)])),_:1},8,["onClick"]),n(x,{class:f(["flex-f btn btn-default",{disable:!g.canReset}]),onClick:g.handleSearchReset},{default:r((()=>[d(c(o.resource.reset),1)])),_:1},8,["class","onClick"])])),_:1})):j("v-if",!0),j(" range "),g.isRange?(l(),i(x,{key:4},{default:r((()=>[n(x,{class:"input-label"},{default:r((()=>[d(c(o.resource.gt),1)])),_:1}),n(w,{class:"input",modelValue:o.gtValue,"onUpdate:modelValue":t[1]||(t[1]=e=>o.gtValue=e)},null,8,["modelValue"]),n(x,{class:"input-label"},{default:r((()=>[d(c(o.resource.lt),1)])),_:1}),n(w,{class:"input",modelValue:o.ltValue,"onUpdate:modelValue":t[2]||(t[2]=e=>o.ltValue=e)},null,8,["modelValue"])])),_:1})):j("v-if",!0),g.isRange?(l(),i(x,{key:5,class:"flex-r opera-area"},{default:r((()=>[n(x,{class:f(["flex-f btn btn-default",{disable:!g.canReset}]),onClick:g.handleRangeReset},{default:r((()=>[d(c(o.resource.reset),1)])),_:1},8,["class","onClick"]),n(x,{class:"flex-f btn btn-submit",onClick:g.handleRangeSubmit},{default:r((()=>[d(c(o.resource.submit),1)])),_:1},8,["onClick"])])),_:1})):j("v-if",!0),j(" date "),g.isDate?(l(),i(x,{key:6},{default:r((()=>[n(C,{ref:"datetimepicker",value:o.dateRange,type:"datetimerange","return-type":"timestamp",onChange:g.datetimechange,onMaskClick:g.timepickerclose},{default:r((()=>[n(x)])),_:1},8,["value","onChange","onMaskClick"])])),_:1})):j("v-if",!0)])),_:1})):j("v-if",!0)])),_:1})}],["__scopeId","data-v-e9cdc6da"]])},emits:["sort-change","filter-change"],props:{width:{type:[String,Number],default:""},align:{type:String,default:"left"},rowspan:{type:[Number,String],default:1},colspan:{type:[Number,String],default:1},sortable:{type:Boolean,default:!1},filterType:{type:String,default:""},filterData:{type:Array,default:()=>[]},filterDefaultValue:{type:[Array,String],default:()=>""}},data:()=>({border:!1,ascending:!1,descending:!1}),computed:{customWidth(){if("number"==typeof this.width)return this.width;if("string"==typeof this.width){let e=new RegExp(/^[1-9][0-9]*px$/g),t=new RegExp(/^[1-9][0-9]*rpx$/g),a=new RegExp(/^[1-9][0-9]*$/g);if(null!==this.width.match(e))return this.width.replace("px","");if(null!==this.width.match(t)){let e=Number(this.width.replace("rpx","")),t=N().screenWidth/750;return Math.round(e*t)}return null!==this.width.match(a)?this.width:""}return""},contentAlign(){let e="left";switch(this.align){case"left":e="flex-start";break;case"center":e="center";break;case"right":e="flex-end"}return e}},created(){this.root=this.getTable("uniTable"),this.rootTr=this.getTable("uniTr"),this.rootTr.minWidthUpdate(this.customWidth?this.customWidth:140),this.border=this.root.border,this.root.thChildren.push(this)},methods:{sort(){if(this.sortable)return this.clearOther(),this.ascending||this.descending?this.ascending&&!this.descending?(this.ascending=!1,this.descending=!0,void this.$emit("sort-change",{order:"descending"})):void(!this.ascending&&this.descending&&(this.ascending=!1,this.descending=!1,this.$emit("sort-change",{order:null}))):(this.ascending=!0,void this.$emit("sort-change",{order:"ascending"}))},ascendingFn(){this.clearOther(),this.ascending=!this.ascending,this.descending=!1,this.$emit("sort-change",{order:this.ascending?"ascending":null})},descendingFn(){this.clearOther(),this.descending=!this.descending,this.ascending=!1,this.$emit("sort-change",{order:this.descending?"descending":null})},clearOther(){this.root.thChildren.map((e=>(e!==this&&(e.ascending=!1,e.descending=!1),e)))},ondropdown(e){this.$emit("filter-change",e)},getTable(e){let t=this.$parent,a=t.$options.name;for(;a!==e;){if(t=t.$parent,!t)return!1;a=t.$options.name}return t}}},[["render",function(e,t,a,s,o,d){const c=y,h=b,p=I("dropdown");return l(),u("th",{rowspan:a.rowspan,colspan:a.colspan,class:f(["uni-table-th",{"table--border":o.border}]),style:T({width:d.customWidth+"px","text-align":a.align})},[n(h,{class:"uni-table-th-row"},{default:r((()=>[n(h,{class:"uni-table-th-content",style:T({"justify-content":d.contentAlign}),onClick:d.sort},{default:r((()=>[V(e.$slots,"default",{},void 0,!0),a.sortable?(l(),i(h,{key:0,class:"arrow-box"},{default:r((()=>[n(c,{class:f(["arrow up",{active:o.ascending}]),onClick:m(d.ascendingFn,["stop"])},null,8,["class","onClick"]),n(c,{class:f(["arrow down",{active:o.descending}]),onClick:m(d.descendingFn,["stop"])},null,8,["class","onClick"])])),_:1})):j("v-if",!0)])),_:3},8,["style","onClick"]),a.filterType||a.filterData.length?(l(),i(p,{key:0,filterDefaultValue:a.filterDefaultValue,filterData:a.filterData,filterType:a.filterType,onChange:d.ondropdown},null,8,["filterDefaultValue","filterData","filterType","onChange"])):j("v-if",!0)])),_:3})],14,["rowspan","colspan"])}],["__scopeId","data-v-b8cfd5ae"]]);const ie=z({name:"uniTd",options:{virtualHost:!0},props:{width:{type:[String,Number],default:""},align:{type:String,default:"left"},rowspan:{type:[Number,String],default:1},colspan:{type:[Number,String],default:1}},data:()=>({border:!1}),created(){this.root=this.getTable(),this.border=this.root.border},methods:{getTable(){let e=this.$parent,t=e.$options.name;for(;"uniTable"!==t;){if(e=e.$parent,!e)return!1;t=e.$options.name}return e}}},[["render",function(e,t,a,s,i,r){return l(),u("td",{class:f(["uni-table-td",{"table--border":i.border}]),rowspan:a.rowspan,colspan:a.colspan,style:T({width:a.width+"px","text-align":a.align})},[V(e.$slots,"default",{},void 0,!0)],14,["rowspan","colspan"])}],["__scopeId","data-v-dc0c405a"]]),re=z(e({__name:"detail",setup(e){const m=t([]),w=t(!0),D=a(),V=t(null),I=s((()=>D.info)),R=t("goods_content"),$=e=>{R.value=e},N=t({sku_id:"",goods_id:""});F((e=>{N.value.sku_id=e.sku_id,N.value.goods_id=e.goods_id,w.value=!0,S()&&D.getMemberInfo(),W(N.value).then((e=>{if("{}"===JSON.stringify(e.data))return O({title:"找不到该商品",icon:"none"}),setTimeout((()=>{x({url:"/addon/o2o/pages/index",mode:"reLaunch"})}),600),!1;m.value=e.data,m.value.goods.goods_image_thumb_mid.forEach(((e,t)=>{m.value.goods.goods_image_thumb_mid[t]=C(e)})),w.value=!1,Y()}))}));let K={sku:{num:1,sku_id:""}};const H=()=>{V.value.open()},U=e=>{m.value.skuList.forEach(((t,a)=>{t.sku_id==e&&Object.assign(m.value,t)}))},M=t(null),z=t("");let q={};const Y=()=>{z.value="?sku_id="+m.value.sku_id,I.value&&I.value.member_id&&(z.value+="&mid="+I.value.member_id)},Z=()=>{q.sku_id=m.value.sku_id,I.value&&I.value.member_id&&(q.member_id=I.value.member_id),M.value.openShare()},ee=t(""),te=s((()=>{let e="0.00";return Object.keys(m.value).length&&Object.keys(m.value.goods).length&&m.value.goods.member_discount&&S()?(e=m.value.member_price||m.value.price,ee.value="member_price"):(e=m.value.price,ee.value=""),parseFloat(e).toFixed(2)}));return(e,t)=>{const a=_(v("u-swiper"),P),s=b,D=y,I=k,N=_(v("u-parse"),A),F=_(v("u-button"),E),O=_(v("loading-page"),B);return l(),i(s,{style:T(e.themeColor())},{default:r((()=>[w.value?j("v-if",!0):(l(),i(s,{key:0,class:"bg-[#f7f7f7] min-h-screen overflow-hidden"},{default:r((()=>[n(a,{list:m.value.goods.goods_image_thumb_mid,autoplay:!1,height:"100vw"},null,8,["list"]),j(' <div class="h-[750rpx] w-[100%] bg-[#fff]">\r\n                <u--image  width="100%" height="750rpx"\r\n                :src="img(detail.sku_image_thumb_big)" mode="aspectFill">\r\n                    <template #error>\r\n                        <u-icon name="photo" color="#999" size="100"></u-icon>\r\n                    </template>\r\n                </u--image>\r\n            </div> '),n(s,{class:"px-[24rpx]"},{default:r((()=>[n(s,{class:"chunk-wrap pt-2 pb-3 rounded-lg relative mt-[14rpx]"},{default:r((()=>[n(s,{class:"font-bold multi-hidden"},{default:r((()=>[d(c(m.value.goods.goods_name),1)])),_:1}),n(s,{class:"flex items-center justify-between mt-2"},{default:r((()=>[n(s,{class:"flex items-center"},{default:r((()=>[n(s,{class:"text-[var(--price-text-color)] text-[28rpx] font-bold flex items-center"},{default:r((()=>[n(D,{class:"text-[28rpx] price-font"},{default:r((()=>[d("￥")])),_:1}),n(D,{class:"price-font text-[28rpx]"},{default:r((()=>[d(c(o(te)),1)])),_:1}),m.value.sku_unit?(l(),i(D,{key:0},{default:r((()=>[d("/"+c(m.value.sku_unit),1)])),_:1})):j("v-if",!0),"member_price"==ee.value?(l(),i(I,{key:1,class:"h-[28rpx] ml-[12rpx] w-[60rpx]",src:o(C)("addon/o2o/VIP.png"),mode:"heightFix"},null,8,["src"])):j("v-if",!0)])),_:1}),n(s,{class:"text-[24rpx] flex ml-[20rpx]"},{default:r((()=>[n(D,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:r((()=>[d(c(m.value.goods.buy_type_name),1)])),_:1})])),_:1})])),_:1}),n(s,{class:"text-[20rpx]"},{default:r((()=>[d(c(m.value.goods.sale_num)+c(o(L)("selectNum")),1)])),_:1})])),_:1})])),_:1}),m.value.skuList&&m.value.skuList.length>1?(l(),i(s,{key:0,onClick:H,class:"flex items-center h-[88rpx] px-[20rpx] bg-[#fff] rounded-lg mb-[20rpx]"},{default:r((()=>[n(D,{class:"text-[var(--text-color-light9)] text-[30rpx] leading-[42rpx] font-500 mr-[20rpx]"},{default:r((()=>[d(c(o(L)("selected")),1)])),_:1}),n(s,{class:"flex-1 text-[#343434] text-sm leading-[42rpx] font-500"},{default:r((()=>[d(c(m.value.sku_name),1)])),_:1}),n(D,{class:"nc-iconfont nc-icon-youV6xx text-[26rpx] text-[var(--text-color-light6)]"})])),_:1})):j("v-if",!0),n(s,{class:"chunk-wrap pt-[34rpx] pb-[24rpx] scheduling rounded-lg"},{default:r((()=>[n(s,{class:"flex items-center"},{default:r((()=>[n(D,{class:f(["text-[30rpx] text-center leading-[80rpx] flex-1 text-[var(--text-color-light6)]",{"class-select":"goods_content"==R.value}]),onClick:t[0]||(t[0]=e=>$("goods_content"))},{default:r((()=>[d("项目介绍")])),_:1},8,["class"]),n(D,{class:f(["text-[30rpx] text-center leading-[80rpx] flex-1 text-[var(--text-color-light6)]",{"class-select":"buy_info"==R.value}]),onClick:t[1]||(t[1]=e=>$("buy_info"))},{default:r((()=>[d("购买须知")])),_:1},8,["class"]),"reservation"==m.value.goods.buy_type?(l(),i(D,{key:0,class:f(["text-[30rpx] text-center leading-[80rpx] flex-1 text-[var(--text-color-light6)]",{"class-select":"price_list"==R.value}]),onClick:t[2]||(t[2]=e=>$("price_list"))},{default:r((()=>[d("价目表")])),_:1},8,["class"])):j("v-if",!0)])),_:1}),n(s,{class:"mt-[24rpx]"},{default:r((()=>["goods_content"==R.value?(l(),i(s,{key:0,class:"scheduling-content mt-2"},{default:r((()=>[m.value.goods.goods_content?(l(),i(N,{key:0,content:m.value.goods.goods_content,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(l(),i(s,{key:1,class:"h-[380rpx] flex"},{default:r((()=>[n(s,{class:"mx-auto"},{default:r((()=>[n(I,{class:"w-[280rpx] h-[280rpx]",src:o(C)("addon/o2o/goods/empty01.png")},null,8,["src"]),n(s,{class:"text-center text-[#c1c1c1] text-[24rpx]"},{default:r((()=>[d(c(o(L)("noProjectInt")),1)])),_:1})])),_:1})])),_:1}))])),_:1})):j("v-if",!0),"buy_info"==R.value?(l(),i(s,{key:1,class:"scheduling-content mt-2"},{default:r((()=>[m.value.goods.buy_info?(l(),i(N,{key:0,content:m.value.goods.buy_info,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(l(),i(s,{key:1,class:"h-[380rpx] flex"},{default:r((()=>[n(s,{class:"mx-auto"},{default:r((()=>[n(I,{class:"w-[280rpx] h-[280rpx]",src:o(C)("addon/o2o/goods/empty01.png")},null,8,["src"]),n(s,{class:"text-center text-[#c1c1c1] text-[24rpx]"},{default:r((()=>[d(c(o(L)("noPurchase")),1)])),_:1})])),_:1})])),_:1}))])),_:1})):j("v-if",!0),"price_list"==R.value?(l(),i(s,{key:2,class:"scheduling-content mt-2"},{default:r((()=>[m.value.goods.price_list&&m.value.goods.price_list.length?(l(),i(s,{key:0},{default:r((()=>[n(Q,{border:"",stripe:"",emptyText:o(L)("noMore")},{default:r((()=>[n(X,null,{default:r((()=>[n(le,{width:"80",align:"center"},{default:r((()=>[d(c(o(L)("projectName")),1)])),_:1}),n(le,{width:"50",align:"center"},{default:r((()=>[d(c(o(L)("price")),1)])),_:1}),n(le,{width:"50",align:"center"},{default:r((()=>[d(c(o(L)("unit")),1)])),_:1})])),_:1}),(l(!0),u(p,null,h(m.value.goods.price_list,((e,t)=>(l(),i(X,{key:t},{default:r((()=>[n(ie,{align:"center"},{default:r((()=>[d(c(e.name),1)])),_:2},1024),n(ie,{align:"center"},{default:r((()=>[n(s,{class:"name"},{default:r((()=>[d(c(e.price),1)])),_:2},1024)])),_:2},1024),n(ie,{align:"center"},{default:r((()=>[d(c(e.unit),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["emptyText"])])),_:1})):(l(),i(s,{key:1,class:"h-[380rpx] flex"},{default:r((()=>[n(s,{class:"mx-auto"},{default:r((()=>[n(I,{class:"w-[280rpx] h-[280rpx]",src:o(C)("addon/o2o/goods/empty01.png")},null,8,["src"]),n(s,{class:"text-center text-[#c1c1c1] text-[24rpx]"},{default:r((()=>[d(c(o(L)("noPriceList")),1)])),_:1})])),_:1})])),_:1}))])),_:1})):j("v-if",!0)])),_:1})])),_:1}),n(s,{class:"h-[148rpx] w-screen"}),n(s,{class:"flex justify-between bg-white px-3 py-2 fixed bottom-0 left-0 right-0"},{default:r((()=>[n(s,{class:"flex items-center"},{default:r((()=>[n(s,{class:"flex flex-col items-center mr-[44rpx]",onClick:t[3]||(t[3]=e=>o(x)({url:"/addon/o2o/pages/index",mode:"reLaunch"}))},{default:r((()=>[n(I,{class:"w-[43rpx] h-[43rpx]",src:o(C)("addon/o2o/service/index.png"),mode:"aspectFill"},null,8,["src"]),n(D,{class:"text-[24rpx] text-[#454545] mt-1.5"},{default:r((()=>[d(c(o(L)("index")),1)])),_:1})])),_:1}),n(s,{class:"flex flex-col items-center mr-[44rpx]",onClick:Z},{default:r((()=>[n(s,{class:"nc-iconfont nc-icon-fenxiangV6xx text-[36rpx] mt-[4rpx] mb-[6rpx] font-bold"}),n(D,{class:"text-[24rpx] text-[#454545] mt-1"},{default:r((()=>[d(c(o(L)("share")),1)])),_:1})])),_:1}),n(s,{class:"flex flex-col items-center mr-[44rpx]"},{default:r((()=>[n(I,{class:"w-[44rpx] h-[44rpx]",src:o(C)("addon/o2o/service/service.png"),mode:"aspectFill"},null,8,["src"]),n(D,{class:"text-[24rpx] text-[#454545] mt-1"},{default:r((()=>[d(c(o(L)("service")),1)])),_:1})])),_:1}),j(' <view class="flex flex-col items-center mr-[44rpx]" @click="collect(detail)">\r\n                        <image class="w-[44rpx] h-[44rpx]" v-if="collect_id > 0" :src="img(\'static/resource/images/member/select_collect.png\')" mode="aspectFill"></image>\r\n                        <image class="w-[44rpx] h-[44rpx]" v-else :src="img(\'static/resource/images/member/collect.png\')" mode="aspectFill"></image>\r\n                        <text class="text-[24rpx] text-[#454545] mt-1">收藏</text>\r\n                    </view> ')])),_:1}),n(F,{customStyle:{marginLeft:"8rpx",borderRadius:"38rpx",flex:"1"},color:m.value.goods.status?"var( --primary-color)":"#999",size:"16",text:m.value.goods.status?"reservation"==m.value.goods.buy_type?o(L)("bookNow"):o(L)("orderNow"):o(L)("delisted"),onClick:t[4]||(t[4]=e=>{return t=m.value,S()?!!t.goods.status&&(K.sku.sku_id=t.sku_id,uni.setStorageSync("o2oCreateData",K),void("buy"==t.goods.buy_type?H():x({url:"/addon/o2o/pages/order/payment",param:{id:t.goods_id}}))):(g().setLoginBack({url:"/addon/o2o/pages/goods/detail",param:{sku_id:t.sku_id}}),!1);var t})},null,8,["color","text"])])),_:1})])),_:1}),n(G,{ref_key:"sharePosterRef",ref:M,posterType:"o2o_goods",posterId:m.value.goods.poster_id,posterParam:o(q),copyUrlParam:z.value},null,8,["posterId","posterParam","copyUrlParam"])])),_:1})),n(J,{ref_key:"goodsSkuRef",ref:V,"goods-detail":m.value,onChange:U},null,8,["goods-detail"]),n(O,{loading:w.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-a5ba3ba4"]]);export{re as default};
