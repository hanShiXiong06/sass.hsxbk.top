import{_ as e}from"./u-input.6410b5d0.js";import{d as a,r as l,p as t,aH as r,j as s,o,c as d,w as u,b as i,u as m,y as n,z as p,ce as c,A as _,n as v,aJ as f,aK as b,a as h,g,h as y,i as x,F as j}from"./index-2882a2d8.js";import{_ as V}from"./u-form-item.03ed7ff5.js";import{_ as k}from"./u-switch.3ee1caf1.js";import{_ as P}from"./u-textarea.6361767e.js";import{_ as $}from"./u-button.0ab7ff00.js";import{_ as w}from"./u-form.54744837.js";import{_ as C}from"./area-select.vue_vue_type_script_setup_true_lang.1ee3e80e.js";import{f as A}from"./tkjhkd.474b5148.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.1104ad2f.js";/* empty css                                                                */import"./u-line.d7ff94e2.js";/* empty css                                                               */import"./u-loading-icon.a37f7e61.js";/* empty css                                                                       */import"./u-popup.2abbe959.js";import"./u-overlay.1a317a4e.js";import"./u-transition.4448d2e5.js";import"./u-safe-bottom.f13b01b8.js";const U=E(a({__name:"address_edit",setup(a){const E=l(),U=l({id:0,name:"",mobile:"",province_id:0,city_id:0,district_id:0,address:"",full_address:"",is_default:0,area:"",type:"address"}),K=l(),T=l(null),q=l(""),z=l(""),H=l(!1),M=()=>{setTimeout((()=>{O()}),500)},O=()=>{E.value?A({address:E.value}).then((e=>{Object.assign(U.value,e.data),uni.$u.toast("地址解析成功"),E.value=""})):uni.$u.toast("请填写解析地址")};t((e=>{e.id&&r(e.id).then((({data:e})=>{e&&Object.assign(U.value,e)})).catch(),q.value=e.type||"",z.value=e.source||""}));const R=s((()=>({name:{type:"string",required:!0,message:j("namePlaceholder"),trigger:["blur","change"]},mobile:[{type:"string",required:!0,message:j("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,a,l){/^1[3-9]\d{9}$/.test(a)?l():l(new Error(j("mobileError")))}}],area:{validator:()=>!uni.$u.test.isEmpty(U.value.area),message:j("selectAreaPlaceholder")},address:{type:"string",required:!0,message:j("addressPlaceholder"),trigger:["blur","change"]}}))),F=()=>{K.value.open()},I=e=>{U.value.province_id=e.province.id||0,U.value.city_id=e.city.id||0,U.value.district_id=e.district.id||0,U.value.area=`${e.province.name||""}${e.city.name||""}${e.district.name||""}`},J=l(!1),S=()=>{const e=U.value.id?f:b;T.value.validate().then((()=>{J.value||(J.value=!0,H.value=!0,U.value.full_address=U.value.area+U.value.address,e(U.value).then((e=>{J.value=!1,setTimeout((()=>{H.value=!1,h({url:"/addon/tk_jhkd/pages/address/address",mode:"redirectTo",param:{type:q.value,source:z.value}})}),1e3)})).catch((()=>{J.value=!1,H.value=!1})))}))};return(a,l)=>{const t=g(y("u-input"),e),r=g(y("u-form-item"),V),s=x,f=g(y("u-switch"),k),b=g(y("u-textarea"),P),h=g(y("u-button"),$),A=g(y("u-form"),w),q=g(y("area-select"),C);return o(),d(s,{class:"px-[30rpx]",style:v(a.themeColor())},{default:u((()=>[i(A,{labelPosition:"left",model:U.value,labelWidth:"200rpx",errorType:"toast",rules:m(R),ref_key:"formRef",ref:T},{default:u((()=>[i(s,{class:"mt-[10rpx]"},{default:u((()=>[i(r,{label:m(j)("name"),prop:"name","border-bottom":!0},{default:u((()=>[i(t,{modelValue:U.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>U.value.name=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"25",placeholder:m(j)("namePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),i(s,{class:"mt-[10rpx]"},{default:u((()=>[i(r,{label:m(j)("mobile"),prop:"mobile","border-bottom":!0},{default:u((()=>[i(t,{modelValue:U.value.mobile,"onUpdate:modelValue":l[1]||(l[1]=e=>U.value.mobile=e),border:"none",clearable:"",placeholder:m(j)("mobilePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),i(s,{class:"mt-[10rpx]"},{default:u((()=>[i(r,{label:m(j)("selectArea"),prop:"area","border-bottom":!0,onClick:F},{default:u((()=>[U.value.area?(o(),d(s,{key:1,class:"text-[30rpx]"},{default:u((()=>[n(p(U.value.area),1)])),_:1})):(o(),d(s,{key:0,class:"text-gray-placeholder text-[30rpx]"},{default:u((()=>[n(p(m(j)("selectAreaPlaceholder")),1)])),_:1}))])),_:1},8,["label"])])),_:1}),i(s,{class:"mt-[10rpx]"},{default:u((()=>[i(r,{label:m(j)("address"),prop:"address","border-bottom":!0},{default:u((()=>[i(t,{modelValue:U.value.address,"onUpdate:modelValue":l[2]||(l[2]=e=>U.value.address=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"120",placeholder:m(j)("addressPlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),i(s,{class:"mt-[10rpx]"},{default:u((()=>[i(r,{label:m(j)("defaultAddress"),prop:"name","border-bottom":!0},{default:u((()=>[i(f,{modelValue:U.value.is_default,"onUpdate:modelValue":l[3]||(l[3]=e=>U.value.is_default=e),size:"20",activeValue:1,inactiveValue:0,activeColor:"var(--primary-color)"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),i(s,{class:"tk-card1 p-2 mt-4 mb-4"},{default:u((()=>[i(b,{clearable:"",border:"none",modelValue:E.value,"onUpdate:modelValue":l[4]||(l[4]=e=>E.value=e),height:"40",placeholder:"在此处输入粘贴地址可以快速自动识别",maxlength:"500",onKeydown:[c(a.handleEnter,["enter"]),c(_(a.handleShiftEnter,["shift"]),["enter"])],onPaste:M,autoHeight:""},null,8,["modelValue","onKeydown"]),i(s,{class:"flex justify-end tk-tag w-48px text-xs mt-1 ml-2",onClick:l[5]||(l[5]=e=>O())},{default:u((()=>[n("地址识别")])),_:1})])),_:1}),i(s,{class:"mt-[40rpx]"},{default:u((()=>[i(h,{type:"primary",shape:"circle",text:m(j)("save"),onClick:S,disabled:H.value,loading:J.value},null,8,["text","disabled","loading"])])),_:1})])),_:1},8,["model","rules"]),i(q,{ref_key:"areaRef",ref:K,onComplete:I,"area-id":U.value.district_id},null,8,["area-id"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-5efd7d77"]]);export{U as default};
