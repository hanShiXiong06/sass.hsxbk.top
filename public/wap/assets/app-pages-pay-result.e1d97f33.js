import{d as t,r as e,j as a,s,t as l,o,c as u,w as n,b as r,H as c,x as i,y as p,u as m,f as d,n as f,a as x,aS as y,C as _,i as v,g as h,h as j,$ as g}from"./index-656dc629.js";import{_ as b}from"./u-button.e2de732d.js";import{_ as w}from"./u-loading-icon.5e5c27a0.js";import{_ as C}from"./u-modal.5865d890.js";import{g as S}from"./pay.c96fa6a1.js";import"./u-icon.286409fc.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-line.144794ca.js";import"./u-popup.7e287da6.js";import"./u-transition.825c0e35.js";import"./u-safe-bottom.d9fa806b.js";const T=t({__name:"result",setup(t){const T=e(null),P=e(!1);let k="",z=0,F=0;a((t=>{k=t.trade_type,z=t.trade_id,L()}));const L=()=>{S(k,z).then((t=>{if(!uni.$u.test.isEmpty(t.data)){if(1==t.data.status&&F<5)return P.value=!0,F++,void setTimeout((()=>{L()}),1e3);T.value=t.data,P.value=!1,s({title:2==T.value.status?l("pay.paySuccess"):l("pay.payFail")})}})).catch((()=>{}))},R=()=>{var t;const e=decodeURIComponent(uni.getStorageSync("payReturn"));x(e?{url:e,mode:"reLaunch"}:{url:y(),param:{code:null==(t=T.value)?void 0:t.out_trade_no},mode:"reLaunch"})};return(t,e)=>{const a=_,s=v,x=h(j("u-button"),b),y=h(j("u-loading-icon"),w),S=h(j("u-modal"),C);return o(),u(s,{style:f(t.themeColor())},{default:n((()=>[T.value?(o(),u(s,{key:0,class:"w-screen h-screen flex flex-col items-center"},{default:n((()=>[r(s,{class:"flex-1 flex flex-col items-center w-full pt-[100rpx]"},{default:n((()=>[r(a,{class:c(["iconfont text-2xl",2==T.value.status?"text-primary iconduigou":"iconzhifushibai text-red"])},null,8,["class"]),r(s,{class:"text-sm"},{default:n((()=>[i(p(2==T.value.status?m(l)("pay.paySuccess"):m(l)("pay.payFail")),1)])),_:1}),r(s,{class:"text-xl font-bold pt-[30rpx]"},{default:n((()=>[r(a,{class:"text-base"},{default:n((()=>[i(p(m(l)("currency")),1)])),_:1}),r(a,null,{default:n((()=>[i(p(m(g)(T.value.money)),1)])),_:1})])),_:1})])),_:1}),r(s,{class:"pb-[200rpx] w-[240rpx]"},{default:n((()=>[r(x,{type:"primary",text:2==T.value.status?m(l)("complete"):m(l)("close"),plain:!0,onClick:R},null,8,["text"])])),_:1})])),_:1})):d("v-if",!0),r(S,{show:P.value,showCancelButton:!0,confirmText:m(l)("pay.completePay"),cancelText:m(l)("pay.incompletePay"),onCancel:R},{default:n((()=>[r(s,{class:"py-[20rpx]"},{default:n((()=>[r(y,{text:m(l)("pay.getting"),textSize:"16",mode:"circle",vertical:!0},null,8,["text"])])),_:1})])),_:1},8,["show","confirmText","cancelText"])])),_:1},8,["style"])}}});export{T as default};
