import{d as a,r as e,o as t,U as s,f as l,b as o,w as n,A as p,n as u,c as r,u as c,y as i,V as d,bx as f,bH as v,E as m,B as y,i as _,D as h,C as g,g as b,h as w,aA as x,_ as U}from"./index-71c7df08.js";const C=U(a({__name:"share-poster",props:{posterId:{type:String||Number,default:0},posterType:{type:String,default:""},posterParam:{type:Object,default:{}},copyUrl:{type:String,default:""},copyUrlParam:{type:String,default:""}},setup(a,{expose:U}){const C=a,S=e(!1),k=()=>{let a="";if(C.copyUrl){let e=location.pathname,t=["/app/","/addon/"];for(let a=0;a<t.length;a++)-1!=e.indexOf(t[a])&&(e=e.substr(0,e.indexOf(t[a])));a=location.origin+e+C.copyUrl+C.copyUrlParam}else a=location.origin+location.pathname+C.copyUrlParam;f(a,(()=>{S.value=!1}))},D=e(!1),O=e(!1),P=e(""),T=()=>{D.value=!0,O.value=!1;let a={id:C.posterId,type:C.posterType,param:C.posterParam},e=Date.parse(new Date);v(a).then((a=>{P.value=a.data&&m(a.data)||"";let t=Date.parse(new Date)-e;t<2200?setTimeout((()=>{D.value=!1,O.value=!0}),2200-t):(D.value=!1,O.value=!0)})).catch((()=>{A()}))},j=e(!1),I=()=>{j.value=!1},z=e(0),A=()=>{S.value=!1,D.value=!1,O.value=!1};return U({openShare:()=>{S.value=!0,T()}}),(a,e)=>{const f=y,v=_,U=h,C=g,T=b(w("u-popup"),x);return t(),s(d,null,[l(" 分享弹窗 "),o(v,{onTouchmove:e[2]||(e[2]=p((()=>{}),["prevent","stop"])),class:"share-popup"},{default:n((()=>[o(T,{show:S.value,type:"bottom",onClose:A,overlayOpacity:"0.8"},{default:n((()=>[o(v,{onTouchmove:e[0]||(e[0]=p((()=>{}),["prevent","stop"]))},{default:n((()=>[o(v,{class:"poster-img-wrap",style:u({top:z.value})},{default:n((()=>[D.value?(t(),r(f,{key:0,class:"poster-animation",src:c(m)("addon/shop/poster_animation.gif"),mode:"aspectFit"},null,8,["src"])):l("v-if",!0),O.value?(t(),r(f,{key:1,class:"poster-img",src:c(m)(P.value),mode:"aspectFit"},null,8,["src"])):l("v-if",!0)])),_:1},8,["style"]),o(v,{class:"share-content"},{default:n((()=>[o(v,{class:"share-box",onClick:k},{default:n((()=>[o(C,{class:"share-btn",plain:!0},{default:n((()=>[o(v,{class:"text-[#07c160] iconfont iconfuzhilianjie"}),o(U,null,{default:n((()=>[i("复制链接")])),_:1})])),_:1})])),_:1})])),_:1}),o(v,{class:"share-footer",onClick:A},{default:n((()=>[o(U,null,{default:n((()=>[i("取消分享")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"]),o(T,{show:j.value,mode:"center",round:10,closeable:!0,onClose:e[1]||(e[1]=a=>j.value=!1),"safe-area-inset-bottom":!1},{default:n((()=>[o(v,{class:"dialog-popup"},{default:n((()=>[o(v,{class:"title"},{default:n((()=>[i("提示")])),_:1}),o(v,{class:"message"},{default:n((()=>[i("您拒绝了保存图片到相册的授权请求，无法保存图片到相册，如需正常使用，请授权之后再进行操作。")])),_:1}),o(v,{class:"action-wrap"},{default:n((()=>[o(v,{onClick:I},{default:n((()=>[i("取消")])),_:1}),o(v,null,{default:n((()=>[o(C,{type:"default",class:"authorization-btn","open-type":"openSetting",onOpensetting:I,"hover-class":"none"},{default:n((()=>[i("立即授权")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})],2112)}}}),[["__scopeId","data-v-e5ec9b44"]]);export{C as s};
