import{d as e,r as t,T as l,o,c as r,w as a,u as s,b as i,W as c,f as d,A as u,U as n,ad as p,V as x,a as f,ab as _,g,h as v,D as m,i as h,ac as b,y as k,z as y,E as w,b7 as C,B as S,bl as F,b8 as j,_ as I,j as V,a4 as N,s as E,t as z,C as A,aV as L,bY as B,aA as O,l as R,e as T,v as D,n as M,ae as U,af as $,H,k as P,p as J,x as W,L as Y}from"./index-71c7df08.js";import{_ as G}from"./tabbar.a37cc2d9.js";import{c as K,i as Q,b as q,j as X}from"./goods.7a0dade1.js";import{M as Z}from"./mescroll-empty.95b8c17e.js";import{M as ee}from"./mescroll-body.49de0f6f.js";import{u as te}from"./useMescroll.26ccf5de.js";import{u as le}from"./cart.1ee162b9.js";import{b as oe}from"./bind-mobile.b7e673b6.js";import{f as re}from"./cloneDeep.77735539.js";import"./mescroll-i18n.00218d15.js";/* empty css                                                                       */import"./sms-code.vue_vue_type_script_setup_true_lang.e09e1c1f.js";/* empty css                                                                    */const ae=I(e({__name:"category-template-two-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const I=e;let V=I.config,N=I.categoryId;const E=t(""),z=t(!0);l((()=>{L()}));const A=t([]),L=()=>{z.value=!0,K().then((e=>{if(A.value=e.data,N)for(let t=0;t<A.value.length;t++){if(A.value[t].category_id==N){B.value=t;break}if(A.value[t].child_list)for(let e=0;e<A.value[t].child_list.length;e++)if(A.value[t].child_list[e].category_id==N){B.value=t;break}}z.value=!1})).catch((()=>{z.value=!1}))},B=t(0),O=()=>{E.value&&f({url:"/addon/phone_shop/pages/goods/list",param:{goods_name:E.value}})};return(e,t)=>{const l=_,I=g(v("u-icon"),C),N=m,L=h,R=b,T=S,D=g(v("u--image"),F),M=g(v("tabbar"),G),U=g(v("u-loading-page"),j);return o(),r(L,{class:"bg-[#F4F6F8] min-h-screen"},{default:a((()=>[A.value.length?(o(),r(L,{key:0,class:"mescroll-box"},{default:a((()=>[s(V).search.control?(o(),r(L,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[106rpx] box-border"},{default:a((()=>[i(l,{class:c(["search-ipt pl-[32rpx] text-[24rpx]",{"pr-[106rpx]":E.value,"pr-[32rpx]":!E.value}]),type:"text",modelValue:E.value,"onUpdate:modelValue":t[0]||(t[0]=e=>E.value=e),placeholder:s(V).search.title,onConfirm:O},null,8,["class","modelValue","placeholder"]),i(L,{class:"flex items-center h-[70rpx] absolute right-[56rpx] top-[18rpx] z-2"},{default:a((()=>[E.value?(o(),r(I,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:t[1]||(t[1]=e=>E.value="")})):d("v-if",!0),i(L,{class:"h-[70rpx] w-[40rpx] text-center leading-[70rpx]",onClick:u(O,["stop"])},{default:a((()=>[i(N,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx]"})])),_:1},8,["onClick"])])),_:1})])),_:1})):d("v-if",!0),i(L,{class:c(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[106rpx]":s(V).search.control}])},{default:a((()=>[i(R,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(L,{class:"bg-[#F4F6F8]"},{default:a((()=>[(o(!0),n(x,null,p(A.value,((e,t)=>(o(),r(L,{class:c(["tab-item truncate",{"tab-item-active":t==B.value,"rounded-br-[12rpx]":B.value-1===t,"rounded-tr-[12rpx]":B.value+1===t}]),key:t,onClick:e=>(e=>{B.value=e})(t)},{default:a((()=>[i(L,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(R,{class:"h-[100vh]","scroll-y":!0},{default:a((()=>[i(L,{class:c(["pl-[202rpx] scroll-ios pt-[20rpx] pr-[20rpx]",{"!pt-[126rpx]":s(V).search.control}])},{default:a((()=>{var e,t;return[(null==(e=A.value[B.value])?void 0:e.child_list)&&!z.value?(o(),r(L,{key:0,class:"bg-[#fff] grid grid-cols-3 gap-x-[50rpx] gap-y-[32rpx] py-[33rpx] px-[23rpx] rounded-[16rpx]"},{default:a((()=>{var e;return[(o(!0),n(x,null,p(null==(e=A.value[B.value])?void 0:e.child_list,((e,t)=>(o(),r(L,{key:e.category_id,class:"",onClick:t=>{return l=e.category_id,void f({url:"/addon/phone_shop/pages/goods/list",param:{curr_goods_category:l}});var l}},{default:a((()=>[i(D,{radius:"12rpx",width:"129rpx",height:"129rpx",src:s(w)(e.image?e.image:""),model:"aspectFill"},{error:a((()=>[i(T,{class:"rounded-[12rpx] overflow-hidden w-[129rpx] h-[129rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(L,{class:"text-[24rpx] text-center mt-[12rpx] leading-[34rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))]})),_:1})):d("v-if",!0),(null==(t=A.value[B.value])?void 0:t.child_list)||z.value?d("v-if",!0):(o(),r(L,{key:1,class:c(["flex justify-center w-[100%] rounded-[16rpx] flex items-center",{noData1:s(V).search.control,noData2:!s(V).search.control}])},{default:a((()=>[i(Z,{option:{tip:"暂无商品分类"}})])),_:1},8,["class"]))]})),_:1},8,["class"])])),_:1})])),_:1})):d("v-if",!0),i(M),A.value.length||z.value?d("v-if",!0):(o(),r(L,{key:1,class:"flex justify-center w-[100%] items-center justify-center h-[100vh]"},{default:a((()=>[i(Z,{option:{tip:"暂无商品分类"}})])),_:1})),i(U,{"bg-color":"rgb(248,248,248)",loading:z.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"])])),_:1})}}}),[["__scopeId","data-v-e90d35ae"]]),se=I(e({__name:"add-cart-popup",setup(e,{expose:l}){const f=le(),_=V((()=>f.cartList)),C=t(!1),j=t({skuId:"",name:[]}),I=t({}),R=t({}),T=t(1),D=()=>{C.value=!1},M=V((()=>{let e=JSON.parse(JSON.stringify(I.value));return Object.keys(e).length&&(Object.keys(j.value.name).length||(j.value.name=e.sku_spec_format.split(",")),e.goodsSpec.forEach(((e,t)=>{let l=e.spec_values.split(",");e.values=[],l.forEach(((l,o)=>{e.values[o]={},e.values[o].name=l,e.values[o].selected=!1,e.values[o].disabled=!1,j.value.name.forEach(((r,a)=>{a==t&&r==l&&(e.values[o].selected=!0)}))}))})),U(),e.skuList&&Object.keys(e.skuList).length&&e.skuList.forEach((e=>{e.sku_id==j.value.skuId&&(R.value=e)}))),e}));N((()=>R.value),((e,t)=>{_.value["goods_"+R.value.goods_id]&&_.value["goods_"+R.value.goods_id]["sku_"+R.value.sku_id]?(T.value=L(_.value["goods_"+R.value.goods_id]["sku_"+R.value.sku_id].num),R.value.cart_id=L(_.value["goods_"+R.value.goods_id]["sku_"+R.value.sku_id].id)):(T.value=1,R.value.cart_id="")}));const U=()=>{I.value.skuList.forEach(((e,t)=>{let l=e.sku_spec_format.split(",");j.value.name.every((e=>l.includes(e)))&&(j.value.skuId=e.sku_id)}))},$=()=>{if(0==T.value)f.reduce({id:R.value.cart_id||"",goods_id:R.value.goods_id,sale_price:R.value.sale_price,sku_id:R.value.sku_id});else{let e=0;e=M.value.goods.is_discount&&R.value.sale_price!=R.value.price?R.value.sale_price?R.value.sale_price:R.value.price:M.value.goods.member_discount&&E()&&R.value.member_price!=R.value.price&&R.value.member_price?R.value.member_price:R.value.price,f.increase({id:R.value.cart_id||"",goods_id:R.value.goods_id,sku_id:R.value.sku_id,stock:R.value.stock,sale_price:e,num:T.value},0,(()=>{z({title:"加入购物车成功",icon:"none"})}))}C.value=!1},H=e=>{let t="0.00";return t=M.value.goods.is_discount&&e.sale_price!=e.price?e.sale_price?e.sale_price:e.price:M.value.goods.member_discount&&E()&&e.member_price!=e.price&&e.member_price?e.member_price:e.price,t},P=e=>{let t="";return t=M.value.goods.is_discount&&e.sale_price!=e.price?"discount_price":M.value.goods.member_discount&&E()&&e.member_price!=e.price?"member_price":"",t};return l({open:e=>{(e=>{Q(e).then((t=>{I.value=t.data,j.value.sku_id=e,I.value.skuList&&Object.keys(I.value.skuList).length&&I.value.skuList.forEach((t=>{t.sku_id==e&&(R.value=t,j.value.name=t.sku_spec_format.split(","))})),C.value=!0}))})(e)}}),(e,t)=>{const l=S,f=g(v("u--image"),F),I=h,V=m,N=g(v("u-number-box"),B),E=b,z=A,L=g(v("u-popup"),O);return o(),r(I,{onTouchmove:t[3]||(t[3]=u((()=>{}),["prevent","stop"]))},{default:a((()=>[i(L,{show:C.value,onClose:D,mode:"bottom"},{default:a((()=>[Object.keys(s(M)).length?(o(),r(I,{key:0,onTouchmove:t[2]||(t[2]=u((()=>{}),["prevent","stop"])),class:"rounded-t-[20rpx] overflow-hidden bg-[#fff] p-[32rpx] relative"},{default:a((()=>[i(I,{class:"flex mb-[58rpx]"},{default:a((()=>[i(I,{class:"rounded-[8rpx] overflow-hidden"},{default:a((()=>[i(f,{width:"180rpx",height:"180rpx",src:s(w)(R.value.sku_image),model:"aspectFill"},{error:a((()=>[i(l,{class:"w-[180rpx] h-[180rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:1},8,["src"])])),_:1}),i(I,{class:"flex flex-1 flex-col ml-[20rpx] py-[10rpx]"},{default:a((()=>[i(I,{class:"w-[100%]"},{default:a((()=>[i(I,{class:"text-[var(--price-text-color)] flex items-baseline"},{default:a((()=>[i(V,{class:"text-[28rpx] font-bold price-font mr-[4rpx]"},{default:a((()=>[k("￥")])),_:1}),i(V,{class:"text-[42rpx] font-bold price-font"},{default:a((()=>[k(y(parseFloat(H(R.value)).toFixed(2).split(".")[0]),1)])),_:1}),i(V,{class:"text-[28rpx] font-bold price-font"},{default:a((()=>[k("."+y(parseFloat(H(R.value)).toFixed(2).split(".")[1]),1)])),_:1}),"member_price"==P(R.value)?(o(),r(l,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0),"discount_price"==P(R.value)?(o(),r(l,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0)])),_:1}),i(I,{class:"text-[24rpx] leading-[32rpx] text-[#303133] mt-[12rpx]"},{default:a((()=>[k("库存"+y(R.value.stock)+y(s(M).goods.unit),1)])),_:1})])),_:1}),s(M).goodsSpec&&s(M).goodsSpec.length?(o(),r(I,{key:0,class:"w-[100%] mt-auto",style:{"max-height":"calc(204rpx - 126rpx)",overflow:"hidden"}},{default:a((()=>[i(V,{class:"text-[24rpx] leading-[30rpx] text-[#666]"},{default:a((()=>[k("已选规格："+y(R.value.sku_spec_format),1)])),_:1})])),_:1})):d("v-if",!0)])),_:1})])),_:1}),i(E,{class:"h-[500rpx] mb-[30rpx]","scroll-y":"true"},{default:a((()=>[(o(!0),n(x,null,p(s(M).goodsSpec,((e,t)=>(o(),r(I,{class:c({"mt-[36rpx]":0!=t}),key:t},{default:a((()=>[i(I,{class:"text-[26rpx] leading-[36rpx] mb-[24rpx]"},{default:a((()=>[k(y(e.spec_name),1)])),_:2},1024),i(I,{class:"flex flex-wrap"},{default:a((()=>[(o(!0),n(x,null,p(e.values,((e,l)=>(o(),r(I,{class:c(["box-border bg-[#f2f2f2] text-[24rpx] px-[44rpx] text-center h-[56rpx] leading-[52rpx] mr-[20rpx] mb-[20rpx] border-1 border-solid rounded-[50rpx] border-[#f2f2f2]",{"!border-[var(--primary-color)] text-[var(--primary-color)] !bg-[var(--primary-color-light)]":e.selected}]),key:l,onClick:l=>((e,t)=>{j.value.name[t]=e.name,T.value=1})(e,t)},{default:a((()=>[k(y(e.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1032,["class"])))),128)),i(I,{class:"flex justify-between items-center mt-[30rpx]"},{default:a((()=>[i(I,{class:"text-[26rpx]"},{default:a((()=>[k("购买数量")])),_:1}),s(_)["goods_"+R.value.goods_id]&&s(_)["goods_"+R.value.goods_id]["sku_"+R.value.sku_id]?(o(),r(N,{key:0,modelValue:T.value,"onUpdate:modelValue":t[0]||(t[0]=e=>T.value=e),min:0,max:R.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(V,{class:c(["text-[34rpx] nc-iconfont nc-icon-jianV6xx",{"!text-[#c8c9cc]":0===T.value}])},null,8,["class"])])),input:a((()=>[i(V,{class:"text-[#303133] text-[24rpx] mx-[10rpx] min-w-[56rpx] h-[38rpx] leading-[40rpx] text-center border-[1rpx] border-solid border-[#ddd] rounded-[4rpx]"},{default:a((()=>[k(y(T.value),1)])),_:1})])),plus:a((()=>[i(V,{class:c(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx",{"!text-[#c8c9cc]":T.value===R.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"])):(o(),r(N,{key:1,modelValue:T.value,"onUpdate:modelValue":t[1]||(t[1]=e=>T.value=e),min:1,max:R.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(V,{class:c(["text-[34rpx] nc-iconfont nc-icon-jianV6xx",{"!text-[#c8c9cc]":1===T.value}])},null,8,["class"])])),input:a((()=>[i(V,{class:"text-[#303133] text-[24rpx] mx-[10rpx] min-w-[56rpx] h-[38rpx] leading-[40rpx] text-center border-[1rpx] border-solid border-[#ddd] rounded-[4rpx]"},{default:a((()=>[k(y(T.value),1)])),_:1})])),plus:a((()=>[i(V,{class:c(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx",{"!text-[#c8c9cc]":T.value===R.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"]))])),_:1})])),_:1}),R.value.stock>0?(o(),r(z,{key:0,class:"!h-[72rpx] primary-btn-bg leading-[72rpx] text-[26rpx] rounded-[50rpx]",type:"primary",onClick:$},{default:a((()=>[k("确定")])),_:1})):(o(),r(z,{key:1,class:"!h-[72rpx] leading-[72rpx] text-[26rpx] text-[#fff] bg-[#ccc] rounded-[50rpx]"},{default:a((()=>[k("已售罄")])),_:1}))])),_:1})):d("v-if",!0)])),_:1},8,["show"])])),_:1})}}}),[["__scopeId","data-v-582bd32f"]]),ie=I(e({__name:"category-template-one-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const I=e,N=le();N.getList();const L=V((()=>N.cartList)),B=V((()=>N.totalNum)),O=V((()=>N.totalMoney)),P=R(),J=V((()=>P.info)),{mescrollInit:W,getMescroll:Y}=te($,U);let Q=I.config,X=I.categoryId;const ae=t([]),ie=t(""),ce=t(!0),de=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const ue=e=>{de.value=!1,q({page:e.num,limit:e.size,keyword:"",goods_category:X,brand_id:"",label_ids:"",start_price:"",end_price:"",order:"price",sort:"desc"}).then((t=>{let l=t.data.data;1==e.num&&(ae.value=[]),ae.value=ae.value.concat(l),ce.value=!1,e.endSuccess(l.length),ae.value.length||(de.value=!0)})).catch((()=>{ce.value=!1,de.value=!0,e.endErr()}))},ne=e=>{f({url:"/addon/phone_shop/pages/goods/detail",param:{goods_id:e}})};l((()=>{ve()}));const pe=t(""),xe=t(!1),fe=t(!1),_e=(e,t)=>{if(xe.value||fe.value)return!1;xe.value=!0,fe.value=!0;let l={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:Fe(e),stock:e.goodsSku.stock};e.id&&(l.num=e.num,l.id=e.id),N.increase(l,1,(()=>{fe.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),l=e.getBoundingClientRect().left,o=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;pe.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{pe.value=`top: ${o+e.offsetHeight/2-r.offsetHeight/2}px; left: ${l+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{pe.value="",xe.value=!1}),1020)}),100)},ge=t([]),ve=()=>{ce.value=!0,K().then((e=>{if(ge.value=e.data,X)for(let t=0;t<ge.value.length;t++){if(ge.value[t].category_id==X){me.value=t;break}if(ge.value[t].child_list)for(let e=0;e<ge.value[t].child_list.length;e++)if(ge.value[t].child_list[e].category_id==X){me.value=t;break}}else X=e.data[0].category_id;ce.value=!1})).catch((()=>{ce.value=!1}))},me=t(0),he=()=>{ie.value&&f({url:"/addon/phone_shop/pages/goods/list",param:{goods_name:ie.value}})},be=t(null),ke=t(),ye=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return ne(e.goodsSku.goods_id);if("cart"!==Q.cart.event)return ne(e.goodsSku.goods_id);if(!J.value)return H().setLoginBack({url:"/addon/phone_shop/pages/goods/category"}),!1;if(uni.getStorageSync("isbindmobile"))return be.value.open(),!1;if(e.goodsSku.sku_spec_format)ke.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void z({title:"商品库存不足",icon:"none"});_e(e,t)}},we=()=>{f({url:"/addon/phone_shop/pages/goods/cart"})},Ce=()=>{if(uni.getStorageSync("isbindmobile"))return be.value.open(),!1;if(!B.value)return void z({title:"还没有选择商品",icon:"none"});const e=[];Object.values(L.value).forEach((t=>{Object.keys(t).forEach((l=>{"totalNum"!=l&&"totalMoney"!=l&&e.push(t[l].id)}))})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/phone_shop/pages/order/payment"})}})},Se=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&E()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},Fe=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&E()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const l=_,f=g(v("u-icon"),C),I=m,V=h,E=b,R=S,U=g(v("u--image"),F),$=A,H=g(v("u-loading-page"),j),P=g(v("tabbar"),G);return o(),r(V,{class:"min-h-screen"},{default:a((()=>[ge.value.length?(o(),r(V,{key:0,class:c(["mescroll-box bg-[#F4F6F8]",{cart:s(Q).cart.control&&"cart"===s(Q).cart.event,detail:!(s(Q).cart.control&&"cart"===s(Q).cart.event)}])},{default:a((()=>[i(ee,{ref:"mescrollRef",down:{use:!1},onInit:s(W),onUp:ue},{default:a((()=>[s(Q).search.control?(o(),r(V,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[106rpx] box-border"},{default:a((()=>[i(l,{class:c(["search-ipt pl-[32rpx] text-[24rpx]",{"pr-[106rpx]":ie.value,"pr-[32rpx]":!ie.value}]),type:"text",modelValue:ie.value,"onUpdate:modelValue":t[0]||(t[0]=e=>ie.value=e),placeholder:s(Q).search.title,onConfirm:he},null,8,["class","modelValue","placeholder"]),i(V,{class:"flex items-center h-[70rpx] absolute right-[56rpx] top-[18rpx] z-2"},{default:a((()=>[ie.value?(o(),r(f,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:t[1]||(t[1]=e=>ie.value="")})):d("v-if",!0),i(V,{class:"h-[70rpx] w-[40rpx] text-center leading-[70rpx]",onClick:u(he,["stop"])},{default:a((()=>[i(I,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx]"})])),_:1},8,["onClick"])])),_:1})])),_:1})):d("v-if",!0),i(V,{class:c(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[106rpx]":s(Q).search.control,"pb-[98rpx]":s(Q).cart.control&&"cart"===s(Q).cart.event}])},{default:a((()=>[i(E,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(V,{class:"bg-[#F4F6F8]"},{default:a((()=>[(o(!0),n(x,null,p(ge.value,((e,t)=>(o(),r(V,{class:c(["tab-item truncate",{"tab-item-active":t==me.value,"rounded-br-[12rpx]":me.value-1===t,"rounded-tr-[12rpx]":me.value+1===t}]),key:t,onClick:l=>((e,t)=>{me.value=e,X=t.category_id,ae.value=[],Y().resetUpScroll()})(t,e)},{default:a((()=>[i(V,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(V,{class:c(["flex justify-center flex-wrap pl-[182rpx] pb-[20rpx]",{" pt-[126rpx]":s(Q).search.control," pt-[20rpx]":!s(Q).search.control}])},{default:a((()=>[(o(!0),n(x,null,p(ae.value,((e,t)=>(o(),r(V,{key:e.goods_id,class:c(["w-[536rpx] box-border bg-white w-full flex mx-[16rpx] px-[24rpx] py-[20rpx] rounded-[12rpx]",{"mt-[16rpx]":t}]),onClick:u((t=>ne(e.goods_id)),["stop"])},{default:a((()=>[i(V,{class:"mr-[8rpx]"},{default:a((()=>[i(U,{width:"168rpx",height:"168rpx",radius:"12rpx",src:s(w)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(R,{class:"rounded-[12rpx] overflow-hidden w-[168rpx] h-[168rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"])])),_:2},1024),i(V,{class:"flex flex-1 ml-[8rpx] flex-wrap"},{default:a((()=>[i(V,{class:"w-[316rpx] max-h-[80rpx] text-[28rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),i(V,{class:"w-[316rpx] flex self-end items-end justify-between"},{default:a((()=>[i(V,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(I,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(I,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(Fe(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(I,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(Fe(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==Se(e)?(o(),r(R,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0),"discount_price"==Se(e)?(o(),r(R,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(Q).cart.control&&"cart"===s(Q).cart.event?(o(),r(V,{key:0,class:"flex items-center"},{default:a((()=>[i(I,{class:"text-[44rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:u((t=>(e=>{if(fe.value)return!1;fe.value=!0,N.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{fe.value=!1}))})(s(L)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(I,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(I,{class:"text-[44rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:u((l=>((e,t,l)=>{if(parseInt(t.num)>=parseInt(t.stock))return void z({title:"商品库存不足",icon:"none"});let o=re(e);o.num=t.num,o.id=t.id,_e(o,l)})(e,s(L)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(Q).cart.event||"real"==e.goods_type?(o(),n(x,{key:1},[s(Q).cart.control&&"style-1"===s(Q).cart.style?(o(),r(V,{key:0,class:"h-[44rpx] relative"},{default:a((()=>[i(V,{id:"itemCart"+t,class:"text-[#fff] bg-color h-[44rpx] text-[24rpx] px-[10px] leading-[44rpx] rounded-[22rpx]",onClick:u((l=>ye(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(Q).cart.text),1)])),_:2},1032,["id","onClick"]),s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id].totalNum?(o(),r(V,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(L)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(Q).cart.control&&"style-2"===s(Q).cart.style?(o(),r(V,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(I,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:u((l=>ye(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id].totalNum?(o(),r(V,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(L)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(Q).cart.control&&"style-3"===s(Q).cart.style?(o(),r(V,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(I,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:u((l=>ye(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id].totalNum?(o(),r(V,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(L)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(Q).cart.control&&"style-4"===s(Q).cart.style?(o(),r(V,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(V,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:u((l=>ye(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(I,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id].totalNum?(o(),r(V,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(L)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0)],64)):d("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),ae.value.length||ce.value||!de.value?d("v-if",!0):(o(),r(V,{key:0,class:c(["mx-[24rpx] w-[536rpx] rounded-[12rpx] flex items-center justify-center",{noData1:s(Q).search.control,noData2:!s(Q).search.control}])},{default:a((()=>[i(Z,{option:{tip:"暂无商品"}})])),_:1},8,["class"]))])),_:1},8,["class"]),i(se,{ref_key:"cartRef",ref:ke},null,512)])),_:1},8,["onInit"]),s(Q).cart.control&&"cart"===s(Q).cart.event?(o(),r(V,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios"},{default:a((()=>[i(V,{class:"flex items-center"},{default:a((()=>[i(V,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(V,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:u(we,["stop"])},{default:a((()=>[i(I,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(B)?(o(),r(V,{key:0,class:c(["absolute left-[50rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(B)>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(B)>99?"99+":s(B)),1)])),_:1},8,["class"])):d("v-if",!0)])),_:1}),i(I,{class:"text-[32rpx] font-500 text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(I,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(I,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(I,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(s(O)).toFixed(2).split(".")[0]),1)])),_:1}),i(I,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(s(O)).toFixed(2).split(".")[1]),1)])),_:1})])),_:1})])),_:1}),i($,{class:"w-[180rpx] h-[66rpx] text-[28rpx] leading-[66rpx] !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",shape:"circle",onClick:Ce},{default:a((()=>[k("去结算")])),_:1})])),_:1})):d("v-if",!0)])),_:1},8,["class"])):d("v-if",!0),T(i(V,{style:M(pe.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(I,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[D,pe.value]]),ge.value.length||ce.value?d("v-if",!0):(o(),r(V,{key:1,class:"flex justify-center items-center w-[100%] h-[100vh]"},{default:a((()=>[i(Z,{option:{tip:"暂无商品分类"}})])),_:1})),i(H,{"bg-color":"rgb(248,248,248)",loading:ce.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"]),i(P),d(" 强制绑定手机号 "),i(oe,{ref_key:"bindMobileRef",ref:be},null,512)])),_:1})}}}),[["__scopeId","data-v-9ff86bca"]]),ce=I(e({__name:"category-template-two-two",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const I=e,N=le();N.getList();const L=V((()=>N.cartList)),B=V((()=>N.totalNum)),J=V((()=>N.totalMoney)),W=R(),Y=V((()=>W.info)),{mescrollInit:Q,getMescroll:X}=te($,U);let ae=I.config,ie=I.categoryId;const ce=t([]),de=t(""),ue=t(!0),ne=t(!1),pe=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const xe=e=>{ne.value=!1,q({page:e.num,limit:e.size,keyword:"",goods_category:ie,brand_id:"",label_ids:"",start_price:"",end_price:"",order:"price",sort:"desc"}).then((t=>{let l=t.data.data;const o=new Date;l=l.map((e=>{const t=new Date(e.create_time),l=+o-+t<1728e5;return{...e,flag:l}})),1==e.num&&(ce.value=[]),ce.value=ce.value.concat(l),ue.value=!1,e.endSuccess(l.length),ce.value.length||(ne.value=!0)})).catch((()=>{ue.value=!1,ne.value=!0,e.endErr()}))},fe=e=>{f({url:"/addon/phone_shop/pages/goods/detail",param:{goods_id:e}})};l((()=>{be()}));const _e=t(""),ge=t(!1),ve=t(!1),me=(e,t)=>{if(ge.value||ve.value)return!1;ge.value=!0,ve.value=!0;let l={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:Ee(e),stock:e.goodsSku.stock};e.id&&(l.num=e.num,l.id=e.id),N.increase(l,1,(()=>{ve.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),l=e.getBoundingClientRect().left,o=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;_e.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{_e.value=`top: ${o+e.offsetHeight/2-r.offsetHeight/2}px; left: ${l+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{_e.value="",ge.value=!1}),1020)}),100)};t({allActive:-1,data:{category_name:"全部",category_id:""}});const he=t([]),be=()=>{ue.value=!0,K().then((e=>{he.value=e.data;for(let t=0;t<he.value.length;t++)if(he.value[t].child_list){let e={category_name:"全部",category_id:he.value[t].category_id};he.value[t].child_list.unshift(e)}if(ie)for(let t=0;t<he.value.length;t++){if(he.value[t].category_id==ie){ke.value=t;break}if(he.value[t].child_list)for(let e=0;e<he.value[t].child_list.length;e++)if(he.value[t].child_list[e].category_id==ie){ke.value=t,ye.value=e;break}}else ie=e.data[0].category_id;ue.value=!1})).catch((()=>{ue.value=!1}))},ke=t(0),ye=t(0),we=(e,t)=>{ye.value=e,ie=t.category_id,pe.value=!1,ce.value=[],X().resetUpScroll()},Ce=()=>{de.value&&f({url:"/addon/phone_shop/pages/goods/list",param:{goods_name:de.value}})};P();const Se=t(null),Fe=t(),je=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return fe(e.goodsSku.goods_id);if("cart"!==ae.cart.event)return fe(e.goods_id);if(!Y.value)return H().setLoginBack({url:"/addon/phone_shop/pages/goods/category"}),!1;if(uni.getStorageSync("isbindmobile"))return Se.value.open(),!1;if(e.goodsSku.sku_spec_format)Fe.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void z({title:"商品库存不足",icon:"none"});me(e,t)}},Ie=()=>{f({url:"/addon/phone_shop/pages/goods/cart"})},Ve=()=>{if(uni.getStorageSync("isbindmobile"))return Se.value.open(),!1;if(!B.value)return void z({title:"还没有选择商品",icon:"none"});const e=[];Object.values(L.value).forEach((t=>{Object.keys(t).forEach((l=>{"totalNum"!=l&&"totalMoney"!=l&&e.push(t[l].id)}))})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/phone_shop/pages/order/payment"})}})},Ne=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&E()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},Ee=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&E()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const l=_,f=g(v("u-icon"),C),I=m,V=h,E=b,R=g(v("u-popup"),O),U=g(v("u--image"),F),$=S,H=A,P=g(v("u-loading-page"),j),W=g(v("tabbar"),G);return o(),r(V,{class:"min-h-screen"},{default:a((()=>[he.value.length?(o(),r(V,{key:0,class:c(["mescroll-box bg-[#F4F6F8]",{cart:s(ae).cart.control&&"cart"===s(ae).cart.event,detail:!(s(ae).cart.control&&"cart"===s(ae).cart.event)}])},{default:a((()=>[i(ee,{ref:"mescrollRef",down:{use:!1},onInit:s(Q),onUp:xe},{default:a((()=>{var e,_,g,v,m,h;return[s(ae).search.control?(o(),r(V,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[106rpx] box-border"},{default:a((()=>[i(l,{class:c(["search-ipt pl-[32rpx] text-[24rpx]",{"pr-[106rpx]":de.value,"pr-[32rpx]":!de.value}]),type:"text",modelValue:de.value,"onUpdate:modelValue":t[0]||(t[0]=e=>de.value=e),placeholder:s(ae).search.title,onConfirm:Ce},null,8,["class","modelValue","placeholder"]),i(V,{class:"flex items-center h-[70rpx] absolute right-[56rpx] top-[18rpx] z-2"},{default:a((()=>[de.value?(o(),r(f,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:t[1]||(t[1]=e=>de.value="")})):d("v-if",!0),i(V,{class:"h-[70rpx] w-[40rpx] text-center leading-[70rpx]",onClick:u(Ce,["stop"])},{default:a((()=>[i(I,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx]"})])),_:1},8,["onClick"])])),_:1})])),_:1})):d("v-if",!0),i(V,{class:c(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[106rpx]":s(ae).search.control,"pb-[98rpx]":s(ae).cart.control&&"cart"===s(ae).cart.event}])},{default:a((()=>[i(E,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(V,{class:"bg-[#F4F6F8]"},{default:a((()=>[(o(!0),n(x,null,p(he.value,((e,t)=>(o(),r(V,{class:c(["tab-item truncate",{"tab-item-active ":t==ke.value,"rounded-br-[12rpx]":!(ke.value-1!==t||he.value[ke.value].child_list&&he.value[ke.value].child_list.length),"rounded-tr-[12rpx]":!(ke.value+1!==t||he.value[ke.value].child_list&&he.value[ke.value].child_list.length)}]),key:t,onClick:l=>((e,t)=>{ke.value=e,t.child_list&&t.child_list.length?we(0,t.child_list[0]):(ie=t.category_id,ce.value=[],X().resetUpScroll())})(t,e)},{default:a((()=>[i(V,{class:"text-box truncate px-[24rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),(null==(e=he.value[ke.value])?void 0:e.child_list)&&(null==(_=he.value[ke.value])?void 0:_.child_list.length)?(o(),r(V,{key:1,class:c(["flex justify-center items-center h-[92rpx] px-[24rpx] py-[20rpx] z-10 bg-white fixed left-[182rpx] right-0 box-border top-0",{"!top-[106rpx]":s(ae).search.control}])},{default:a((()=>[pe.value?(o(),n(x,{key:1},[i(V,{class:"flex-1 h-[48rpx] text-[22rpx] text-[#A5A6A6] pr-[24rpx] leading-[48rpx]"},{default:a((()=>[k("全部分类 ")])),_:1}),i(I,{class:"nc-iconfont nc-icon-shangV6xx-1 text-[30rpx]",onClick:t[3]||(t[3]=e=>pe.value=!1)})],64)):(o(),n(x,{key:0},[i(E,{"scroll-x":!0,"scroll-with-animation":"","scroll-into-view":"id"+(ye.value?ye.value-1:0),class:"flex-1 h-[49rpx] scroll-Y box-border pr-[24rpx] bg-white"},{default:a((()=>[i(V,{class:"flex items-center h-[48rpx] box-border"},{default:a((()=>{var e;return[(o(!0),n(x,null,p(null==(e=he.value[ke.value])?void 0:e.child_list,((e,t)=>(o(),r(I,{class:c(["flex-shrink-0 ml-[24rpx] px-[24rpx] h-[48rpx] text-[22rpx] leading-[44rpx] border-[2rpx] border-solid rounded-[24rpx] box-border",{"sub-tab-active text-color border-color":t===ye.value,"border-[#E2E2E2]":t!=ye.value}]),key:he.value[ke.value].category_id,id:"id"+t,onClick:l=>we(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","id","onClick"])))),128))]})),_:1})])),_:1},8,["scroll-into-view"]),i(V,{class:"nc-iconfont nc-icon-xiaV6xx text-[30rpx] w-[30rpx] h-[30rpx] text-center transform",onClick:t[2]||(t[2]=e=>pe.value=!0)})],64))])),_:1},8,["class"])):d("v-if",!0),i(V,{class:c(["labelPopup",{active:s(ae).search.control}])},{default:a((()=>[i(R,{show:pe.value,mode:"top",onClose:t[5]||(t[5]=e=>pe.value=!1)},{default:a((()=>[i(V,{class:"flex flex-wrap py-[24rpx]",onTouchmove:t[4]||(t[4]=u((()=>{}),["prevent","stop"]))},{default:a((()=>{var e;return[d(' <text\r\n\t\t\t\t\t\t\t\tclass="flex-shrink-0 w-[160rpx] ml-[22rpx] mb-[24rpx] text-center h-[48rpx] text-[22rpx] leading-[48rpx] border-[2rpx] border-solid rounded-[24rpx] box-border"\r\n\t\t\t\t\t\t\t\t:class="{ \'sub-tab-active text-color border-color\': initAll.allActive === subActive, \'border-[#E2E2E2]\': initAll.allActive != subActive }"\r\n\t\t\t\t\t\t\t\t @click="subMenuClick(initAll.allActive,initAll.data)">全部</text> '),(o(!0),n(x,null,p(null==(e=he.value[ke.value])?void 0:e.child_list,((e,t)=>(o(),r(I,{class:c(["flex-shrink-0 w-auto pl-2 pr-2 ml-[22rpx] mb-[24rpx] text-center h-[48rpx] text-[22rpx] leading-[48rpx] border-[2rpx] border-solid rounded-[24rpx] box-border",{"sub-tab-active text-color border-color":t===ye.value,"border-[#E2E2E2]":t!=ye.value}]),key:he.value[ke.value].category_id,onClick:l=>we(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1},8,["show"])])),_:1},8,["class"]),i(V,{class:c(["flex justify-center flex-wrap pl-[182rpx] pt-[20rpx] pb-[20rpx]",{"!pt-[218rpx]":s(ae).search.control&&(null==(g=he.value[ke.value])?void 0:g.child_list)&&(null==(v=he.value[ke.value])?void 0:v.child_list.length),"pt-[126rpx]":s(ae).search.control&&(!he.value[ke.value].child_list||!he.value[ke.value].child_list.length),"pt-[112rpx]":(null==(m=he.value[ke.value])?void 0:m.child_list)&&(null==(h=he.value[ke.value])?void 0:h.child_list.length)&&!s(ae).search.control}])},{default:a((()=>{var e,t,l,_;return[(o(!0),n(x,null,p(ce.value,((e,t)=>(o(),r(V,{key:e.goods_id,class:c(["w-[536rpx] box-border bg-white w-full flex mx-[16rpx] px-[24rpx] py-[20rpx] rounded-[12rpx]",{"mt-[16rpx]":t}]),onClick:u((t=>fe(e.goods_id)),["stop"])},{default:a((()=>[i(V,{class:"overflow-hidden mr-[8rpx] rounded-md position-r"},{default:a((()=>[i(V,{class:"position-a"},{default:a((()=>[e.flag?(o(),r(U,{key:0,class:"position-a",width:"58rpx",height:"28rpx",src:"https://vip.123pan.cn/1832133965/tiantai/1717078717e95d5ba5e4287e7131ff27478e746976_ott.png",model:"aspectFill"})):d("v-if",!0)])),_:2},1024),i(V,{class:"position-b"},{default:a((()=>[i(U,{width:"168rpx",height:"168rpx",src:s(w)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(f,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024)])),_:2},1024),i(V,{class:"flex flex-1 flex-wrap"},{default:a((()=>[i(V,{class:"w-[316rpx] max-h-[80rpx] text-[28rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),e.sub_title?(o(),r(V,{key:0,class:"w-[316rpx] max-h-[80rpx] text-[20rpx] leading-[40rpx] truncate"},{default:a((()=>[k(y(e.sub_title),1)])),_:2},1024)):d("v-if",!0),e.goodsSku.sku_no?(o(),r(V,{key:1,class:"w-[316rpx] max-h-[80rpx] text-[20rpx] leading-[40rpx] truncate"},{default:a((()=>[k(" sn: "+y(e.goodsSku.sku_no),1)])),_:2},1024)):d("v-if",!0),i(V,{class:"w-[316rpx] flex self-end items-end justify-between"},{default:a((()=>[i(V,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(I,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(I,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(Ee(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(I,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(Ee(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==Ne(e)?(o(),r($,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0),"discount_price"==Ne(e)?(o(),r($,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(ae).cart.control&&"cart"===s(ae).cart.event?(o(),r(V,{key:0,class:"flex items-center"},{default:a((()=>[i(I,{class:"text-[44rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:u((t=>(e=>{if(ve.value)return!1;ve.value=!0,N.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{ve.value=!1}))})(s(L)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(I,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(I,{class:"text-[44rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:u((l=>((e,t,l)=>{if(parseInt(t.num)>=parseInt(t.stock))return void z({title:"商品库存不足",icon:"none"});let o=re(e);o.num=t.num,o.id=t.id,me(o,l)})(e,s(L)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(ae).cart.event||"real"==e.goods_type?(o(),n(x,{key:1},[s(ae).cart.control&&"style-1"===s(ae).cart.style?(o(),r(V,{key:0,class:"h-[44rpx] relative pl-[20rpx]"},{default:a((()=>[i(V,{id:"itemCart"+t,class:"text-[#fff] bg-color h-[44rpx] text-[24rpx] px-[10px] leading-[44rpx] rounded-[22rpx]",onClick:u((l=>je(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(ae).cart.text),1)])),_:2},1032,["id","onClick"]),s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id].totalNum?(o(),r(V,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(L)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ae).cart.control&&"style-2"===s(ae).cart.style?(o(),r(V,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(I,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:u((l=>je(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id].totalNum?(o(),r(V,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(L)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ae).cart.control&&"style-3"===s(ae).cart.style?(o(),r(V,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(I,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:u((l=>je(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id].totalNum?(o(),r(V,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(L)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ae).cart.control&&"style-4"===s(ae).cart.style?(o(),r(V,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(V,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:u((l=>je(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(I,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(L)["goods_"+e.goods_id]&&s(L)["goods_"+e.goods_id].totalNum?(o(),r(V,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(L)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(L)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0)],64)):d("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),ce.value.length||ue.value||!ne.value?d("v-if",!0):(o(),r(V,{key:0,class:c(["w-[536rpx] mx-[16rpx] rounded-[12rpx] flex items-center justify-center",{noData1:s(ae).search.control,noData2:!s(ae).search.control,child:(null==(e=he.value[ke.value])?void 0:e.child_list)&&(null==(t=he.value[ke.value])?void 0:t.child_list.length),noChild:!(null==(l=he.value[ke.value])?void 0:l.child_list)||!(null==(_=he.value[ke.value])?void 0:_.child_list.length)}])},{default:a((()=>[i(Z,{option:{tip:"暂无商品"}})])),_:1},8,["class"]))]})),_:1},8,["class"]),i(se,{ref_key:"cartRef",ref:Fe},null,512)]})),_:1},8,["onInit"]),s(ae).cart.control&&"cart"===s(ae).cart.event?(o(),r(V,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios"},{default:a((()=>[i(V,{class:"flex items-center"},{default:a((()=>[i(V,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(V,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:u(Ie,["stop"])},{default:a((()=>[i(I,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(B)?(o(),r(V,{key:0,class:c(["absolute left-[50rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(B)>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(B)>99?"99+":s(B)),1)])),_:1},8,["class"])):d("v-if",!0)])),_:1}),i(I,{class:"text-[32rpx] font-500 text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(I,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(I,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(I,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(s(J)).toFixed(2).split(".")[0]),1)])),_:1}),i(I,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(s(J)).toFixed(2).split(".")[1]),1)])),_:1})])),_:1})])),_:1}),i(H,{class:"w-[180rpx] h-[66rpx] text-[28rpx] leading-[66rpx] !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",shape:"circle",onClick:Ve},{default:a((()=>[k("去结算")])),_:1})])),_:1})):d("v-if",!0)])),_:1},8,["class"])):d("v-if",!0),T(i(V,{style:M(_e.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(I,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[D,_e.value]]),he.value.length||ue.value?d("v-if",!0):(o(),r(V,{key:1,class:"flex justify-center items-center w-[100%]"},{default:a((()=>[i(Z,{option:{tip:"暂无商品分类"}})])),_:1})),i(P,{"bg-color":"rgb(248,248,248)",loading:ue.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"]),i(W),d(" 强制绑定手机号 "),i(oe,{ref_key:"bindMobileRef",ref:Se},null,512)])),_:1})}}}),[["__scopeId","data-v-25c58f1c"]]),de=I(e({__name:"category",setup(e){const l=R(),s=V((()=>l.info)),i=le(),c=t({}),u=t(0);return J((e=>{if(!s.value){let e=uni.getStorageSync("pid");e&&e>0?H().setLoginBack({url:"/addon/phone_shop/pages/goods/category?mid="+e}):H().setLoginBack({url:"/addon/phone_shop/pages/goods/category"})}u.value=e.category_id||0,X().then((e=>{c.value=e.data,Y({title:c.value.page_title})}))})),W((()=>{i.getList()})),(e,t)=>{const l=h;return o(),r(l,{style:M(e.themeColor())},{default:a((()=>[1===c.value.level&&"style-1"===c.value.template?(o(),r(ie,{key:0,class:"category",categoryId:u.value,config:c.value},null,8,["categoryId","config"])):d("v-if",!0),2===c.value.level&&"style-1"===c.value.template?(o(),r(ae,{key:1,categoryId:u.value,config:c.value},null,8,["categoryId","config"])):d("v-if",!0),2===c.value.level&&"style-2"===c.value.template?(o(),r(ce,{key:2,class:"category",categoryId:u.value,config:c.value},null,8,["categoryId","config"])):d("v-if",!0)])),_:1},8,["style"])}}}),[["__scopeId","data-v-3cd2179b"]]);export{de as default};
