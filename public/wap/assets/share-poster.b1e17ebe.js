import{d as e,r as a,o as t,I as s,f as o,b as l,w as p,u as n,Y as r,n as u,c,y as i,bw as d,K as f,bx as _,by as m,l as y,Q as v,i as h,D as g,E as b,g as w,h as x}from"./index-d8a8f699.js";import{_ as S}from"./u-popup.0d48946e.js";import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";const j=U(e({__name:"share-poster",props:{posterId:{type:String||Number,default:0},posterType:{type:String,default:""},posterParam:{type:Object,default:{}},copyUrl:{type:String,default:""},copyUrlParam:{type:String,default:""}},setup(e,{expose:U}){const j=e;let k=a(!1);const C=()=>{let e="";e=j.copyUrl?location.origin+j.copyUrl+j.copyUrlParam:location.origin+location.pathname+j.copyUrlParam,_(e,(()=>{k.value=!1}))};let D=a(!1),P=a(!1),T=a("");const I=()=>{D.value=!0,P.value=!1;let e={id:j.posterId,type:j.posterType,param:j.posterParam},a=Date.parse(new Date);m(e).then((e=>{T.value=e.data&&y(e.data)||"";let t=Date.parse(new Date)-a;t<2200?setTimeout((()=>{D.value=!1,P.value=!0}),2200-t):(D.value=!1,P.value=!0)})).catch((()=>{E()}))};let O=a(!1);const z=()=>{O.value=!1};let F=a(0);const E=()=>{k.value=!1,D.value=!1,P.value=!1};return U({openShare:()=>{k.value=!0,I()}}),(e,a)=>{const _=v,m=h,U=g,j=b,I=w(x("u-popup"),S);return t(),s(f,null,[o(" 分享弹窗 "),l(m,{onTouchmove:a[2]||(a[2]=r((()=>{}),["prevent","stop"])),class:"share-popup"},{default:p((()=>[l(I,{show:n(k),type:"bottom",onClose:E,overlayOpacity:"0.8"},{default:p((()=>[l(m,{onTouchmove:a[0]||(a[0]=r((()=>{}),["prevent","stop"]))},{default:p((()=>[l(m,{class:"poster-img-wrap",style:u({top:n(F)})},{default:p((()=>[n(D)?(t(),c(_,{key:0,class:"poster-animation",src:n(y)("addon/shop/poster_animation.gif"),mode:"aspectFit"},null,8,["src"])):o("v-if",!0),n(P)?(t(),c(_,{key:1,class:"poster-img",src:n(y)(n(T)),mode:"aspectFit"},null,8,["src"])):o("v-if",!0)])),_:1},8,["style"]),l(m,{class:"share-content"},{default:p((()=>[l(m,{class:"share-box",onClick:C},{default:p((()=>[l(j,{class:"share-btn",plain:!0},{default:p((()=>[l(m,{class:"text-[#07c160] iconfont iconfuzhilianjie"}),l(U,null,{default:p((()=>[i("复制链接")])),_:1})])),_:1})])),_:1})])),_:1}),l(m,{class:"share-footer",onClick:E},{default:p((()=>[l(U,null,{default:p((()=>[i("取消分享")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"]),l(I,{show:n(O),mode:"center",round:10,closeable:!0,onClose:a[1]||(a[1]=e=>d(O)?O.value=!1:O=!1),"safe-area-inset-bottom":!1},{default:p((()=>[l(m,{class:"dialog-popup"},{default:p((()=>[l(m,{class:"title"},{default:p((()=>[i("提示")])),_:1}),l(m,{class:"message"},{default:p((()=>[i("您拒绝了保存图片到相册的授权请求，无法保存图片到相册，如需正常使用，请授权之后再进行操作。")])),_:1}),l(m,{class:"action-wrap"},{default:p((()=>[l(m,{onClick:z},{default:p((()=>[i("取消")])),_:1}),l(m,null,{default:p((()=>[l(j,{type:"default",class:"authorization-btn","open-type":"openSetting",onOpensetting:z,"hover-class":"none"},{default:p((()=>[i("立即授权")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})],2112)}}}),[["__scopeId","data-v-43f05d69"]]);export{j as _};
