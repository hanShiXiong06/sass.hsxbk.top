import{d as e,r as a,p as l,aR as t,j as r,o as d,c as s,w as o,b as u,u as i,y as n,z as m,cw as c,A as p,n as v,aQ as b,aT as f,a as _,g as h,h as g,i as y,F as x,Q as V,R as k,aU as P,cs as j,bX as w,S as U,_ as $}from"./index-71c7df08.js";import{_ as C}from"./area-select.vue_vue_type_script_setup_true_lang.8205cddf.js";import{f as A}from"./tkjhkd.b2eaaef1.js";const E=$(e({__name:"address_edit",setup(e){const $=a(),E=a({id:0,name:"",mobile:"",province_id:0,city_id:0,district_id:0,address:"",full_address:"",is_default:0,area:"",type:"address"}),T=a(),R=a(null),q=a(""),z=a(""),K=a(!1),M=()=>{setTimeout((()=>{O()}),500)},O=()=>{$.value?A({address:$.value}).then((e=>{Object.assign(E.value,e.data),uni.$u.toast("地址解析成功"),$.value=""})):uni.$u.toast("请填写解析地址")};l((e=>{e.id&&t(e.id).then((({data:e})=>{e&&Object.assign(E.value,e)})).catch(),q.value=e.type||"",z.value=e.source||""}));const Q=r((()=>({name:{type:"string",required:!0,message:x("namePlaceholder"),trigger:["blur","change"]},mobile:[{type:"string",required:!0,message:x("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,a,l){/^1[3-9]\d{9}$/.test(a)?l():l(new Error(x("mobileError")))}}],area:{validator:()=>!uni.$u.test.isEmpty(E.value.area),message:x("selectAreaPlaceholder")},address:{type:"string",required:!0,message:x("addressPlaceholder"),trigger:["blur","change"]}}))),S=()=>{T.value.open()},F=e=>{E.value.province_id=e.province.id||0,E.value.city_id=e.city.id||0,E.value.district_id=e.district.id||0,E.value.area=`${e.province.name||""}${e.city.name||""}${e.district.name||""}`},H=a(!1),I=()=>{const e=E.value.id?b:f;R.value.validate().then((()=>{H.value||(H.value=!0,K.value=!0,E.value.full_address=E.value.area+E.value.address,e(E.value).then((e=>{H.value=!1,setTimeout((()=>{K.value=!1,_({url:"/addon/tk_jhkd/pages/address/address",mode:"redirectTo",param:{type:q.value,source:z.value}})}),1e3)})).catch((()=>{H.value=!1,K.value=!1})))}))};return(e,a)=>{const l=h(g("u-input"),V),t=h(g("u-form-item"),k),r=y,b=h(g("u-switch"),P),f=h(g("u-textarea"),j),_=h(g("u-button"),w),A=h(g("u-form"),U),q=h(g("area-select"),C);return d(),s(r,{class:"px-[30rpx]",style:v(e.themeColor())},{default:o((()=>[u(A,{labelPosition:"left",model:E.value,labelWidth:"200rpx",errorType:"toast",rules:i(Q),ref_key:"formRef",ref:R},{default:o((()=>[u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(x)("name"),prop:"name","border-bottom":!0},{default:o((()=>[u(l,{modelValue:E.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>E.value.name=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"25",placeholder:i(x)("namePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(x)("mobile"),prop:"mobile","border-bottom":!0},{default:o((()=>[u(l,{modelValue:E.value.mobile,"onUpdate:modelValue":a[1]||(a[1]=e=>E.value.mobile=e),border:"none",clearable:"",placeholder:i(x)("mobilePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(x)("selectArea"),prop:"area","border-bottom":!0,onClick:S},{default:o((()=>[E.value.area?(d(),s(r,{key:1,class:"text-[30rpx]"},{default:o((()=>[n(m(E.value.area),1)])),_:1})):(d(),s(r,{key:0,class:"text-gray-placeholder text-[30rpx]"},{default:o((()=>[n(m(i(x)("selectAreaPlaceholder")),1)])),_:1}))])),_:1},8,["label"])])),_:1}),u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(x)("address"),prop:"address","border-bottom":!0},{default:o((()=>[u(l,{modelValue:E.value.address,"onUpdate:modelValue":a[2]||(a[2]=e=>E.value.address=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"120",placeholder:i(x)("addressPlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),u(r,{class:"mt-[10rpx]"},{default:o((()=>[u(t,{label:i(x)("defaultAddress"),prop:"name","border-bottom":!0},{default:o((()=>[u(b,{modelValue:E.value.is_default,"onUpdate:modelValue":a[3]||(a[3]=e=>E.value.is_default=e),size:"20",activeValue:1,inactiveValue:0,activeColor:"var(--primary-color)"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),u(r,{class:"tk-card1 p-2 mt-4 mb-4"},{default:o((()=>[u(f,{clearable:"",border:"none",modelValue:$.value,"onUpdate:modelValue":a[4]||(a[4]=e=>$.value=e),height:"40",placeholder:"在此处输入粘贴地址可以快速自动识别",maxlength:"240",onKeydown:[c(e.handleEnter,["enter"]),c(p(e.handleShiftEnter,["shift"]),["enter"])],onPaste:M,autoHeight:""},null,8,["modelValue","onKeydown"]),u(r,{class:"flex justify-end tk-tag w-48px text-xs mt-1 ml-2",onClick:a[5]||(a[5]=e=>O())},{default:o((()=>[n("地址识别")])),_:1})])),_:1}),u(r,{class:"mt-[40rpx]"},{default:o((()=>[u(_,{type:"primary",shape:"circle",text:i(x)("save"),onClick:I,disabled:K.value,loading:H.value},null,8,["text","disabled","loading"])])),_:1})])),_:1},8,["model","rules"]),u(q,{ref_key:"areaRef",ref:T,onComplete:F,"area-id":E.value.district_id},null,8,["area-id"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-24ffcf79"]]);export{E as default};
