import{d as a,r as e,o as t,E as s,f as o,b as l,w as p,u as n,_ as r,n as u,c,x as i,aN as d,G as f,bv as m,bw as _,V as v,N as y,i as h,C as g,ab as b,g as w,h as x}from"./index-656dc629.js";import{_ as C}from"./u-popup.7e287da6.js";import{_ as S}from"./_plugin-vue_export-helper.1b428a4d.js";const U=S(a({__name:"share-poster",props:{posterId:{type:String||Number,default:0},posterType:{type:String,default:""},posterParam:{type:Object,default:{}},copyUrl:{type:String,default:""},copyUrlParam:{type:String,default:""}},setup(a,{expose:S}){const U=a;let j=e(!1);const k=()=>{let a="";a=U.copyUrl?location.origin+U.copyUrl+U.copyUrlParam:location.origin+location.pathname+U.copyUrlParam,m(a,(()=>{j.value=!1}))};let P=e(!1),T=e(!1),D=e("");const I=()=>{P.value=!0,T.value=!1;let a={id:U.posterId,type:U.posterType,param:U.posterParam},e=Date.parse(new Date);_(a).then((a=>{D.value=a.data&&v(a.data)||"";let t=Date.parse(new Date)-e;t<2200?setTimeout((()=>{P.value=!1,T.value=!0}),2200-t):(P.value=!1,T.value=!0)})).catch((()=>{F()}))};let N=e(!1);const O=()=>{N.value=!1};let z=e(0);const F=()=>{j.value=!1,P.value=!1,T.value=!1};return S({openShare:()=>{j.value=!0,I()}}),(a,e)=>{const m=y,_=h,S=g,U=b,I=w(x("u-popup"),C);return t(),s(f,null,[o(" 分享弹窗 "),l(_,{onTouchmove:e[2]||(e[2]=r((()=>{}),["prevent","stop"])),class:"share-popup"},{default:p((()=>[l(I,{show:n(j),type:"bottom",onClose:F,overlayOpacity:"0.8"},{default:p((()=>[l(_,{onTouchmove:e[0]||(e[0]=r((()=>{}),["prevent","stop"]))},{default:p((()=>[l(_,{class:"poster-img-wrap",style:u({top:n(z)})},{default:p((()=>[n(P)?(t(),c(m,{key:0,class:"poster-animation",src:n(v)("addon/shop/poster_animation.gif"),mode:"aspectFit"},null,8,["src"])):o("v-if",!0),n(T)?(t(),c(m,{key:1,class:"poster-img",src:n(v)(n(D)),mode:"aspectFit"},null,8,["src"])):o("v-if",!0)])),_:1},8,["style"]),l(_,{class:"share-content"},{default:p((()=>[l(_,{class:"share-box",onClick:k},{default:p((()=>[l(U,{class:"share-btn",plain:!0},{default:p((()=>[l(_,{class:"text-[#07c160] iconfont iconfuzhilianjie"}),l(S,null,{default:p((()=>[i("复制链接")])),_:1})])),_:1})])),_:1})])),_:1}),l(_,{class:"share-footer",onClick:F},{default:p((()=>[l(S,null,{default:p((()=>[i("取消分享")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"]),l(I,{show:n(N),mode:"center",round:10,closeable:!0,onClose:e[1]||(e[1]=a=>d(N)?N.value=!1:N=!1),"safe-area-inset-bottom":!1},{default:p((()=>[l(_,{class:"dialog-popup"},{default:p((()=>[l(_,{class:"title"},{default:p((()=>[i("提示")])),_:1}),l(_,{class:"message"},{default:p((()=>[i("您拒绝了保存图片到相册的授权请求，无法保存图片到相册，如需正常使用，请授权之后再进行操作。")])),_:1}),l(_,{class:"action-wrap"},{default:p((()=>[l(_,{onClick:O},{default:p((()=>[i("取消")])),_:1}),l(_,null,{default:p((()=>[l(U,{type:"default",class:"authorization-btn","open-type":"openSetting",onOpensetting:O,"hover-class":"none"},{default:p((()=>[i("立即授权")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})],2112)}}}),[["__scopeId","data-v-0d6fbaf2"]]);export{U as s};
