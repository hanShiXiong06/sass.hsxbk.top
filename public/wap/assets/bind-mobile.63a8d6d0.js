import{d as e,r as l,m as a,p as o,q as r,t,x as s,o as i,c as n,w as d,b as p,y as u,z as m,u as c,f as b,Y as g,A as x,i as f,a1 as _,g as h,h as v,D as y,E as k,a as S,F as w}from"./index-d8a8f699.js";import{_ as j,a as V}from"./u-form.11d92cf8.js";import{_ as C}from"./sms-code.vue_vue_type_script_setup_true_lang.ce239318.js";import{_ as T,a as A}from"./u-checkbox-group.00090a01.js";import{_ as P}from"./u-popup.0d48946e.js";import{_ as z}from"./_plugin-vue_export-helper.1b428a4d.js";const B=z(e({__name:"bind-mobile",setup(e,{expose:z}){const B=l(!1),I=a(),q=o((()=>I.info)),E=o((()=>w().login));l(null);const O=l(!1),U=l(!1),M=r({mobile:"",mobile_code:"",mobile_key:""});let D=l(!0);t((()=>{setTimeout((()=>{D.value=!1}),800)})),uni.getStorageSync("openid")&&Object.assign(M,{openid:uni.getStorageSync("openid")}),uni.getStorageSync("pid")&&Object.assign(M,{pid:uni.getStorageSync("pid")}),uni.getStorageSync("unionid")&&Object.assign(M,{unionid:uni.getStorageSync("unionid")});const F={mobile:[{type:"string",required:!0,message:s("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,l,a){/^1[3-9]\d{9}$/.test(l)?a():a(new Error("请输入正确的手机号"))},message:s("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:s("codePlaceholder"),trigger:["blur","change"]}},R=()=>{U.value=!U.value},W=l(null),Y=()=>{W.value.validate().then((()=>{O.value||(O.value=!0,x(M).then((e=>{I.getMemberInfo(),q.value.mobile&&uni.removeStorageSync("isbindmobile"),B.value=!1})).catch((()=>{O.value=!1})))}))};return z({open:()=>{B.value=!0}}),(e,l)=>{const a=f,o=_,r=h(v("u-form-item"),j),t=h(v("sms-code"),C),x=h(v("u-checkbox"),T),w=h(v("u-checkbox-group"),A),z=y,I=k,q=h(v("u-form"),V),$=h(v("u-popup"),P);return i(),n($,{show:B.value,onClose:l[6]||(l[6]=e=>B.value=!1),mode:"center",round:10,closeable:!0,safeAreaInsetBottom:!1,zIndex:"10086"},{default:d((()=>[p(a,{onTouchmove:l[5]||(l[5]=g((()=>{}),["prevent","stop"])),class:"max-w-[630rpx] w-[630rpx] box-border"},{default:d((()=>[p(a,{class:"text-center py-[50rpx] text-[32rpx] font-500 leading-[46rpx]"},{default:d((()=>[u(m(c(s)("bindMobile")),1)])),_:1}),p(a,{class:"px-[50rpx] pb-[50rpx]"},{default:d((()=>[p(q,{labelPosition:"left",model:M,errorType:"toast",rules:F,ref_key:"formRef",ref:W},{default:d((()=>[p(r,{label:"",prop:"mobile",borderBottom:!0},{default:d((()=>[p(o,{modelValue:M.mobile,"onUpdate:modelValue":l[0]||(l[0]=e=>M.mobile=e),placeholder:c(s)("mobilePlaceholder"),class:"w-full h-[50rpx] leading-[50rpx] !bg-transparent !px-[20rpx] text-[26rpx] text-[#333]",disabled:c(D),"placeholder-class":"bind-mobile"},null,8,["modelValue","placeholder","disabled"])])),_:1}),p(a,{class:"mt-[20rpx]"},{default:d((()=>[p(r,{label:"",prop:"mobile_code",borderBottom:!0},{right:d((()=>[p(t,{mobile:M.mobile,type:"bind_mobile",modelValue:M.mobile_key,"onUpdate:modelValue":l[2]||(l[2]=e=>M.mobile_key=e)},null,8,["mobile","modelValue"])])),default:d((()=>[p(o,{modelValue:M.mobile_code,"onUpdate:modelValue":l[1]||(l[1]=e=>M.mobile_code=e),placeholder:c(s)("codePlaceholder"),class:"box-border w-full h-[50rpx] leading-[50rpx] !bg-transparent !px-[20rpx] text-[26rpx] text-[#333]",disabled:c(D),"placeholder-class":"bind-mobile"},null,8,["modelValue","placeholder","disabled"])])),_:1})])),_:1}),c(E).agreement_show?(i(),n(a,{key:0,class:"flex items-baseline mt-[20rpx] pl-[10rpx]"},{default:d((()=>[p(w,null,{default:d((()=>[p(x,{activeColor:"var(--primary-color)",checked:U.value,shape:"shape",size:"12",onChange:R,customStyle:{marginTop:"0rpx",marginBottom:"0rpx"},label:c(s)("agreeTips"),labelSize:"22rpx",labelColor:"#8288A2"},null,8,["checked","label"])])),_:1}),p(a,{class:"text-[22rpx] text-[#8288A2] leading-[30rpx] flex flex-wrap"},{default:d((()=>[p(a,{onClick:l[3]||(l[3]=e=>c(S)({url:"/app/pages/auth/agreement?key=service"}))},{default:d((()=>[u(" 《"),p(z,{class:"text-primary"},{default:d((()=>[u(m(c(s)("userAgreement")),1)])),_:1}),u("》 ")])),_:1}),p(a,{onClick:l[4]||(l[4]=e=>c(S)({url:"/app/pages/auth/agreement?key=privacy"}))},{default:d((()=>[u(" 《"),p(z,{class:"text-primary"},{default:d((()=>[u(m(c(s)("privacyAgreement")),1)])),_:1}),u("》 ")])),_:1})])),_:1})])),_:1})):b("v-if",!0),p(a,{class:"mt-[120rpx]"},{default:d((()=>[p(I,{class:"primary-btn-bg text-[26rpx] text-[#fff] !h-[80rpx] leading-[80rpx] rounded-full font-bold",loading:O.value,loadingText:c(s)("binding"),onClick:Y},{default:d((()=>[u(m(c(s)("bind")),1)])),_:1},8,["loading","loadingText"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-7103d0b0"]]);export{B as b};
