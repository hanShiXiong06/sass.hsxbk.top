import{_ as e}from"./u-input.9468a367.js";import{d as l,r as t,j as a,t as s,x as r,o,c,w as u,b as i,L as p,y as n,Y as d,f as x,I as f,J as m,K as _,u as v,b9 as g,n as h,a3 as b,a4 as y,g as k,h as w,D as j,i as S,a2 as C,z as F,l as V,a as I,G as U,Q as z}from"./index-d8a8f699.js";import{_ as M}from"./u--image.2df700b8.js";import{_ as D}from"./u-button.aa0eb212.js";import{_ as T}from"./u-popup.0d48946e.js";import{_ as E}from"./tabbar.fdead755.js";import{b as K,c as N}from"./goods.0e06a97b.js";import{M as P}from"./mescroll-body.f9302aea.js";import{M as Y}from"./mescroll-empty.2fe85dec.js";import{u as B}from"./useMescroll.26ccf5de.js";import{_ as G}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.5ba98c98.js";import"./u-image.e646392b.js";import"./u-transition.db07fff7.js";import"./u-loading-icon.6808ae8c.js";import"./u-safe-bottom.a4431b09.js";import"./u-badge.d38c6915.js";import"./u-tabbar.5fed7184.js";import"./mescroll-i18n.49872024.js";const J=G(l({__name:"list",setup(l){const{mescrollInit:G,downCallback:J,getMescroll:L}=B(y,b),Q=t([]),R=t([]),W=t(""),X=t(""),Z=t(null),$=t(!1),q=t(!1),A=t(""),H=t(""),O=t(""),ee=t("all");t(!1);let le=t({start_price:"",end_price:""});const te=t(!0);a((async e=>{X.value=e.curr_goods_category||"",A.value=e.goods_name||"",W.value=e.coupon_id||"",await K().then((e=>{Q.value.push({category_name:"全部",category_id:""}),Q.value=Q.value.concat(e.data)}))}));const ae=e=>{$.value=!1;let l={goods_category:se.value,page:e.num,limit:e.size,keyword:A.value,coupon_id:W.value,order:"all"===ee.value?"":ee.value,sort:"price"==ee.value?H.value:O.value,start_price:le.value.start_price,end_price:le.value.end_price};N(l).then((l=>{let t=l.data.data;1===Number(e.num)&&(R.value=[]),R.value=R.value.concat(t),e.endSuccess(t.length),$.value=!0})).catch((()=>{$.value=!0,e.endErr()}))},se=t(""),re=e=>{ee.value=e,"all"==e&&(O.value="",H.value=""),"price"==e&&(O.value="",H.value?H.value="asc"==H.value?"desc":"asc":H.value="asc"),"sale_num"==e&&(H.value="",O.value?O.value="asc"==O.value?"desc":"asc":O.value="asc"),"label"==e?(O.value="asc",H.value="asc",q.value=!q.value):(q.value=!1,R.value=[],L().resetUpScroll())},oe=()=>{te.value=!te.value},ce=e=>{I({url:"/addon/phone_shop/pages/goods/detail",param:{goods_id:e},mode:"navigateTo"})},ue=()=>{A.value="",X.value="",se.value="",W.value="",H.value="",O.value="",le.value.start_price="",le.value.end_price="",q.value=!1,ee.value="all",te.value=!0,R.value=[],L().resetUpScroll()};s((()=>{setTimeout((()=>{L().optUp.textNoMore=r("end")}),500)}));const ie=e=>{let l="";return l=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&U()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",l},pe=e=>{let l="0.00";return l=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&U()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,parseFloat(l)};return(l,t)=>{const a=k(w("u-input"),e),s=j,r=S,b=C,y=z,I=k(w("u--image"),M),U=k(w("u-button"),D),K=k(w("u-popup"),T),N=k(w("tabbar"),E);return o(),c(r,{class:"bg-gray-100 min-h-[100vh]",style:h(l.themeColor())},{default:u((()=>[i(r,{class:"fixed left-0 right-0 top-0 product-warp bg-[#fff] px-[30rpx]"},{default:u((()=>[i(r,{class:"py-[14rpx] flex items-center justify-between"},{default:u((()=>[i(r,{class:"flex-1 flex items-center h-[64rpx] bg-[#F6F8F8] rounded-[33rpx] px-[32rpx] mr-[30rpx]"},{default:u((()=>[i(a,{class:"flex-1",maxlength:"50",modelValue:A.value,"onUpdate:modelValue":t[0]||(t[0]=e=>A.value=e),onConfirm:t[1]||(t[1]=e=>re("all")),placeholder:"请搜索您想要的商品",placeholderClass:"text-[#a5a6a6] text-[26rpx]",fontSize:"26rpx",clearable:"",border:"none"},null,8,["modelValue"]),i(s,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx] ml-[18rpx] !text-[#999]",onClick:t[2]||(t[2]=e=>re("all"))})])),_:1}),i(r,{class:p(["nc-iconfont text-[34rpx] text-[#666]",te.value?"nc-icon-erweimaV6xx":"nc-icon-yingyongliebiaoV6xx"]),onClick:oe},null,8,["class"])])),_:1}),i(r,{class:"flex justify-between tems-center py-[22rpx] px-[20rpx]"},{default:u((()=>[i(r,{class:"flex items-center justify-between text-[24rpx] text-[#666] flex-1"},{default:u((()=>[i(s,{class:p({"text-[#303133] ":"all"==ee.value}),onClick:t[3]||(t[3]=e=>re("all"))},{default:u((()=>[n("综合排序")])),_:1},8,["class"]),i(r,{class:p(["flex items-center",{"text-[#303133]":"sale_num"==ee.value}]),onClick:t[4]||(t[4]=e=>re("sale_num"))},{default:u((()=>[i(s,{class:"mr-[4rpx]"},{default:u((()=>[n("销量")])),_:1}),"asc"==O.value?(o(),c(s,{key:0,class:"text-[18rpx] text-[#666] nc-iconfont nc-icon-a-xiangshangV6xx1"})):(o(),c(s,{key:1,class:"text-[18rpx] text-[#666] nc-iconfont nc-icon-a-xiangxiaV6xx1"}))])),_:1},8,["class"]),i(r,{class:p(["flex items-center",{"text-[#303133]":"price"==ee.value}]),onClick:t[5]||(t[5]=e=>re("price"))},{default:u((()=>[i(s,{class:"mr-[4rpx]"},{default:u((()=>[n("价格")])),_:1}),"asc"==H.value?(o(),c(s,{key:0,class:"text-[18rpx] text-[#666] nc-iconfont nc-icon-a-xiangshangV6xx1"})):(o(),c(s,{key:1,class:"text-[18rpx] text-[#666] nc-iconfont nc-icon-a-xiangxiaV6xx1"}))])),_:1},8,["class"]),i(r,{class:p(["flex items-center",{"text-[#303133]":"label"==ee.value}]),onClick:t[6]||(t[6]=e=>re("label"))},{default:u((()=>[i(s,{class:"mr-[2rpx]"},{default:u((()=>[n("筛选")])),_:1}),i(s,{class:"nc-iconfont color-[#666] nc-icon-shaixuanV6xx text-[28rpx]"})])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),i(K,{show:q.value,mode:"top",onClose:t[10]||(t[10]=e=>q.value=!1)},{default:u((()=>[i(r,{onTouchmove:t[9]||(t[9]=d((()=>{}),["prevent","stop"])),class:""},{default:u((()=>[x(' <view class="text-sm font-bold px-[30rpx] mt-3">全部分类</view> '),i(r,{class:"tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-20 pl-[30rpx] pt-[30rpx]"},{default:u((()=>[i(b,{"scroll-y":!0,class:"scroll-height"},{default:u((()=>[i(r,{class:"bg-[#F4F6F8]"},{default:u((()=>[(o(!0),f(_,null,m(Q.value,((e,l)=>(o(),c(r,{class:p(["tab-item truncate",{"tab-item-active":X.value==l,"rounded-br-[12rpx]":X.value-1===l,"rounded-tr-[12rpx]":X.value+1===l}]),key:e.category_id,onClick:l=>(e=>{se.value=e,R.value=[];const l=Q.value.findIndex((l=>l.category_id==e));X.value=l})(e.category_id)},{default:u((()=>[i(r,{class:"text-box px-[16rpx] truncate"},{default:u((()=>[n(F(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1}),x("        价格区间筛选 "),i(r,{class:"flex justify-center flex-wrap pl-[200rpx] pb-[20rpx]"},{default:u((()=>[i(r,{class:"flex flex-wrap pl-[30rpx] pt-[30rpx] mr-3"},{default:u((()=>[i(a,{placeholder:"请输入查找最低价格",border:"surround",class:"mr-3",prefixIconStyle:"font-size: 22px;color: #909399",modelValue:v(le).start_price,"onUpdate:modelValue":t[7]||(t[7]=e=>v(le).start_price=e)},null,8,["modelValue"]),n(" - "),i(a,{placeholder:"请输入最高价格",border:"surround",class:"ml-3",modelValue:v(le).end_price,"onUpdate:modelValue":t[8]||(t[8]=e=>v(le).end_price=e)},null,8,["modelValue"])])),_:1}),i(b,{class:"h-[70vh]","scroll-y":!0},{default:u((()=>[i(r,{class:"bg-[#fff] grid grid-cols-3 gap-x-[50rpx] gap-y-[32rpx] py-[33rpx] px-[23rpx] rounded-[16rpx]"},{default:u((()=>{var e;return[(o(!0),f(_,null,m(null==(e=Q.value[X.value])?void 0:e.child_list,((e,l)=>(o(),c(r,{key:e.category_id,class:p(["text-center flex flex-col items-center pt-[8rpx] rounded",{"bg-[#f4f6f8]":se.value==e.category_id}]),onClick:l=>{return t=e.category_id,se.value==t?se.value=Q.value[X.value-1].category_id||"":se.value=t,void(R.value=[]);var t}},{default:u((()=>[i(I,{radius:"12rpx",width:"60rpx",height:"60rpx",src:v(V)(e.image?e.image:""),model:"aspectFill"},{error:u((()=>[i(y,{class:"rounded-[12rpx] overflow-hidden w-[60rpx] h-[60rpx]",src:v(V)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(r,{class:"text-[24rpx] text-center mt-[12rpx] leading-[34rpx]"},{default:u((()=>[n(F(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1}),i(r,{class:"flex flex-wrap justify-end pl-[30rpx] p-[30rpx]"},{default:u((()=>[g("div",{class:"flex"},[i(U,{type:"primary",class:"mr-3",text:"重置",onClick:ue}),i(U,{type:"success",plain:!0,onClick:re,text:"搜索"})])])),_:1})])),_:1})])),_:1})])),_:1},8,["show"]),i(P,{ref_key:"mescrollRef",ref:Z,top:"160rpx",bottom:"50px",onInit:v(G),down:{use:!1},onUp:ae},{default:u((()=>[R.value.length?(o(),c(r,{key:0,class:p(["sidebar-marign",te.value?"":"flex justify-between flex-wrap"])},{default:u((()=>[(o(!0),f(_,null,m(R.value,((e,l)=>(o(),f(_,null,[te.value?(o(),c(r,{key:0,class:p(["bg-white flex p-[20rpx] rounded-[16rpx] overflow-hidden mt-[20rpx]",{"mb-[20rpx]":l+1==R.value.length}]),onClick:l=>ce(e.goods_id)},{default:u((()=>[i(I,{class:"rounded-[10rpx] overflow-hidden",width:"190rpx",height:"190rpx",src:v(V)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:u((()=>[i(y,{class:"w-[190rpx] h-[190rpx] rounded-[10rpx] overflow-hidden",src:v(V)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(r,{class:"flex-1 flex flex-col ml-[20rpx] py-[6rpx]"},{default:u((()=>[i(r,{class:"text-[28rpx] text-[#303133] leading-[40rpx] multi-hidden mb-[10rpx]"},{default:u((()=>[n(F(e.goods_name),1)])),_:2},1024),e.sub_title?(o(),c(r,{key:0,class:"text-[16rpx] text-[#303133] leading-[40rpx] multi-hidden mb-[10rpx]"},{default:u((()=>[n(F(e.sub_title),1)])),_:2},1024)):x("v-if",!0),e.goodsSku.sku_no?(o(),c(r,{key:1,class:"text-[16rpx] text-[#303133] leading-[40rpx] multi-hidden mb-[10rpx]"},{default:u((()=>[n(" sn: "+F(e.goodsSku.sku_no),1)])),_:2},1024)):x("v-if",!0),i(r,{class:"mt-auto flex justify-between items-baseline"},{default:u((()=>[i(r,{class:"text-[var(--price-text-color)] price-font flex items-baseline"},{default:u((()=>[i(s,{class:"text-[26rpx] font-500"},{default:u((()=>[n("￥")])),_:1}),i(s,{class:"text-[36rpx] font-500"},{default:u((()=>[n(F(pe(e).toFixed(2).split(".")[0]),1)])),_:2},1024),i(s,{class:"text-[24rpx] font-500"},{default:u((()=>[n("."+F(pe(e).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==ie(e)?(o(),c(y,{key:0,class:"h-[24rpx] w-[72rpx] ml-[6rpx]",src:v(V)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):x("v-if",!0),"discount_price"==ie(e)?(o(),c(y,{key:1,class:"h-[24rpx] w-[72rpx] ml-[6rpx]",src:v(V)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):x("v-if",!0)])),_:2},1024),i(s,{class:"text-[22rpx] text-[#999]"},{default:u((()=>[n("库存:"+F(e.goodsSku.stock)+F(e.unit)+" | 已售:"+F(e.sale_num)+F(e.unit),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])):(o(),c(r,{key:1,class:"goods-item-style-two flex flex-col bg-[#fff] box-border rounded-[12rpx] overflow-hidden mt-[20rpx]",onClick:l=>ce(e.goods_id)},{default:u((()=>[i(I,{width:"100%",height:"350rpx",src:v(V)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:u((()=>[i(y,{class:"w-[100%] h-[350rpx]",src:v(V)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(r,{class:"px-[16rpx] flex-1 pt-[16rpx] pb-[20rpx] flex flex-col justify-between"},{default:u((()=>[i(r,{class:"text-[#303133] leading-[40rpx] text-[28rpx] multi-hidden"},{default:u((()=>[n(F(e.goods_name),1)])),_:2},1024),i(r,{class:"text-[#303133] leading-[40rpx] text-[20rpx] multi-hidden"},{default:u((()=>[n(F(e.sub_title),1)])),_:2},1024),i(r,{class:"flex justify-between flex-wrap items-baseline mt-[16rpx]"},{default:u((()=>[i(r,{class:"text-[var(--price-text-color)] price-font flex items-baseline"},{default:u((()=>[x('\t\t\t\t\t\t\t\t\t\t<text class="text-[20rpx]  mr-[4rpx]">￥</text>'),x('\t\t\t\t\t\t\t\t\t\t<text class="text-[36rpx] font-500">{{ item.goodsSku.price }}</text>'),i(s,{class:"text-[26rpx] font-500"},{default:u((()=>[n("￥")])),_:1}),i(s,{class:"text-[36rpx] font-500"},{default:u((()=>[n(F(pe(e).toFixed(2).split(".")[0]),1)])),_:2},1024),i(s,{class:"text-[24rpx] font-500"},{default:u((()=>[n("."+F(pe(e).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==ie(e)?(o(),c(y,{key:0,class:"h-[24rpx] ml-[6rpx]",src:v(V)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):x("v-if",!0),"discount_price"==ie(e)?(o(),c(y,{key:1,class:"h-[24rpx] ml-[6rpx]",src:v(V)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):x("v-if",!0)])),_:2},1024),i(s,{class:"text-[22rpx] text-[#999]"},{default:u((()=>[n(" 库存"+F(e.goodsSku.stock)+F(e.unit),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]))],64)))),256))])),_:1},8,["class"])):x("v-if",!0),!R.value.length&&$.value?(o(),c(r,{key:1,class:"mx-[30rpx] mt-[20rpx] bg-[#fff] rounded-[16rpx] noData flex items-center justify-center"},{default:u((()=>[i(Y,{option:{tip:"暂无商品"}})])),_:1})):x("v-if",!0)])),_:1},8,["onInit"]),i(N)])),_:1},8,["style"])}}}),[["__scopeId","data-v-3b9e9c3f"]]);export{J as default};
