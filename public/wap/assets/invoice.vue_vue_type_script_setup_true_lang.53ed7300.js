import{d as e,r as a,N as l,g as r,h as t,o,c as s,w as u,b as d,A as n,y as c,U as p,V as i,ad as m,W as x,z as f,f as _,u as b,E as v,bq as h,t as y,i as g,D as k,b3 as V,a$ as C,ac as w,C as j,aA as U,bG as A,j as M,e as T,v as $,an as q,R as z,Q as E,S as F}from"./index-71c7df08.js";import{j as L}from"./order.fd75567a.js";const R=e({__name:"select-store",emits:["confirm"],setup(e,{expose:A,emit:M}){const T=a(!1),$=a(!1),q=a(!0),z=a([]),E=a(null),F=l({lat:0,lng:0}),R=()=>{M("confirm",E.value),T.value=!1},S=e=>{if((e=parseFloat(e))<1e3)return`${e}m`;return`${(e/1e3).toFixed(2)}km`};return A({open:()=>{$.value||($.value=!0,h({type:"gcj02",success:e=>{F.lat=e.latitude,F.lng=e.longitude},fail:e=>{if(e.errMsg&&e.errno)if(104==e.errno){y({title:"用户未授权隐私权限，获取位置失败",icon:"none"})}else if(112==e.errno){y({title:"隐私协议中未声明，获取位置失败",icon:"none"})}else if("getLocation:fail auth deny"==e.errMsg){y({title:"用户未授权获取位置的权限",icon:"none"})}else y({title:e.errMsg,icon:"none"})}}),setTimeout((()=>{L({latlng:F}).then((({data:e})=>{z.value=e,q.value=!1})).catch((()=>{q.value=!1}))}),1500)),T.value=!0}}),(e,a)=>{const l=g,h=k,y=r(t("u-loading-icon"),V),A=r(t("u-empty"),C),M=w,$=j,F=r(t("u-popup"),U);return o(),s(F,{show:T.value,onClose:a[1]||(a[1]=e=>T.value=!1),mode:"bottom",round:10,closeable:!0},{default:u((()=>[d(l,{onTouchmove:a[0]||(a[0]=n((()=>{}),["prevent","stop"]))},{default:u((()=>[d(l,{class:"text-center p-[30rpx]"},{default:u((()=>[c("请选择自提点")])),_:1}),d(M,{"scroll-y":"true",class:"h-[50vh]"},{default:u((()=>[d(l,{class:"p-[30rpx] pt-0 text-sm"},{default:u((()=>[(o(!0),p(i,null,m(z.value,(e=>(o(),s(l,{class:x(["mt-[30rpx] p-[30rpx] border-1 !border-[#eee] border-solid rounded-[20rpx]",{"!border-primary bg-primary-light":E.value&&E.value.store_id==e.store_id}]),onClick:a=>{return l=e,void(E.value?E.value=E.value.store_id!=l.store_id?l:null:E.value=l);var l}},{default:u((()=>[d(l,{class:"font-bold flex"},{default:u((()=>[d(l,{class:"flex-1 w-0"},{default:u((()=>[d(h,null,{default:u((()=>[c(f(e.store_name),1)])),_:2},1024),d(h,{class:"text-[26rpx] ml-[20rpx]"},{default:u((()=>[c(f(e.store_mobile),1)])),_:2},1024)])),_:2},1024),e.distance?(o(),s(l,{key:0},{default:u((()=>[d(h,{class:"text-red text-xs font-normal"},{default:u((()=>[c(f(S(e.distance)),1)])),_:2},1024)])),_:2},1024)):_("v-if",!0)])),_:2},1024),d(l,{class:"mt-[16rpx] text-[26rpx]"},{default:u((()=>[c(f(e.full_address),1)])),_:2},1024),d(l,{class:"mt-[16rpx] text-[26rpx]"},{default:u((()=>[c("营业时间："+f(e.trade_time),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),256))])),_:1}),q.value?(o(),s(l,{key:0,class:"h-[50vh] flex items-center flex-col justify-center"},{default:u((()=>[d(y,{vertical:!0})])),_:1})):_("v-if",!0),q.value||z.value.length?_("v-if",!0):(o(),s(l,{key:1,class:"h-[50vh] flex items-center flex-col justify-center"},{default:u((()=>[d(A,{text:"没有可选择的自提点",icon:b(v)("static/resource/images/empty.png")},null,8,["icon"])])),_:1}))])),_:1}),d(l,{class:"p-[30rpx]"},{default:u((()=>[d($,{class:"bg-[var(--primary-color)] text-[#fff] h-[80rpx] leading-[80rpx] rounded-[100rpx] text-[28rpx]",onClick:R},{default:u((()=>[c("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])}}});const S=e({__name:"invoice",emits:["confirm"],setup(e,{expose:l,emit:v}){const h=a(!1),y=a({is_invoice:2,invoice_content:[]}),V=a(!1),C=a(!1),L=a({header_type:1,header_name:"",type:"",name:"",tax_number:"",telephone:"",address:"",bank_name:"",bank_card_number:""}),R=M((()=>1==y.value.is_invoice));A.get("phone_shop/config/invoice").then((({data:e})=>{y.value=e,e.invoice_content.length&&(L.value.name=e.invoice_content[0])})).catch();const S=e=>{q((()=>{L.value.tax_number=e.replace(/[^0-9a-zA-Z]/g,"")}))},W=a(null),Z=M((()=>({header_name:{type:"string",required:V.value,message:"请输入发票抬头",trigger:["blur","change"]},tax_number:[{type:"string",required:V.value&&2==L.value.header_type,message:"请输入纳税人识别号",trigger:["blur","change"]},{validator(e,a,l){/^[0-9a-zA-Z]+$/.test(a)||2!=L.header_type?l():l(new Error("请输入正确的纳税人识别号"))}}]}))),B=()=>{W.value.validate().then((()=>{const e=V.value?L.value:{};v("confirm",e),h.value=!1}))};return l({open:()=>{h.value=!0},invoiceOpen:R}),(e,a)=>{const l=g,v=r(t("u-form-item"),z),A=r(t("u-input"),E),M=k,q=r(t("u-form"),F),R=w,D=j,G=r(t("u-popup"),U);return o(),s(G,{show:h.value,onClose:a[12]||(a[12]=e=>h.value=!1),mode:"bottom",round:10,closeable:!0,safeAreaInsetBottom:!0,customStyle:{maxHeight:"58vh"}},{default:u((()=>[d(l,{onTouchmove:a[11]||(a[11]=n((()=>{}),["prevent","stop"]))},{default:u((()=>[d(l,{class:"text-center p-[30rpx] box-border h-[111rpx]"},{default:u((()=>[c("请填写发票信息")])),_:1}),d(R,{"scroll-y":!0,class:"max-h-[calc(50vh-211rpx)]"},{default:u((()=>[d(l,{class:"p-[30rpx] pt-0 text-sm"},{default:u((()=>[d(q,{labelPosition:"left",model:L.value,labelWidth:"200rpx",errorType:"toast",rules:b(Z),ref_key:"formRef",ref:W},{default:u((()=>[d(l,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"需要发票","border-bottom":!0},{default:u((()=>[d(l,{class:"flex"},{default:u((()=>[d(l,{class:x(["rounded px-[30rpx] py-[10rpx] mr-[20rpx] border-1 !border-[#eee] border-solid text-sm",{"bg-primary text-white !border-primary":!V.value}]),onClick:a[0]||(a[0]=e=>V.value=!1)},{default:u((()=>[c(" 不需要")])),_:1},8,["class"]),d(l,{class:x(["rounded px-[30rpx] py-[10rpx] border-1 !border-[#eee] border-solid text-sm",{"bg-primary text-white !border-primary":V.value}]),onClick:a[1]||(a[1]=e=>V.value=!0)},{default:u((()=>[c("需要 ")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),T(d(l,null,{default:u((()=>[d(l,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"抬头类型","border-bottom":!0},{default:u((()=>[d(l,{class:"flex"},{default:u((()=>[d(l,{class:x(["rounded px-[30rpx] py-[10rpx] mr-[20rpx] border-1 !border-[#eee] border-solid text-sm",{"bg-primary text-white !border-primary":1==L.value.header_type}]),onClick:a[2]||(a[2]=e=>L.value.header_type=1)},{default:u((()=>[c("个人")])),_:1},8,["class"]),d(l,{class:x(["rounded px-[30rpx] py-[10rpx] border-1 !border-[#eee] border-solid text-sm",{"bg-primary text-white !border-primary":2==L.value.header_type}]),onClick:a[3]||(a[3]=e=>L.value.header_type=2)},{default:u((()=>[c("企业")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),d(l,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"发票内容",prop:"header_name","border-bottom":!0},{default:u((()=>[d(l,{class:"flex flex-wrap"},{default:u((()=>[(o(!0),p(i,null,m(y.value.invoice_content,(e=>(o(),s(l,{class:x(["rounded px-[30rpx] my-[10rpx] py-[10rpx] mr-[20rpx] border-1 !border-[#eee] border-solid text-sm whitespace-normal",{"bg-primary text-white !border-primary":L.value.name==e}]),onClick:a=>L.value.name=e},{default:u((()=>[c(f(e),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1}),d(l,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"发票抬头",prop:"header_name","border-bottom":!0},{default:u((()=>[d(A,{modelValue:L.value.header_name,"onUpdate:modelValue":a[4]||(a[4]=e=>L.value.header_name=e),modelModifiers:{trim:!0},border:"none",clearable:"",placeholder:"请输入发票抬头"},null,8,["modelValue"])])),_:1})])),_:1}),2==L.value.header_type?(o(),s(l,{key:0},{default:u((()=>[d(l,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"纳税人识别号",prop:"tax_number","border-bottom":!0},{default:u((()=>[d(A,{modelValue:L.value.tax_number,"onUpdate:modelValue":a[5]||(a[5]=e=>L.value.tax_number=e),modelModifiers:{trim:!0},border:"none",clearable:"",placeholder:"请输入纳税人识别号",onChange:S},null,8,["modelValue"])])),_:1})])),_:1}),d(l,{class:"py-[20rpx] flex items-baseline"},{default:u((()=>[d(M,{class:"text-[30rpx]"},{default:u((()=>[c("更多选填内容")])),_:1}),d(M,{class:"text-xs text-gray-subtitle ml-[10rpx]"},{default:u((()=>[c("注册地址、电话、开户银行及账号")])),_:1}),d(l,{class:"text-xs text-right flex-1",onClick:a[6]||(a[6]=e=>C.value=!C.value)},{default:u((()=>[d(M,null,{default:u((()=>[c(f(C.value?"收起":"展开"),1)])),_:1}),d(M,{class:x(["text-[30rpx] nc-iconfont text-gray-subtitle ml-[5rpx]",C.value?"nc-icon-shangV6xx-1":"nc-icon-xiaV6xx"])},null,8,["class"])])),_:1})])),_:1}),T(d(l,null,{default:u((()=>[d(l,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"注册地址","border-bottom":!0},{default:u((()=>[d(A,{modelValue:L.value.address,"onUpdate:modelValue":a[7]||(a[7]=e=>L.value.address=e),border:"none",clearable:"",placeholder:"(选填)请输入企业注册地址"},null,8,["modelValue"])])),_:1})])),_:1}),d(l,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"注册电话","border-bottom":!0},{default:u((()=>[d(A,{modelValue:L.value.telephone,"onUpdate:modelValue":a[8]||(a[8]=e=>L.value.telephone=e),border:"none",clearable:"",placeholder:"(选填)请输入企业注册电话"},null,8,["modelValue"])])),_:1})])),_:1}),d(l,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"开户银行","border-bottom":!0},{default:u((()=>[d(A,{modelValue:L.value.bank_name,"onUpdate:modelValue":a[9]||(a[9]=e=>L.value.bank_name=e),border:"none",clearable:"",placeholder:"(选填)请输入企业开户银行"},null,8,["modelValue"])])),_:1})])),_:1}),d(l,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"银行账号","border-bottom":!0},{default:u((()=>[d(A,{modelValue:L.value.bank_card_number,"onUpdate:modelValue":a[10]||(a[10]=e=>L.value.bank_card_number=e),border:"none",clearable:"",placeholder:"(选填)请输入企业开户银行账号"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},512),[[$,C.value]])])),_:1})):_("v-if",!0)])),_:1},512),[[$,V.value]])])),_:1},8,["model","rules"])])),_:1})])),_:1}),d(l,{class:"p-[30rpx]"},{default:u((()=>[d(D,{class:"bg-[var(--primary-color)] text-[#fff] h-[80rpx] leading-[80rpx] rounded-[100rpx] text-[28rpx]",onClick:B},{default:u((()=>[c("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])}}});export{R as _,S as a};
