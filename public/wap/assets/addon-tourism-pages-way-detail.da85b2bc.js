import{d as e,r as t,l as a,j as l,p as r,s,J as o,E as n,o as i,c as u,w as d,u as c,b as p,y as f,z as m,f as x,bV as _,P as v,a7 as b,Q as y,n as g,bW as h,a as w,H as k,g as j,h as F,D as I,B as E,i as D,R as C}from"./index-7bf68536.js";import{_ as B}from"./u-swiper.f792d47e.js";import{_ as V}from"./u-parse.525658f5.js";import{_ as P}from"./u-button.359d7329.js";import{_ as S}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{_ as z}from"./u-calendar.f4984da6.js";import{d as A,e as H}from"./tourism.3586533e.js";import{s as T}from"./share-poster.5efeffe7.js";import{_ as J}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.b37701e7.js";import"./u-icon.0c1c54c7.js";import"./u-loading-page.566c330a.js";import"./u-transition.cdf87992.js";import"./u-popup.be4bfacd.js";import"./u-safe-bottom.908eeae4.js";import"./index.a605aec4.js";/* empty css                                                                     */const L=J(e({__name:"detail",setup(e){let J=t([]),L=t([]),O=t(!0),R=t(!1),U=t(!1),G=t("");const M=a(),N=l((()=>M.info));let Q=t({way_id:"",reserve_time:"",num:1}),W=t([]),Y=t(0);t(null),r((e=>{G.value=e.way_id,O.value=!0,Z(e.way_id),A(e.way_id).then((e=>{L.value=e.data,L.value.goods.member_discount&&s()?ue.value=L.value.member_price:ue.value=L.value.price,de.value=L.value.day_info?L.value.day_info.time_date:"",o({title:L.value.way_name}),J.value=[],L.value.goods.image_thumb_big&&L.value.goods.image_thumb_big.length&&""!=L.value.goods.image_thumb_big.toString()?L.value.goods.image_thumb_big.forEach(((e,t)=>{J.value.push(n(e))})):J.value.push(n(L.value.goods.cover_thumb_big)),ne(),O.value=!1})).catch((()=>{O.value=!1}))}));let q={};const K=e=>{let t=new Date(e[0]).getTime();ae(t),Y.value=0,R.value=!1,Q.value.reserve_time=e[0],L.value.goods.price=q[e[0]],ue.value=q[e[0]],de.value=e[0]},X=e=>{const t=h(Date.parse(e.date)/1e3,"year_month_day");return q[t]&&(e.bottomInfo=q[t]),e},Z=e=>{H(e).then((e=>{let t=e.data;t&&(q=t),U.value=!0,ae()})).catch((()=>{O.value=!1}))},$=e=>{var t=[];return-1!=e.indexOf("-")?t=e.split("-"):-1!=e.indexOf("/")&&(t=e.split("/")),t[1]+"-"+t[2]},ee=(e,t="")=>{var a=864e5*e;return t?new Date(t+a):new Date(Date.now()+a)},te=e=>{let t=e.getFullYear(),a=e.getMonth()+1,l=e.getDate();return""+(t+"-"+(a<10?"0"+a:a)+"-"+(l<10?"0"+l:l))},ae=(e="")=>{let t,a=["周日","周一","周二","周三","周四","周五","周六"];W.value=[];for(let l=0;l<4;l++){t={};let r=te(ee(l,e));t.centerInfo=$(r);let s=r.split("/").map((e=>{let t="";return t=e<10?"0"+e:e,t})).join("-");t.bottomInfo=q[s]||"",t.topInfo=a[new Date(s).getDay()],t.initInfo=s,W.value.push(t)}Q.value.reserve_time=te(ee(0))},le=()=>{w({url:"/addon/tourism/pages/index",mode:"reLaunch"})};let re=t(null),se=t(""),oe={};const ne=()=>{se.value="?way_id="+L.value.way_id,N.value&&N.value.member_id&&(se.value+="&mid="+N.value.member_id)},ie=()=>{oe.way_id=L.value.way_id,N.value&&N.value.member_id&&(oe.member_id=N.value.member_id),re.value.openShare()};let ue=t("0.00"),de=t(""),ce=e=>{let t="";return t=!e.goods.member_discount||!s()||e.day_list[de.value]&&1!=e.day_list[de.value].member_price?"":"member_price",t};return(e,t)=>{const a=j(F("u-swiper"),B),l=I,r=E,o=D,h=j(F("u-parse"),V),A=j(F("u-button"),P),H=j(F("loading-page"),S),M=j(F("u-calendar"),z);return i(),u(o,{class:"bg-[#f7f7f7] min-h-screen overflow-hidden",style:g(e.themeColor())},{default:d((()=>[c(O)?x("v-if",!0):(i(),u(o,{key:0},{default:d((()=>[p(a,{list:c(J),height:"380rpx",radius:"0"},null,8,["list"]),p(o,{class:"chunk-wrap pt-4 pb-3 rounded-t-2xl relative -mt-[30rpx]"},{default:d((()=>[p(o,{class:"flex justify-between items-center"},{default:d((()=>[p(o,{class:"flex-1"},{default:d((()=>[p(o,{class:"flex items-baseline text-[24rpx] text-[#888]"},{default:d((()=>[p(l,{class:"text-[#FA6400] text-[26rpx] price-font"},{default:d((()=>[f("￥")])),_:1}),p(l,{class:"text-[#FA6400] text-[38rpx] price-font"},{default:d((()=>[f(m(c(ue)),1)])),_:1}),"member_price"==c(ce)(c(L))?(i(),u(r,{key:0,class:"h-[22rpx] ml-[6rpx] w-[55rpx]",src:c(n)("addon/tourism/VIP.png"),mode:"widthFix"},null,8,["src"])):x("v-if",!0),p(l,{class:"ml-1"},{default:d((()=>[f("/人起")])),_:1}),x(' <text class="ml-3">年销量268</text> ')])),_:1}),x(' <view class="flex justify-between text-[#543E3E] items-baseline member-price mt-3 pl-2 pb-1 rounded-l-md">\r\n\t\t\t\t\t\t\t<text class="text-xs">会员价: 188/人</text>\r\n\t\t\t\t\t\t\t<view class="text-xs">立即开通<text class="nc-iconfont nc-icon-youV6xx text-[26rpx]"></text></view>\r\n\t\t\t\t\t\t</view> ')])),_:1}),p(o,{class:"flex flex-col items-center text-[#6D7278] ml-[40rpx] pl-[50rpx] pr-[30rpx] border-0 border-l border-solid border-[#F0F0F0]",onClick:ie},{default:d((()=>[p(l,{class:"nc-iconfont nc-icon-fenxiangV6xx-1 text-lg"}),p(l,{class:"mt-1 text-xs"},{default:d((()=>[f("分享")])),_:1})])),_:1})])),_:1}),p(o,{class:"mt-2 font-bold multi-hidden"},{default:d((()=>[f(m(c(L).way_name),1)])),_:1}),p(o,{class:"flex flex-wrap mt-3 text-xs"},{default:d((()=>[c(L).group_buy_type_name?(i(),u(l,{key:0,class:"text-[#696969] border-1 border-solid border-[#E4E4E4] rounded-md px-3 py-1"},{default:d((()=>[f(m(c(L).group_buy_type_name),1)])),_:1})):x("v-if",!0),c(L).travel_type_name?(i(),u(l,{key:1,class:"text-[#696969] border-1 border-solid border-[#E4E4E4] rounded-md px-3 py-1 ml-2"},{default:d((()=>[f(m(c(L).travel_type_name),1)])),_:1})):x("v-if",!0),c(L).way_theme_name?(i(),u(l,{key:2,class:"text-[#696969] border-1 border-solid border-[#E4E4E4] rounded-md px-3 py-1 ml-2"},{default:d((()=>[f(m(c(L).way_theme_name),1)])),_:1})):x("v-if",!0),c(L).way_traffic_name?(i(),u(l,{key:3,class:"text-[#696969] border-1 border-solid border-[#E4E4E4] rounded-md px-3 py-1 ml-2"},{default:d((()=>[f(m(c(L).way_traffic_name),1)])),_:1})):x("v-if",!0)])),_:1}),p(o,{class:"flex justify-between mt-3 text-xs text-[#696969]"},{default:d((()=>[p(o,{class:"flex flex-wrap flex-1"},{default:d((()=>[p(l,null,{default:d((()=>[f("出发城市："+m(c(L).start_city),1)])),_:1}),p(l,{class:"iconfont iconshuangxiang mx-3"}),p(l,null,{default:d((()=>[f("目的地："+m(c(L).end_city),1)])),_:1})])),_:1}),x(" <text>库存：{{detail?.goods?.stock||0}}</text> ")])),_:1})])),_:1}),p(o,{class:"chunk-wrap"},{default:d((()=>[p(o,{class:"chunk-head"},{default:d((()=>[p(l,null,{default:d((()=>[f("出发日期")])),_:1}),p(l,{onClick:t[0]||(t[0]=e=>_(R)?R.value=!0:R=!0)},{default:d((()=>[f("查看"),p(l,{class:"nc-iconfont nc-icon-youV6xx text-[26rpx]"})])),_:1})])),_:1}),p(o,{class:"flex pt-[28rpx] pb-[24rpx]"},{default:d((()=>[(i(!0),v(y,null,b(c(W),((e,t)=>(i(),u(o,{class:C(["relative flex flex-col items-center justify-center w-[130rpx] h-[142rpx] border-1 border-solid border-[#F0F0F0] mr-[14rpx] text-sm rounded",{"bg-[#F8F8F8]":!c(q)[e.initInfo],"border-color":t==c(Y),"border-[#F0F0F0]":t!=c(Y)}]),onClick:a=>((e,t)=>{q[e.initInfo]&&(Y.value=t,Q.value.reserve_time=e.initInfo,L.value.price=q[e.initInfo],ue.value=q[e.initInfo],de.value=e.initInfo)})(e,t)},{default:d((()=>[t==c(Y)?(i(),u(o,{key:0,class:"absolute bottom-[0] right-[0] bg-[var(--primary-color)] rounded-tl-[16rpx] flex items-center justify-center leading-[1] px-[2rpx] pt-[4rpx]"},{default:d((()=>[p(l,{class:"nc-iconfont nc-icon-duihaoV6xx-1 text-[#fff] text-[28rpx]"})])),_:1})):x("v-if",!0),p(l,{class:"text-[#9B9B9B] text-xs"},{default:d((()=>[f(m(e.topInfo),1)])),_:2},1024),p(l,{class:"mt-[4rpx]"},{default:d((()=>[f(m(e.centerInfo),1)])),_:2},1024),e.bottomInfo?(i(),u(l,{key:1,class:"text-[#FA6400] text-xs"},{default:d((()=>[f(m(e.bottomInfo),1)])),_:2},1024)):x("v-if",!0)])),_:2},1032,["class","onClick"])))),256)),p(o,{class:"relative flex flex-col items-center justify-center w-[130rpx] h-[142rpx] border-1 border-solid border-[#F8F8F8] text-sm rounded bg-[#F8F8F8]",onClick:t[1]||(t[1]=e=>_(R)?R.value=!0:R=!0)},{default:d((()=>[p(l,{class:"nc-iconfont nc-icon-a-riliV6xx-36 text-[44rpx] text-[#707070]"}),p(l,{class:"text-xs text-[#9B9B9B] mt-[4rpx]"},{default:d((()=>[f("更多")])),_:1})])),_:1})])),_:1})])),_:1}),p(o,{class:"chunk-wrap pt-[34rpx] scheduling"},{default:d((()=>[p(o,{class:"text-center text-[34rpx] font-bold"},{default:d((()=>[f("-- 费用说明 --")])),_:1}),p(o,{class:"scheduling-content"},{default:d((()=>{var e;return[(null==(e=c(L))?void 0:e.fee_desc)?(i(),u(h,{key:0,content:c(L).fee_desc,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(i(),u(l,{key:1,class:"pb-5 block"},{default:d((()=>[f("暂无费用说明")])),_:1}))]})),_:1})])),_:1}),p(o,{class:"chunk-wrap pt-[34rpx] scheduling"},{default:d((()=>[p(o,{class:"text-center text-[34rpx] font-bold"},{default:d((()=>[f("-- 线路特点 --")])),_:1}),p(o,{class:"scheduling-content"},{default:d((()=>{var e;return[(null==(e=c(L))?void 0:e.way_character)?(i(),u(h,{key:0,content:c(L).way_character,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(i(),u(l,{key:1,class:"pb-5 block"},{default:d((()=>[f("暂无线路特点")])),_:1}))]})),_:1})])),_:1}),p(o,{class:"h-[148rpx] w-screen"}),p(o,{class:"flex justify-between bg-white p-3 fixed bottom-0 left-0 right-0"},{default:d((()=>[p(o,{class:"flex flex-col items-center",onClick:le},{default:d((()=>[x(' <image class="w-[38rpx] h-[38rpx]" :src="img(\'addon/tourism/tourism/way/index.png\')" mode="aspectFill"></image> '),p(l,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[46rpx] text-[#333]"}),p(l,{class:"text-xs text-[#363636] mt-1"},{default:d((()=>[f("首页")])),_:1})])),_:1}),x(' <u-button class="!w-[276rpx] !rounded-3xl !mr-[24rpx]" type="primary" :plain="true" size="16">在线咨询</u-button> '),p(A,{text:"立即报名",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"76rpx",margin:"0rpx",color:"#fff",width:"276rpx"},size:"16",onClick:t[2]||(t[2]=e=>(e=>{if(Q.value.way_id=e.goods.goods_id,!s())return k().setLoginBack({url:"/addon/tourism/pages/way/detail",param:{way_id:G.value}}),!1;uni.setStorageSync("wayCreateData",Q.value),w({url:"/addon/tourism/pages/way/order"})})(c(L)))})])),_:1})])),_:1})),p(H,{loading:c(O)},null,8,["loading"]),x(" 出发日期 "),c(U)?(i(),u(M,{key:1,show:c(R),defaultDate:c(Q).reserve_time,onConfirm:K,onClose:t[3]||(t[3]=e=>_(R)?R.value=!1:R=!1),formatter:X,confirmDisabledText:"请选择离店日期",ref:"calendar",monthNum:"2"},null,8,["show","defaultDate"])):x("v-if",!0),p(T,{ref_key:"sharePosterRef",ref:re,posterType:"tourism_way",posterId:c(L).poster_id,posterParam:c(oe),copyUrlParam:c(se)},null,8,["posterId","posterParam","copyUrlParam"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-afc2fccf"]]);export{L as default};
