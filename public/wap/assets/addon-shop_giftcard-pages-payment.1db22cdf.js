import{d as t,r as e,o as a,c as r,w as l,b as s,u as d,y as o,z as n,f as i,n as c,a as p,B as x,g as u,h as m,i as f,D as _,c3 as g,C as v,E as b,bl as h,bF as y,_ as w}from"./index-71c7df08.js";import{_ as k}from"./pay.6aa36878.js";import{c as j,d as F}from"./order.9eeece48.js";import"./pay.4cfa8889.js";const C=w(t({__name:"payment",setup(t){const w=e({order_key:"",member_remark:"",giftcard_data:{giftcard_id:"",num:1,balance:"",material_id:""}}),C=e(null),S=e(),V=e(!1);uni.getStorageSync("giftCardOrderCreateData")&&Object.assign(w.value,uni.getStorageSync("giftCardOrderCreateData"));j(w.value).then((({data:t})=>{C.value=t,w.value.order_key=t.order_key})).catch();let I=0;const N=()=>{V.value||(V.value=!0,w.value.member_remark.length>200&&(w.value.member_remark=w.value.member_remark.substr(0,200)),F(w.value).then((({data:t})=>{var e;I=t.order_id,0==C.value.basic.order_money?p({url:"/addon/shop_giftcard/pages/order_detail",param:{order_id:I},mode:"redirectTo"}):null==(e=S.value)||e.open(t.trade_type,t.order_id,`/addon/shop_giftcard/pages/order_detail?order_id=${t.order_id}`)})).catch((()=>{V.value=!1})))},B=()=>{p({url:"/addon/shop_giftcard/pages/order_detail",param:{order_id:I},mode:"redirectTo"})};return(t,e)=>{const p=x,j=u(m("u--image"),h),F=f,V=_,I=g,D=v,O=u(m("u-tabbar"),y),z=u(m("pay"),k);return a(),r(F,{style:c(t.themeColor())},{default:l((()=>[C.value?(a(),r(F,{key:0,class:"bg-[var(--page-bg-color)] min-h-[100vh]"},{default:l((()=>[s(F,{class:"pt-[var(--top-m)] sidebar-margin payment-bottom"},{default:l((()=>[s(F,{class:"mb-[var(--top-m)] card-template"},{default:l((()=>[s(F,{class:"flex"},{default:l((()=>[s(j,{radius:"var(--goods-rounded-big)",width:"280rpx",height:"200rpx",src:d(b)(C.value.goods_data.card_cover),model:"aspectFill"},{error:l((()=>["balance"==C.value.goods_data.card_right_type?(a(),r(p,{key:0,class:"w-[280rpx] h-[200rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:d(b)("addon/shop_giftcard/diy/index/value_card.jpg"),mode:"aspectFill"},null,8,["src"])):(a(),r(p,{key:1,class:"w-[280rpx] h-[200rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:d(b)("addon/shop_giftcard/diy/index/redemption_card.jpg"),mode:"aspectFill"},null,8,["src"]))])),_:1},8,["src"]),s(F,{class:"flex flex-1 w-0 flex-col justify-between ml-[20rpx] py-[6rpx]"},{default:l((()=>[s(F,{class:"line-normal"},{default:l((()=>[s(F,{class:"truncate text-[#303133] text-[28rpx] leading-[32rpx]"},{default:l((()=>[o(n(C.value.goods_data.card_name),1)])),_:1}),"balance"==C.value.goods_data.card_right_type?(a(),r(F,{key:0,class:"mt-[20rpx] flex items-center justify-between"},{default:l((()=>[s(V,{class:"truncate text-[24rpx] text-[var(--text-color-light9)] leading-[28rpx]"},{default:l((()=>[o(n(C.value.goods_data.balance)+"元储值卡",1)])),_:1})])),_:1})):i("v-if",!0)])),_:1}),s(F,{class:"flex justify-between items-baseline"},{default:l((()=>[s(F,{class:"text-[var(--price-text-color)] flex items-baseline price-font"},{default:l((()=>[s(V,{class:"text-[24rpx] font-500 mr-[4rpx]"},{default:l((()=>[o("￥")])),_:1}),s(V,{class:"text-[40rpx] font-500"},{default:l((()=>[o(n(parseFloat(C.value.goods_data.card_price).toFixed(2).split(".")[0]),1)])),_:1}),s(V,{class:"text-[24rpx] font-500"},{default:l((()=>[o("."+n(parseFloat(C.value.goods_data.card_price).toFixed(2).split(".")[1]),1)])),_:1})])),_:1}),s(F,{class:"font-400 text-[28rpx] text-[var(--text-color-light9)]"},{default:l((()=>[s(V,null,{default:l((()=>[o("x")])),_:1}),s(V,null,{default:l((()=>[o(n(C.value.goods_data.num),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),i(" 购买数量 "),i(' <view class="card-template mb-[var(--top-m)]">\r\n\t\t\t\t    <view class="card-template-item justify-between">\r\n\t\t\t\t        <view class="text-[28rpx] w-[150rpx] leading-[30rpx] text-[#303133]">购买数量</view>\r\n\t\t\t\t        <u-number-box :min="1" :max="stock" integer :step="1" input-width="68rpx" v-model="buyNum" input-height="52rpx">\r\n\t\t\t\t        \t<template #minus>\r\n\t\t\t\t        \t\t<text class="text-[30rpx] nc-iconfont nc-icon-jianV6xx font-500" :class="{ \'!text-[var(--text-color-light9)]\': buyNum <= 1 }"></text>\r\n\t\t\t\t        \t</template>\r\n\t\t\t\t        \t<template #input>\r\n\t\t\t\t        \t\t<input  class="text-[#303133] text-[28rpx] mx-[10rpx] w-[80rpx] h-[44rpx] bg-[var(--temp-bg)] leading-[44rpx] text-center rounded-[6rpx]" type="number" @input="goodsSkuInputFn" @blur="goodsSkuBlurFn" v-model="buyNum"  />\r\n\t\t\t\t        \t</template>\r\n\t\t\t\t        \t<template #plus>\r\n\t\t\t\t        \t\t<text class="text-[30rpx] nc-iconfont nc-icon-jiahaoV6xx font-500" :class="{ \'!text-[var(--text-color-light9)]\': buyNum >= stock }"></text>\r\n\t\t\t\t        \t</template>\r\n\t\t\t\t        </u-number-box>\r\n\t\t\t\t    </view>\r\n\t\t\t\t</view> '),i(" 订单留言 "),s(F,{class:"card-template"},{default:l((()=>[s(F,{class:"title"},{default:l((()=>[o("订单留言")])),_:1}),s(I,{modelValue:w.value.member_remark,"onUpdate:modelValue":e[0]||(e[0]=t=>w.value.member_remark=t),modelModifiers:{trim:!0},class:"text-[#333] leading-[1.3] w-[100%] h-[140rpx] text-[28rpx]",placeholder:"选填,建议先与商家协商一致","placeholder-class":"text-[var(--text-color-light9)] text-[28rpx]",maxlength:"200"},null,8,["modelValue"])])),_:1})])),_:1}),s(O,{fixed:!0,placeholder:!0,safeAreaInsetBottom:!0,zIndex:"10"},{default:l((()=>[s(F,{class:"flex-1 flex items-center justify-between pl-[30rpx] pr-[20rpx]"},{default:l((()=>[s(F,{class:"flex items-baseline"},{default:l((()=>[s(V,{class:"text-[26rpx] text-[#333] leading-[32rpx]"},{default:l((()=>[o("合计：")])),_:1}),s(F,{class:"inline-block"},{default:l((()=>[s(V,{class:"text-[26rpx] font-500 text-[var(--price-text-color)] price-font leading-[30rpx]"},{default:l((()=>[o("￥")])),_:1}),s(V,{class:"text-[44rpx] font-500 text-[var(--price-text-color)] price-font leading-[46rpx]"},{default:l((()=>[o(n(parseFloat(C.value.basic.order_money).toFixed(2).split(".")[0]),1)])),_:1}),s(V,{class:"text-[26rpx] font-500 text-[var(--price-text-color)] price-font leading-[46rpx]"},{default:l((()=>[o("."+n(parseFloat(C.value.basic.order_money).toFixed(2).split(".")[1]),1)])),_:1})])),_:1})])),_:1}),s(D,{class:"w-[196rpx] h-[70rpx] font-500 text-[26rpx] leading-[70rpx] !text-[#fff] m-0 rounded-full primary-btn-bg remove-border","hover-class":"none",onClick:N},{default:l((()=>[o("提交订单")])),_:1})])),_:1})])),_:1}),s(z,{ref_key:"payRef",ref:S,onClose:B},null,512)])),_:1})):i("v-if",!0)])),_:1},8,["style"])}}}),[["__scopeId","data-v-7e0d516e"]]);export{C as default};
