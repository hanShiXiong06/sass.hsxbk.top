import{d as e,p as t,r as a,j as l,o as s,c as r,w as o,u as n,I as i,b as p,n as c,y as d,z as x,K as u,J as f,f as m,a3 as _,a4 as g,a as y,D as b,i as h,a2 as v,g as k,h as w,Z as j,L as F,l as C,a9 as S}from"./index-d8a8f699.js";import{_ as T}from"./u-empty.41eb000a.js";import{_ as E}from"./u-loading-page.c740ef13.js";import{g as I,a as O,b as z,c as A}from"./sale.f5548578.js";import{M as J}from"./mescroll-body.f9302aea.js";import{M}from"./mescroll-empty.2fe85dec.js";import{u as N}from"./useMescroll.26ccf5de.js";import{t as P}from"./topTabbar.a37f79d9.js";import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.5ba98c98.js";import"./u-loading-icon.6808ae8c.js";import"./u-transition.db07fff7.js";import"./mescroll-i18n.49872024.js";const B=U(e({__name:"sale",setup(e){let U={};const{mescrollInit:B,downCallback:D,getMescroll:L}=N(g,_),R=P();R.setTopTabbarParam({title:"销售奖励"});const Y=t((()=>{let e={backgroundImage:"url("+C("addon/shop_fenxiao/sale/head_bg.png")+") ",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPositionY:"-170rpx"};return e})),Z=t((()=>Object.keys(U).length?S(Number(U.height))+S(U.top)+S(8)+690+"rpx":"690rpx"));let K=a(""),V=a(!0);l((async()=>{await I().then((e=>{K.value=e.data.is_open,0==K.value&&R.setTopTabbarParam({title:"销售奖励",topStatusBar:{textColor:"#333",bgColor:"#fff"}}),V.value=!1}))}));const W=a([{name:"全部",key:"all"},{name:"待发放",key:"0"},{name:"已发放",key:"1"}]),X=a("all"),q=a(0);let G=a(!0),H=a(!0);const Q=a([]),$=e=>{H.value=!0,O({page:e.num,limit:e.size,is_send:X.value}).then((t=>{let a=t.data.data;1==e.num&&(Q.value=[],"1"!=X.value&&ee(a)),Q.value=Q.value.concat(a),H.value=!1,e.endSuccess(a.length)})).catch((()=>{G.value=!1,H.value=!1,e.endErr()}))},ee=async e=>{G.value=!0;const t=await z();let a=e.map((e=>e.period_id));if(Object.keys(t.data).length&&(a.length&&-1==a.indexOf(t.data.id)||!a.length)){let e=JSON.parse(JSON.stringify(t.data));e.reward_money=e.total_reward_money,e.period_id=e.id,e.order_money=e.total_order_money,Q.value.unshift(e)}G.value=!1};let te=a({});A().then((e=>{te.value=e.data}));const ae=()=>{uni.setStorageSync("cashOutAccountType","commission"),y({url:"/app/pages/member/apply_cash_out"})};return(e,t)=>{const a=b,l=h,_=v,g=k(w("u-empty"),T),S=k(w("u-loading-page"),E);return s(),r(l,{class:"bg-[#f8f8f8] min-h-[100vh]",style:c(e.themeColor())},{default:o((()=>[1!=n(K)||n(V)?m("v-if",!0):(s(),i(u,{key:0},[p(l,{class:"fixed w-full z-2 !bg-[#F6F6F6]"},{default:o((()=>[p(l,{class:"w-full overflow-hidden",style:c(n(Y))},{default:o((()=>[p(l,{class:"card-template sidebar-marign mt-[312rpx]"},{default:o((()=>[p(l,{class:"flex justify-between items-baseline mb-[50rpx]"},{default:o((()=>[p(l,{class:"flex flex-col"},{default:o((()=>[p(a,{class:"text-[26rpx] h-[36rpx] leading-[36rpx] text-[#333] mb-[6rpx]"},{default:o((()=>[d("销售奖励（元）")])),_:1}),p(a,{class:"text-[44rpx] price-font text-[#EF000C] min-h-[58rpx] leading-[58rpx]"},{default:o((()=>[d(x(n(j)(n(te).sale_commission)||0),1)])),_:1})])),_:1}),p(l,{class:"flex items-center h-[34rpx]",onClick:ae},{default:o((()=>[p(a,{class:"text-[24rpx] text-[#626779]"},{default:o((()=>[d("去提现")])),_:1}),p(a,{class:"nc-iconfont nc-icon-youV6xx text-[22rpx] text-[#626779]"})])),_:1})])),_:1}),p(l,{class:"flex item-center justify-between"},{default:o((()=>[p(l,{class:"flex flex-col w-[50%]"},{default:o((()=>[p(a,{class:"text-[24rpx] h-[34rpx] leading-[34rpx] text-[#8288A2] mb-[8rpx]"},{default:o((()=>[d("待发放（元）")])),_:1}),p(a,{class:"text-[36rpx] min-h-[46rpx] leading-[46rpx] text-[#333] price-font"},{default:o((()=>[d(x(n(j)(n(te).wait_sale_commission)||0),1)])),_:1})])),_:1}),p(l,{class:"flex flex-col w-[50%]"},{default:o((()=>[p(a,{class:"text-[24rpx] h-[34rpx] leading-[34rpx] text-[#8288A2] mb-[8rpx]"},{default:o((()=>[d("已发放（元）")])),_:1}),p(a,{class:"text-[36rpx] min-h-[46rpx] leading-[46rpx] text-[#333] price-font"},{default:o((()=>[d(x(n(j)(n(te).sale_commission_send)||0),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),p(l,{class:"tab-style-1 pb-[0] mt-[30rpx]"},{default:o((()=>[p(_,{"scroll-x":!0,"scroll-with-animation":"","scroll-into-view":"id"+(q.value>3?q.value-2:0),class:"!h-[100%] flex-1"},{default:o((()=>[p(l,{class:"tab-left"},{default:o((()=>[(s(!0),i(u,null,f(W.value,((e,t)=>(s(),r(l,{id:"id"+t,class:F(["tab-left-item pb-[20rpx]",{"class-select":X.value===e.key,"ml-30rpx":t}]),onClick:a=>((e,t)=>{X.value=e,q.value=t,Q.value=[],L().resetUpScroll()})(e.key,t)},{default:o((()=>[d(x(e.name),1)])),_:2},1032,["id","class","onClick"])))),256))])),_:1})])),_:1},8,["scroll-into-view"])])),_:1})])),_:1}),p(J,{ref:"mescrollRef",down:{use:!1},onInit:n(B),onUp:$,top:n(Z)},{default:o((()=>[!Q.value.length||n(H)||n(G)?m("v-if",!0):(s(!0),i(u,{key:0},f(Q.value,((e,t)=>(s(),r(l,{keys:t,class:"flex flex-col px-[20rpx] py-[22rpx] rounded-[16rpx] bg-[#fff] mt-[24rpx] sidebar-marign",onClick:t=>{return a=e.period_id,void y({url:"/addon/shop_fenxiao/pages/sale_detail",param:{id:a}});var a}},{default:o((()=>[p(l,{class:"flex items-center justify-between h-[40rpx]"},{default:o((()=>[e.is_settlement?(s(),r(l,{key:0,class:"text-[#333] text-[28rpx] flex items-center"},{default:o((()=>[p(a,{class:"text-[24rpx] mr-[6rpx]"},{default:o((()=>[d("结算时间")])),_:1}),p(a,null,{default:o((()=>[d(x(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)):(s(),r(l,{key:1,class:"text-[#333] text-[28rpx] flex items-center"},{default:o((()=>[p(a,{class:"text-[24rpx] mr-[6rpx]"},{default:o((()=>[d("预计结算时间")])),_:1}),p(a,null,{default:o((()=>[d(x(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)),p(l,{class:"text-[32rpx] font-600 text-[#333]"},{default:o((()=>[d(" +"+x(n(j)(e.reward_money)),1)])),_:2},1024)])),_:2},1024),p(l,{class:"flex items-center justify-between mt-[10rpx] h-[34rpx]"},{default:o((()=>[p(l,{class:"text-[24rpx] text-[#8288A2]"},{default:o((()=>[d("销售金额："+x(e.order_money),1)])),_:2},1024),p(l,{class:F(["rounded-[8rpx] px-[10rpx] py-[6rpx] text-[20rpx]",{"bg-[#FFF5F6] text-[#EF000C]":e.is_send,"bg-[#ECF4FF] text-[#308AFF]":!e.is_send}])},{default:o((()=>[d(x(e.is_send?"已发放":"待发放"),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1032,["keys","onClick"])))),256)),Q.value.length||n(H)||n(G)?m("v-if",!0):(s(),r(l,{key:1,class:"box-border pt-[20rpx] px-[30rpx] body-bottom",style:c({height:"calc(100vh - 20rpx - "+n(Z)+")"})},{default:o((()=>[p(l,{class:"h-full rounded-[16rpx] flex items-center justify-center"},{default:o((()=>[p(M,{option:{icon:n(C)("addon/shop_fenxiao/sale/empty.png"),tip:"暂无销售奖励记录",btnText:"去逛逛"},onEmptyclick:t[0]||(t[0]=e=>n(y)({url:"/addon/shop_fenxiao/pages/goods"}))},null,8,["option"])])),_:1})])),_:1},8,["style"]))])),_:1},8,["onInit","top"])],64)),0!=n(K)||n(V)?m("v-if",!0):(s(),r(l,{key:1,class:"h-[100vh] w-[100vw] flex justify-center items-center"},{default:o((()=>[p(g,{text:"销售奖励设置未开启",width:"347rpx",height:"265rpx",icon:n(C)("static/resource/images/system/empty.png")},null,8,["icon"])])),_:1})),p(S,{"bg-color":"rgb(248,248,248)",loading:n(V),loadingText:"",fontSize:"16",color:"#333"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-3343daff"]]);export{B as default};
