import{d as e,r as a,p as l,T as t,F as s,o,c as r,w as c,b as u,A as n,f as i,W as d,y as p,U as x,ad as m,V as f,u as v,n as _,ae as g,af as y,D as h,ab as b,i as k,g as w,h as j,z as C,E as S,a as V,s as F,aA as I,B as U,_ as E}from"./index-71c7df08.js";import{_ as M}from"./tabbar.a37cc2d9.js";import{b as T,c as z}from"./goods.3be4f1b5.js";import{M as N}from"./mescroll-body.49de0f6f.js";import{M as P}from"./mescroll-empty.95b8c17e.js";import{u as R}from"./useMescroll.26ccf5de.js";import"./cloneDeep.77735539.js";import"./mescroll-i18n.00218d15.js";/* empty css                                                                       */const A=E(e({__name:"list",setup(e){const{mescrollInit:E,downCallback:A,getMescroll:B}=R(y,g),D=a([]),O=a([]),Q=a(""),W=a(""),q=a(null),G=a(!1),H=a(!1),J=a(""),K=a(""),L=a(""),X=a("all");a(!1);const Y=a(!0);l((async e=>{W.value=e.curr_goods_category||"",J.value=e.goods_name?decodeURIComponent(e.goods_name):"",Q.value=e.coupon_id||"",await T().then((e=>{D.value.push({category_name:"全部",category_id:""}),D.value=D.value.concat(e.data)}))}));const Z=e=>{G.value=!1;let a={goods_category:W.value,page:e.num,limit:e.size,keyword:J.value,coupon_id:Q.value,order:"all"===X.value?"":X.value,sort:"price"==X.value?K.value:L.value};z(a).then((a=>{let l=a.data.data;1===Number(e.num)&&(O.value=[]),O.value=O.value.concat(l),e.endSuccess(l.length),G.value=!0})).catch((()=>{G.value=!0,e.endErr()}))},$=e=>{X.value=e,"all"==e&&(L.value="",K.value=""),"price"==e&&(L.value="",K.value?K.value="asc"==K.value?"desc":"asc":K.value="asc"),"sale_num"==e&&(K.value="",L.value?L.value="asc"==L.value?"desc":"asc":L.value="asc"),"label"==e?(L.value="asc",K.value="asc",H.value=!0):(H.value=!1,O.value=[],B().resetUpScroll())},ee=()=>{Y.value=!Y.value},ae=e=>{V({url:"/addon/shop/pages/goods/detail",param:{goods_id:e},mode:"navigateTo"})};t((()=>{setTimeout((()=>{B().optUp.textNoMore=s("end")}),500)}));const le=e=>{let a="";return a=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",a},te=e=>{let a="0.00";return a=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,parseFloat(a)};return(e,a)=>{const l=h,t=b,s=k,g=w(j("u-popup"),I),y=U,V=w(j("tabbar"),M);return o(),r(s,{class:"bg-gray-100 min-h-[100vh]",style:_(e.themeColor())},{default:c((()=>[u(s,{class:"fixed left-0 right-0 top-0 product-warp bg-[#fff]"},{default:c((()=>[u(s,{class:"py-[14rpx] flex items-center justify-between px-[20rpx]"},{default:c((()=>[u(s,{class:"flex-1 search-input mr-[20rpx]"},{default:c((()=>[u(l,{onClick:a[0]||(a[0]=n((e=>$("all")),["stop"])),class:"nc-iconfont nc-icon-sousuo-duanV6xx1 btn"}),u(t,{class:"input",maxlength:"50",type:"text",modelValue:J.value,"onUpdate:modelValue":a[1]||(a[1]=e=>J.value=e),placeholder:"请搜索您想要的商品",placeholderClass:"text-[var(--text-color-light9)] text-[24rpx]","confirm-type":"search",onConfirm:a[2]||(a[2]=e=>$("all"))},null,8,["modelValue"]),J.value?(o(),r(l,{key:0,class:"nc-iconfont nc-icon-cuohaoV6xx1 clear",onClick:a[3]||(a[3]=e=>J.value="")})):i("v-if",!0)])),_:1}),u(s,{class:d(["iconfont text-[32rpx] text-[#333] -mb-[2rpx]",Y.value?"icona-yingyongzhongxinV6xx-32":"icona-yingyongliebiaoV6xx-32"]),onClick:ee},null,8,["class"])])),_:1}),u(s,{class:"flex justify-between tems-center h-[88rpx] px-[30rpx]"},{default:c((()=>[u(s,{class:"flex items-center justify-between text-[26rpx] flex-1"},{default:c((()=>[u(l,{class:d(["text-[#333]",{"text-[var(--primary-color)] font-500":"all"==X.value}]),onClick:a[4]||(a[4]=e=>$("all"))},{default:c((()=>[p("综合排序")])),_:1},8,["class"]),u(s,{class:d(["flex items-center text-[#333]",{"text-[var(--primary-color)] font-500":"sale_num"==X.value}]),onClick:a[5]||(a[5]=e=>$("sale_num"))},{default:c((()=>[u(l,{class:"mr-[4rpx]"},{default:c((()=>[p("销量")])),_:1}),"asc"==L.value?(o(),r(l,{key:0,class:d(["text-[16rpx] nc-iconfont nc-icon-a-xiangshangV6xx1",{"text-[var(--primary-color)]":"sale_num"==X.value}])},null,8,["class"])):(o(),r(l,{key:1,class:d(["text-[16rpx] nc-iconfont nc-icon-a-xiangxiaV6xx1",{"text-[var(--primary-color)]":"sale_num"==X.value}])},null,8,["class"]))])),_:1},8,["class"]),u(s,{class:d(["flex items-center text-[#333]",{"text-[var(--primary-color)] font-500":"price"==X.value}]),onClick:a[6]||(a[6]=e=>$("price"))},{default:c((()=>[u(l,{class:"mr-[4rpx]"},{default:c((()=>[p("价格")])),_:1}),"asc"==K.value?(o(),r(l,{key:0,class:d(["text-[16rpx] nc-iconfont nc-icon-a-xiangshangV6xx1",{"text-[var(--primary-color)]":"price"==X.value}])},null,8,["class"])):(o(),r(l,{key:1,class:d(["text-[16rpx] nc-iconfont nc-icon-a-xiangxiaV6xx1",{"text-[var(--primary-color)]":"price"==X.value}])},null,8,["class"]))])),_:1},8,["class"]),u(s,{class:d(["flex items-center",{"text-[var(--primary-color)] font-500":"label"==X.value,"text-[#333]":"label"!=X.value}]),onClick:a[7]||(a[7]=e=>$("label"))},{default:c((()=>[u(l,{class:"mr-[8rpx]"},{default:c((()=>[p("筛选")])),_:1}),u(l,{class:"iconfont font-500 icona-shaixuanV6xx-34 -mb-[4rpx] !text-[26rpx]"})])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),u(g,{show:H.value,mode:"top",onClose:a[9]||(a[9]=e=>H.value=!1)},{default:c((()=>[u(s,{onTouchmove:a[8]||(a[8]=n((()=>{}),["prevent","stop"]))},{default:c((()=>[u(s,{class:"text-[28rpx] px-[30rpx] mt-[40rpx]"},{default:c((()=>[p("全部分类")])),_:1}),u(s,{class:"flex flex-wrap pl-[30rpx] pt-[30rpx]"},{default:c((()=>[(o(!0),x(f,null,m(D.value,((e,a)=>(o(),r(l,{onClick:a=>{return l=e.category_id,W.value=l,O.value=[],B().resetUpScroll(),void(H.value=!1);var l},key:e.category_id,class:d([{"label-select":W.value==e.category_id},"truncate text-[#333] px-[10rpx] border-[2rpx] border-solid border-transparent w-[184rpx] h-[56rpx] flex items-center justify-center mr-[30rpx] mb-[30rpx] box-border bg-[var(--temp-bg)] rounded-[50rpx] text-[24rpx]"])},{default:c((()=>[p(C(e.category_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1})])),_:1},8,["show"]),u(N,{ref_key:"mescrollRef",ref:q,top:"176rpx",bottom:"60px",onInit:v(E),down:{use:!1},onUp:Z},{default:c((()=>[O.value.length?(o(),r(s,{key:0,class:d(["sidebar-margin",Y.value?"":"flex justify-between flex-wrap"])},{default:c((()=>[(o(!0),x(f,null,m(O.value,((e,a)=>(o(),x(f,null,[Y.value?(o(),r(s,{key:0,class:d(["bg-white flex px-[20rpx] py-[24rpx] rounded-[var(--rounded-small)] overflow-hidden top-mar",{"mb-[20rpx]":a+1==O.value.length}]),onClick:a=>ae(e.goods_id)},{default:c((()=>[e.goods_cover_thumb_mid?(o(),r(y,{key:0,class:"w-[190rpx] h-[190rpx] rounded-[var(--rounded-mid)]",src:v(S)(e.goods_cover_thumb_mid),mode:"aspectFill",onError:a=>e.goods_cover_thumb_mid="static/resource/images/diy/shop_default.jpg"},null,8,["src","onError"])):(o(),r(y,{key:1,class:"w-[190rpx] h-[190rpx] rounded-[var(--rounded-mid)]",src:v(S)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])),u(s,{class:"flex-1 flex flex-col ml-[20rpx] py-[6rpx]"},{default:c((()=>[u(s,{class:"text-[28rpx] text-[#333] leading-[40rpx] multi-hidden mb-[10rpx]"},{default:c((()=>[p(C(e.goods_name),1)])),_:2},1024),u(s,{class:"mt-auto flex justify-between items-baseline"},{default:c((()=>[u(s,{class:"text-[var(--price-text-color)] price-font flex items-baseline"},{default:c((()=>[u(l,{class:"text-[24rpx] font-500 mr-[4rpx]"},{default:c((()=>[p("￥")])),_:1}),u(l,{class:"text-[40rpx] font-500"},{default:c((()=>[p(C(te(e).toFixed(2).split(".")[0]),1)])),_:2},1024),u(l,{class:"text-[24rpx] font-500"},{default:c((()=>[p("."+C(te(e).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==le(e)?(o(),r(y,{key:0,class:"h-[24rpx] w-[72rpx] ml-[6rpx]",src:v(S)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0),"discount_price"==le(e)?(o(),r(y,{key:1,class:"h-[24rpx] w-[72rpx] ml-[6rpx]",src:v(S)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0)])),_:2},1024),u(l,{class:"text-[22rpx] text-[var(--text-color-light9)]"},{default:c((()=>[p("已售"+C(e.sale_num)+C(e.unit),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])):(o(),r(s,{key:1,class:"goods-item-style-two flex flex-col bg-[#fff] box-border rounded-[var(--rounded-mid)] overflow-hidden mt-[var(--top-m)]",onClick:a=>ae(e.goods_id)},{default:c((()=>[e.goods_cover_thumb_mid?(o(),r(y,{key:0,class:"w-[100%] h-[344rpx] rounded-tl-[var(--rounded-mid)] rounded-tr-[var(--rounded-mid)]",src:v(S)(e.goods_cover_thumb_mid),mode:"aspectFill",onError:a=>e.goods_cover_thumb_mid="static/resource/images/diy/shop_default.jpg"},null,8,["src","onError"])):(o(),r(y,{key:1,class:"w-[100%] h-[344rpx] rounded-tl-[var(--rounded-mid)] rounded-tr-[var(--rounded-mid)]",src:v(S)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])),u(s,{class:"px-[20rpx] flex-1 pt-[16rpx] pb-[24rpx] flex flex-col justify-between"},{default:c((()=>[u(s,{class:"text-[#303133] leading-[40rpx] text-[28rpx] multi-hidden"},{default:c((()=>[p(C(e.goods_name),1)])),_:2},1024),u(s,{class:"flex justify-between flex-wrap items-baseline mt-[28rpx]"},{default:c((()=>[u(s,{class:"text-[var(--price-text-color)] price-font flex items-baseline"},{default:c((()=>[i('\t\t\t\t\t\t\t\t\t\t<text class="text-[20rpx]  mr-[4rpx]">￥</text>'),i('\t\t\t\t\t\t\t\t\t\t<text class="text-[36rpx] font-500">{{ item.goodsSku.price }}</text>'),u(l,{class:"text-[24rpx] font-500"},{default:c((()=>[p("￥")])),_:1}),u(l,{class:"text-[40rpx] font-500"},{default:c((()=>[p(C(te(e).toFixed(2).split(".")[0]),1)])),_:2},1024),u(l,{class:"text-[24rpx] font-500"},{default:c((()=>[p("."+C(te(e).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==le(e)?(o(),r(y,{key:0,class:"h-[24rpx] ml-[6rpx]",src:v(S)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0),"discount_price"==le(e)?(o(),r(y,{key:1,class:"h-[24rpx] ml-[6rpx]",src:v(S)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):i("v-if",!0)])),_:2},1024),u(l,{class:"text-[22rpx] text-[var(--text-color-light9)]"},{default:c((()=>[p("已售"+C(e.sale_num)+C(e.unit),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]))],64)))),256))])),_:1},8,["class"])):i("v-if",!0),!O.value.length&&G.value?(o(),r(P,{key:1,option:{tip:"暂无商品",btnText:"去逛逛"}})):i("v-if",!0)])),_:1},8,["onInit"]),u(V)])),_:1},8,["style"])}}}),[["__scopeId","data-v-c7215b98"]]);export{A as default};
