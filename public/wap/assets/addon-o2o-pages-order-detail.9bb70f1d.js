import{d as e,r as t,p as r,o as l,c as a,w as s,P as o,b as d,y as i,z as u,u as n,f,Q as p,a7 as x,n as c,a as _,c3 as m,k as v,aT as b,D as y,i as g,g as h,h as k,F as j,E as w}from"./index-7bf68536.js";import{_ as C}from"./u-icon.0c1c54c7.js";import{_ as T,a as M}from"./u-steps.9fc55f35.js";import{_ as P}from"./u--image.b3bf1d5c.js";import{_ as z}from"./u-empty.68b4529f.js";import{_ as N}from"./pay.d2e850e8.js";import{_ as D}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{e as F,c as O,d as R}from"./order.d71d5845.js";import{_ as V}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-text.df478cbc.js";import"./u-image.e46f68ef.js";import"./u-transition.cdf87992.js";import"./u-popup.be4bfacd.js";import"./u-safe-bottom.908eeae4.js";import"./pay.2db06871.js";import"./u-loading-page.566c330a.js";import"./u-loading-icon.b37701e7.js";const E=V(e({__name:"detail",setup(e){let V=0;const E=t(null),S=t(!1);r((e=>{V=e.order_id||0,$()}));const $=()=>{S.value=!0,F(V).then((e=>{E.value=e.data,S.value=!1,G()})).catch((()=>{S.value=!1}))},A=()=>{F(V).then((e=>{E.value=e.data,G()})).catch((()=>{}))},B=t(null),H=(e="",t="")=>{var r,l;"pay"==e?null==(r=B.value)||r.open(E.value.order_type,E.value.order_id,`/addon/o2o/pages/order/detail?order_id=${E.value.order_id}`):"item_pay"==e?null==(l=B.value)||l.open("o2o_item",t.order_item_id,`/addon/o2o/pages/order/detail?order_id=${E.value.order_id}`):"cancel"==e?I(E.value):"delete"==e?L(E.value):"index"==e&&_({url:"/addon/o2o/pages/index",mode:"reLaunch"})},I=e=>{m({title:"提示",content:"您确定要取消该订单吗？",confirmColor:v().themeColor["--primary-color"],success:t=>{t.confirm&&O(e.order_id).then((e=>{$()}))}})},L=e=>{m({title:"提示",content:"您确定要删除该订单吗？",confirmColor:v().themeColor["--primary-color"],success:t=>{t.confirm&&R(e.order_id).then((e=>{_({url:"/addon/o2o/pages/order/list"})})).catch((()=>{}))}})};function Q(e){var t=new Date(e).getTime();if(null!=t&&""!=t&&t>0){var r=new Date;r.setTime(t);var l=r.getMonth()+1;l=l<10?"0"+l:l;var a=r.getDate();a=a<10?"0"+a:a;var s=r.getHours();s=s<10?"0"+s:s;var o=r.getMinutes();return l+"-"+a+" "+s+":"+(o=o<10?"0"+o:o)}return""}const q=t(0);function G(){return"dispatch"==E.value.order_status_info.status?q.value=0:"wait_service"==E.value.order_status_info.status?q.value=1:"in_service"==E.value.order_status_info.status?q.value=2:"finish"==E.value.order_status_info.status?q.value=3:void 0}return(e,t)=>{const r=y,m=g,v=h(k("u-icon"),C),F=h(k("u-steps-item"),T),O=h(k("u-steps"),M),R=h(k("u--image"),P),V=h(k("u-empty"),z),$=h(k("pay"),N),I=h(k("loading-page"),D);return l(),a(m,{style:c(e.themeColor())},{default:s((()=>[S.value?f("v-if",!0):(l(),o(p,{key:0},[E.value?(l(),a(m,{key:0,class:"bg-[#f7f7f7] min-h-screen overflow-hidden"},{default:s((()=>[d(m,{class:"bg-linear h-[480rpx] text-white px-3 pt-5"},{default:s((()=>[d(m,{class:"text-[42rpx] flex items-baseline text-[#fff]"},{default:s((()=>[d(r,{class:"nc-iconfont nc-icon-a-shijianV6xx-36 text-[42rpx] mr-1"}),d(r,{class:"font-bold"},{default:s((()=>{var e,t;return[i(u(n(j)("order"))+u(null==(t=null==(e=E.value)?void 0:e.order_status_info)?void 0:t.name),1)]})),_:1})])),_:1})])),_:1}),d(m,{class:"bg-[#fff] mx-3 p-[30rpx] -mt-[360rpx] rounded-[10rpx]"},{default:s((()=>[d(m,{class:"flex"},{default:s((()=>[d(m,{class:"min-w-[50rpx] flex items-center justify-center"},{default:s((()=>[d(v,{name:"map",size:"20"})])),_:1}),d(m,{class:"flex flex-col ml-[20rpx]"},{default:s((()=>[d(r,{class:"text-[24rpx] mt-[10rpx] leading-[35rpx] line-feed"},{default:s((()=>[i(u(E.value.taker_full_address),1)])),_:1}),d(m,null,{default:s((()=>[d(r,{class:"text-[24rpx]"},{default:s((()=>[i(u(E.value.taker_name),1)])),_:1}),d(r,{class:"text-[24rpx] mt-[15rpx]"},{default:s((()=>[i(u(E.value.taker_mobile),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),E.value.pay_time?(l(),a(m,{key:0,class:"flex py-4 px-3 bg-white rounded-md box-border mx-3 mt-[20rpx] task-steps"},{default:s((()=>[d(O,{current:q.value,activeColor:"var(--primary-color)"},{default:s((()=>[d(F,{title:n(j)("placeOrder"),desc:E.value.create_time?Q(E.value.create_time):"---"},null,8,["title","desc"]),d(F,{title:n(j)("takeOrders"),desc:E.value.dispatch_time?Q(E.value.dispatch_time):"---"},null,8,["title","desc"]),d(F,{title:n(j)("start"),desc:E.value.service_time?Q(E.value.service_time):"---"},null,8,["title","desc"]),d(F,{title:n(j)("finish"),desc:E.value.finish_time?Q(E.value.finish_time):"---"},null,8,["title","desc"])])),_:1},8,["current"])])),_:1})):f("v-if",!0),d(m,{class:"mt-[20rpx]"},{default:s((()=>[d(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] rounded-[10rpx]"},{default:s((()=>[(l(!0),o(p,null,x(E.value.item,((e,t)=>(l(),a(m,{class:"order-goods-item py-[20rpx]",key:t},{default:s((()=>[d(m,{class:"flex justify-between items-center",onClick:t=>{var r;"reservation"!=(r=e).item_type&&"buy"!=r.item_type||_({url:"/addon/o2o/pages/goods/detail",param:{sku_id:r.item_id}})}},{default:s((()=>[d(m,{class:"w-[160rpx] h-[160rpx] flex-2"},{default:s((()=>[d(R,{class:"rounded-[10rpx] overflow-hidden",width:"160rpx",height:"160rpx",src:n(w)(e.item_image?e.item_image:""),model:"aspectFill"},{error:s((()=>[d(v,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024),d(m,{class:"ml-[20rpx] flex-1"},{default:s((()=>[d(m,{class:"flex justify-between"},{default:s((()=>[d(r,{class:"text-[28rpx] text-item leading-[40rpx] max-h-[80rpx] w-[360rpx] multi-hidden"},{default:s((()=>[i(u(e.item_name),1)])),_:2},1024),d(r,{class:"shrink-0 text-[24rpx] text-[var(--primary-color)] ml-[10rpx] leading-[40rpx]"},{default:s((()=>[i(u(e.pay_time?n(j)("havePaid"):n(j)("notPaid")),1)])),_:2},1024)])),_:2},1024),d(m,{class:"text-[24rpx] mt-[20rpx] flex"},{default:s((()=>[d(r,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:s((()=>[i(u(e.item_type_name),1)])),_:2},1024)])),_:2},1024),d(m,{class:"flex justify-between mt-[26rpx] items-center"},{default:s((()=>[d(r,{class:"text-right text-[28rpx] text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(e.price),1)])),_:2},1024),d(r,{class:"text-right text-sm"},{default:s((()=>[d(r,{class:"text-[26rpx]"},{default:s((()=>[i("x")])),_:1}),i(u(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),d(m,{class:"flex justify-end self-end w-[100%] mt-[10rpx]"},{default:s((()=>[e.refund_no&&""!=e.refund_status&&"cancel"!=e.refund_status?(l(),a(m,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>n(_)({url:"/addon/o2o/pages/refund/detail",param:{refund_no:e.refund_no}})},{default:s((()=>[i(u(n(j)("viewRefund")),1)])),_:2},1032,["onClick"])):f("v-if",!0),E.value.order_status_info.is_refund&&e.is_enable_refund&&-1!=["","cancel"].indexOf(e.refund_status)?(l(),a(m,{key:1,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{return r=e.order_item_id,void _({url:"/addon/o2o/pages/refund/apply",param:{order_id:E.value.order_id,order_item_id:r}});var r}},{default:s((()=>[i(u(n(j)("applyRefund")),1)])),_:2},1032,["onClick"])):f("v-if",!0),"custom"==e.item_type?(l(),o(p,{key:2},[e.pay_time?f("v-if",!0):(l(),a(m,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>H("item_pay",e)},{default:s((()=>[i(u(n(j)("goToPay")),1)])),_:2},1032,["onClick"])),d(m,{class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{var r;_({url:"/addon/o2o/pages/master/task/show",param:{order_id:(r=e).order_id,order_item_id:r.order_item_id,item_name:r.item_name,price:r.item_money,item_images:r.item_images}})}},{default:s((()=>[i(u(n(j)("show")),1)])),_:2},1032,["onClick"])],64)):f("v-if",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),E.value.check_code?(l(),a(m,{key:0,class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[E.value.technician_id?(l(),a(m,{key:0,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("servicePersonal")),1)])),_:1}),d(m,{class:"text-[var(--text-color-light9)]",onClick:t[0]||(t[0]=e=>n(_)({url:"/addon/o2o/pages/technician/detail",param:{id:E.value.technician_id}}))},{default:s((()=>[i(u(E.value.technician_id?E.value.technician_info.name:n(j)("orderToBeSent")),1)])),_:1})])),_:1})):f("v-if",!0),E.value.technician_id?(l(),a(m,{key:1,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("contactNumber")),1)])),_:1}),d(m,{class:"text-[var(--text-color-light9)]",onClick:t[1]||(t[1]=e=>{return t=E.value.technician_info.mobile,void b({phoneNumber:t});var t})},{default:s((()=>[i(u(E.value.technician_info.mobile),1)])),_:1})])),_:1})):f("v-if",!0),d(m,{class:"flex justify-between text-[28rpx] mt-[30rpx]"},{default:s((()=>[d(r,null,{default:s((()=>[i(u(n(j)("serviceCode")),1)])),_:1}),d(r,{class:"text-[var(--text-color-light9)]"},{default:s((()=>[i(u(E.value.check_code),1)])),_:1})])),_:1}),d(m,{class:"text-[20rpx] mt-[20rpx] text-[var(--text-color-light9)]"},{default:s((()=>[i(u(n(j)("explain")),1)])),_:1})])),_:1})):f("v-if",!0),d(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("onOrder")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(E.value.order_no),1)])),_:1})])),_:1}),E.value.out_trade_no?(l(),a(m,{key:0,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("transactionNumber")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(E.value.out_trade_no),1)])),_:1})])),_:1})):f("v-if",!0),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("createTime")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(E.value.create_time),1)])),_:1})])),_:1}),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("reserveServiceTime")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(E.value.reserve_service_time),1)])),_:1})])),_:1}),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx] box-border"},{default:s((()=>[d(m,{class:"shrink-0 mr-[18rpx]"},{default:s((()=>[i(u(n(j)("remark")),1)])),_:1}),d(m,{class:"max-w-[510rpx] leading-[38rpx] line-feed"},{default:s((()=>[i(u(E.value.member_message?E.value.member_message:"无"),1)])),_:1})])),_:1}),E.value.pay?(l(),a(m,{key:1,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("modePayment")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(E.value.pay.type_name),1)])),_:1})])),_:1})):f("v-if",!0),E.value.pay?(l(),a(m,{key:2,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("payTime")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(E.value.pay.pay_time),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1}),d(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[d(m,{class:"flex justify-between text-[28rpx] pt-[20rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("goodsMoney")),1)])),_:1}),d(m,{class:"text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(E.value.total_money),1)])),_:1})])),_:1}),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[40rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(j)("realMoney")),1)])),_:1}),d(m,{class:"text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(E.value.total_pay_money),1)])),_:1})])),_:1})])),_:1})])),_:1}),d(m,{class:"h-[160rpx] w-full"}),d(m,{class:"flex z-2 justify-between items-center bg-[#fff] fixed left-0 right-0 bottom-0 min-h-[100rpx] px-1 flex-wrap pb-ios"},{default:s((()=>[d(m,{class:"flex ml-[30rpx] w-[70rpx] flex-col justify-center items-center",onClick:t[2]||(t[2]=e=>H("index"))},{default:s((()=>[d(r,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[36rpx]"}),d(r,{class:"text-xs mt-1"},{default:s((()=>[i(u(n(j)("index")),1)])),_:1})])),_:1}),E.value.order_status_info?(l(),a(m,{key:0,class:"flex justify-end mr-[30rpx]"},{default:s((()=>[(l(!0),o(p,null,x(E.value.order_status_info.member_action,((e,t)=>(l(),a(m,{key:t,class:"inline-block text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>H(e.key)},{default:s((()=>[i(u(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})):f("v-if",!0)])),_:1})])),_:1})):(l(),a(m,{key:1,class:"w-screen h-screen flex flex-col justify-center items-center"},{default:s((()=>[d(V,{icon:n(w)("static/resource/images/order_empty.png"),text:"未获取到订单信息"},null,8,["icon"])])),_:1})),f(" 刷新 "),d(m,{class:"fixed bottom-[calc(160rpx+env(safe-area-inset-bottom))] right-[30rpx] rounded-full bg-[#fff] w-[80rpx] h-[80rpx] flex flex-col items-center justify-center shadow-xl",onClick:A},{default:s((()=>[d(r,{class:"nc-iconfont nc-icon-shuaxinV6xx text-[36rpx]"}),d(r,{class:"text-[22rpx] mt-[6rpx]"},{default:s((()=>[i(u(n(j)("refresh")),1)])),_:1})])),_:1})],64)),d($,{ref_key:"payRef",ref:B},null,512),d(I,{loading:S.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-ad4ab945"]]);export{E as default};
