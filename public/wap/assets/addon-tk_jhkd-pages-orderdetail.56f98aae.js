import{d as e,r as a,N as t,p as s,o as r,U as d,b as l,w as o,y as f,z as n,c as u,f as c,V as i,ad as _,e as x,v as m,u as p,b1 as k,i as v,D as y,g as I,h as g,B as h,E as b,b7 as w,c9 as j,c1 as N,c2 as O,_ as C}from"./index-71c7df08.js";import{_ as J}from"./tabbar.a37cc2d9.js";import{_ as S}from"./pay.6aa36878.js";import{e as z,c as P,d as U,b as D,f as V}from"./order.898f5699.js";import{g as q}from"./goto.334b67ec.js";import"./cloneDeep.77735539.js";import"./pay.4cfa8889.js";const B=C(e({__name:"orderdetail",setup(e){const C=a(null),B=a(!1),E=t({}),R=a(),T=a(),$=e=>{k({phoneNumber:e})},A=async()=>{await P(E.id),q("/addon/tk_jhkd/pages/orderlist")},F=async()=>{await U(E.id),q("/addon/tk_jhkd/pages/orderlist")},G=async()=>{let e={id:E.id,close_reason:"用户主动退款"};await D(e),q("/addon/tk_jhkd/pages/orderlist")},H=()=>{var e;B.value=!0,null==(e=C.value)||e.open(E.payInfo.trade_type,E.payInfo.trade_id,"/tk_jhkd/pages/orderdetail?id="+E.id)},K=async e=>{const a=await z(e);null==a.data.order_status_arr&&(uni.$u.toast("订单不存在或删除"),setTimeout((function(){q("/addon/tk_jhkd/pages/orderlist")}),1e3)),Object.assign(E,a.data),E.orderInfo.delivery_id&&(async e=>{const a=await V(e);R.value=a.data})(E.orderInfo.delivery_id),E.orderInfo.courier_context&&(T.value=JSON.parse(E.orderInfo.courier_context),console.log(T.value))};return s((e=>{e.id&&K(e.id)})),(e,a)=>{const t=v,s=y,k=I(g("u-icon"),w),z=I(g("u-code-input"),j),P=h,U=I(g("u-steps-item"),N),D=I(g("u-steps"),O),V=I(g("tabbar"),J),q=I(g("pay"),S);return r(),d(i,null,[l(t,{class:""},{default:o((()=>[l(t,{class:"tk-card"},{default:o((()=>[l(t,{class:"order-num-card"},{default:o((()=>[l(t,{class:"text-xs font-weight text-slate-600"},{default:o((()=>[f("订单号:"+n(E.order_id),1)])),_:1}),l(t,{class:"fb mt-1"},{default:o((()=>[l(t,{class:"text-xs font-weight text-slate-500"},{default:o((()=>[f(n(E.create_time),1)])),_:1}),E.order_status_arr?(r(),u(t,{key:0,class:"mr-4 tk-tag"},{default:o((()=>[f(n(E.order_status_arr.name),1)])),_:1})):c("v-if",!0)])),_:1})])),_:1}),l(t,{class:"flex mt-1 items-center"},{default:o((()=>[l(t,{class:"mr-4"},{default:o((()=>[l(s,{class:"qu-tag text-xs"},{default:o((()=>[f("取")])),_:1})])),_:1}),E.orderInfo?(r(),u(t,{key:0,class:""},{default:o((()=>[l(t,{class:"tk-sltext text-xs text-[#4b4b4b] font-bold"},{default:o((()=>[f(n(JSON.parse(E.orderInfo.start_address).address),1)])),_:1}),l(t,{class:"text-xs flex"},{default:o((()=>[l(t,{class:"tk-sltext"},{default:o((()=>[f(n(JSON.parse(E.orderInfo.start_address).full_address),1)])),_:1})])),_:1}),l(t,{class:"text-xs flex"},{default:o((()=>[l(t,{class:"tk-sltext"},{default:o((()=>[f(n(JSON.parse(E.orderInfo.start_address).mobile),1)])),_:1})])),_:1})])),_:1})):c("v-if",!0)])),_:1}),l(t,{class:"flex mt-2 items-center"},{default:o((()=>[l(t,{class:"mr-4"},{default:o((()=>[l(s,{class:"song-tag text-xs"},{default:o((()=>[f("送")])),_:1})])),_:1}),E.orderInfo?(r(),u(t,{key:0,class:""},{default:o((()=>[l(t,{class:"tk-sltext text-xs text-[#4b4b4b] font-bold"},{default:o((()=>[f(n(JSON.parse(E.orderInfo.end_address).address),1)])),_:1}),l(t,{class:"text-xs flex"},{default:o((()=>[l(t,{class:"tk-sltext w-3/4"},{default:o((()=>[f(n(JSON.parse(E.orderInfo.end_address).full_address),1)])),_:1})])),_:1}),l(t,{class:"text-xs flex"},{default:o((()=>[l(t,{class:"tk-sltext w-3/4"},{default:o((()=>[f(n(JSON.parse(E.orderInfo.end_address).mobile),1)])),_:1})])),_:1})])),_:1})):c("v-if",!0)])),_:1}),E.orderInfo?(r(),u(t,{key:0,class:"detail-tag mt-2 text-xs font-weight p-4 text-[#878787]"},{default:o((()=>[f(" 物品:"+n(E.orderInfo.goods)+"重量:"+n(E.orderInfo.weight)+"kg "+n(E.orderInfo.goods)+" "+n(E.orderInfo.long)+"x"+n(E.orderInfo.width)+"x"+n(E.orderInfo.height)+"cm ",1)])),_:1})):c("v-if",!0),l(t,{class:"detail-tag font-weight p-4 text-[#313131]"},{default:o((()=>[f("备注:"+n(E.remark),1)])),_:1}),l(t,{class:"flex justify-end mt-2"},{default:o((()=>[E.order_status_arr?(r(!0),d(i,{key:0},_(E.order_status_arr.member_action,((e,a)=>(r(),u(t,{class:"tk-tag mr-4",onClick:a=>{return"gopay"==(t=e.class)&&H(),"del"==t&&F(),"refund"==t&&G(),void("close"==t&&A());var t}},{default:o((()=>[f(n(e.name),1)])),_:2},1032,["onClick"])))),256)):c("v-if",!0)])),_:1})])),_:1}),l(t,{class:"tk-card"},{default:o((()=>[E.orderInfo&&T.value&&1==E.orderInfo.order_status?(r(),u(t,{key:0,class:"mb-2 font-weight text-xs text-slate-600"},{default:o((()=>[l(t,{class:"fl items-center"},{default:o((()=>[l(t,{class:""},{default:o((()=>[f("揽件员："+n(T.value.courierName),1)])),_:1}),l(t,{class:"ml-4 mr-1",onClick:a[0]||(a[0]=e=>$(T.value.courierPhone))},{default:o((()=>[f("联系电话："+n(T.value.courierPhone),1)])),_:1}),l(k,{name:"phone",color:"#676767",size:"18",onClick:a[1]||(a[1]=e=>$(T.value.courierPhone))})])),_:1}),T.value&&T.value.pickUpCode?(r(),u(t,{key:0,class:"mt-2"},{default:o((()=>[l(z,{size:"24",bold:"",color:"#2931cc",value:T.value.pickUpCode},null,8,["value"])])),_:1})):c("v-if",!0)])),_:1})):c("v-if",!0),x(l(t,{class:"mt-2 flex items-center"},{default:o((()=>[l(P,{src:p(b)(E.orderInfo&&E.orderInfo.delivery_arry?E.orderInfo.delivery_arry.logo:""),mode:"",style:{width:"34px",height:"34px","border-radius":"100%"}},null,8,["src"]),l(t,{class:""},{default:o((()=>[l(t,{class:"ml-2 text-sm"},{default:o((()=>[f(n(E.orderInfo&&E.orderInfo.delivery_arry?E.orderInfo.delivery_arry.name:""),1)])),_:1}),E.orderInfo&&1!=E.orderInfo.order_status?(r(),u(t,{key:0,class:"ml-2 font-weight text-xs text-slate-600"},{default:o((()=>[f(n(E.orderInfo&&E.orderInfo.delivery_id?E.orderInfo.delivery_id:"暂无单号"),1)])),_:1})):c("v-if",!0)])),_:1}),l(t,{class:"tk-tag ml-2 font-weight text-xs text-slate-600"},{default:o((()=>[f(n(E.orderInfo&&E.orderInfo.order_status_desc?E.orderInfo.order_status_desc:"暂无状态"),1)])),_:1})])),_:1},512),[[m,E.orderInfo&&E.orderInfo.delivery_arry]])])),_:1}),l(t,{class:"tk-card"},{default:o((()=>[R.value&&R.value.length>0?(r(),u(t,{key:0,class:"p-2"},{default:o((()=>[l(D,{dot:"true",direction:"column"},{default:o((()=>[(r(!0),d(i,null,_(R.value,((e,a)=>(r(),u(U,{key:"index",title:e.desc,desc:e.time},null,8,["title","desc"])))),128))])),_:1})])),_:1})):(r(),u(t,{key:1,class:"text-xs text-slate-400"},{default:o((()=>[f("暂无运单动态")])),_:1}))])),_:1})])),_:1}),l(V,{addon:"tk_jhkd"}),l(q,{ref_key:"payRef",ref:C,onClose:a[2]||(a[2]=e=>B.value=!1)},null,512)],64)}}}),[["__scopeId","data-v-4069dea9"]]);export{B as default};
