import{d as e,r as t,l,j as a,p as s,E as r,L as o,o as n,c,w as u,u as i,b as d,y as x,z as f,U as m,ad as p,V as _,cd as b,f as h,A as g,n as v,cc as y,g as k,h as w,i as F,D as j,cf as C,B as V,ac as D,C as P,W as T,F as O,t as z,s as E,H as I,a as S,b_ as U,aA as A,M as B,ce as H,_ as L}from"./index-71c7df08.js";import{_ as M}from"./loading-page.vue_vue_type_script_setup_true_lang.c7dc2256.js";import{k as N,l as R,m as W}from"./tourism.86990a9a.js";import{s as Y}from"./share-poster.aefc8367.js";const q=L(e({__name:"detail",setup(e){let L=t([]),q=t([]),G=t(!0),J=t(!1),K=t(!1),Q=t(!1),X=t([]),Z=t({start_time:"",end_time:"",day:1}),$={room_id:"",start_time:"",end_time:"",num:1},ee=t(!1),te=t(!1);const le=l(),ae=a((()=>le.info)),se=e=>(y(Date.parse(e.date)/1e3,"year_month_day"),e),re=e=>{$.start_time=e[0],$.end_time=e[e.length-1],Z.value.start_time=ie(e[0]),Z.value.end_time=ie(e[e.length-1]),Z.value.day=e.length-1,ee.value=!1,fe($.start_time)};let oe=t(""),ne=t([]);s((e=>{var t;oe.value=e.id,G.value=!0,t=e.id,R(t).then((e=>{e.data,te.value=!0})).catch((()=>{G.value=!0})),N(e.id).then((e=>{q.value=e.data,ne.value.push({id:1,latitude:q.value.latitude,longitude:q.value.longitude,iconPath:r("addon/tourism/tourism/map_icon.png"),height:25}),o({title:q.value.hotel_name}),L.value=[],q.value.image_thumb_big&&q.value.image_thumb_big.length?q.value.image_thumb_big.forEach(((e,t)=>{L.value.push(r(e))})):L.value.push(r(q.value.cover_thumb_big)),q.value.hotel_tag&&(q.value.hotel_tag=q.value.hotel_tag.split("，").join(",").split(","),q.value.hotel_tag=q.value.hotel_tag.filter((e=>e&&e.trim()))),q.value.hotel_attribute&&(q.value.hotel_attribute=q.value.hotel_attribute.split("，").join(",").split(","),q.value.hotel_attribute=q.value.hotel_attribute.filter((e=>e&&e.trim()))),q.value.room_list&&q.value.room_list.forEach(((e,t)=>{e.attr_name=e.attr_name.split("|").filter(((e,t)=>e&&e.trim()))})),X.value=q.value.room_list||[],be(),G.value=!1}))}));let ce=t({});const ue=(e,t)=>"empty"==t?(z({title:"入住时间当日房间已售空",icon:"none"}),!1):E()?($.room_id=e.goods_id,uni.setStorageSync("hotelCreateData",$),void S({url:"/addon/tourism/pages/hotel/order"})):(I().setLoginBack({url:"/addon/tourism/pages/hotel/detail",param:{id:oe.value}}),!1),ie=e=>{var t=[];return-1!=e.indexOf("-")?t=e.split("-"):-1!=e.indexOf("/")&&(t=e.split("/")),t[1]+"月"+t[2]+"日"},de=e=>{var t=864e5*e;return new Date(Date.now()+t)},xe=e=>{let t=e.getFullYear(),l=e.getMonth()+1,a=e.getDate();return""+(t+"-"+(l<10?"0"+l:l)+"-"+(a<10?"0"+a:a))};Z.value.start_time=ie(xe(de(0))),Z.value.end_time=ie(xe(de(1))),$.start_time=xe(de(0)),$.end_time=xe(de(1));const fe=e=>{let t={};t.date=e,t.hotel_id=q.value.hotel_id,W(t).then((e=>{X.value=e.data,X.value&&X.value.forEach(((e,t)=>{e.attr_name=e.attr_name.split("|").filter(((e,t)=>e&&e.trim()))}))}))};let me=t(null),pe=t(""),_e={};const be=()=>{pe.value="?id="+q.value.hotel_id,ae.value&&ae.value.member_id&&(pe.value+="&mid="+ae.value.member_id)},he=()=>{_e.id=q.value.hotel_id,ae.value&&ae.value.member_id&&(_e.member_id=ae.value.member_id),me.value.openShare()};let ge=e=>{let t="";return t=e.member_discount&&E()?"member_price":"",t},ve=e=>{let t="0.00";return t=e.member_discount&&E()&&e.member_price||e.price,parseFloat(t).toFixed(2)};return(e,t)=>{const l=k(w("u-swiper"),U),a=F,s=j,o=k(w("u-popup"),A),y=C,z=V,E=k(w("u-parse"),B),I=D,S=P,N=k(w("loading-page"),M),R=k(w("u-calendar"),H);return n(),c(a,{class:"bg-[#f7f7f7] min-h-screen overflow-hidden",style:v(e.themeColor())},{default:u((()=>[i(G)?h("v-if",!0):(n(),c(a,{key:0},{default:u((()=>[d(l,{list:i(L),height:"380rpx",radius:"0"},null,8,["list"]),d(a,{class:"chunk-wrap pt-4 pb-3 rounded-t-2xl relative -mt-[30rpx]"},{default:u((()=>[d(a,{class:"flex flex-wrap items-center"},{default:u((()=>[d(a,{class:"font-bold multi-hidden"},{default:u((()=>[x(f(i(q).hotel_name),1)])),_:1}),d(a,{class:"font-bold multi-hidden text-[#ffaf00] flex items-center text-xs mt-[-4rpx] ml-2"},{default:u((()=>[d(s,{class:"iconfont iconxingxing mr-[4rpx] text-xs mt-[-4rpx]"}),d(s,null,{default:u((()=>[x(f(i(q).hotel_star)+"星",1)])),_:1})])),_:1})])),_:1}),d(a,{class:"flex mt-[16rpx] justify-between items-center"},{default:u((()=>[d(a,{class:"flex"},{default:u((()=>[i(q).hotel_tag.length?(n(!0),m(_,{key:0},p(i(q).hotel_tag,((e,t)=>(n(),m(_,null,[t<4?(n(),c(s,{key:0,class:T(["bg-[#F6F8F9] text-xs px-[10rpx] py-[4rpx] rounded",{"mr-[20rpx]":t<3}])},{default:u((()=>[x(f(e),1)])),_:2},1032,["class"])):h("v-if",!0)],64)))),256)):(n(!0),m(_,{key:1},p(i(q).hotel_attribute,((e,t)=>(n(),m(_,null,[t<4?(n(),c(s,{key:0,class:T(["bg-[#F6F8F9] text-xs px-[10rpx] py-[4rpx] rounded",{"mr-[20rpx]":t<3}])},{default:u((()=>[x(f(e),1)])),_:2},1032,["class"])):h("v-if",!0)],64)))),256))])),_:1}),d(a,{class:"flex items-center",onClick:t[0]||(t[0]=e=>b(J)?J.value=!i(J):J=!i(J))},{default:u((()=>[d(a,{class:"text-xs flex items-baseline"},{default:u((()=>[x("详情"),d(s,{class:"nc-iconfont nc-icon-fengefuV6xx text-xs"}),x("设施")])),_:1}),d(s,{class:"nc-iconfont nc-icon-youV6xx text-[26rpx]"})])),_:1})])),_:1}),d(o,{show:i(J),mode:"bottom",round:10,onClose:t[2]||(t[2]=e=>b(J)?J.value=!1:J=!1)},{default:u((()=>[d(a,{class:"flex flex-col p-3 rounded-t-3xl"},{default:u((()=>[d(a,{class:"text-base font-bold flex justify-between items-center"},{default:u((()=>[d(s,null,{default:u((()=>[x(f(i(O)("hotelTab")),1)])),_:1}),d(s,{class:"nc-iconfont nc-icon-guanbiV6xx text-[var(--text-color-light6)]",onClick:t[1]||(t[1]=e=>b(J)?J.value=!1:J=!1)})])),_:1}),d(a,{class:"mt-2 flex flex-col"},{default:u((()=>[i(q).hotel_tag?(n(),c(a,{key:0},{default:u((()=>[d(a,{class:"flex flex-wrap"},{default:u((()=>[(n(!0),m(_,null,p(i(q).hotel_tag,((e,t)=>(n(),c(s,{class:T(["my-2 whitespace-nowrap text-xs px-[10rpx] py-[4rpx]",{"mr-[20rpx]":t<i(q).hotel_attribute.length-1}])},{default:u((()=>[x(f(e),1)])),_:2},1032,["class"])))),256))])),_:1})])),_:1})):h("v-if",!0),i(q).hotel_attribute?(n(),c(a,{key:1},{default:u((()=>[(n(!0),m(_,null,p(Object.values(i(q).hotel_attribute_array),((e,t)=>(n(),c(a,{class:"mt-2"},{default:u((()=>[d(a,{class:"text-sm font-bold"},{default:u((()=>[x(f(e.name),1)])),_:2},1024),d(a,{class:"flex flex-wrap"},{default:u((()=>[(n(!0),m(_,null,p(e.attr,((e,t)=>(n(),m(_,null,[e[1]?(n(),c(s,{key:0,class:"m-2 whitespace-nowrap bg-[#F6F8F9] text-xs px-[10rpx] py-[4rpx] rounded"},{default:u((()=>[x(f(e[0]),1)])),_:2},1024)):h("v-if",!0)],64)))),256))])),_:2},1024)])),_:2},1024)))),256))])),_:1})):h("v-if",!0)])),_:1})])),_:1})])),_:1},8,["show"]),d(a,{class:"flex items-center mt-3"},{default:u((()=>[d(a,{class:"flex-1 leading-tight text-[#19293F] text-[26rpx] font-bold"},{default:u((()=>[x(f(i(q).full_address),1)])),_:1}),d(a,{class:"flex ml-auto"},{default:u((()=>[d(a,{class:"flex flex-col items-center justify-center mr-[20rpx]",onClick:t[3]||(t[3]=e=>b(Q)?Q.value=!0:Q=!0)},{default:u((()=>[d(s,{class:"nc-iconfont nc-icon-dizhiguanliV6xx bg-[#F1F1F1] w-[44rpx] h-[44rpx] rounded-full flex items-center justify-center"}),d(s,{class:"text-xs mt-1"},{default:u((()=>[x(f(i(O)("map")),1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center mr-[20rpx]",onClick:he},{default:u((()=>[d(s,{class:"nc-iconfont nc-icon-fenxiangV6xx text-[30rpx] bg-[#F1F1F1] w-[44rpx] h-[44rpx] rounded-full flex items-center justify-center"}),d(s,{class:"text-xs mt-1"},{default:u((()=>[x("分享")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),d(o,{show:i(Q),onClose:t[4]||(t[4]=e=>b(Q)?Q.value=!1:Q=!1),closeable:!0},{default:u((()=>[d(a,{class:"text-center py-[30rpx] font-bold leading-none"},{default:u((()=>[d(s,null,{default:u((()=>[x("地图")])),_:1})])),_:1}),d(a,null,{default:u((()=>[d(y,{class:"map-body w-full h-[600rpx]",latitude:i(q).latitude,longitude:i(q).longitude,markers:i(ne)},null,8,["latitude","longitude","markers"])])),_:1})])),_:1},8,["show"]),d(a,{class:"chunk-wrap pt-[34rpx] scheduling"},{default:u((()=>{var e;return[d(a,{class:"flex justify-between items-center",onClick:t[5]||(t[5]=e=>b(ee)?ee.value=!0:ee=!0)},{default:u((()=>[d(a,{class:"flex"},{default:u((()=>[d(a,{class:"flex items-center"},{default:u((()=>[d(s,{class:"font-bold text-[30rpx]"},{default:u((()=>[x(f(i(Z).start_time),1)])),_:1}),d(s,{class:"text-xs ml-1"},{default:u((()=>[x(f(i(O)("checkToday")),1)])),_:1})])),_:1}),d(a,{class:"flex items-center ml-[30rpx]"},{default:u((()=>[d(s,{class:"font-bold text-[30rpx]"},{default:u((()=>[x(f(i(Z).end_time),1)])),_:1}),d(s,{class:"text-xs ml-1"},{default:u((()=>[x(f(i(O)("checkTomorrow")),1)])),_:1})])),_:1})])),_:1}),d(a,{class:"text-sm flex items-center"},{default:u((()=>[d(s,{class:"text-color"},{default:u((()=>[x(f(i(O)("common"))+f(i(Z).day)+f(i(O)("lateness")),1)])),_:1}),d(s,{class:"nc-iconfont nc-icon-youV6xx text-[26rpx] text-[var(--text-color-light6)]"})])),_:1})])),_:1}),(null==(e=i(X))?void 0:e.length)?(n(),c(a,{key:0,class:"py-[20rpx]"},{default:u((()=>[(n(!0),m(_,null,p(i(X),((e,t)=>(n(),c(a,{class:"flex mb-[30rpx]",key:e.goods_id,onClick:e=>(e=>{ce.value=q.value.room_list[e],K.value=!0})(t)},{default:u((()=>[d(z,{class:"w-[162rpx] h-[184rpx] mr-[20rpx] rounded-md",src:i(r)(e.cover_thumb_mid),mode:"aspectFill"},null,8,["src"]),d(a,{class:"flex flex-col flex-1 py-[4rpx] relative"},{default:u((()=>[d(a,{class:"text-sm font-bold truncate"},{default:u((()=>[x(f(e.goods_name),1)])),_:2},1024),d(a,{class:"text-xs text-[#626262] mt-[10rpx]"},{default:u((()=>[(n(!0),m(_,null,p(e.attr_name,((e,t)=>(n(),c(s,{class:"mr-[10rpx]"},{default:u((()=>[x(f(e),1)])),_:2},1024)))),256))])),_:2},1024),h(' <view class="text-color text-[26rpx] mt-[10rpx]">15分钟内可免费取消</view> '),d(a,{class:"flex items-center mt-auto text-[#F55246] text-base font-bold price-font"},{default:u((()=>[d(s,{class:"text-xs"},{default:u((()=>[x("￥")])),_:1}),x(" "+f(i(ve)(e))+" ",1),"member_price"==i(ge)(e)?(n(),c(z,{key:0,class:"h-[22rpx] ml-[6rpx] w-[55rpx]",src:i(r)("addon/tourism/VIP.png"),mode:"widthFix"},null,8,["src"])):h("v-if",!0)])),_:2},1024),e.stock?(n(),c(a,{key:0,class:"flex flex-col border-[2rpx] border-solid border-[#FC565F] border-md absolute right-0 bottom-[4rpx] rounded w-[90rpx]",onClick:g((t=>ue(e)),["stop"])},{default:u((()=>[d(s,{class:"bg-[#FC565F] font-bold text-white font-bold text-[34rpx] text-center py-[8rpx]"},{default:u((()=>[x(f(i(O)("rob")),1)])),_:1}),d(s,{class:"text-xs text-scale py-[2rpx] text-center text-[#FC565F]"},{default:u((()=>[x(f(i(O)("onlinePayment")),1)])),_:1})])),_:2},1032,["onClick"])):(n(),c(a,{key:1,class:"flex flex-col border-[2rpx] border-solid border-[#999] border-md absolute right-0 bottom-[4rpx] rounded w-[90rpx]",onClick:g((t=>ue(e,"empty")),["stop"])},{default:u((()=>[d(s,{class:"bg-[#999] font-bold text-white font-bold text-[34rpx] text-center py-[8rpx]"},{default:u((()=>[x(f(i(O)("rob")),1)])),_:1}),d(s,{class:"text-xs text-scale py-[2rpx] text-center text-[var(--text-color-light9)]"},{default:u((()=>[x(f(i(O)("onlinePayment")),1)])),_:1})])),_:2},1032,["onClick"]))])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):h("v-if",!0),h(" 酒店房型详情 "),Object.keys(i(ce)).length?(n(),c(o,{key:1,show:i(K),mode:"bottom",round:10,onClose:t[9]||(t[9]=e=>b(K)?K.value=!1:K=!1)},{default:u((()=>[d(a,{class:"h-[1000rpx] relative rounded-t-3xl bg-[#f8f8f8] overflow-hidden"},{default:u((()=>[d(a,{class:"text-base font-bold flex justify-between items-center h-[96rpx] px-[26rpx] bg-[#fff] absolute top-0 left-0 right-0 z-10"},{default:u((()=>[d(s,{class:"text-[30rpx]"},{default:u((()=>[x(f(i(ce).goods_name),1)])),_:1}),d(s,{class:"nc-iconfont nc-icon-guanbiV6xx text-[32rpx] text-[var(--text-color-light6)]",onClick:t[6]||(t[6]=e=>b(K)?K.value=!1:K=!1)})])),_:1}),d(I,{"scroll-y":"true",class:"flex h-[1000rpx] flex-col bg-[#f8f8f8] !rounded-none"},{default:u((()=>[d(a,{class:"pt-[96rpx]"}),d(z,{src:i(r)(i(ce).cover_thumb_big),class:"w-[750rpx] h-[218]",mode:"aspectFill"},null,8,["src"]),d(a,{class:"px-4 bg-[#fff]"},{default:u((()=>[d(a,{class:"flex justify-between border-0 border-b-1 border-[#F2F2F2] border-solid px-1 py-4"},{default:u((()=>[d(a,{class:"flex flex-col items-center justify-center"},{default:u((()=>[d(s,{class:"nc-iconfont nc-icon-chuangV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:u((()=>[x(f(i(ce).room_bed||"双人床"),1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center"},{default:u((()=>[d(s,{class:"nc-iconfont nc-icon-loucengV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:u((()=>[x(f(i(ce).room_floor||"1层"),1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center"},{default:u((()=>[d(s,{class:"nc-iconfont nc-icon-fangziV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:u((()=>[x(f(i(ce).room_area||0)+"m²",1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center"},{default:u((()=>[d(s,{class:"nc-iconfont nc-icon-jiamengV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:u((()=>[x(f(i(ce).room_stay||"0人"),1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center"},{default:u((()=>[d(s,{class:"nc-iconfont nc-icon-liebiaoV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:u((()=>[x(f(i(ce).stock||"0间"),1)])),_:1})])),_:1})])),_:1}),i(ce).goods_attribute?(n(),c(a,{key:0,class:"flex items-baseline py-4"},{default:u((()=>[d(s,{class:"mr-3 text-sm"},{default:u((()=>[x("房间设施")])),_:1}),d(a,{class:"flex-1 flex flex-wrap"},{default:u((()=>[(n(!0),m(_,null,p(i(ce).goods_attribute.split(","),((e,t)=>{var l,a;return n(),c(s,{class:T(["mr-1 text-sm",{"class-select":t<(null==(a=null==(l=i(ce).goods_attribute)?void 0:l.split(","))?void 0:a.length)-1}])},{default:u((()=>[x(f(e),1)])),_:2},1032,["class"])})),256))])),_:1})])),_:1})):h("v-if",!0)])),_:1}),d(a,{class:"mt-2 px-3 bg-[#fff]"},{default:u((()=>[d(a,{class:"border-0 border-b-1 border-[#F2F2F2] border-solid py-3 text-[30rpx] font-bold"},{default:u((()=>[x(" 房型详情 ")])),_:1}),d(a,{class:"py-3 px-1"},{default:u((()=>[i(ce).goods_content?(n(),c(E,{key:0,content:i(ce).goods_content,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(n(),c(a,{key:1},{default:u((()=>[x("暂无房型详情")])),_:1}))])),_:1})])),_:1}),d(a,{class:"h-[136rpx]"})])),_:1}),d(a,{class:"flex justify-between items-center px-4 py-3 mt-2 bg-[#fff] absolute bottom-0 left-0 right-0 z-10"},{default:u((()=>[d(s,{class:"text-[var(--price-color)] price-font"},{default:u((()=>[x(" ￥"+f(i(ve)(i(ce)))+" ",1),"member_price"==i(ge)(i(ce))?(n(),c(z,{key:0,class:"h-[22rpx] ml-[6rpx] w-[55rpx]",src:i(r)("addon/tourism/VIP.png"),mode:"widthFix"},null,8,["src"])):h("v-if",!0)])),_:1}),i(ce).stock?(n(),c(S,{key:0,type:"primary",class:"w-[276rpx] h-[88rpx] rounded-3xl flex items-center justify-center text-base m-0 !bg-[var(--primary-color)]",onClick:t[7]||(t[7]=g((e=>ue(i(ce))),["stop"]))},{default:u((()=>[x("立即抢购")])),_:1})):(n(),c(S,{key:1,type:"primary",class:"w-[276rpx] h-[88rpx] rounded-3xl flex items-center justify-center text-base m-0 !bg-[#999]",onClick:t[8]||(t[8]=g((e=>ue(i(ce),"empty")),["stop"]))},{default:u((()=>[x("立即抢购")])),_:1}))])),_:1})])),_:1})])),_:1},8,["show"])):h("v-if",!0)]})),_:1}),d(a,{class:"chunk-wrap pt-[34rpx] pb-[24rpx] scheduling"},{default:u((()=>[d(a,{class:"text-center text-[34rpx] font-bold"},{default:u((()=>[x("-- 酒店介绍 --")])),_:1}),d(a,{class:"scheduling-content"},{default:u((()=>[i(q).hotel_desc?(n(),c(E,{key:0,content:i(q).hotel_desc,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(n(),c(a,{key:1},{default:u((()=>[x("暂无酒店介绍")])),_:1}))])),_:1})])),_:1})])),_:1})),d(N,{loading:i(G)},null,8,["loading"]),i(te)?(n(),c(R,{key:1,show:i(ee),mode:"range",onConfirm:re,onClose:t[10]||(t[10]=e=>b(ee)?ee.value=!1:ee=!1),formatter:se,startText:i(O)("inHotel"),endText:i(O)("checkOut"),confirmDisabledText:i(O)("checkOutDate"),ref:"calendar",monthNum:"2"},null,8,["show","startText","endText","confirmDisabledText"])):h("v-if",!0),d(Y,{ref_key:"sharePosterRef",ref:me,posterType:"tourism_hotel",posterId:i(q).poster_id,posterParam:i(_e),copyUrlParam:i(pe)},null,8,["posterId","posterParam","copyUrlParam"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-01bc709b"]]);export{q as default};
