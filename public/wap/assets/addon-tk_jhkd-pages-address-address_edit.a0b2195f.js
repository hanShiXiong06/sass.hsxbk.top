import{_ as e}from"./u-input.9468a367.js";import{al as a,am as t,an as l,aY as r,aW as o,aX as s,bO as n,o as d,c as i,w as u,b as c,n as m,y as h,z as p,f,L as g,c2 as b,D as y,i as v,d as x,r as _,j as C,aG as S,p as V,u as j,cc as P,Y as k,aI as B,aJ as $,a as E,g as w,h as F,x as K}from"./index-d8a8f699.js";import{_ as I,a as N}from"./u-form.11d92cf8.js";import{_ as T}from"./u-switch.e6aa1f1d.js";import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as D}from"./u-button.aa0eb212.js";import{_ as H}from"./area-select.vue_vue_type_script_setup_true_lang.9ef924e0.js";import{f as L}from"./tkjhkd.30d20d1f.js";import"./u-icon.5ba98c98.js";import"./u-line.d86b0940.js";import"./u-loading-icon.6808ae8c.js";import"./u-popup.0d48946e.js";import"./u-transition.db07fff7.js";import"./u-safe-bottom.a4431b09.js";const A=U({name:"u-textarea",mixins:[t,l,{props:{value:{type:[String,Number],default:()=>a.textarea.value},modelValue:{type:[String,Number],default:()=>a.textarea.value},placeholder:{type:[String,Number],default:()=>a.textarea.placeholder},placeholderClass:{type:String,default:()=>a.input.placeholderClass},placeholderStyle:{type:[String,Object],default:()=>a.input.placeholderStyle},height:{type:[String,Number],default:()=>a.textarea.height},confirmType:{type:String,default:()=>a.textarea.confirmType},disabled:{type:Boolean,default:()=>a.textarea.disabled},count:{type:Boolean,default:()=>a.textarea.count},focus:{type:Boolean,default:()=>a.textarea.focus},autoHeight:{type:Boolean,default:()=>a.textarea.autoHeight},fixed:{type:Boolean,default:()=>a.textarea.fixed},cursorSpacing:{type:Number,default:()=>a.textarea.cursorSpacing},cursor:{type:[String,Number],default:()=>a.textarea.cursor},showConfirmBar:{type:Boolean,default:()=>a.textarea.showConfirmBar},selectionStart:{type:Number,default:()=>a.textarea.selectionStart},selectionEnd:{type:Number,default:()=>a.textarea.selectionEnd},adjustPosition:{type:Boolean,default:()=>a.textarea.adjustPosition},disableDefaultPadding:{type:Boolean,default:()=>a.textarea.disableDefaultPadding},holdKeyboard:{type:Boolean,default:()=>a.textarea.holdKeyboard},maxlength:{type:[String,Number],default:()=>a.textarea.maxlength},border:{type:String,default:()=>a.textarea.border},formatter:{type:[Function,null],default:()=>a.textarea.formatter},ignoreCompositionEvent:{type:Boolean,default:!0}}}],data:()=>({innerValue:"",focused:!1,firstChange:!0,changeFromInner:!1,innerFormatter:e=>e}),created(){},watch:{modelValue:{immediate:!0,handler(e,a){this.innerValue=e,!1===this.firstChange&&!1===this.changeFromInner&&this.valueChange(),this.firstChange=!1,this.changeFromInner=!1}}},computed:{textareaClass(){let e=[],{border:a,disabled:t}=this;return"surround"===a&&(e=e.concat(["u-border","u-textarea--radius"])),"bottom"===a&&(e=e.concat(["u-border-bottom","u-textarea--no-radius"])),t&&e.push("u-textarea--disabled"),e.join(" ")},textareaStyle(){return r({},o(this.customStyle))}},emits:["update:modelValue","linechange","focus","blur","change","confirm","keyboardheightchange"],methods:{addStyle:o,addUnit:s,setFormatter(e){this.innerFormatter=e},onFocus(e){this.$emit("focus",e)},onBlur(e){this.$emit("blur",e),n(this,"blur")},onLinechange(e){this.$emit("linechange",e)},onInput(e){let{value:a=""}=e.detail||{};const t=(this.formatter||this.innerFormatter)(a);this.innerValue=a,this.$nextTick((()=>{this.innerValue=t,this.valueChange()}))},valueChange(){const e=this.innerValue;this.$nextTick((()=>{this.$emit("update:modelValue",e),this.changeFromInner=!0,this.$emit("change",e),n(this,"change")}))},onConfirm(e){this.$emit("confirm",e)},onKeyboardheightchange(e){this.$emit("keyboardheightchange",e)}}},[["render",function(e,a,t,l,r,o){const s=b,n=y,x=v;return d(),i(x,{class:g(["u-textarea",o.textareaClass]),style:m([o.textareaStyle])},{default:u((()=>[c(s,{class:"u-textarea__field",value:r.innerValue,style:m({height:o.addUnit(e.height)}),placeholder:e.placeholder,"placeholder-style":o.addStyle(e.placeholderStyle,"string"),"placeholder-class":e.placeholderClass,disabled:e.disabled,focus:e.focus,autoHeight:e.autoHeight,fixed:e.fixed,cursorSpacing:e.cursorSpacing,cursor:e.cursor,showConfirmBar:e.showConfirmBar,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,adjustPosition:e.adjustPosition,disableDefaultPadding:e.disableDefaultPadding,holdKeyboard:e.holdKeyboard,maxlength:e.maxlength,"confirm-type":e.confirmType,ignoreCompositionEvent:e.ignoreCompositionEvent,onFocus:o.onFocus,onBlur:o.onBlur,onLinechange:o.onLinechange,onInput:o.onInput,onConfirm:o.onConfirm,onKeyboardheightchange:o.onKeyboardheightchange},null,8,["value","style","placeholder","placeholder-style","placeholder-class","disabled","focus","autoHeight","fixed","cursorSpacing","cursor","showConfirmBar","selectionStart","selectionEnd","adjustPosition","disableDefaultPadding","holdKeyboard","maxlength","confirm-type","ignoreCompositionEvent","onFocus","onBlur","onLinechange","onInput","onConfirm","onKeyboardheightchange"]),e.count?(d(),i(n,{key:0,class:"u-textarea__count",style:m({"background-color":e.disabled?"transparent":"#fff"})},{default:u((()=>[h(p(r.innerValue.length)+"/"+p(e.maxlength),1)])),_:1},8,["style"])):f("v-if",!0)])),_:1},8,["class","style"])}],["__scopeId","data-v-56565a8a"]]),O=U(x({__name:"address_edit",setup(a){const t=_(),l=_({id:0,name:"",mobile:"",province_id:0,city_id:0,district_id:0,address:"",full_address:"",is_default:0,area:"",type:"address"}),r=_(),o=_(null),s=_(""),n=_(""),f=_(!1),g=()=>{setTimeout((()=>{b()}),500)},b=()=>{t.value?L({address:t.value}).then((e=>{Object.assign(l.value,e.data),uni.$u.toast("地址解析成功"),t.value=""})):uni.$u.toast("请填写解析地址")};C((e=>{e.id&&S(e.id).then((({data:e})=>{e&&Object.assign(l.value,e)})).catch(),s.value=e.type||"",n.value=e.source||""}));const y=V((()=>({name:{type:"string",required:!0,message:K("namePlaceholder"),trigger:["blur","change"]},mobile:[{type:"string",required:!0,message:K("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,a,t){/^1[3-9]\d{9}$/.test(a)?t():t(new Error(K("mobileError")))}}],area:{validator:()=>!uni.$u.test.isEmpty(l.value.area),message:K("selectAreaPlaceholder")},address:{type:"string",required:!0,message:K("addressPlaceholder"),trigger:["blur","change"]}}))),x=()=>{r.value.open()},U=e=>{l.value.province_id=e.province.id||0,l.value.city_id=e.city.id||0,l.value.district_id=e.district.id||0,l.value.area=`${e.province.name||""}${e.city.name||""}${e.district.name||""}`},O=_(!1),W=()=>{const e=l.value.id?B:$;o.value.validate().then((()=>{O.value||(O.value=!0,f.value=!0,l.value.full_address=l.value.area+l.value.address,e(l.value).then((e=>{O.value=!1,setTimeout((()=>{f.value=!1,E({url:"/addon/tk_jhkd/pages/address/address",mode:"redirectTo",param:{type:s.value,source:n.value}})}),1e3)})).catch((()=>{O.value=!1,f.value=!1})))}))};return(a,s)=>{const n=w(F("u-input"),e),_=w(F("u-form-item"),I),C=v,S=w(F("u-switch"),T),V=w(F("u-textarea"),A),B=w(F("u-button"),D),$=w(F("u-form"),N),E=w(F("area-select"),H);return d(),i(C,{class:"px-[30rpx]",style:m(a.themeColor())},{default:u((()=>[c($,{labelPosition:"left",model:l.value,labelWidth:"200rpx",errorType:"toast",rules:j(y),ref_key:"formRef",ref:o},{default:u((()=>[c(C,{class:"mt-[10rpx]"},{default:u((()=>[c(_,{label:j(K)("name"),prop:"name","border-bottom":!0},{default:u((()=>[c(n,{modelValue:l.value.name,"onUpdate:modelValue":s[0]||(s[0]=e=>l.value.name=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"25",placeholder:j(K)("namePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),c(C,{class:"mt-[10rpx]"},{default:u((()=>[c(_,{label:j(K)("mobile"),prop:"mobile","border-bottom":!0},{default:u((()=>[c(n,{modelValue:l.value.mobile,"onUpdate:modelValue":s[1]||(s[1]=e=>l.value.mobile=e),border:"none",clearable:"",placeholder:j(K)("mobilePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),c(C,{class:"mt-[10rpx]"},{default:u((()=>[c(_,{label:j(K)("selectArea"),prop:"area","border-bottom":!0,onClick:x},{default:u((()=>[l.value.area?(d(),i(C,{key:1,class:"text-[30rpx]"},{default:u((()=>[h(p(l.value.area),1)])),_:1})):(d(),i(C,{key:0,class:"text-gray-placeholder text-[30rpx]"},{default:u((()=>[h(p(j(K)("selectAreaPlaceholder")),1)])),_:1}))])),_:1},8,["label"])])),_:1}),c(C,{class:"mt-[10rpx]"},{default:u((()=>[c(_,{label:j(K)("address"),prop:"address","border-bottom":!0},{default:u((()=>[c(n,{modelValue:l.value.address,"onUpdate:modelValue":s[2]||(s[2]=e=>l.value.address=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"120",placeholder:j(K)("addressPlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),c(C,{class:"mt-[10rpx]"},{default:u((()=>[c(_,{label:j(K)("defaultAddress"),prop:"name","border-bottom":!0},{default:u((()=>[c(S,{modelValue:l.value.is_default,"onUpdate:modelValue":s[3]||(s[3]=e=>l.value.is_default=e),size:"20",activeValue:1,inactiveValue:0,activeColor:"var(--primary-color)"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),c(C,{class:"tk-card1 p-2 mt-4 mb-4"},{default:u((()=>[c(V,{clearable:"",border:"none",modelValue:t.value,"onUpdate:modelValue":s[4]||(s[4]=e=>t.value=e),height:"40",placeholder:"在此处输入粘贴地址可以快速自动识别",maxlength:"500",onKeydown:[P(a.handleEnter,["enter"]),P(k(a.handleShiftEnter,["shift"]),["enter"])],onPaste:g,autoHeight:""},null,8,["modelValue","onKeydown"]),c(C,{class:"flex justify-end tk-tag w-48px text-xs mt-1 ml-2",onClick:s[5]||(s[5]=e=>b())},{default:u((()=>[h("地址识别")])),_:1})])),_:1}),c(C,{class:"mt-[40rpx]"},{default:u((()=>[c(B,{type:"primary",shape:"circle",text:j(K)("save"),onClick:W,disabled:f.value,loading:O.value},null,8,["text","disabled","loading"])])),_:1})])),_:1},8,["model","rules"]),c(E,{ref_key:"areaRef",ref:r,onComplete:U,"area-id":l.value.district_id},null,8,["area-id"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-5efd7d77"]]);export{O as default};
