import{d as e,r as t,j as r,o as l,c as a,w as s,I as o,b as d,y as i,z as u,u as n,f,K as p,J as x,n as c,a as _,c3 as m,aR as v,D as b,i as y,g,h,x as k,l as j}from"./index-d8a8f699.js";import{_ as w}from"./u-icon.5ba98c98.js";import{_ as C,a as T}from"./u-steps.2c140480.js";import{_ as z}from"./u--image.2df700b8.js";import{_ as P}from"./u-empty.41eb000a.js";import{_ as D}from"./pay.9a75868d.js";import{_ as M}from"./u-loading-page.c740ef13.js";import{e as O,c as R,d as N}from"./order.581cf11a.js";import{_ as S}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-text.b9c32215.js";import"./u-image.e646392b.js";import"./u-transition.db07fff7.js";import"./u-popup.0d48946e.js";import"./u-safe-bottom.a4431b09.js";import"./pay.974edcbe.js";import"./u-loading-icon.6808ae8c.js";const V=S(e({__name:"detail",setup(e){let S=0;const V=t(null),$=t(!1);r((e=>{S=e.order_id||0,I()}));const I=()=>{$.value=!0,O(S).then((e=>{V.value=e.data,$.value=!1,L()})).catch((()=>{$.value=!1}))},J=()=>{O(S).then((e=>{V.value=e.data,L()})).catch((()=>{}))},X=t(null),Z=(e="",t="")=>{var r,l;"pay"==e?null==(r=X.value)||r.open(V.value.order_type,V.value.order_id,`/addon/o2o/pages/order/detail?order_id=${V.value.order_id}`):"item_pay"==e?null==(l=X.value)||l.open("o2o_item",t.order_item_id,`/addon/o2o/pages/order/detail?order_id=${V.value.order_id}`):"cancel"==e?B(V.value):"delete"==e?F(V.value):"index"==e&&_({url:"/addon/o2o/pages/index",mode:"reLaunch"})},B=e=>{m({title:"提示",content:"您确定要取消该订单吗？",success:t=>{t.confirm&&R(e.order_id).then((e=>{I()}))}})},F=e=>{m({title:"提示",content:"您确定要删除该订单吗？",success:t=>{t.confirm&&N(e.order_id).then((e=>{_({url:"/addon/o2o/pages/order/list"})})).catch((()=>{}))}})};function H(e){var t=new Date(e).getTime();if(null!=t&&""!=t&&t>0){var r=new Date;r.setTime(t);var l=r.getMonth()+1;l=l<10?"0"+l:l;var a=r.getDate();a=a<10?"0"+a:a;var s=r.getHours();s=s<10?"0"+s:s;var o=r.getMinutes();return l+"-"+a+" "+s+":"+(o=o<10?"0"+o:o)}return""}let K=t(0);function L(){return"dispatch"==V.value.order_status_info.status?K.value=0:"wait_service"==V.value.order_status_info.status?K.value=1:"in_service"==V.value.order_status_info.status?K.value=2:"finish"==V.value.order_status_info.status?K.value=3:void 0}return(e,t)=>{const r=b,m=y,O=g(h("u-icon"),w),R=g(h("u-steps-item"),C),N=g(h("u-steps"),T),S=g(h("u--image"),z),I=g(h("u-empty"),P),B=g(h("pay"),D),F=g(h("u-loading-page"),M);return l(),a(m,{style:c(e.themeColor())},{default:s((()=>[$.value?f("v-if",!0):(l(),o(p,{key:0},[V.value?(l(),a(m,{key:0,class:"bg-[#f7f7f7] min-h-screen overflow-hidden"},{default:s((()=>[d(m,{class:"bg-linear h-[480rpx] text-white px-3 pt-5"},{default:s((()=>[d(m,{class:"text-[42rpx] flex items-baseline text-[#fff]"},{default:s((()=>[d(r,{class:"nc-iconfont nc-icon-shijianV6xx text-[42rpx] mr-1"}),d(r,{class:"font-bold"},{default:s((()=>{var e,t;return[i(u(n(k)("order"))+u(null==(t=null==(e=V.value)?void 0:e.order_status_info)?void 0:t.name),1)]})),_:1})])),_:1})])),_:1}),d(m,{class:"bg-[#fff] mx-3 p-[30rpx] -mt-[360rpx] rounded-[10rpx]"},{default:s((()=>[d(m,{class:"flex"},{default:s((()=>[d(m,{class:"min-w-[50rpx] flex items-center justify-center"},{default:s((()=>[d(O,{name:"map",size:"20"})])),_:1}),d(m,{class:"flex flex-col ml-[20rpx]"},{default:s((()=>[d(r,{class:"text-[24rpx] mt-[10rpx] leading-[35rpx] line-feed"},{default:s((()=>[i(u(V.value.taker_full_address),1)])),_:1}),d(m,null,{default:s((()=>[d(r,{class:"text-[24rpx]"},{default:s((()=>[i(u(V.value.taker_name),1)])),_:1}),d(r,{class:"text-[24rpx] mt-[15rpx]"},{default:s((()=>[i(u(V.value.taker_mobile),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),V.value.pay_time?(l(),a(m,{key:0,class:"flex py-4 px-3 bg-white rounded-md box-border mx-3 mt-[20rpx] task-steps"},{default:s((()=>[d(N,{current:n(K),activeColor:"var(--primary-color)"},{default:s((()=>[d(R,{title:n(k)("placeOrder"),desc:V.value.create_time?H(V.value.create_time):"---"},null,8,["title","desc"]),d(R,{title:n(k)("takeOrders"),desc:V.value.dispatch_time?H(V.value.dispatch_time):"---"},null,8,["title","desc"]),d(R,{title:n(k)("start"),desc:V.value.service_time?H(V.value.service_time):"---"},null,8,["title","desc"]),d(R,{title:n(k)("finish"),desc:V.value.finish_time?H(V.value.finish_time):"---"},null,8,["title","desc"])])),_:1},8,["current"])])),_:1})):f("v-if",!0),d(m,{class:"mt-[20rpx]"},{default:s((()=>[d(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] rounded-[10rpx]"},{default:s((()=>[(l(!0),o(p,null,x(V.value.item,((e,t)=>(l(),a(m,{class:"order-goods-item py-[20rpx]",key:t},{default:s((()=>[d(m,{class:"flex justify-between items-center",onClick:t=>{var r;"reservation"!=(r=e).item_type&&"buy"!=r.item_type||_({url:"/addon/o2o/pages/goods/detail",param:{sku_id:r.item_id}})}},{default:s((()=>[d(m,{class:"w-[160rpx] h-[160rpx] flex-2"},{default:s((()=>[d(S,{class:"rounded-[10rpx] overflow-hidden",width:"160rpx",height:"160rpx",src:n(j)(e.item_image?e.item_image:""),model:"aspectFill"},{error:s((()=>[d(O,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024),d(m,{class:"ml-[20rpx] flex-1"},{default:s((()=>[d(m,{class:"flex justify-between"},{default:s((()=>[d(r,{class:"text-[28rpx] text-item leading-[40rpx] max-h-[80rpx] w-[360rpx] multi-hidden"},{default:s((()=>[i(u(e.item_name),1)])),_:2},1024),d(r,{class:"shrink-0 text-[24rpx] text-[var(--primary-color)] ml-[10rpx] leading-[40rpx]"},{default:s((()=>[i(u(e.pay_time?n(k)("havePaid"):n(k)("notPaid")),1)])),_:2},1024)])),_:2},1024),d(m,{class:"text-[24rpx] mt-[20rpx] flex"},{default:s((()=>[d(r,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:s((()=>[i(u(e.item_type_name),1)])),_:2},1024)])),_:2},1024),d(m,{class:"flex justify-between mt-[26rpx] items-center"},{default:s((()=>[d(r,{class:"text-right text-[28rpx] text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(e.price),1)])),_:2},1024),d(r,{class:"text-right text-sm"},{default:s((()=>[d(r,{class:"text-[26rpx]"},{default:s((()=>[i("x")])),_:1}),i(u(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),d(m,{class:"flex justify-end self-end w-[100%] mt-[10rpx]"},{default:s((()=>[e.refund_no&&""!=e.refund_status&&"cancel"!=e.refund_status?(l(),a(m,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>n(_)({url:"/addon/o2o/pages/refund/detail",param:{refund_no:e.refund_no}})},{default:s((()=>[i(u(n(k)("viewRefund")),1)])),_:2},1032,["onClick"])):f("v-if",!0),V.value.order_status_info.is_refund&&e.is_enable_refund&&-1!=["","cancel"].indexOf(e.refund_status)?(l(),a(m,{key:1,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{return r=e.order_item_id,void _({url:"/addon/o2o/pages/refund/apply",param:{order_id:V.value.order_id,order_item_id:r}});var r}},{default:s((()=>[i(u(n(k)("applyRefund")),1)])),_:2},1032,["onClick"])):f("v-if",!0),"custom"==e.item_type?(l(),o(p,{key:2},[e.pay_time?f("v-if",!0):(l(),a(m,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>Z("item_pay",e)},{default:s((()=>[i(u(n(k)("goToPay")),1)])),_:2},1032,["onClick"])),d(m,{class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{var r;_({url:"/addon/o2o/pages/master/task/show",param:{order_id:(r=e).order_id,order_item_id:r.order_item_id,item_name:r.item_name,price:r.item_money,item_images:r.item_images}})}},{default:s((()=>[i(u(n(k)("show")),1)])),_:2},1032,["onClick"])],64)):f("v-if",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),V.value.check_code?(l(),a(m,{key:0,class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[V.value.technician_id?(l(),a(m,{key:0,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("servicePersonal")),1)])),_:1}),d(m,{class:"text-[#999]",onClick:t[0]||(t[0]=e=>n(_)({url:"/addon/o2o/pages/technician/detail",param:{id:V.value.technician_id}}))},{default:s((()=>[i(u(V.value.technician_id?V.value.technician_info.name:n(k)("orderToBeSent")),1)])),_:1})])),_:1})):f("v-if",!0),V.value.technician_id?(l(),a(m,{key:1,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("contactNumber")),1)])),_:1}),d(m,{class:"text-[#999]",onClick:t[1]||(t[1]=e=>{return t=V.value.technician_info.mobile,void v({phoneNumber:t});var t})},{default:s((()=>[i(u(V.value.technician_info.mobile),1)])),_:1})])),_:1})):f("v-if",!0),d(m,{class:"flex justify-between text-[28rpx] mt-[30rpx]"},{default:s((()=>[d(r,null,{default:s((()=>[i(u(n(k)("serviceCode")),1)])),_:1}),d(r,{class:"text-[#999]"},{default:s((()=>[i(u(V.value.check_code),1)])),_:1})])),_:1}),d(m,{class:"text-[20rpx] mt-[20rpx] text-[#999]"},{default:s((()=>[i(u(n(k)("explain")),1)])),_:1})])),_:1})):f("v-if",!0),d(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("onOrder")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(V.value.order_no),1)])),_:1})])),_:1}),V.value.out_trade_no?(l(),a(m,{key:0,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("transactionNumber")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(V.value.out_trade_no),1)])),_:1})])),_:1})):f("v-if",!0),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("createTime")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(V.value.create_time),1)])),_:1})])),_:1}),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("reserveServiceTime")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(V.value.reserve_service_time),1)])),_:1})])),_:1}),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx] box-border"},{default:s((()=>[d(m,{class:"shrink-0 mr-[18rpx]"},{default:s((()=>[i(u(n(k)("remark")),1)])),_:1}),d(m,{class:"max-w-[510rpx] leading-[38rpx] line-feed"},{default:s((()=>[i(u(V.value.member_message?V.value.member_message:"无"),1)])),_:1})])),_:1}),V.value.pay?(l(),a(m,{key:1,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("modePayment")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(V.value.pay.type_name),1)])),_:1})])),_:1})):f("v-if",!0),V.value.pay?(l(),a(m,{key:2,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("payTime")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(V.value.pay.pay_time),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1}),d(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[d(m,{class:"flex justify-between text-[28rpx] pt-[20rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("goodsMoney")),1)])),_:1}),d(m,{class:"text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(V.value.total_money),1)])),_:1})])),_:1}),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[40rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("realMoney")),1)])),_:1}),d(m,{class:"text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(V.value.total_pay_money),1)])),_:1})])),_:1})])),_:1})])),_:1}),d(m,{class:"h-[160rpx] w-full"}),d(m,{class:"flex z-2 justify-between items-center bg-[#fff] fixed left-0 right-0 bottom-0 min-h-[100rpx] px-1 flex-wrap pb-ios"},{default:s((()=>[d(m,{class:"flex ml-[30rpx] w-[70rpx] flex-col justify-center items-center",onClick:t[2]||(t[2]=e=>Z("index"))},{default:s((()=>[d(r,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[36rpx]"}),d(r,{class:"text-xs mt-1"},{default:s((()=>[i(u(n(k)("index")),1)])),_:1})])),_:1}),V.value.order_status_info?(l(),a(m,{key:0,class:"flex justify-end mr-[30rpx]"},{default:s((()=>[(l(!0),o(p,null,x(V.value.order_status_info.member_action,((e,t)=>(l(),a(m,{key:t,class:"inline-block text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>Z(e.key)},{default:s((()=>[i(u(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})):f("v-if",!0)])),_:1})])),_:1})):(l(),a(m,{key:1,class:"w-screen h-screen flex flex-col justify-center items-center"},{default:s((()=>[d(I,{icon:n(j)("static/resource/images/order_empty.png"),text:"未获取到订单信息"},null,8,["icon"])])),_:1})),f(" 刷新 "),d(m,{class:"fixed bottom-[calc(160rpx+env(safe-area-inset-bottom))] right-[30rpx] rounded-full bg-[#fff] w-[80rpx] h-[80rpx] flex flex-col items-center justify-center shadow-xl",onClick:J},{default:s((()=>[d(r,{class:"nc-iconfont nc-icon-shuaxinV6xx text-[36rpx]"}),d(r,{class:"text-[22rpx] mt-[6rpx]"},{default:s((()=>[i(u(n(k)("refresh")),1)])),_:1})])),_:1})],64)),d(B,{ref_key:"payRef",ref:X},null,512),d(F,{loading:$.value,"loading-text":"","bg-color":"none",loadingColor:"var(--primary-color)",iconSize:"35"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-21a79b77"]]);export{V as default};
