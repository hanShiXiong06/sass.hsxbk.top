import{d as e,r as t,N as a,g as l,h as r,o,c as s,w as n,b as d,A as u,y as p,U as i,V as c,ad as x,W as m,z as v,f,u as b,E as _,bq as h,t as g,i as y,D as k,b3 as V,a$ as w,ac as C,C as S,aA as z,bG as j,j as M,e as U,v as A,an as O,R as T,Q as $,S as q}from"./index-71c7df08.js";import{j as R}from"./order.c5841498.js";import{_ as Z}from"./uni-popup.402343c9.js";const E=e({__name:"select-store",emits:["confirm"],setup(e,{expose:j,emit:M}){const U=t(!1),A=t(!1),O=t(!0),T=t([]),$=t(null),q=a({lat:0,lng:0}),Z=()=>{M("confirm",$.value),U.value=!1},E=e=>{if((e=parseFloat(e))<1e3)return`${e}m`;return`${(e/1e3).toFixed(2)}km`};return j({open:()=>{A.value||(A.value=!0,h({type:"gcj02",success:e=>{q.lat=e.latitude,q.lng=e.longitude},fail:e=>{if(e.errno)if(104==e.errno){g({title:"用户未授权隐私权限，获取位置失败",icon:"none"})}else if(112==e.errno){g({title:"隐私协议中未声明，获取位置失败",icon:"none"})}if(e.errMsg)if(-1!=e.errMsg.indexOf("getLocation:fail")||-1!=e.errMsg.indexOf("deny")||-1!=e.errMsg.indexOf("denied")){g({title:"用户未授权获取位置权限，将无法提供距离最近的门店",icon:"none"})}else g({title:e.errMsg,icon:"none"})}}),setTimeout((()=>{R({latlng:q}).then((({data:e})=>{T.value=e,O.value=!1})).catch((()=>{O.value=!1}))}),1500)),U.value=!0}}),(e,t)=>{const a=y,h=k,g=l(r("u-loading-icon"),V),j=l(r("u-empty"),w),M=C,A=S,q=l(r("u-popup"),z);return o(),s(q,{show:U.value,onClose:t[1]||(t[1]=e=>U.value=!1),mode:"bottom",round:10},{default:n((()=>[d(a,{onTouchmove:t[0]||(t[0]=u((()=>{}),["prevent","stop"])),class:"popup-common"},{default:n((()=>[d(a,{class:"title"},{default:n((()=>[p("请选择自提点")])),_:1}),d(M,{"scroll-y":"true",class:"h-[50vh]"},{default:n((()=>[d(a,{class:"p-[var(--popup-sidebar-m)] pt-0 text-sm"},{default:n((()=>[(o(!0),i(c,null,x(T.value,(e=>(o(),s(a,{class:m(["mt-[var(--top-m)] border-1 border-[#eee] border-solid rounded-[var(--rounded-mid)] px-[var(--pad-sidebar-m)] py-[var(--pad-top-m)] mb-[var(--top-m)]",{"!border-primary bg-[var(--primary-color-light2)]":$.value&&$.value.store_id==e.store_id}]),onClick:t=>{return a=e,void($.value?$.value=$.value.store_id!=a.store_id?a:null:$.value=a);var a}},{default:n((()=>[d(a,{class:"flex"},{default:n((()=>[d(a,{class:"flex-1 w-0"},{default:n((()=>[d(h,{class:"text-[30rpx] text-[#333]"},{default:n((()=>[p(v(e.store_name),1)])),_:2},1024),d(h,{class:"text-[26rpx] ml-[12rpx] text-[var(--text-color-light6)]"},{default:n((()=>[p(v(e.store_mobile),1)])),_:2},1024)])),_:2},1024),e.distance?(o(),s(a,{key:0},{default:n((()=>[d(h,{class:"text-red text-[26rpx] font-normal"},{default:n((()=>[p(v(E(e.distance)),1)])),_:2},1024)])),_:2},1024)):f("v-if",!0)])),_:2},1024),d(a,{class:"mt-[20rpx] text-[26rpx] leading-[1.4] flex"},{default:n((()=>[d(h,{class:"flex-shrink-0"},{default:n((()=>[p("门店地址：")])),_:1}),d(h,null,{default:n((()=>[p(v(e.full_address),1)])),_:2},1024)])),_:2},1024),d(a,{class:"mt-[16rpx] text-[26rpx]"},{default:n((()=>[p("营业时间："+v(e.trade_time),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),256))])),_:1}),O.value?(o(),s(a,{key:0,class:"h-[50vh] flex items-center flex-col justify-center"},{default:n((()=>[d(g,{vertical:!0})])),_:1})):f("v-if",!0),O.value||T.value.length?f("v-if",!0):(o(),s(a,{key:1,class:"h-[50vh] flex items-center flex-col justify-center"},{default:n((()=>[d(j,{text:"没有可选择的自提点",icon:b(_)("static/resource/images/empty.png")},null,8,["icon"])])),_:1}))])),_:1}),d(a,{class:"btn-wrap"},{default:n((()=>[d(A,{class:"primary-btn-bg btn",onClick:Z},{default:n((()=>[p("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])}}});const F=e({__name:"invoice",emits:["confirm"],setup(e,{expose:a,emit:_}){const h=t(),g=t({is_invoice:2,invoice_content:[]}),k=t(!1);t(!1);const V=t({header_type:1,header_name:"",type:"",name:"",tax_number:"",telephone:"",address:"",bank_name:"",bank_card_number:""}),w=M((()=>1==g.value.is_invoice));j.get("shop/config/invoice").then((({data:e})=>{g.value=e,e.invoice_content.length&&(V.value.name=e.invoice_content[0])})).catch();const z=e=>{O((()=>{V.value.tax_number=e.replace(/[^0-9a-zA-Z]/g,"")}))},R=t(null),E=M((()=>({header_name:{type:"string",required:k.value,message:"请输入发票抬头",trigger:["blur","change"]},tax_number:[{type:"string",required:k.value&&2==V.value.header_type,message:"请输入纳税人识别号",trigger:["blur","change"]},{validator(e,t,a){/^[0-9a-zA-Z]+$/.test(t)||2!=V.header_type?a():a(new Error("请输入正确的纳税人识别号"))}}]}))),F=()=>{R.value.validate().then((()=>{var e;const t=k.value?V.value:{};_("confirm",t),null==(e=h.value)||e.close()}))};return a({open:()=>{var e;null==(e=h.value)||e.open()},invoiceOpen:w}),(e,t)=>{const a=y,_=l(r("u-form-item"),T),w=l(r("u-input"),$),j=l(r("u-form"),q),M=C,O=S,W=l(r("uni-popup"),Z);return o(),s(W,{ref_key:"popupRef",ref:h,type:"bottom"},{default:n((()=>[d(a,{class:"bg-[#fff] rounded-[10rpx] popup-common",onTouchmove:t[10]||(t[10]=u((()=>{}),["prevent","stop"]))},{default:n((()=>[d(a,{class:"title"},{default:n((()=>[p("请填写发票信息")])),_:1}),d(M,{"scroll-y":!0,class:"h-[50vh]"},{default:n((()=>[d(a,{class:"px-[var(--popup-sidebar-m)] pb-[60rpx] pt-0 text-sm"},{default:n((()=>[d(j,{labelPosition:"left",model:V.value,labelWidth:"200rpx",labelStyle:{"font-size":"28rpx"},errorType:"toast",rules:b(E),ref_key:"formRef",ref:R},{default:n((()=>[d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"需要发票",leftIconStyle:"text-[28rpx]"},{default:n((()=>[d(a,{class:"flex"},{default:n((()=>[d(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] leading-[56rpx] mr-[20rpx] border-[2rpx] border-[var(--temp-bg)] bg-[var(--temp-bg)] border-solid text-[24rpx]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":!k.value}]),onClick:t[0]||(t[0]=e=>k.value=!1)},{default:n((()=>[p("不需要")])),_:1},8,["class"]),d(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] leading-[56rpx] border-[2rpx] border-[var(--temp-bg)] border-solid text-[24rpx] bg-[var(--temp-bg)]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":k.value}]),onClick:t[1]||(t[1]=e=>k.value=!0)},{default:n((()=>[p("需要")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),U(d(a,null,{default:n((()=>[d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"抬头类型"},{default:n((()=>[d(a,{class:"flex"},{default:n((()=>[d(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] mr-[20rpx] leading-[56rpx] border-[2rpx] border-[var(--temp-bg)] border-solid text-[24rpx] bg-[var(--temp-bg)]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":1==V.value.header_type}]),onClick:t[2]||(t[2]=e=>V.value.header_type=1)},{default:n((()=>[p("个人")])),_:1},8,["class"]),d(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] leading-[56rpx] border-[2rpx] border-[var(--temp-bg)] border-solid text-[24rpx] bg-[var(--temp-bg)]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":2==V.value.header_type}]),onClick:t[3]||(t[3]=e=>V.value.header_type=2)},{default:n((()=>[p("企业")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"发票内容",prop:"header_name"},{default:n((()=>[d(a,{class:"flex flex-wrap"},{default:n((()=>[(o(!0),i(c,null,x(g.value.invoice_content,((e,t)=>(o(),s(a,{class:m(["h-[60rpx] box-border rounded px-[30rpx] leading-[56rpx] border-[2rpx] border-[var(--temp-bg)] border-solid text-[24rpx] bg-[var(--temp-bg)]",{"!bg-[var(--primary-color-light)] !text-[var(--primary-color)] !border-primary":V.value.name==e,"mr-[20rpx]":g.value.invoice_content.length-1!=t}]),onClick:t=>V.value.name=e},{default:n((()=>[p(v(e),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"发票抬头",prop:"header_name"},{default:n((()=>[d(w,{fontSize:"28rpx",modelValue:V.value.header_name,"onUpdate:modelValue":t[4]||(t[4]=e=>V.value.header_name=e),modelModifiers:{trim:!0},border:"none","placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",clearable:"",placeholder:"请输入发票抬头"},null,8,["modelValue"])])),_:1})])),_:1}),2==V.value.header_type?(o(),s(a,{key:0},{default:n((()=>[d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"纳税人识别号",prop:"tax_number"},{default:n((()=>[d(w,{fontSize:"28rpx",modelValue:V.value.tax_number,"onUpdate:modelValue":t[5]||(t[5]=e=>V.value.tax_number=e),modelModifiers:{trim:!0},border:"none",clearable:"",placeholder:"请输入纳税人识别号","placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",onChange:z},null,8,["modelValue"])])),_:1})])),_:1}),f(' <view class="py-[20rpx] h-[48rpx] flex items-center">\r\n\t\t\t\t\t\t\t\t\t<text class="text-[30rpx]">更多选填内容</text>\r\n\t\t\t\t\t\t\t\t\t<text class="text-xs text-gray-subtitle ml-[10rpx]">注册地址、电话、开户银行及账号</text>\r\n\t\t\t\t\t\t\t\t\t<view class="text-xs text-right flex-1" @click="optionalShow = !optionalShow">\r\n\t\t\t\t\t\t\t\t\t\t<text>{{ optionalShow ? \'收起\' : \'展开\' }}</text>\r\n\t\t\t\t\t\t\t\t\t\t<text class="text-[30rpx] nc-iconfont text-gray-subtitle ml-[5rpx]" :class="optionalShow ? \'nc-icon-shangV6xx-1\' : \'nc-icon-xiaV6xx\'"></text>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view> '),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"注册地址"},{default:n((()=>[d(w,{fontSize:"28rpx",modelValue:V.value.address,"onUpdate:modelValue":t[6]||(t[6]=e=>V.value.address=e),"placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",border:"none",clearable:"",placeholder:"(选填)请输入企业注册地址"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"注册电话"},{default:n((()=>[d(w,{fontSize:"28rpx",modelValue:V.value.telephone,"onUpdate:modelValue":t[7]||(t[7]=e=>V.value.telephone=e),"placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",border:"none",clearable:"",placeholder:"(选填)请输入企业注册电话"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"开户银行"},{default:n((()=>[d(w,{fontSize:"28rpx",modelValue:V.value.bank_name,"onUpdate:modelValue":t[8]||(t[8]=e=>V.value.bank_name=e),"placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",border:"none",clearable:"",placeholder:"(选填)请输入企业开户银行"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:n((()=>[d(_,{label:"银行账号"},{default:n((()=>[d(w,{fontSize:"28rpx",modelValue:V.value.bank_card_number,"onUpdate:modelValue":t[9]||(t[9]=e=>V.value.bank_card_number=e),"placeholder-class":"!text-[var(--text-color-light9)] text-[28rpx]",border:"none",clearable:"",placeholder:"(选填)请输入企业开户银行账号"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})):f("v-if",!0)])),_:1},512),[[A,k.value]])])),_:1},8,["model","rules"])])),_:1})])),_:1}),d(a,{class:"btn-wrap"},{default:n((()=>[d(O,{class:"primary-btn-bg btn",onClick:F},{default:n((()=>[p("确认")])),_:1})])),_:1})])),_:1})])),_:1},512)}}});export{E as _,F as a};
