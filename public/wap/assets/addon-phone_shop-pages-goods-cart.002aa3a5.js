import{d as e,l as t,j as s,r as l,x as o,Z as r,F as a,o as d,c as u,w as p,u as i,b as x,y as n,z as c,O as f,a6 as _,P as m,f as g,Q as h,n as b,H as v,t as k,a as y,B as w,i as F,C as j,D as S,g as C,h as E,a5 as V,E as z,s as I,ag as P}from"./index-9317da28.js";import{_ as B}from"./u--image.5461b7b7.js";import{_ as D}from"./u-number-box.3146e59e.js";import{_ as L}from"./u-swipe-action-item.2a7081d5.js";import{_ as O}from"./u-swipe-action.6f19c3fc.js";import{_ as U}from"./u-loading-page.de89bca9.js";import{_ as q}from"./tabbar.31005363.js";import{u as A,g as H}from"./cart.ede9540f.js";import{b as M}from"./bind-mobile.7937266a.js";import{_ as Q}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-image.74ac23f6.js";import"./u-icon.5e775659.js";import"./u-transition.65be38eb.js";import"./u-loading-icon.aabe3d05.js";/* empty css                                                                       */import"./u-badge.4fd7810d.js";import"./u-tabbar.c8394bc9.js";import"./u-safe-bottom.3546c5bb.js";import"./u-form-item.83fe1c60.js";import"./u-line.30917996.js";/* empty css                                                               */import"./u-form.cfe692b2.js";import"./sms-code.vue_vue_type_script_setup_true_lang.ef47410d.js";/* empty css                                                               */import"./u-input.e030155a.js";/* empty css                                                                */import"./u-modal.42c2671a.js";import"./u-popup.1f2ebcae.js";/* empty css                                                                */import"./u-checkbox-group.2c561dd7.js";/* empty css                                                                         *//* empty css                                                                    */const R=Q(e({__name:"cart",setup(e){const Q=t(),R=s((()=>Q.info)),T=l(!0),Z=l(!1),$=l("0.00"),G=l([]),J=l([]),K=l(!1),N=l(!0),W=A(),X=()=>{H({}).then((({data:e})=>{G.value=[],J.value=[],T.value=!1,e.forEach((e=>{e.checked=!1,e.goodsSku&&(e.goods.status&&0==e.goods.delete_time&&e.goodsSku.stock?(e.num>e.goodsSku.stock&&(e.num=e.goodsSku.stock),G.value.push(e)):J.value.push(e))})),oe(),N.value&&(N.value=!1)})).catch((e=>{401==e.code&&(G.value=[],J.value=[],T.value=!1)}))};o((()=>{X(),W.getList()}));const Y=s((()=>{let e=0;return G.value.forEach((t=>{t.checked&&(e+=1)})),e}));r((()=>G.value),(()=>{let e=0;G.value.forEach((t=>{if(t.checked&&t.goodsSku){let s=0;s=t.goods.is_discount&&t.goodsSku.sale_price!=t.goodsSku.price?t.goodsSku.sale_price:t.goods.member_discount&&I()&&t.goodsSku.member_price!=t.goodsSku.price?t.goodsSku.member_price:t.goodsSku.price,e+=parseFloat(s)*t.num}})),$.value=e.toFixed(2)}),{deep:!0});const ee=()=>{v().setLoginBack({url:"/addon/phone_shop/pages/goods/cart"})},te=e=>({min:1,max:e.goodsSku.stock||1}),se=l([{text:a("delete"),style:{backgroundColor:"#F56C6C"}}]),le=l(),oe=()=>{const e=G.value.length!=Y.value;G.value.forEach((t=>{t.checked=e}))},re=l(null),ae=()=>{if(uni.getStorageSync("isbindmobile"))return re.value.open(),!1;if(!Y.value)return void k({title:"还没有选择商品",icon:"none"});const e=[];G.value.forEach((t=>{t.checked&&e.push(t.id)})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){y({url:"/addon/phone_shop/pages/order/payment"})}})},de=()=>{if(!Y.value)return void k({title:"还没有选择商品",icon:"none"});if(Z.value)return;Z.value=!0;const e=[];G.value.forEach((t=>{t.checked&&e.push(t.id)})),W.delete(e,(()=>{X(),Z.value=!1}))},ue=()=>{if(Z.value)return;Z.value=!0;const e=J.value.map((e=>e.id));W.delete(e,(()=>{X(),Z.value=!1})),J.value=[]},pe=e=>{let t="";return t=e.goods.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.goods.member_discount&&I()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},ie=e=>{let t="0.00";return t=e.goods.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.goods.member_discount&&I()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const s=w,l=F,o=j,r=S,a=C(E("u--image"),B),v=C(E("u-number-box"),D),k=C(E("u-swipe-action-item"),L),I=C(E("u-swipe-action"),O),A=V,H=C(E("u-loading-page"),U),Q=C(E("tabbar"),q);return d(),u(l,{style:b(e.themeColor())},{default:p((()=>[T.value?g("v-if",!0):(d(),u(l,{key:0,class:"bg-page h-screen overflow-hidden flex flex-col"},{default:p((()=>[i(R)?G.value.length||J.value.length?(d(),u(l,{key:2,class:"flex-1 h-0"},{default:p((()=>[x(A,{class:"scroll-height box-border","scroll-y":!0},{default:p((()=>[x(l,{class:"py-[20rpx] sidebar-marign"},{default:p((()=>[G.value.length?(d(),u(l,{key:0,class:"bg-[#fff] pb-[10rpx] box-border rounded-[16rpx]"},{default:p((()=>[x(l,{class:"flex mx-[20rpx] justify-between items-center h-[76rpx] box-border font-400 text-[24rpx] mb-[10rpx] leading-[30rpx] border-0 border-b-[2rpx] border-solid border-[#F6F6F6]"},{default:p((()=>[x(l,{class:"flex items-center text-[26rpx] text-[#333]"},{default:p((()=>[x(r,null,{default:p((()=>[n("共")])),_:1}),x(r,{class:"text-[32rpx] mx-[2rpx] text-[var(--price-text-color)]"},{default:p((()=>[n(c(G.value.length),1)])),_:1}),x(r,null,{default:p((()=>[n("件商品")])),_:1})])),_:1}),x(r,{onClick:t[1]||(t[1]=e=>K.value=!K.value),class:"text-[#666] text-[26rpx]"},{default:p((()=>[n(c(K.value?"完成":"管理"),1)])),_:1})])),_:1}),x(I,{ref_key:"swipeActive",ref:le},{default:p((()=>[(d(!0),f(m,null,_(G.value,((e,t)=>(d(),f(m,null,[e.goodsSku?(d(),u(l,{key:0,class:"py-[20rpx] overflow-hidden w-full"},{default:p((()=>[x(k,{options:se.value,onClick:s=>((e,t)=>{Z.value||(Z.value=!0,W.delete(t.id,(()=>{G.value.splice(e,1),P((()=>{le.value&&le.value.closeOther()})),Z.value=!1})))})(t,e)},{default:p((()=>[x(l,{class:"flex px-[20rpx]"},{default:p((()=>[x(r,{class:h(["self-center iconfont text-color text-[34rpx] mr-[16rpx] w-[34rpx] h-[34rpx] rounded-[17rpx] overflow-hidden shrink-0",{iconxuanze1:e.checked,"bg-[#F5F5F5]":!e.checked}]),onClick:t=>e.checked=!e.checked},null,8,["class","onClick"]),x(a,{class:"rounded-[8rpx] overflow-hidden",width:"170rpx",height:"170rpx",onClick:t=>{y({url:"/addon/phone_shop/pages/goods/detail",param:{goods_id:e.goods_id}})},src:i(z)(e.goodsSku.sku_image_thumb_mid||""),model:"aspectFill"},{error:p((()=>[x(s,{class:"w-[170rpx] h-[170rpx] rounded-[8rpx] overflow-hidden",src:i(z)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["onClick","src"]),x(l,{class:"flex flex-1 flex-wrap ml-[20rpx] w-[410rpx]"},{default:p((()=>[x(l,{class:"w-[100%] flex flex-col items-baseline"},{default:p((()=>[x(l,{class:"w-[406rpx] text-[#333] text-[28rpx] max-h-[80rpx] leading-[40rpx] multi-hidden font-400"},{default:p((()=>[n(c(e.goods.goods_name),1)])),_:2},1024),x(l,{class:"w-[406rpx] text-[#333] text-[20rpx] max-h-[80rpx] leading-[40rpx] multi-hidden font-400"},{default:p((()=>[n(c(e.goods.sub_title),1)])),_:2},1024),e.goodsSku&&e.goodsSku.sku_spec_format?(d(),u(l,{key:0,class:"box-border max-w-[406rpx] mt-[4rpx] px-[14rpx] h-[36rpx] leading-[36rpx] truncate text-[#666] bg-[#F5F5F5] text-[22rpx] rounded-[20rpx]"},{default:p((()=>[n(c(e.goodsSku.sku_spec_format),1)])),_:2},1024)):g("v-if",!0)])),_:2},1024),x(l,{class:"flex justify-between items-end self-end w-[100%]"},{default:p((()=>[x(l,{class:"flex items-end text-[var(--price-text-color)] leading-[40rpx] price-font"},{default:p((()=>[x(l,{class:"text-[var(--price-text-color)] price-font"},{default:p((()=>[x(r,{class:"text-[26rpx] font-500"},{default:p((()=>[n("￥")])),_:1}),x(r,{class:"text-[36rpx] font-500"},{default:p((()=>[n(c(parseFloat(ie(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),x(r,{class:"text-[24rpx] font-500"},{default:p((()=>[n("."+c(parseFloat(ie(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==pe(e)?(d(),u(s,{key:0,class:"h-[24rpx] ml-[6rpx]",src:i(z)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):g("v-if",!0),"discount_price"==pe(e)?(d(),u(s,{key:1,class:"h-[24rpx] ml-[6rpx]",src:i(z)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):g("v-if",!0)])),_:2},1024)])),_:2},1024),x(v,{modelValue:e.num,"onUpdate:modelValue":t=>e.num=t,min:te(e).min,max:te(e).max,integer:"",step:1,"input-width":"68rpx","input-height":"52rpx","button-size":"52rpx",disabledInput:"",onChange:e=>((e,t)=>{uni.$u.debounce((e=>{const s=G.value[t];W.increase({id:s.id,goods_id:s.goods_id,sku_id:s.sku_id,stock:s.goodsSku.stock,sale_price:s.goodsSku.sale_price,num:s.num},0)}),500)})(0,t)},{minus:p((()=>[x(r,{class:h([{"text-[#999]":e.num===te(e).min,"text-[#303133]":e.num!==te(e).min},"text-[34rpx] nc-iconfont nc-icon-jianV6xx"])},null,8,["class"])])),input:p((()=>[x(r,{class:"text-[#303133] text-[24rpx] mx-[10rpx] min-w-[56rpx] h-[38rpx] leading-[40rpx] text-center border-[1rpx] border-solid border-[#ddd] rounded-[4rpx]"},{default:p((()=>[n(c(e.num),1)])),_:2},1024)])),plus:p((()=>[x(r,{class:h([{"text-[#999]":e.num===te(e).max," text-[#303133]":e.num!==te(e).max},"text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx"])},null,8,["class"])])),_:2},1032,["modelValue","onUpdate:modelValue","min","max","onChange"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["options","onClick"])])),_:2},1024)):g("v-if",!0)],64)))),256))])),_:1},512)])),_:1})):g("v-if",!0),J.value.length?(d(),u(l,{key:1,class:"bg-[#fff] pb-[10rpx] box-border rounded-[16rpx] mt-[20rpx]"},{default:p((()=>[x(l,{class:"flex px-[20rpx] justify-between items-center h-[79rpx] box-border font-400 text-[#303133] text-[24rpx] mb-[10rpx] leading-[30rpx] border-0 border-b-[2rpx] border-solid border-[#f6f6f6]"},{default:p((()=>[x(r,null,{default:p((()=>[n("共"),x(r,{class:"text-[var(--price-text-color)]"},{default:p((()=>[n(c(J.value.length),1)])),_:1}),n("件失效商品")])),_:1}),x(r,{class:"text-[#666] text-[26rpx]",onClick:ue},{default:p((()=>[n("清空")])),_:1})])),_:1}),(d(!0),f(m,null,_(J.value,((e,t)=>(d(),u(l,{class:"py-[20rpx] overflow-hidden"},{default:p((()=>[x(l,{class:"flex px-[20rpx]"},{default:p((()=>[x(r,{class:"self-center iconfont iconxuanze1 text-[34rpx] mr-[20rpx] text-[#F5F5F5] rounded-[50%] overflow-hidden shrink-0"}),x(l,{class:"relative w-[168rpx] h-[168rpx]"},{default:p((()=>[x(a,{class:"rounded-[8rpx] overflow-hidden",width:"168rpx",height:"168rpx",src:i(z)(e.goodsSku.sku_image_thumb_mid),model:"aspectFill"},{error:p((()=>[x(s,{class:"w-[168rpx] h-[168rpx] rounded-[8rpx] overflow-hidden",src:i(z)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),0==e.goodsSku.stock?(d(),u(l,{key:0,class:"absolute left-0 top-0 w-[168rpx] h-[168rpx] leading-[168rpx] text-center",style:{"background-color":"rgba(0,0,0,0.3)"}},{default:p((()=>[x(r,{class:"text-[#fff] text-[24rpx]"},{default:p((()=>[n("已售罄")])),_:1})])),_:1})):g("v-if",!0),0!=e.goodsSku.stock?(d(),u(l,{key:1,class:"absolute left-0 top-0 w-[168rpx] h-[168rpx] leading-[168rpx] text-center",style:{"background-color":"rgba(0,0,0,0.3)"}},{default:p((()=>[x(r,{class:"text-[#fff] text-[24rpx]"},{default:p((()=>[n("已失效")])),_:1})])),_:1})):g("v-if",!0)])),_:2},1024),x(l,{class:"flex flex-1 flex-wrap ml-[20rpx] w-[410rpx]"},{default:p((()=>[x(l,{class:"w-[100%] flex flex-col items-baseline"},{default:p((()=>[x(l,{class:"w-[406rpx] text-[#333] text-[28rpx] max-h-[80rpx] leading-[40rpx] font-400 multi-hidden"},{default:p((()=>[n(c(e.goods.goods_name),1)])),_:2},1024),x(l,{class:"w-[406rpx] text-[#333] text-[20rpx] max-h-[80rpx] leading-[40rpx] font-400 multi-hidden"},{default:p((()=>[n(c(e.goods.sub_title),1)])),_:2},1024),e.goodsSku&&e.goodsSku.sku_spec_format?(d(),u(l,{key:0,class:"box-border max-w-[406rpx] mt-[4rpx] px-[14rpx] h-[36rpx] leading-[36rpx] truncate text-[#666] bg-[#F5F5F5] text-[22rpx] rounded-[20rpx]"},{default:p((()=>[n(c(e.goodsSku.sku_spec_format),1)])),_:2},1024)):g("v-if",!0)])),_:2},1024),x(l,{class:"flex justify-between items-end self-end w-[100%]"},{default:p((()=>[x(l,{class:"flex items-end text-[var(--price-text-color)] leading-[40rpx] price-font"},{default:p((()=>[x(l,{class:"text-[var(--price-text-color)] price-font"},{default:p((()=>[x(r,{class:"text-[26rpx] font-500"},{default:p((()=>[n("￥")])),_:1}),x(r,{class:"text-[36rpx] font-500"},{default:p((()=>[n(c(parseFloat(ie(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),x(r,{class:"text-[24rpx] font-500"},{default:p((()=>[n("."+c(parseFloat(ie(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==pe(e)?(d(),u(s,{key:0,class:"h-[24rpx] ml-[6rpx]",src:i(z)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):g("v-if",!0),"discount_price"==pe(e)?(d(),u(s,{key:1,class:"h-[24rpx] ml-[6rpx]",src:i(z)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):g("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),256))])),_:1})):g("v-if",!0)])),_:1})])),_:1})])),_:1})):(d(),u(l,{key:1,class:"flex-1 flex flex-col justify-center bg-[#fff]"},{default:p((()=>[x(s,{class:"overflow-hidden mx-auto w-[348rpx] h-[256rpx]",src:i(z)("addon/phone_shop/cart-empty.png"),model:"aspectFit"},null,8,["src"]),x(l,{class:"text-[#999] text-[26rpx] font-400 text-center leading-[30rpx]"},{default:p((()=>[n("赶紧去逛逛, 购买心仪的商品吧")])),_:1}),x(o,{shape:"circle",plain:"true",class:"!min-w-[220rpx] mt-[40rpx] text-[26rpx] h-[66rpx] leading-[62rpx] !text-[#EF000C] !border-[#EF000C] rounded-full",onClick:t[0]||(t[0]=e=>i(y)({url:"/addon/phone_shop/pages/goods/list"}))},{default:p((()=>[n("去逛逛")])),_:1})])),_:1})):(d(),u(l,{key:0,class:"flex-1 flex flex-col justify-center bg-[#fff]"},{default:p((()=>[x(s,{class:"overflow-hidden mx-auto w-[348rpx] h-[250rpx]",src:i(z)("static/resource/images/system/login.png"),model:"aspectFit"},null,8,["src"]),x(l,{class:"text-[#999] text-[26rpx] font-400 text-center leading-[30rpx]"},{default:p((()=>[n("暂未登录")])),_:1}),x(o,{shape:"circle",plain:"true",class:"!w-[220rpx] mt-[40rpx] text-[26rpx] !text-[#EF000C] !border-[#EF000C] leading-[62rpx] h-[66rpx] rounded-full",onClick:ee},{default:p((()=>[n("去登录")])),_:1})])),_:1}))])),_:1})),G.value.length?(d(),u(l,{key:1,class:"flex h-[100rpx] items-center bg-[#fff] fixed left-0 right-0 bottom-[50px] box-solid mb-ios justify-between"},{default:p((()=>[x(l,{class:"flex items-center pl-[30rpx]",onClick:oe},{default:p((()=>[x(r,{class:h(["self-center iconfont text-color text-[34rpx] mr-[20rpx] w-[34rpx] h-[34rpx] rounded-[17rpx] overflow-hidden shrink-0",G.value.length==i(Y)?"iconxuanze1":"bg-[#F5F5F5]"])},null,8,["class"]),x(r,{class:"font-400 text-[#303133] text-[26rpx]"},{default:p((()=>[n("全选")])),_:1})])),_:1}),x(l,{class:"flex items-center"},{default:p((()=>[K.value?(d(),u(l,{key:1,class:"flex-1 flex items-center justify-end"},{default:p((()=>[x(o,{class:"w-[160rpx] h-[66rpx] text-[28rpx] leading-[66rpx] !text-[#fff] m-0 !mr-[30rpx] rounded-full primary-btn-bg remove-border",onClick:de},{default:p((()=>[n("删除")])),_:1})])),_:1})):(d(),u(l,{key:0,class:"flex-1 flex items-center justify-between"},{default:p((()=>[x(l,{class:"flex items-center mr-[67rpx] text-[var(--price-text-color)] leading-[45rpx]"},{default:p((()=>[x(l,{class:"font-400 text-[#303133] text-[26rpx]"},{default:p((()=>[n("合计：")])),_:1}),x(r,{class:"text-[var(--price-text-color)] price-font"},{default:p((()=>[x(r,{class:"text-[26rpx] font-500"},{default:p((()=>[n("￥")])),_:1}),x(r,{class:"text-[36rpx] font-500"},{default:p((()=>[n(c(parseFloat($.value).toFixed(2).split(".")[0]),1)])),_:1}),x(r,{class:"text-[24rpx] font-500"},{default:p((()=>[n("."+c(parseFloat($.value).toFixed(2).split(".")[1]),1)])),_:1})])),_:1})])),_:1}),x(o,{class:"w-[160rpx] h-[66rpx] text-[28rpx] leading-[66rpx] !text-[#fff] m-0 !mr-[30rpx] rounded-full primary-btn-bg remove-border",onClick:ae},{default:p((()=>[n("结算")])),_:1})])),_:1}))])),_:1})])),_:1})):g("v-if",!0),x(H,{"bg-color":"rgb(248,248,248)",loading:T.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"]),x(Q),g(" 强制绑定手机号 "),x(M,{ref_key:"bindMobileRef",ref:re},null,512)])),_:1},8,["style"])}}}),[["__scopeId","data-v-b07fbd90"]]);export{R as default};
