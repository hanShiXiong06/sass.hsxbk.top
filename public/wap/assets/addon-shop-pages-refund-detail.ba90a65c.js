import{d as e,r as t,j as a,p as l,K as r,E as s,o,c as d,w as u,b as p,y as n,z as i,u as x,f,R as c,A as m,n as _,a as v,i as g,B as b,g as h,h as y,D as w,C as j,F as k}from"./index-7bf68536.js";import{_ as F}from"./u--image.b3bf1d5c.js";import{_ as C}from"./u--input.ddc1d28b.js";import{_ as V}from"./u-form.78a4f7c2.js";import{_ as O}from"./u--form.632a93a1.js";import{_ as T}from"./u-modal.b47eb877.js";import{_ as z}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{t as B}from"./topTabbar.f3f9eebd.js";import{c as S,i as L,r as R,h as U}from"./refund.15be903a.js";import{l as A}from"./logistics-tracking.2245bacf.js";import{_ as N}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-image.e46f68ef.js";import"./u-icon.0c1c54c7.js";import"./u-transition.cdf87992.js";import"./u-input.09a5cedd.js";import"./u-line.463a2a45.js";import"./u-loading-icon.b37701e7.js";import"./u-popup.be4bfacd.js";import"./u-safe-bottom.908eeae4.js";import"./u-loading-page.566c330a.js";import"./u-steps.9fc55f35.js";import"./u-text.df478cbc.js";import"./order.3552570e.js";const q=N(e({__name:"detail",setup(e){B().setTopTabbarParam({title:"退款详情"});const N=t({}),q=t(!0),E=t(""),M=t(""),P=t(!1),D=t("");t("");const I=t(""),K=t({express_number:"",express_company:"",remark:""}),W=a((()=>({express_number:{type:"string",required:!0,message:"请输入物流单号",trigger:["blur","change"]},express_company:{type:"string",required:!0,message:"请输入物流公司",trigger:["blur","change"]}})));t(null),l((e=>{if(E.value=e.order_refund_no,E.value)M.value=e.type,P.value=e.is_edit_delivery,X(E.value);else{r({url:"/addon/shop/pages/refund/list",title:"缺少订单号"})}}));const X=e=>{q.value=!0,S(e).then((e=>{N.value=e.data,P.value&&N.value.delivery&&(K.value.express_number=N.value.delivery.express_number,K.value.express_company=N.value.delivery.express_company,K.value.remark=N.value.delivery.remark),D.value=N.value.order_goods.goods_name,I.value=s(N.value.order_goods.goods_image_thumb_small||""),q.value=!1})).catch((()=>{q.value=!1}))},Y=e=>{v({url:"/addon/shop/pages/goods/detail",param:{goods_id:e}})},G=t(),H=()=>{G.value.validate().then((e=>{let t={delivery:K.value,order_refund_no:N.value.order_refund_no};(P.value?L(t):R(t)).then((e=>{setTimeout((()=>{v({url:"/addon/shop/pages/refund/list"})}),500)})).catch((()=>{}))}))},J=e=>{"cancel"==e?(Z=N.value.order_refund_no,Q.value=!0):"edit"==e?v({url:"/addon/shop/pages/refund/edit_apply",param:{order_refund_no:N.value.order_refund_no}}):"logistics"==e?v({url:"/addon/shop/pages/refund/detail",param:{order_refund_no:N.value.order_refund_no,type:"logistics"}}):"editLogistics"==e&&v({url:"/addon/shop/pages/refund/detail",param:{order_refund_no:N.value.order_refund_no,type:"logistics",is_edit_delivery:!0}})},Q=t(!1);let Z="";const $=()=>{U(Z).then((e=>{Q.value=!1,X(E.value)})).catch((()=>{Q.value=!1}))},ee=()=>{Q.value=!1};return(e,t)=>{const a=g,l=b,r=h(y("u--image"),F),B=w,S=h(y("u--input"),C),L=h(y("u-form-item"),V),R=h(y("u--form"),O),U=j,P=h(y("u-modal"),T),D=h(y("loading-page"),z);return o(),d(a,{style:_(e.themeColor())},{default:u((()=>[q.value?f("v-if",!0):(o(),d(a,{key:0,class:"bg-[var(--page-bg-color)] min-h-screen overflow-hidden"},{default:u((()=>["logistics"!=M.value?(o(),d(a,{key:0,class:"pb-[200rpx]"},{default:u((()=>[p(a,{class:"bg-linear"},{default:u((()=>[N.value.status_name?(o(),d(a,{key:0,class:"flex justify-between items-center pl-[40rpx] pr-[50rpx] h-[280rpx] box-border pb-[90rpx]"},{default:u((()=>[p(a,{class:"text-[36rpx] font-500 leading-[42rpx] text-[#fff]"},{default:u((()=>[n(i(N.value.status_name),1)])),_:1}),p(a,{class:"flex items-center"},{default:u((()=>[-1!=["1","2","4","6","7"].indexOf(N.value.status)?(o(),d(l,{key:0,class:"w-[180rpx] h-[140rpx]",src:x(s)("addon/shop/detail/payment.png"),mode:"aspectFit"},null,8,["src"])):f("v-if",!0),-1!=["8"].indexOf(N.value.status)?(o(),d(l,{key:1,class:"w-[180rpx] h-[140rpx]",src:x(s)("addon/shop/detail/complete.png"),mode:"aspectFit"},null,8,["src"])):f("v-if",!0),-1!=["3","5","-1"].indexOf(N.value.status)?(o(),d(l,{key:2,class:"w-[180rpx] h-[140rpx]",src:x(s)("addon/shop/detail/close.png"),mode:"aspectFit"},null,8,["src"])):f("v-if",!0)])),_:1})])),_:1})):f("v-if",!0)])),_:1}),p(a,{class:"sidebar-margin card-template flex justify-between flex-wrap mt-[-76rpx]"},{default:u((()=>[p(a,{class:"w-[150rpx] h-[150rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",onClick:t[0]||(t[0]=e=>Y(N.value.order_goods.goods_id))},{default:u((()=>[p(r,{radius:"var(--goods-rounded-big)",width:"150rpx",height:"150rpx",src:x(s)(N.value.order_goods.goods_image_thumb_small?N.value.order_goods.goods_image_thumb_small:""),model:"aspectFill"},{error:u((()=>[p(l,{class:"w-[150rpx] h-[150rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:x(s)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:1},8,["src"])])),_:1}),p(a,{class:"ml-[20rpx] flex flex-1 flex-col justify-between"},{default:u((()=>[p(a,null,{default:u((()=>[p(a,{class:"text-[28rpx] max-w-[490rpx] truncate leading-[40rpx]"},{default:u((()=>[n(i(N.value.order_goods.goods_name),1)])),_:1}),N.value.order_goods.sku_name?(o(),d(a,{key:0,class:"text-[22rpx] mt-[10rpx] text-[var(--text-color-light9)] truncate max-w-[490rpx] leading-[28rpx]"},{default:u((()=>[n(i(N.value.order_goods.sku_name),1)])),_:1})):f("v-if",!0)])),_:1}),p(a,{class:"flex justify-between items-center leading-[28rpx]"},{default:u((()=>[p(a,{class:"price-font"},{default:u((()=>[p(B,{class:"text-[24rpx]"},{default:u((()=>[n("￥")])),_:1}),p(B,{class:"text-[40rpx] font-500"},{default:u((()=>[n(i(parseFloat(N.value.order_goods.price).toFixed(2).split(".")[0]),1)])),_:1}),p(B,{class:"text-[24rpx] font-500"},{default:u((()=>[n("."+i(parseFloat(N.value.order_goods.price).toFixed(2).split(".")[1]),1)])),_:1})])),_:1}),p(B,{class:"text-right text-[26rpx]"},{default:u((()=>[n("x"+i(N.value.order_goods.num),1)])),_:1})])),_:1})])),_:1})])),_:1}),p(a,{class:"sidebar-margin mt-[var(--top-m)] card-template"},{default:u((()=>[p(a,{class:"justify-between text-[28rpx] card-template-item"},{default:u((()=>[p(a,null,{default:u((()=>[n(i(x(k)("refundMoney")),1)])),_:1}),p(a,{class:"price-font text-[var(--price-text-color)]"},{default:u((()=>[p(B,{class:"text-[24rpx] mr-[4rpx]"},{default:u((()=>[n("￥")])),_:1}),8==N.value.status?(o(),d(B,{key:0,class:"text-[28rpx]"},{default:u((()=>[n(i(parseFloat(N.value.money).toFixed(2)),1)])),_:1})):(o(),d(B,{key:1,class:"text-[28rpx]"},{default:u((()=>[n(i(parseFloat(N.value.apply_money).toFixed(2)),1)])),_:1}))])),_:1})])),_:1}),p(a,{class:"justify-between text-[28rpx] card-template-item"},{default:u((()=>[p(a,null,{default:u((()=>[n(i(x(k)("refundType")),1)])),_:1}),p(a,null,{default:u((()=>[n(i(N.value.refund_type_name),1)])),_:1})])),_:1}),p(a,{class:"justify-between text-[28rpx] card-template-item"},{default:u((()=>[p(a,null,{default:u((()=>[n(i(x(k)("refundCause")),1)])),_:1}),p(a,{class:"w-[400rpx] multi-hidden text-right"},{default:u((()=>[n(i(N.value.reason||"--"),1)])),_:1})])),_:1}),p(a,{class:"justify-between text-[28rpx] card-template-item"},{default:u((()=>[p(a,null,{default:u((()=>[n(i(x(k)("refundNo")),1)])),_:1}),p(a,null,{default:u((()=>[n(i(N.value.order_refund_no),1)])),_:1})])),_:1}),p(a,{class:"justify-between text-[28rpx] card-template-item"},{default:u((()=>[p(a,null,{default:u((()=>[n(i(x(k)("createTime")),1)])),_:1}),p(a,null,{default:u((()=>[n(i(N.value.create_time),1)])),_:1})])),_:1}),p(a,{class:"justify-between text-[28rpx] card-template-item !items-baseline"},{default:u((()=>[p(a,null,{default:u((()=>[n(i(x(k)("createExplain")),1)])),_:1}),p(a,{class:"flex-1 ml-[60rpx] text-right leading-[1.5] flex justify-end break-all"},{default:u((()=>[n(i(N.value.remark),1)])),_:1})])),_:1}),p(a,{class:"justify-between text-[28rpx] card-template-item !items-baseline"},{default:u((()=>[p(a,null,{default:u((()=>[n(i(x(k)("reasonRefusal")),1)])),_:1}),p(a,{class:c(["flex-1 ml-[60rpx] leading-[1.5] text-right",{"#333":N.value.shop_reason,"text-[var(--text-color-light9)]":!N.value.shop_reason}])},{default:u((()=>[n(i(N.value.shop_reason||"--"),1)])),_:1},8,["class"])])),_:1})])),_:1}),p(a,{class:"sidebar-margin mt-[var(--top-m)] card-template"},{default:u((()=>[p(a,{class:"justify-between text-[28rpx] card-template-item"},{default:u((()=>[p(a,null,{default:u((()=>[n(i(x(k)("record")),1)])),_:1}),p(a,{class:"flex items-center",onClick:t[1]||(t[1]=e=>x(v)({url:"/addon/shop/pages/refund/log",param:{order_refund_no:E.value}}))},{default:u((()=>[p(B,{class:"text-[26rpx] text-[var(--text-color-light9)]"},{default:u((()=>[n(i(x(k)("check")),1)])),_:1}),p(B,{class:"nc-iconfont nc-icon-youV6xx text-[24rpx] text-[var(--text-color-light9)] pt-[2rpx]"})])),_:1})])),_:1})])),_:1}),p(a,{class:"flex tab-bar justify-between items-center bg-[#fff] fixed left-0 right-0 bottom-0 min-h-[100rpx] pl-[30rpx] pr-[20rpx] flex-wrap"},{default:u((()=>[p(a,{class:"flex"},{default:u((()=>[p(a,{class:"flex mr-[20rpx] flex-col justify-center items-center",onClick:t[2]||(t[2]=e=>x(v)({url:"/addon/shop/pages/index",mode:"reLaunch"}))},{default:u((()=>[p(a,{class:"nc-iconfont nc-icon-shouyeV6xx11 text-[36rpx]"}),p(B,{class:"text-[20rpx] mt-[10rpx]"},{default:u((()=>[n(i(x(k)("index")),1)])),_:1})])),_:1})])),_:1}),p(a,{class:"flex justify-end"},{default:u((()=>[-1==["6","7","8","-1"].indexOf(N.value.status)?(o(),d(a,{key:0,class:"min-w-[180rpx] box-border text-[26rpx] h-[70rpx] flex-center border-[2rpx] border-solid border-[#ccc] text-[#333] rounded-full ml-[20rpx]",onClick:t[3]||(t[3]=e=>J("cancel"))},{default:u((()=>[n(i(x(k)("refundApply")),1)])),_:1})):f("v-if",!0),-1!=["3"].indexOf(N.value.status)?(o(),d(a,{key:1,class:"min-w-[180rpx] box-border text-[#333] text-[26rpx] h-[70rpx] flex-center border-[2rpx] border-solid border-[#ccc] rounded-full ml-[20rpx] px-[20rpx]",onClick:t[4]||(t[4]=m((e=>J("edit")),["stop"]))},{default:u((()=>[n("编辑退款信息")])),_:1})):f("v-if",!0),-1!=["2"].indexOf(N.value.status)?(o(),d(a,{key:2,class:"min-w-[180rpx] box-border text-[#333] text-[26rpx] h-[70rpx] flex-center border-[2rpx] border-solid border-[#ccc] rounded-full ml-[20rpx] px-[20rpx]",onClick:t[5]||(t[5]=m((e=>J("logistics")),["stop"]))},{default:u((()=>[n("填写发货物流")])),_:1})):f("v-if",!0),-1!=["5"].indexOf(N.value.status)?(o(),d(a,{key:3,class:"min-w-[180rpx] box-border text-[#333] text-[26rpx] h-[70rpx] flex-center border-[2rpx] border-solid border-[#ccc] rounded-full ml-[20rpx] px-[20rpx]",onClick:t[6]||(t[6]=m((e=>J("editLogistics")),["stop"]))},{default:u((()=>[n("编辑发货物流")])),_:1})):f("v-if",!0)])),_:1})])),_:1})])),_:1})):(o(),d(a,{key:1},{default:u((()=>[p(a,{class:"bg-linear"},{default:u((()=>[p(a,{class:"flex justify-between items-center pl-[40rpx] pr-[50rpx] h-[280rpx] box-border pb-[90rpx]"},{default:u((()=>[p(a,{class:"text-[36rpx] font-500 leading-[42rpx] text-[#fff]"},{default:u((()=>[n(i(N.value.status_name),1)])),_:1}),p(a,{class:"flex items-center"},{default:u((()=>[p(l,{class:"w-[180rpx] h-[140rpx]",src:x(s)("addon/shop/detail/payment.png"),mode:"aspectFit"},null,8,["src"])])),_:1})])),_:1})])),_:1}),p(a,{class:"sidebar-margin card-template mt-[-79rpx] flex justify-between flex-wrap"},{default:u((()=>[p(a,{class:"w-[150rpx] h-[150rpx] flex-2",onClick:t[7]||(t[7]=e=>Y(N.value.order_goods.goods_id))},{default:u((()=>[p(r,{radius:"var(--goods-rounded-big)",width:"150rpx",height:"150rpx",src:x(s)(N.value.order_goods.sku_image?N.value.order_goods.sku_image.split(",")[0]:""),model:"aspectFill"},{error:u((()=>[p(l,{class:"w-[150rpx] h-[150rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:x(s)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:1},8,["src"])])),_:1}),p(a,{class:"ml-[20rpx] flex flex-1 flex-col justify-between"},{default:u((()=>[p(a,null,{default:u((()=>[p(a,{class:"text-[28rpx] max-w-[490rpx] truncate leading-[40rpx]"},{default:u((()=>[n(i(N.value.order_goods.goods_name),1)])),_:1}),N.value.order_goods.sku_name?(o(),d(a,{key:0,class:"text-[24rpx] mt-[14rpx] text-[var(--text-color-light9)] truncate max-w-[490rpx] leading-[28rpx]"},{default:u((()=>[n(i(N.value.order_goods.sku_name),1)])),_:1})):f("v-if",!0)])),_:1}),p(a,{class:"flex justify-between items-center leading-[28rpx]"},{default:u((()=>[p(a,{class:"price-font"},{default:u((()=>[p(B,{class:"text-[24rpx] font-500"},{default:u((()=>[n("￥")])),_:1}),p(B,{class:"text-[40rpx] font-500"},{default:u((()=>[n(i(parseFloat(N.value.order_goods.price).toFixed(2).split(".")[0]),1)])),_:1}),p(B,{class:"text-[24rpx] font-500"},{default:u((()=>[n("."+i(parseFloat(N.value.order_goods.price).toFixed(2).split(".")[1]),1)])),_:1})])),_:1}),p(B,{class:"text-right text-[26rpx]"},{default:u((()=>[n("x"+i(N.value.order_goods.num),1)])),_:1})])),_:1})])),_:1})])),_:1}),p(a,{class:"sidebar-margin card-template top-mar"},{default:u((()=>[p(a,{class:"card-template-item justify-between text-[28rpx]"},{default:u((()=>[p(a,null,{default:u((()=>[n("联系人")])),_:1}),p(a,null,{default:u((()=>[n(i(N.value.refund_address.contact_name),1)])),_:1})])),_:1}),p(a,{class:"card-template-item justify-between text-[28rpx]"},{default:u((()=>[p(a,null,{default:u((()=>[n("手机号")])),_:1}),p(a,null,{default:u((()=>[n(i(N.value.refund_address.mobile),1)])),_:1})])),_:1}),p(a,{class:"card-template-item justify-between text-[28rpx]"},{default:u((()=>[p(a,null,{default:u((()=>[n("退货地址")])),_:1}),N.value.refund_address?(o(),d(a,{key:0,class:"w-[460rpx] text-sm text-right"},{default:u((()=>[n(i(N.value.refund_address.full_address||"--"),1)])),_:1})):f("v-if",!0)])),_:1})])),_:1}),p(a,{class:"sidebar-margin card-template top-mar py-[var(--top-m)]"},{default:u((()=>[p(a,{class:"title"},{default:u((()=>[n("物流信息")])),_:1}),p(R,{labelPosition:"left",model:K.value,rules:x(W),errorType:"toast",ref_key:"deliveryForm",ref:G,labelWidth:"140rpx",labelStyle:{fontSize:"28rpx"}},{default:u((()=>[p(L,{label:"物流公司",prop:"express_company",borderBottom:!1},{default:u((()=>[p(S,{border:"none",modelValue:K.value.express_company,"onUpdate:modelValue":t[8]||(t[8]=e=>K.value.express_company=e),placeholder:"请输入物流公司",placeholderClass:"text-sm !text-[var(--text-color-light9)]",fontSize:"28rpx",maxlength:"50"},null,8,["modelValue"])])),_:1}),p(a,{class:"mt-[16rpx]"},{default:u((()=>[p(L,{label:"物流单号",prop:"express_number",borderBottom:!1},{default:u((()=>[p(S,{border:"none",placeholder:"请输入物流单号",modelValue:K.value.express_number,"onUpdate:modelValue":t[9]||(t[9]=e=>K.value.express_number=e),placeholderClass:"text-sm !text-[var(--text-color-light9)]",fontSize:"28rpx",maxlength:"100"},null,8,["modelValue"])])),_:1})])),_:1}),p(a,{class:"mt-[16rpx]"},{default:u((()=>[p(L,{label:"物流说明",borderBottom:!1},{default:u((()=>[p(S,{border:"none",placeholder:"选填",modelValue:K.value.remark,"onUpdate:modelValue":t[10]||(t[10]=e=>K.value.remark=e),placeholderClass:"text-sm !text-[var(--text-color-light9)]",fontSize:"28rpx",maxlength:"100"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1}),p(a,{class:"common-tab-bar-placeholder"}),p(a,{class:"common-tab-bar fixed left-[var(--sidebar-m)] right-[var(--sidebar-m)] bottom-[0]"},{default:u((()=>[p(U,{class:"mt-[80rpx] primary-btn-bg text-[#fff] h-[80rpx] leading-[80rpx] rounded-[100rpx] text-[26rpx] font-500","hover-class":"none",onClick:H},{default:u((()=>[n("提交")])),_:1})])),_:1})])),_:1})),p(A,{ref:"materialRef"},null,512),p(P,{show:Q.value,confirmColor:"var(--primary-color)",content:x(k)("cancelRefundContent"),showCancelButton:!0,closeOnClickOverlay:!0,onCancel:ee,onConfirm:$},null,8,["show","content"])])),_:1})),p(D,{loading:q.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-6f4d480d"]]);export{q as default};
