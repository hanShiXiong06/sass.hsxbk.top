import{d as e,r as a,p as l,aH as t,j as s,aI as r,t as d,o,c as u,w as i,b as n,u as m,y as c,z as p,n as _,aJ as v,aK as f,a as b,i as g,g as h,h as y,a5 as x,F as j}from"./index-9317da28.js";import{_ as V}from"./u-input.e030155a.js";import{_ as w}from"./u-form-item.83fe1c60.js";import{_ as k}from"./u-icon.5e775659.js";import{_ as S}from"./u-switch.4466d14d.js";import{_ as q}from"./u-button.c3400270.js";import{_ as C}from"./u-form.cfe692b2.js";import{m as I}from"./manifest.3a40c0c0.js";/* empty css                                                                */import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-line.30917996.js";/* empty css                                                               */import"./u-loading-icon.aabe3d05.js";/* empty css                                                                       */const P=e({__name:"edit",setup(e){a("");const P=a({id:0,name:"",mobile:"",lat:"",lng:"",address:"",address_name:"",full_address:"",is_default:0,area:"",type:"location_address"}),U=a(!1);l((e=>{if(e.id)t(e.id).then((({data:e})=>{e&&(Object.assign(P.value,e),P.value.area=P.value.full_address.replace(P.value.address,"").replace(P.value.address_name,""))})).catch();else if(option.name){uni.getStorageSync("addressInfo")&&Object.assign(P.value,uni.getStorageSync("addressInfo")),P.value.address=option.name,O(option.latng);var a=z("latng").split(",");P.value.lat=a[0],P.value.lng=a[1]}}));const $=a(null),A=s((()=>({address:{type:"string",required:!0,message:"请填写门牌号",trigger:["blur","change"]},name:{type:"string",required:!0,message:"请输入联系人姓名",trigger:["blur","change"]},mobile:[{type:"string",required:!0,message:"请输入手机号码",trigger:["blur","change"]},{validator:()=>uni.$u.test.mobile(P.value.mobile),message:"请输入正确的手机号"}]}))),z=e=>{for(var a=window.location.search.substring(1).split("&"),l=0;l<a.length;l++){var t=a[l].split("=");if(t[0]==e)return t[1]}return!1},O=e=>{r({latlng:e}).then((e=>{e.data&&e.data.length?(P.value.full_address="",P.value.full_address+=null!=e.data.province?e.data.province:"",P.value.full_address+=null!=e.data.city?""+e.data.city:"",P.value.full_address+=null!=e.data.district?""+e.data.district:"",P.value.address_name=P.value.full_address.replace(/-/g,""),P.value.area=e.data.full_address,P.value.province_id=null!=e.data.province_id?e.data.province_id:0,P.value.city_id=null!=e.data.city_id?e.data.city_id:0,P.value.district_id=null!=e.data.district_id?e.data.district_id:0):d({title:e.msg,icon:"none"})}))},R=a(!1),T=()=>{if(uni.$u.test.isEmpty(P.value.area))return void d({title:"请选择地址",icon:"none"});const e=P.value.id?v:f;$.value.validate().then((()=>{R.value||(R.value=!0,U.value=!0,P.value.full_address=`${P.value.area}${P.value.address_name}${P.value.address}`,e(P.value).then((e=>{R.value=!1,uni.removeStorageSync("addressInfo"),setTimeout((()=>{U.value=!1,b({url:"/addon/o2o/pages/address/index"})}),1e3)})).catch((()=>{R.value=!1,U.value=!1})))}))},W=()=>{var e=P.value;uni.setStorageSync("addressInfo",e);let a=location.href;window.location.href="https://apis.map.qq.com/tools/locpicker?search=1&type=0&backurl="+encodeURIComponent(a)+"&key="+I.h5.sdkConfigs.maps.qqmap.key+"&referer=myapp"};return(e,a)=>{const l=g,t=h(y("u-input"),V),s=h(y("u-form-item"),w),r=h(y("u-icon"),k),d=h(y("u-switch"),S),v=h(y("u-button"),q),f=h(y("u-form"),C),b=x;return o(),u(l,{style:_(e.themeColor())},{default:i((()=>[n(b,{"scroll-y":"true",class:"bg-page h-screen"},{default:i((()=>[n(l,{class:"h-[30rpx]"}),n(l,{class:"m-[30rpx] mt-0 p-[30rpx] pt-[10rpx] rounded-md bg-white"},{default:i((()=>[n(f,{labelPosition:"left",model:P.value,labelWidth:"200rpx",errorType:"toast",rules:m(A),ref_key:"formRef",ref:$},{default:i((()=>[n(l,{class:"mt-[10rpx]"},{default:i((()=>[n(s,{label:m(j)("name"),prop:"name","border-bottom":!0},{default:i((()=>[n(t,{modelValue:P.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>P.value.name=e),border:"none",clearable:"",maxlength:"25",placeholder:m(j)("namePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),n(l,{class:"mt-[10rpx]"},{default:i((()=>[n(s,{label:m(j)("mobile"),prop:"mobile","border-bottom":!0},{default:i((()=>[n(t,{modelValue:P.value.mobile,"onUpdate:modelValue":a[1]||(a[1]=e=>P.value.mobile=e),border:"none",clearable:"",placeholder:m(j)("mobilePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),n(l,{class:"mt-[10rpx]"},{default:i((()=>[n(s,{label:m(j)("homeAddress"),prop:"address_name","border-bottom":!0},{default:i((()=>[n(l,{class:"flex justify-between flex-1",onClick:W},{default:i((()=>[n(l,{class:"text-[#c3c4d5] text-[15px]"},{default:i((()=>[c(p(P.value.area?P.value.address_name:m(j)("selectAddressPlaceholder")),1)])),_:1}),n(r,{name:"arrow-right",color:"#c3c4d5"})])),_:1})])),_:1},8,["label"])])),_:1}),n(l,{class:"mt-[10rpx]"},{default:i((()=>[n(s,{label:m(j)("address"),prop:"address","border-bottom":!0},{default:i((()=>[n(t,{modelValue:P.value.address,"onUpdate:modelValue":a[2]||(a[2]=e=>P.value.address=e),border:"none",clearable:"",maxlength:"120",placeholder:m(j)("addressPlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),n(l,{class:"mt-[10rpx]"},{default:i((()=>[n(s,{label:m(j)("defaultAddress"),prop:"name","border-bottom":!0},{default:i((()=>[n(d,{modelValue:P.value.is_default,"onUpdate:modelValue":a[3]||(a[3]=e=>P.value.is_default=e),size:"20",activeValue:1,inactiveValue:0,activeColor:"var(--primary-color)"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),n(l,{class:"mt-[40rpx]"},{default:i((()=>[n(v,{class:"text-[var-(--primary-color)]",type:"primary",shape:"circle",text:m(j)("save"),onClick:T,disabled:U.value,loading:R.value},null,8,["text","disabled","loading"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})])),_:1},8,["style"])}}});export{P as default};
