import{d as e,r as t,l as s,m as a,o as i,c as l,w as n,b as r,u as o,x as d,y as c,E as u,F as h,G as p,aN as f,H as m,_ as g,B as x,a as b,i as k,g as _,h as y,C as v,a4 as w,V as C,X as S,b8 as D,n as V,aW as T,f as I,bd as R,c5 as $,a3 as j,ac as N,j as O,I as F,N as L,t as P}from"./index-e6ce9fbf.js";import{_ as A}from"./u-swiper.c3f444d2.js";import{_ as E}from"./u-parse.eafe216c.js";import{_ as B}from"./u-button.7a41d301.js";import{_ as W}from"./u-loading-page.76c2d95f.js";import{c as K}from"./goods.45ad32e1.js";import{_ as U}from"./u-icon.c5d9cd81.js";import{_ as H}from"./u--image.2a363e1d.js";import{_ as J}from"./u-number-box.4270f2af.js";import{_ as M}from"./u-popup.b16d6e1d.js";import{_ as z}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as q}from"./share-poster.88ccab8c.js";import"./u-loading-icon.39fd4711.js";import"./u-transition.6919b33f.js";import"./u-image.c9386d77.js";import"./u-safe-bottom.1ba5bfba.js";const G=e({__name:"ns-goods-sku",props:["goodsDetail"],emits:["change"],setup(e,{expose:D,emit:V}){const T=e;let I=t(!1),R=t(null),$=t({sku_id:"",name:""}),j=t(1);const N=s(),O=a((()=>N.info)),F=()=>{I.value=!1},L=a((()=>{let e=JSON.parse(JSON.stringify(T.goodsDetail));return Object.keys(e).length&&($.value.sku_id=e.sku_id,e.skuList.map(((e,t)=>(e.selected=!1,e.sku_id==$.value.sku_id&&(e.selected=!0),e))),P(),e.skuList&&Object.keys(e.skuList).length&&e.skuList.forEach(((t,s)=>{t.sku_id==$.value.sku_id&&(e.detail=t)}))),e})),P=()=>{T.goodsDetail.skuList.forEach(((e,t)=>{e.sku_id==$.value.sku_id&&V("change",e.sku_id)}))},A=()=>{if(!O.value)return x().setLoginBack({url:"/addon/o2o/pages/goods/detail",param:{sku_id:L.value.sku_id}}),!1;if(!L.value.goods.status)return!1;var e={sku_id:L.value.sku_id,num:j.value};uni.setStorage({key:"o2oCreateData",data:{sku:e},success:()=>{b({url:"/addon/o2o/pages/order/payment",param:{id:L.value.goods_id}})}}),F()};D({open:(e="")=>{j.value=T.goodsDetail.min_buy,I.value=!0,R.value=e}});let E=a((()=>{let e="0.00";return e=Object.keys(L.value).length&&Object.keys(L.value.goods).length&&L.value.goods.member_discount&&S()?L.value.member_price:L.value.price,parseFloat(e).toFixed(2)}));return(e,t)=>{const s=k,a=_(y("u-icon"),U),x=_(y("u--image"),H),b=v,S=_(y("u-number-box"),J),D=w,V=_(y("u-button"),B),T=_(y("u-popup"),M);return i(),l(s,{onTouchmove:t[1]||(t[1]=g((()=>{}),["prevent","stop"]))},{default:n((()=>[r(T,{show:o(I),onClose:F,mode:"bottom"},{default:n((()=>[r(s,{class:"rounded-t-[20rpx] overflow-hidden bg-[#fff] p-[32rpx] relative"},{default:n((()=>[r(s,{class:"absolute right-[37rpx] nc-iconfont nc-icon-guanbiV6xx text-[40rpx]",onClick:F}),r(s,{class:"flex mb-[58rpx]"},{default:n((()=>[r(s,{class:"rounded-[8rpx] overflow-hidden"},{default:n((()=>[r(x,{width:"204rpx",height:"204rpx",src:o(C)(o(L).detail.sku_image),model:"aspectFill"},{error:n((()=>[r(a,{name:"photo",color:"#999",size:"50"})])),_:1},8,["src"])])),_:1}),r(s,{class:"flex flex-1 flex-col justify-between ml-[20rpx]"},{default:n((()=>[r(s,{class:"w-[100%]"},{default:n((()=>[r(s,{class:"text-[var(--price-text-color)]"},{default:n((()=>[r(b,{class:"text-[28rpx] font-bold"},{default:n((()=>[d("￥")])),_:1}),r(b,{class:"text-[28rpx] mr-[10rpx] font-bold"},{default:n((()=>[d(c(o(E)),1)])),_:1})])),_:1})])),_:1}),r(s,{class:"w-[100%]",style:{"max-height":"calc(204rpx - 92rpx)"}},{default:n((()=>[r(b,{class:"text-[24rpx] leading-[38rpx] text-[#666] multi-hidden"},{default:n((()=>[d("已选规格："+c(o(L).detail.sku_name),1)])),_:1})])),_:1})])),_:1})])),_:1}),r(D,{class:"h-[500rpx]","scroll-y":"true"},{default:n((()=>[r(s,{class:"mb-[20rpx]"},{default:n((()=>[r(s,{class:"flex flex-wrap"},{default:n((()=>[(i(!0),u(p,null,h(o(L).skuList,((e,t)=>(i(),l(s,{key:t,class:m(["box-border max-w-[680px] truncate text-[24rpx] px-[15rpx] text-center leading-[42rpx] mr-[20rpx] mb-[20rpx] border-1 border-solid rounded-[8rpx] border-[#888]",{"!border-[var(--primary-color)] text-[var(--primary-color)] bg-[var(--primary-color-light)]":e.selected}]),onClick:t=>{return s=e,$.value.sku_id=s.sku_id,$.value.name=s.sku_name,j.value=s.min_buy,void P();var s}},{default:n((()=>[d(c(e.sku_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),r(s,{class:"flex justify-between"},{default:n((()=>[r(s,{class:"text-[26rpx] leading-[36rpx] mb-[30rpx]"},{default:n((()=>[d("购买数量")])),_:1}),r(S,{min:o(L).min_buy,integer:"",step:1,"input-width":"98rpx",modelValue:o(j),"onUpdate:modelValue":t[0]||(t[0]=e=>f(j)?j.value=e:j=e),"input-height":"54rpx"},{minus:n((()=>[r(b,{class:m(["text-[44rpx] nc-iconfont nc-icon-jianshaoV6xx text-[var(--primary-color)]",{"!text-[#c8c9cc]":o(j)===o(L).min_buy}])},null,8,["class"])])),input:n((()=>[r(b,{class:"text-[#333] fext-[23rpx] font-500 mx-[16rpx]"},{default:n((()=>[d(c(o(j)),1)])),_:1})])),plus:n((()=>[r(b,{class:"text-[44rpx] nc-iconfont nc-icon-tianjiaV6mm text-[var(--primary-color)]"})])),_:1},8,["min","modelValue"])])),_:1})])),_:1}),r(V,{text:o(L).goods.status?"确定":"已下架",class:"!h-[80rpx] !text-[30rpx] !m-0 !mt-[30rpx]",shape:"circle",color:o(L).goods.status?"var( --primary-color)":"#999",onClick:A},null,8,["text","color"])])),_:1})])),_:1},8,["show"])])),_:1})}}});const X=z({name:"uniTable",options:{virtualHost:!0},emits:["selection-change"],props:{data:{type:Array,default:()=>[]},border:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1},type:{type:String,default:""},emptyText:{type:String,default:"没有更多数据"},loading:{type:Boolean,default:!1},rowKey:{type:String,default:""}},data:()=>({noData:!0,minWidth:0,multiTableHeads:[]}),watch:{loading(e){},data(e){this.theadChildren,this.theadChildren&&this.theadChildren.rowspan,this.noData=!1}},created(){this.trChildren=[],this.thChildren=[],this.theadChildren=null,this.backData=[],this.backIndexData=[]},methods:{isNodata(){this.theadChildren;let e=1;this.theadChildren&&(e=this.theadChildren.rowspan),this.noData=this.trChildren.length-e<=0},selectionAll(){let e=1,t=this.theadChildren;this.theadChildren?e=t.rowspan-1:t=this.trChildren[0];let s=this.data&&this.data.length>0;t.checked=!0,t.indeterminate=!1,this.trChildren.forEach(((t,a)=>{if(!t.disabled){if(t.checked=!0,s&&t.keyValue){const e=this.data.find((e=>e[this.rowKey]===t.keyValue));this.backData.find((t=>t[this.rowKey]===e[this.rowKey]))||this.backData.push(e)}a>e-1&&-1===this.backIndexData.indexOf(a-e)&&this.backIndexData.push(a-e)}})),this.$emit("selection-change",{detail:{value:this.backData,index:this.backIndexData}})},toggleRowSelection(e,t){e=[].concat(e),this.trChildren.forEach(((s,a)=>{const i=e.findIndex((e=>"number"==typeof e?e===a-1:e[this.rowKey]===s.keyValue));let l=s.checked;-1!==i&&(s.checked="boolean"==typeof t?t:!s.checked,l!==s.checked&&this.check(s.rowData||s,s.checked,s.rowData?s.keyValue:null,!0))})),this.$emit("selection-change",{detail:{value:this.backData,index:this.backIndexData}})},clearSelection(){let e=this.theadChildren;this.theadChildren||(e=this.trChildren[0]),e.checked=!1,e.indeterminate=!1,this.trChildren.forEach((e=>{e.checked=!1})),this.backData=[],this.backIndexData=[],this.$emit("selection-change",{detail:{value:[],index:[]}})},toggleAllSelection(){let e=[],t=1,s=this.theadChildren;this.theadChildren?t=s.rowspan-1:s=this.trChildren[0],this.trChildren.forEach(((s,a)=>{s.disabled||a>t-1&&e.push(a-t)})),this.toggleRowSelection(e)},check(e,t,s,a){let i=this.theadChildren;this.theadChildren||(i=this.trChildren[0]);let l=this.trChildren.findIndex(((t,s)=>e===t));if(l<0&&(l=this.data.findIndex((e=>e[this.rowKey]===s))+1),this.trChildren.filter((e=>!e.disabled&&e.keyValue)).length,0===l)return void(t?this.selectionAll():this.clearSelection());if(t)s&&this.backData.push(e),this.backIndexData.push(l-1);else{const e=this.backData.findIndex((e=>e[this.rowKey]===s)),t=this.backIndexData.findIndex((e=>e===l-1));s&&this.backData.splice(e,1),this.backIndexData.splice(t,1)}this.trChildren.find(((e,t)=>t>0&&!e.checked&&!e.disabled))?(i.indeterminate=!0,i.checked=!1):(i.indeterminate=!1,i.checked=!0),0===this.backIndexData.length&&(i.indeterminate=!1),a||this.$emit("selection-change",{detail:{value:this.backData,index:this.backIndexData}})}}},[["render",function(e,t,s,a,r,o){const d=k;return i(),l(d,{class:m(["uni-table-scroll",{"table--border":s.border,"border-none":!r.noData}])},{default:n((()=>[D("table",{class:m(["uni-table",{"table--stripe":s.stripe}]),border:"0",cellpadding:"0",cellspacing:"0",style:V({"min-width":r.minWidth+"px"})},[T(e.$slots,"default",{},void 0,!0),r.noData?(i(),u("tr",{key:0,class:"uni-table-loading"},[D("td",{class:m(["uni-table-text",{"empty-border":s.border}])},c(s.emptyText),3)])):I("v-if",!0),s.loading?(i(),l(d,{key:1,class:m(["uni-table-mask",{"empty-border":s.border}])},{default:n((()=>[D("div",{class:"uni-table--loader"})])),_:1},8,["class"])):I("v-if",!0)],6)])),_:3},8,["class"])}],["__scopeId","data-v-77ce1604"]]);const Q=z({name:"TableCheckbox",emits:["checkboxSelected"],props:{indeterminate:{type:Boolean,default:!1},checked:{type:[Boolean,String],default:!1},disabled:{type:Boolean,default:!1},index:{type:Number,default:-1},cellData:{type:Object,default:()=>({})}},watch:{checked(e){"boolean"==typeof this.checked?this.isChecked=e:this.isChecked=!0},indeterminate(e){this.isIndeterminate=e}},data:()=>({isChecked:!1,isDisabled:!1,isIndeterminate:!1}),created(){"boolean"==typeof this.checked&&(this.isChecked=this.checked),this.isDisabled=this.disabled},methods:{selected(){this.isDisabled||(this.isIndeterminate=!1,this.isChecked=!this.isChecked,this.$emit("checkboxSelected",{checked:this.isChecked,data:this.cellData}))}}},[["render",function(e,t,s,a,o,d){const c=k;return i(),l(c,{class:"uni-table-checkbox",onClick:d.selected},{default:n((()=>[s.indeterminate?(i(),l(c,{key:1,class:"checkbox__inner checkbox--indeterminate"},{default:n((()=>[r(c,{class:"checkbox__inner-icon"})])),_:1})):(i(),l(c,{key:0,class:m(["checkbox__inner",{"is-checked":o.isChecked,"is-disable":o.isDisabled}])},{default:n((()=>[r(c,{class:"checkbox__inner-icon"})])),_:1},8,["class"]))])),_:1},8,["onClick"])}],["__scopeId","data-v-8af00625"]]);const Y=z({name:"uniTr",components:{tableCheckbox:Q},props:{disabled:{type:Boolean,default:!1},keyValue:{type:[String,Number],default:""}},options:{virtualHost:!0},data:()=>({value:!1,border:!1,selection:!1,widthThArr:[],ishead:!0,checked:!1,indeterminate:!1}),created(){this.root=this.getTable(),this.head=this.getTable("uniThead"),this.head&&(this.ishead=!1,this.head.init(this)),this.border=this.root.border,this.selection=this.root.type,this.root.trChildren.push(this);const e=this.root.data.find((e=>e[this.root.rowKey]===this.keyValue));e&&(this.rowData=e),this.root.isNodata()},mounted(){if(this.widthThArr.length>0){const e="selection"===this.selection?50:0;this.root.minWidth=Number(this.widthThArr.reduce(((e,t)=>Number(e)+Number(t))))+e}},unmounted(){const e=this.root.trChildren.findIndex((e=>e===this));this.root.trChildren.splice(e,1),this.root.isNodata()},methods:{minWidthUpdate(e){if(this.widthThArr.push(e),this.widthThArr.length>0){const e="selection"===this.selection?50:0;this.root.minWidth=Number(this.widthThArr.reduce(((e,t)=>Number(e)+Number(t))))+e}},checkboxSelected(e){let t=this.root.data.find((e=>e[this.root.rowKey]===this.keyValue));this.checked=e.checked,this.root.check(t||this,e.checked,t?this.keyValue:null)},change(e){this.root.trChildren.forEach((t=>{t===this&&this.root.check(this,e.detail.value.length>0)}))},getTable(e="uniTable"){let t=this.$parent,s=t.$options.name;for(;s!==e;){if(t=t.$parent,!t)return!1;s=t.$options.name}return t}}},[["render",function(e,t,s,a,l,n){const o=R("table-checkbox");return i(),u("tr",{class:"uni-table-tr"},["selection"===l.selection&&l.ishead?(i(),u("th",{key:0,class:m(["checkbox",{"tr-table--border":l.border}])},[r(o,{checked:l.checked,indeterminate:l.indeterminate,disabled:s.disabled,onCheckboxSelected:n.checkboxSelected},null,8,["checked","indeterminate","disabled","onCheckboxSelected"])],2)):I("v-if",!0),T(e.$slots,"default",{},void 0,!0),I(' <uni-th class="th-fixed">123</uni-th> ')])}],["__scopeId","data-v-dc00fea3"]]),Z={reset:"重置",search:"搜索",submit:"确定",filter:"筛选",gt:"大于等于",lt:"小于等于",date:"日期范围"},ee="select",te="search",se="range",ae="date",ie="timestamp";const le=z({name:"uniTh",options:{virtualHost:!0},components:{dropdown:z({name:"FilterDropdown",emits:["change"],components:{checkBox:Q},options:{virtualHost:!0},props:{filterType:{type:String,default:ee},filterData:{type:Array,default:()=>[]},mode:{type:String,default:"default"},map:{type:Object,default:()=>({text:"text",value:"value"})},filterDefaultValue:{type:[Array,String],default:()=>""}},computed:{canReset(){return this.isSearch?this.filterValue.length>0:this.isSelect?this.checkedValues.length>0:this.isRange?this.gtValue.length>0&&this.ltValue.length>0:!!this.isDate&&this.dateSelect.length>0},isSelect(){return this.filterType===ee},isSearch(){return this.filterType===te},isRange(){return this.filterType===se},isDate(){return this.filterType===ae||this.filterType===ie}},watch:{filterData(e){this._copyFilters()},indeterminate(e){this.isIndeterminate=e}},data(){return{resource:Z,enabled:!0,isOpened:!1,dataList:[],filterValue:this.filterDefaultValue,checkedValues:[],gtValue:"",ltValue:"",dateRange:[],dateSelect:[]}},created(){this._copyFilters()},methods:{_copyFilters(){let e=JSON.parse(JSON.stringify(this.filterData));for(let t=0;t<e.length;t++)void 0===e[t].checked&&(e[t].checked=!1);this.dataList=e},openPopup(){this.isOpened=!0,this.isDate&&this.$nextTick((()=>{this.dateRange.length||this.resetDate(),this.$refs.datetimepicker.show()}))},closePopup(){this.isOpened=!1},handleClose(e){this.closePopup()},resetDate(){let e=(new Date).toISOString().split("T")[0];this.dateRange=[e+" 0:00:00",e+" 23:59:59"]},onDropdown(e){this.openPopup()},onItemClick(e,t){let s=this.dataList,a=s[t];void 0===a.checked?s[t].checked=!0:s[t].checked=!a.checked;let i=[];for(let l=0;l<s.length;l++){const e=s[l];e.checked&&i.push(e.value)}this.checkedValues=i},datetimechange(e){this.closePopup(),this.dateRange=e,this.dateSelect=e,this.$emit("change",{filterType:this.filterType,filter:e})},timepickerclose(e){this.closePopup()},handleSelectSubmit(){this.closePopup(),this.$emit("change",{filterType:this.filterType,filter:this.checkedValues})},handleSelectReset(){if(this.canReset){var e=this.dataList;for(let t=0;t<e.length;t++){let s=e[t];this.$set(s,"checked",!1)}this.checkedValues=[],this.handleSelectSubmit()}},handleSearchSubmit(){this.closePopup(),this.$emit("change",{filterType:this.filterType,filter:this.filterValue})},handleSearchReset(){this.canReset&&(this.filterValue="",this.handleSearchSubmit())},handleRangeSubmit(e){this.closePopup(),this.$emit("change",{filterType:this.filterType,filter:!0===e?[]:[parseInt(this.gtValue),parseInt(this.ltValue)]})},handleRangeReset(){this.canReset&&(this.gtValue="",this.ltValue="",this.handleRangeSubmit(!0))}}},[["render",function(e,t,s,a,o,f){const x=k,b=R("check-box"),_=v,y=$,w=j,C=R("uni-datetime-picker");return i(),l(x,{class:"uni-filter-dropdown"},{default:n((()=>[r(x,{class:"dropdown-btn",onClick:f.onDropdown},{default:n((()=>[f.isSelect||f.isRange?(i(),l(x,{key:0,class:m(["icon-select",{active:f.canReset}])},null,8,["class"])):I("v-if",!0),f.isSearch?(i(),l(x,{key:1,class:m(["icon-search",{active:f.canReset}])},{default:n((()=>[r(x,{class:"icon-search-0"}),r(x,{class:"icon-search-1"})])),_:1},8,["class"])):I("v-if",!0),f.isDate?(i(),l(x,{key:2,class:m(["icon-calendar",{active:f.canReset}])},{default:n((()=>[r(x,{class:"icon-calendar-0"}),r(x,{class:"icon-calendar-1"})])),_:1},8,["class"])):I("v-if",!0)])),_:1},8,["onClick"]),o.isOpened?(i(),l(x,{key:0,class:"uni-dropdown-cover",onClick:f.handleClose},null,8,["onClick"])):I("v-if",!0),o.isOpened?(i(),l(x,{key:1,class:"dropdown-popup dropdown-popup-right",onClick:t[3]||(t[3]=g((()=>{}),["stop"]))},{default:n((()=>[I(" select"),f.isSelect?(i(),l(x,{key:0,class:"list"},{default:n((()=>[(i(!0),u(p,null,h(o.dataList,((e,t)=>(i(),l(y,{class:"flex-r a-i-c list-item",key:t,onClick:e=>f.onItemClick(e,t)},{default:n((()=>[r(b,{class:"check",checked:e.checked},null,8,["checked"]),r(x,{class:"checklist-content"},{default:n((()=>[r(_,{class:"checklist-text",style:V(e.styleIconText)},{default:n((()=>[d(c(e[s.map.text]),1)])),_:2},1032,["style"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):I("v-if",!0),f.isSelect?(i(),l(x,{key:1,class:"flex-r opera-area"},{default:n((()=>[r(x,{class:m(["flex-f btn btn-default",{disable:!f.canReset}]),onClick:f.handleSelectReset},{default:n((()=>[d(c(o.resource.reset),1)])),_:1},8,["class","onClick"]),r(x,{class:"flex-f btn btn-submit",onClick:f.handleSelectSubmit},{default:n((()=>[d(c(o.resource.submit),1)])),_:1},8,["onClick"])])),_:1})):I("v-if",!0),I(" search "),f.isSearch?(i(),l(x,{key:2,class:"search-area"},{default:n((()=>[r(w,{class:"search-input",modelValue:o.filterValue,"onUpdate:modelValue":t[0]||(t[0]=e=>o.filterValue=e)},null,8,["modelValue"])])),_:1})):I("v-if",!0),f.isSearch?(i(),l(x,{key:3,class:"flex-r opera-area"},{default:n((()=>[r(x,{class:"flex-f btn btn-submit",onClick:f.handleSearchSubmit},{default:n((()=>[d(c(o.resource.search),1)])),_:1},8,["onClick"]),r(x,{class:m(["flex-f btn btn-default",{disable:!f.canReset}]),onClick:f.handleSearchReset},{default:n((()=>[d(c(o.resource.reset),1)])),_:1},8,["class","onClick"])])),_:1})):I("v-if",!0),I(" range "),f.isRange?(i(),l(x,{key:4},{default:n((()=>[r(x,{class:"input-label"},{default:n((()=>[d(c(o.resource.gt),1)])),_:1}),r(w,{class:"input",modelValue:o.gtValue,"onUpdate:modelValue":t[1]||(t[1]=e=>o.gtValue=e)},null,8,["modelValue"]),r(x,{class:"input-label"},{default:n((()=>[d(c(o.resource.lt),1)])),_:1}),r(w,{class:"input",modelValue:o.ltValue,"onUpdate:modelValue":t[2]||(t[2]=e=>o.ltValue=e)},null,8,["modelValue"])])),_:1})):I("v-if",!0),f.isRange?(i(),l(x,{key:5,class:"flex-r opera-area"},{default:n((()=>[r(x,{class:m(["flex-f btn btn-default",{disable:!f.canReset}]),onClick:f.handleRangeReset},{default:n((()=>[d(c(o.resource.reset),1)])),_:1},8,["class","onClick"]),r(x,{class:"flex-f btn btn-submit",onClick:f.handleRangeSubmit},{default:n((()=>[d(c(o.resource.submit),1)])),_:1},8,["onClick"])])),_:1})):I("v-if",!0),I(" date "),f.isDate?(i(),l(x,{key:6},{default:n((()=>[r(C,{ref:"datetimepicker",value:o.dateRange,type:"datetimerange","return-type":"timestamp",onChange:f.datetimechange,onMaskClick:f.timepickerclose},{default:n((()=>[r(x)])),_:1},8,["value","onChange","onMaskClick"])])),_:1})):I("v-if",!0)])),_:1})):I("v-if",!0)])),_:1})}],["__scopeId","data-v-2b916fcf"]])},emits:["sort-change","filter-change"],props:{width:{type:[String,Number],default:""},align:{type:String,default:"left"},rowspan:{type:[Number,String],default:1},colspan:{type:[Number,String],default:1},sortable:{type:Boolean,default:!1},filterType:{type:String,default:""},filterData:{type:Array,default:()=>[]},filterDefaultValue:{type:[Array,String],default:()=>""}},data:()=>({border:!1,ascending:!1,descending:!1}),computed:{customWidth(){if("number"==typeof this.width)return this.width;if("string"==typeof this.width){let e=new RegExp(/^[1-9][0-9]*px$/g),t=new RegExp(/^[1-9][0-9]*rpx$/g),s=new RegExp(/^[1-9][0-9]*$/g);if(null!==this.width.match(e))return this.width.replace("px","");if(null!==this.width.match(t)){let e=Number(this.width.replace("rpx","")),t=N().screenWidth/750;return Math.round(e*t)}return null!==this.width.match(s)?this.width:""}return""},contentAlign(){let e="left";switch(this.align){case"left":e="flex-start";break;case"center":e="center";break;case"right":e="flex-end"}return e}},created(){this.root=this.getTable("uniTable"),this.rootTr=this.getTable("uniTr"),this.rootTr.minWidthUpdate(this.customWidth?this.customWidth:140),this.border=this.root.border,this.root.thChildren.push(this)},methods:{sort(){if(this.sortable)return this.clearOther(),this.ascending||this.descending?this.ascending&&!this.descending?(this.ascending=!1,this.descending=!0,void this.$emit("sort-change",{order:"descending"})):void(!this.ascending&&this.descending&&(this.ascending=!1,this.descending=!1,this.$emit("sort-change",{order:null}))):(this.ascending=!0,void this.$emit("sort-change",{order:"ascending"}))},ascendingFn(){this.clearOther(),this.ascending=!this.ascending,this.descending=!1,this.$emit("sort-change",{order:this.ascending?"ascending":null})},descendingFn(){this.clearOther(),this.descending=!this.descending,this.ascending=!1,this.$emit("sort-change",{order:this.descending?"descending":null})},clearOther(){this.root.thChildren.map((e=>(e!==this&&(e.ascending=!1,e.descending=!1),e)))},ondropdown(e){this.$emit("filter-change",e)},getTable(e){let t=this.$parent,s=t.$options.name;for(;s!==e;){if(t=t.$parent,!t)return!1;s=t.$options.name}return t}}},[["render",function(e,t,s,a,o,d){const c=v,h=k,p=R("dropdown");return i(),u("th",{rowspan:s.rowspan,colspan:s.colspan,class:m(["uni-table-th",{"table--border":o.border}]),style:V({width:d.customWidth+"px","text-align":s.align})},[r(h,{class:"uni-table-th-row"},{default:n((()=>[r(h,{class:"uni-table-th-content",style:V({"justify-content":d.contentAlign}),onClick:d.sort},{default:n((()=>[T(e.$slots,"default",{},void 0,!0),s.sortable?(i(),l(h,{key:0,class:"arrow-box"},{default:n((()=>[r(c,{class:m(["arrow up",{active:o.ascending}]),onClick:g(d.ascendingFn,["stop"])},null,8,["class","onClick"]),r(c,{class:m(["arrow down",{active:o.descending}]),onClick:g(d.descendingFn,["stop"])},null,8,["class","onClick"])])),_:1})):I("v-if",!0)])),_:3},8,["style","onClick"]),s.filterType||s.filterData.length?(i(),l(p,{key:0,filterDefaultValue:s.filterDefaultValue,filterData:s.filterData,filterType:s.filterType,onChange:d.ondropdown},null,8,["filterDefaultValue","filterData","filterType","onChange"])):I("v-if",!0)])),_:3})],14,["rowspan","colspan"])}],["__scopeId","data-v-b8cfd5ae"]]);const ne=z({name:"uniTd",options:{virtualHost:!0},props:{width:{type:[String,Number],default:""},align:{type:String,default:"left"},rowspan:{type:[Number,String],default:1},colspan:{type:[Number,String],default:1}},data:()=>({border:!1}),created(){this.root=this.getTable(),this.border=this.root.border},methods:{getTable(){let e=this.$parent,t=e.$options.name;for(;"uniTable"!==t;){if(e=e.$parent,!e)return!1;t=e.$options.name}return e}}},[["render",function(e,t,s,a,l,n){return i(),u("td",{class:m(["uni-table-td",{"table--border":l.border}]),rowspan:s.rowspan,colspan:s.colspan,style:V({width:s.width+"px","text-align":s.align})},[T(e.$slots,"default",{},void 0,!0)],14,["rowspan","colspan"])}],["__scopeId","data-v-dc0c405a"]]),re=z(e({__name:"detail",setup(e){let f=t([]),g=t(!0);const w=s(),D=t(null),T=a((()=>w.info));let R=t("goods_content");const $=e=>{R.value=e};let j=t({sku_id:"",goods_id:""});O((e=>{j.value.sku_id=e.sku_id,j.value.goods_id=e.goods_id,g.value=!0,S()&&w.getMemberInfo(),K(j.value).then((e=>{if("{}"===JSON.stringify(e.data))return F({title:"找不到该商品",icon:"none"}),setTimeout((()=>{b({url:"/addon/o2o/pages/index",mode:"reLaunch"})}),600),!1;f.value=e.data,f.value.goods.goods_image_thumb_mid.forEach(((e,t)=>{f.value.goods.goods_image_thumb_mid[t]=C(e)})),g.value=!1,Q()}))}));let N={sku:{num:1,sku_id:""}};const U=()=>{D.value.open()},H=e=>{f.value.skuList.forEach(((t,s)=>{t.sku_id==e&&Object.assign(f.value,t)}))};let J=t(null),M=t(""),z={};const Q=()=>{M.value="?sku_id="+f.value.sku_id,T.value&&T.value.member_id&&(M.value+="&mid="+T.value.member_id)},Z=()=>{z.sku_id=f.value.sku_id,T.value&&T.value.member_id&&(z.member_id=T.value.member_id),J.value.openShare()};let ee=t(""),te=a((()=>{let e="0.00";return Object.keys(f.value).length&&Object.keys(f.value.goods).length&&f.value.goods.member_discount&&S()?(e=f.value.member_price||f.value.price,ee.value="member_price"):(e=f.value.price,ee.value=""),parseFloat(e).toFixed(2)}));return(e,t)=>{const s=_(y("u-swiper"),A),a=k,w=v,T=L,j=_(y("u-parse"),E),O=_(y("u-button"),B),F=_(y("u-loading-page"),W);return i(),l(a,{style:V(e.themeColor())},{default:n((()=>[o(g)?I("v-if",!0):(i(),l(a,{key:0,class:"bg-[#f7f7f7] min-h-screen overflow-hidden"},{default:n((()=>[r(s,{list:o(f).goods.goods_image_thumb_mid,autoplay:!1,height:"100vw"},null,8,["list"]),I(' <div class="h-[750rpx] w-[100%] bg-[#fff]">\r\n                <u--image  width="100%" height="750rpx"\r\n                :src="img(detail.sku_image_thumb_big)" mode="aspectFill">\r\n                    <template #error>\r\n                        <u-icon name="photo" color="#999" size="100"></u-icon>\r\n                    </template>\r\n                </u--image>\r\n            </div> '),r(a,{class:"px-[24rpx]"},{default:n((()=>[r(a,{class:"chunk-wrap pt-2 pb-3 rounded-lg relative mt-[14rpx]"},{default:n((()=>[r(a,{class:"font-bold multi-hidden"},{default:n((()=>[d(c(o(f).goods.goods_name),1)])),_:1}),r(a,{class:"flex items-center justify-between mt-2"},{default:n((()=>[r(a,{class:"flex items-center"},{default:n((()=>[r(a,{class:"text-[var(--price-text-color)] text-[28rpx] font-bold flex items-center"},{default:n((()=>[r(w,{class:"text-[28rpx] price-font"},{default:n((()=>[d("￥")])),_:1}),r(w,{class:"price-font text-[28rpx]"},{default:n((()=>[d(c(o(te)),1)])),_:1}),o(f).sku_unit?(i(),l(w,{key:0},{default:n((()=>[d("/"+c(o(f).sku_unit),1)])),_:1})):I("v-if",!0),"member_price"==o(ee)?(i(),l(T,{key:1,class:"h-[28rpx] ml-[12rpx] w-[60rpx]",src:o(C)("addon/o2o/VIP.png"),mode:"heightFix"},null,8,["src"])):I("v-if",!0)])),_:1}),r(a,{class:"text-[24rpx] flex ml-[20rpx]"},{default:n((()=>[r(w,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:n((()=>[d(c(o(f).goods.buy_type_name),1)])),_:1})])),_:1})])),_:1}),r(a,{class:"text-[20rpx]"},{default:n((()=>[d(c(o(f).goods.sale_num)+c(o(P)("selectNum")),1)])),_:1})])),_:1})])),_:1}),o(f).skuList&&o(f).skuList.length>1?(i(),l(a,{key:0,onClick:U,class:"flex items-center h-[88rpx] px-[20rpx] bg-[#fff] rounded-lg mb-[20rpx]"},{default:n((()=>[r(w,{class:"text-[#999] text-[30rpx] leading-[42rpx] font-500 mr-[20rpx]"},{default:n((()=>[d(c(o(P)("selected")),1)])),_:1}),r(a,{class:"flex-1 text-[#343434] text-sm leading-[42rpx] font-500"},{default:n((()=>[d(c(o(f).sku_name),1)])),_:1}),r(w,{class:"nc-iconfont nc-icon-youV6xx text-[26rpx] text-[#666]"})])),_:1})):I("v-if",!0),r(a,{class:"chunk-wrap pt-[34rpx] pb-[24rpx] scheduling rounded-lg"},{default:n((()=>[r(a,{class:"flex items-center"},{default:n((()=>[r(w,{class:m(["text-[30rpx] text-center leading-[80rpx] flex-1 text-[#666]",{"class-select":"goods_content"==o(R)}]),onClick:t[0]||(t[0]=e=>$("goods_content"))},{default:n((()=>[d("项目介绍")])),_:1},8,["class"]),r(w,{class:m(["text-[30rpx] text-center leading-[80rpx] flex-1 text-[#666]",{"class-select":"buy_info"==o(R)}]),onClick:t[1]||(t[1]=e=>$("buy_info"))},{default:n((()=>[d("购买须知")])),_:1},8,["class"]),"reservation"==o(f).goods.buy_type?(i(),l(w,{key:0,class:m(["text-[30rpx] text-center leading-[80rpx] flex-1 text-[#666]",{"class-select":"price_list"==o(R)}]),onClick:t[2]||(t[2]=e=>$("price_list"))},{default:n((()=>[d("价目表")])),_:1},8,["class"])):I("v-if",!0)])),_:1}),r(a,{class:"mt-[24rpx]"},{default:n((()=>["goods_content"==o(R)?(i(),l(a,{key:0,class:"scheduling-content mt-2"},{default:n((()=>[o(f).goods.goods_content?(i(),l(j,{key:0,content:o(f).goods.goods_content,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(i(),l(a,{key:1,class:"h-[380rpx] flex"},{default:n((()=>[r(a,{class:"mx-auto"},{default:n((()=>[r(T,{class:"w-[280rpx] h-[280rpx]",src:o(C)("addon/o2o/goods/empty01.png")},null,8,["src"]),r(a,{class:"text-center text-[#c1c1c1] text-[24rpx]"},{default:n((()=>[d(c(o(P)("noProjectInt")),1)])),_:1})])),_:1})])),_:1}))])),_:1})):I("v-if",!0),"buy_info"==o(R)?(i(),l(a,{key:1,class:"scheduling-content mt-2"},{default:n((()=>[o(f).goods.buy_info?(i(),l(j,{key:0,content:o(f).goods.buy_info,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(i(),l(a,{key:1,class:"h-[380rpx] flex"},{default:n((()=>[r(a,{class:"mx-auto"},{default:n((()=>[r(T,{class:"w-[280rpx] h-[280rpx]",src:o(C)("addon/o2o/goods/empty01.png")},null,8,["src"]),r(a,{class:"text-center text-[#c1c1c1] text-[24rpx]"},{default:n((()=>[d(c(o(P)("noPurchase")),1)])),_:1})])),_:1})])),_:1}))])),_:1})):I("v-if",!0),"price_list"==o(R)?(i(),l(a,{key:2,class:"scheduling-content mt-2"},{default:n((()=>[o(f).goods.price_list&&o(f).goods.price_list.length?(i(),l(a,{key:0},{default:n((()=>[r(X,{border:"",stripe:"",emptyText:o(P)("noMore")},{default:n((()=>[r(Y,null,{default:n((()=>[r(le,{width:"80",align:"center"},{default:n((()=>[d(c(o(P)("projectName")),1)])),_:1}),r(le,{width:"50",align:"center"},{default:n((()=>[d(c(o(P)("price")),1)])),_:1}),r(le,{width:"50",align:"center"},{default:n((()=>[d(c(o(P)("unit")),1)])),_:1})])),_:1}),(i(!0),u(p,null,h(o(f).goods.price_list,((e,t)=>(i(),l(Y,{key:t},{default:n((()=>[r(ne,{align:"center"},{default:n((()=>[d(c(e.name),1)])),_:2},1024),r(ne,{align:"center"},{default:n((()=>[r(a,{class:"name"},{default:n((()=>[d(c(e.price),1)])),_:2},1024)])),_:2},1024),r(ne,{align:"center"},{default:n((()=>[d(c(e.unit),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["emptyText"])])),_:1})):(i(),l(a,{key:1,class:"h-[380rpx] flex"},{default:n((()=>[r(a,{class:"mx-auto"},{default:n((()=>[r(T,{class:"w-[280rpx] h-[280rpx]",src:o(C)("addon/o2o/goods/empty01.png")},null,8,["src"]),r(a,{class:"text-center text-[#c1c1c1] text-[24rpx]"},{default:n((()=>[d(c(o(P)("noPriceList")),1)])),_:1})])),_:1})])),_:1}))])),_:1})):I("v-if",!0)])),_:1})])),_:1}),r(a,{class:"h-[148rpx] w-screen"}),r(a,{class:"flex justify-between bg-white px-3 py-2 fixed bottom-0 left-0 right-0"},{default:n((()=>[r(a,{class:"flex items-center"},{default:n((()=>[r(a,{class:"flex flex-col items-center mr-[44rpx]",onClick:t[3]||(t[3]=e=>o(b)({url:"/addon/o2o/pages/index",mode:"reLaunch"}))},{default:n((()=>[r(T,{class:"w-[43rpx] h-[43rpx]",src:o(C)("addon/o2o/service/index.png"),mode:"aspectFill"},null,8,["src"]),r(w,{class:"text-[24rpx] text-[#454545] mt-1.5"},{default:n((()=>[d(c(o(P)("index")),1)])),_:1})])),_:1}),r(a,{class:"flex flex-col items-center mr-[44rpx]",onClick:Z},{default:n((()=>[r(a,{class:"nc-iconfont nc-icon-fenxiangV6xx text-[36rpx] mt-[4rpx] mb-[6rpx] font-bold"}),r(w,{class:"text-[24rpx] text-[#454545] mt-1"},{default:n((()=>[d(c(o(P)("share")),1)])),_:1})])),_:1}),r(a,{class:"flex flex-col items-center mr-[44rpx]"},{default:n((()=>[r(T,{class:"w-[44rpx] h-[44rpx]",src:o(C)("addon/o2o/service/service.png"),mode:"aspectFill"},null,8,["src"]),r(w,{class:"text-[24rpx] text-[#454545] mt-1"},{default:n((()=>[d(c(o(P)("service")),1)])),_:1})])),_:1}),I(' <view class="flex flex-col items-center mr-[44rpx]" @click="collect(detail)">\r\n                        <image class="w-[44rpx] h-[44rpx]" v-if="collect_id > 0" :src="img(\'static/resource/images/member/select_collect.png\')" mode="aspectFill"></image>\r\n                        <image class="w-[44rpx] h-[44rpx]" v-else :src="img(\'static/resource/images/member/collect.png\')" mode="aspectFill"></image>\r\n                        <text class="text-[24rpx] text-[#454545] mt-1">收藏</text>\r\n                    </view> ')])),_:1}),r(O,{customStyle:{marginLeft:"8rpx",borderRadius:"38rpx",flex:"1"},color:o(f).goods.status?"var( --primary-color)":"#999",size:"16",text:o(f).goods.status?"reservation"==o(f).goods.buy_type?o(P)("bookNow"):o(P)("orderNow"):o(P)("delisted"),onClick:t[4]||(t[4]=e=>{return t=o(f),S()?!!t.goods.status&&(N.sku.sku_id=t.sku_id,uni.setStorageSync("o2oCreateData",N),void("buy"==t.goods.buy_type?U():b({url:"/addon/o2o/pages/order/payment",param:{id:t.goods_id}}))):(x().setLoginBack({url:"/addon/o2o/pages/goods/detail",param:{sku_id:t.sku_id}}),!1);var t})},null,8,["color","text"])])),_:1})])),_:1}),r(q,{ref_key:"sharePosterRef",ref:J,posterType:"o2o_goods",posterId:o(f).goods.poster_id,posterParam:o(z),copyUrlParam:o(M)},null,8,["posterId","posterParam","copyUrlParam"])])),_:1})),r(G,{ref_key:"goodsSkuRef",ref:D,"goods-detail":o(f),onChange:H},null,8,["goods-detail"]),r(F,{"bg-color":"rgb(248,248,248)",loading:o(g),fontSize:"16",color:"#333"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-18b8f097"]]);export{re as default};
