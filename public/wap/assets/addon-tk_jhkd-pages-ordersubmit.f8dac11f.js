import{d as e,l as t,j as a,r as s,K as l,p as d,s as r,q as o,H as u,o as n,O as i,b as c,w as f,y as m,c as p,f as _,z as v,P as x,a6 as g,u as k,a as b,D as y,i as h,g as w,h as A,cg as j,c9 as C,ch as S,C as V,Q as $,E as P,B as U}from"./index-2882a2d8.js";import{_ as L}from"./u-line.d7ff94e2.js";import{_ as z,a as T}from"./u-row.6967f74a.js";import{_ as B}from"./u-icon.1104ad2f.js";import{_ as H}from"./u-alert.44ca23a1.js";import{_ as I}from"./u-input.6410b5d0.js";import{_ as W}from"./u-tag.4c3b3b6c.js";import{_ as q}from"./u-number-box.86ecacda.js";import{_ as N}from"./u-loading-icon.a37f7e61.js";import{_ as E}from"./u-safe-bottom.f13b01b8.js";import{_ as K}from"./u-popup.2abbe959.js";import{_ as R}from"./share-poster.cdaa31fc.js";import{_ as D}from"./pay.d604a92e.js";import{c as M,b as O,p as Q,d as Y,a as F}from"./tkjhkd.474b5148.js";import{_ as G}from"./_plugin-vue_export-helper.1b428a4d.js";/* empty css                                                               */import"./u-transition.4448d2e5.js";/* empty css                                                                *//* empty css                                                                       */import"./u-overlay.1a317a4e.js";import"./u-image.46ebbbc1.js";import"./pay.a752545f.js";const J=G(e({__name:"ordersubmit",setup(e){const G=t(),J=a((()=>G.info));s([""]),s(null),s(null);const X=s();s();const Z=s(),ee=s(null),te=s(!1);s(!1);const ae=s(!0),se=s(!1),le=s(null),de=s({title:"快速下单必读",description:"先地址簿添加/编辑地址，选择取/收货地址，填写物品信息，选择渠道下单",closable:!1}),re=s(["普货","文件","美妆用品","数码产品","服装鞋帽","珠宝首饰","零食特产","办公用品"]);let oe=s(null),ue=s(""),ne={};const ie=s(0),ce=()=>{if(!J.value){let e=uni.getStorageSync("pid");return e&&e>0?(u().setLoginBack({url:"/addon/tk_jhkd/pages/ordersubmit?mid="+e}),!1):(u().setLoginBack({url:"/addon/tk_jhkd/pages/ordersubmit"}),!1)}J.value&&J.value.member_id&&(ne.member_id=J.value.member_id),J.value&&J.value.member_id&&(ue.value+="?mid="+J.value.member_id),oe.value.openShare()},fe=e=>{1==ae.value?ae.value=!1:ae.value=!0},me=s({title:"填写须知",description:"物品名称必须填写，物品重量需按照实际重量填写,超长物品请填写实际尺寸，如需要保价请填写保价金额",closable:!1}),pe=l({startAddress:uni.getStorageSync("startAddress"),endAddress:uni.getStorageSync("endAddress"),customerType:"kd",goods:"",packageCount:1,weight:1,vloumLong:10,vloumWidth:10,vloumHeight:10,guaranteeValueAmount:null,remark:"",showPrice:"0",payMethod:"",delivery_info:[],key:"",delivery_index:""}),_e=()=>{ve.value=!1},ve=s(!1);s(["0000","15222"]);const xe=e=>{uni.setStorage({key:"selectAddressCallback",data:{back:"/addon/tk_jhkd/pages/ordersubmit",delivery:e,value:e},success(){b({url:"/addon/tk_jhkd/pages/address/address",param:{type:"address"}})}})},ge=async e=>{if(e>0){return(await O(e)).data}},ke=uni.getStorageSync("selectAddressCallback");ke&&("startaddress"==ke.delivery&&ge(ke.address_id).then((e=>{uni.setStorageSync("startAddress",e),pe.startAddress=uni.getStorageSync("startAddress")})).catch((e=>{console.error(e)})),"endaddress"==ke.delivery&&ge(ke.address_id).then((e=>{uni.setStorageSync("endAddress",e),pe.endAddress=uni.getStorageSync("endAddress")})).catch((e=>{console.error(e)})),uni.removeStorage({key:"selectAddressCallback"}));const be=s();return d((e=>{e.mid&&uni.setStorageSync("pid",e.mid);let t={type:""};if(!r()){const e=u();o()&&(t.query.code?e.authLogin(t.query.code):e.getAuthCode("snsapi_userinfo"))}setTimeout((()=>{if(!J.value){let e=uni.getStorageSync("pid");return e&&e>0?(u().setLoginBack({url:"/addon/tk_jhkd/pages/ordersubmit?mid="+e}),!1):(u().setLoginBack({url:"/addon/tk_jhkd/pages/ordersubmit"}),!1)}}),500);let a=uni.getStorageSync("pid");a&&a>0&&M({pid:a}),pe.customerType=e.type?e.type:"kd","ky"==pe.customerType&&(pe.weight=30),(async()=>{const e=await F("jhkdservice");be.value=e.data})()})),(e,t)=>{const a=y,s=h,l=w(A("u-line"),L),d=w(A("u-col"),z),r=w(A("u-row"),T),o=w(A("u-icon"),B),u=w(A("u-alert"),H),M=U,O=j,F=C,G=S,J=w(A("u-input"),I),ge=w(A("u-tag"),W),ke=w(A("u-number-box"),q),ye=w(A("u-loading-icon"),N),he=V,we=w(A("u-safe-bottom"),E),Ae=w(A("u-popup"),K),je=w(A("share-poster"),R),Ce=w(A("pay"),D);return n(),i(x,null,[c(s,{class:"tk-card"},{default:f((()=>[c(r,{gutter:"12",class:"flex item-center"},{default:f((()=>[c(d,{span:"2"},{default:f((()=>[c(s,{class:""},{default:f((()=>[c(a,{class:"tag"},{default:f((()=>[m("寄")])),_:1})])),_:1}),c(s,{class:"mt-[4rpx] mb-[4rpx]"},{default:f((()=>[c(l,{color:"#4541c7",direction:"col",length:"98rpx","border-style":"dotted"})])),_:1}),c(s,{class:""},{default:f((()=>[c(a,{class:"tag",style:{background:"#4541c7",color:"#ffffff"}},{default:f((()=>[m("收")])),_:1})])),_:1})])),_:1}),c(d,{span:"10"},{default:f((()=>[c(s,{class:"fb flex item-center"},{default:f((()=>[c(s,{class:"w-[380rpx]"},{default:f((()=>[pe.startAddress==[]?(n(),p(a,{key:0,class:"font-bold"},{default:f((()=>[m("从哪里寄？")])),_:1})):_("v-if",!0),pe.startAddress==[]?(n(),p(a,{key:1,class:"tk-sltext"},{default:f((()=>[m("请选择寄件地址")])),_:1})):_("v-if",!0),pe.startAddress?(n(),p(a,{key:2,class:"font-bold tk-sltext text-sm"},{default:f((()=>[m(v(pe.startAddress.name)+" ",1),c(a,{class:"font-light text-xs"},{default:f((()=>[m(v(pe.startAddress.mobile),1)])),_:1})])),_:1})):_("v-if",!0),pe.startAddress?(n(),p(a,{key:3,class:"text-xs"},{default:f((()=>[m(v(pe.startAddress.address)+v(pe.startAddress.full_address),1)])),_:1})):_("v-if",!0)])),_:1}),c(s,{class:""},{default:f((()=>[c(a,{class:"bt text-sm",onClick:t[0]||(t[0]=e=>xe("startaddress"))},{default:f((()=>[m("地址簿")])),_:1})])),_:1})])),_:1}),c(s,{class:"fb fb flex item-center mt-[28rpx]"},{default:f((()=>[c(s,{class:"w-[380rpx]"},{default:f((()=>[pe.endAddress==[]?(n(),p(s,{key:0,class:"font-bold"},{default:f((()=>[m("收件人信息？")])),_:1})):_("v-if",!0),pe.endAddress==[]?(n(),p(a,{key:1,class:"tk-sltext"},{default:f((()=>[m("请选择收件地址")])),_:1})):_("v-if",!0),pe.endAddress?(n(),p(a,{key:2,class:"font-bold tk-sltext text-sm"},{default:f((()=>[m(v(pe.endAddress.name)+" ",1),c(a,{class:"font-light text-xs"},{default:f((()=>[m(v(pe.endAddress.mobile),1)])),_:1})])),_:1})):_("v-if",!0),pe.endAddress?(n(),p(a,{key:3,class:"text-xs"},{default:f((()=>[m(v(pe.endAddress.address)+v(pe.endAddress.full_address),1)])),_:1})):_("v-if",!0)])),_:1}),c(s,{class:""},{default:f((()=>[c(a,{class:"bt text-sm",onClick:t[1]||(t[1]=e=>xe("endaddress"))},{default:f((()=>[m("地址簿")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),c(s,{class:"text-sm mt-2 text-[#686868] font-bold"},{default:f((()=>[m(" 请认真核实地址,填写实际重量再下单！ ")])),_:1})])),_:1}),c(s,{class:"tk-card"},{default:f((()=>[c(s,{class:"fb"},{default:f((()=>[c(s,{class:"fl items-center"},{default:f((()=>[c(s,{class:"text-xs tk-tag mr-1"},{default:f((()=>[m("必填")])),_:1}),c(s,{class:"mr-2"},{default:f((()=>[m("物品信息")])),_:1}),c(s,{class:"font-weight text-[#272822] text-sm"},{default:f((()=>[m(v(pe.goods)+","+v(pe.weight)+"kg",1)])),_:1})])),_:1}),c(o,{size:"22",name:"edit-pen",onClick:t[2]||(t[2]=e=>pe.startAddress==[]?(xe("startaddress"),void uni.$u.toast("请填写取件地址")):pe.endAddress==[]?(xe("endaddress"),void uni.$u.toast("请填写送件地址")):(ve.value=!0,void(pe.delivery_info=[])))})])),_:1})])),_:1}),c(s,{class:"pl-2 pr-2"},{default:f((()=>[c(u,{title:de.value.title,type:"info",closable:de.value.closable,description:de.value.description},null,8,["title","closable","description"])])),_:1}),X.value?(n(),p(s,{key:0,class:"tk-card mt-[40rpx] overflow-y-auto"},{default:f((()=>[(n(!0),i(x,null,g(X.value,((e,t)=>(n(),i(x,{key:t},["Y"==e.onlinePay?(n(),p(s,{key:0,class:$(["fb p-[12rpx]",[{selectitemclass:le.value==t}]]),onClick:e=>{return a=t,le.value=a,Z.value=X.value[a],pe.showPrice=Z.value.showPrice,pe.delivery_info=Z.value,void(pe.delivery_index=a);var a}},{default:f((()=>[c(s,{class:"fl"},{default:f((()=>[c(M,{style:{width:"68rpx",height:"68rpx","border-radius":"8rpx"},src:k(P)(e.logo),mode:""},null,8,["src"]),c(s,{class:"ml-[18rpx] w-[340rpx]"},{default:f((()=>[c(s,{class:"font-weight text-xs w-[440rpx]"},{default:f((()=>[m(v(e.channelName),1)])),_:2},1024),c(s,{class:"text-xs text-[#272822]"},{default:f((()=>[m("限重:"+v(e.limitWeight)+"kg",1)])),_:2},1024)])),_:2},1024)])),_:2},1024),c(s,{class:"font-weight text-sm"},{default:f((()=>[m(v(e.showPrice)+"元 ",1)])),_:2},1024)])),_:2},1032,["class","onClick"])):_("v-if",!0)],64)))),128))])),_:1})):_("v-if",!0),be.value?(n(),p(s,{key:1,class:"tk-card"},{default:f((()=>[c(G,{class:"uni-list",onChange:fe},{default:f((()=>[c(F,{class:"text-xs fl items-center uni-list-cell uni-list-cell-pd"},{default:f((()=>[c(s,null,{default:f((()=>[c(O,{color:"#3c4cde",style:{transform:"scale(0.6)"},value:"true",checked:ae.value},null,8,["checked"])])),_:1}),c(s,{onClick:t[3]||(t[3]=e=>k(b)({url:"/addon/tk_jhkd/pages/agreement?type=jhkdyesgoods"}))},{default:f((()=>[m(" 阅读并同意《"+v(be.value.title?be.value.title:"寄件服务协议")+"》",1)])),_:1})])),_:1})])),_:1})])),_:1})):_("v-if",!0),c(s,{class:"mt-[380rpx] mb-[260rpx] flex items-center"}),_(" 物品信息弹出框 "),c(Ae,{class:"safe-area-inset-bottom",round:10,onClose:_e,closeable:"true",show:ve.value,mode:"bottom","border-radius":"12"},{default:f((()=>[c(s,{class:"tk-card h-[760rpx] overflow-y-auto"},{default:f((()=>[c(s,{class:"flex items-center"},{default:f((()=>[c(s,{class:"senddetail"},{default:f((()=>[m(" 物品名称 ")])),_:1}),c(J,{clearable:"true",border:"bottom",class:"mt-[8rpx] text-sm",modelValue:pe.goods,"onUpdate:modelValue":t[4]||(t[4]=e=>pe.goods=e),placeholder:"如:生活用品,点击标签快速填写"},null,8,["modelValue"])])),_:1}),c(s,{class:"fl flex-wrap mt-2"},{default:f((()=>[(n(!0),i(x,null,g(re.value,((e,t)=>(n(),p(s,{key:"index",class:"mt-1 mr-2 mb-1"},{default:f((()=>[c(ge,{borderColor:"#444444",color:"#1d1d1d",text:e,type:"success",plain:"",onClick:e=>(e=>{uni.$u.toast(re.value[e]),pe.goods=re.value[e]})(t)},null,8,["text","onClick"])])),_:2},1024)))),128))])),_:1}),c(s,{class:"font-bold text-xs mt-2",onClick:t[5]||(t[5]=e=>k(b)({url:"/addon/tk_jhkd/pages/agreement?type=jhkdyesgoods"}))},{default:f((()=>[m(" 《违禁品查询》")])),_:1}),c(s,{class:"flex items-center mt-[24rpx]"},{default:f((()=>[c(s,{class:"senddetail"},{default:f((()=>[m(" 物品重量 ")])),_:1}),c(ke,{"button-size":"24",color:"#0000ff",bgColor:"#e6e6e6",iconStyle:"color: #0000ff",integer:"",min:"kd"==pe.customerType?1:30,max:1e4,class:"text-sm",modelValue:pe.weight,"onUpdate:modelValue":t[6]||(t[6]=e=>pe.weight=e)},null,8,["min","modelValue"]),c(a,{class:"ml-4 text-[#a3a3a3]"},{default:f((()=>[m("kg")])),_:1})])),_:1}),c(s,{class:"flex items-center mt-[24rpx]"},{default:f((()=>[c(s,{class:"senddetail"},{default:f((()=>[m(" 包裹数量 ")])),_:1}),c(ke,{"button-size":"24",color:"#0000ff",bgColor:"#e6e6e6",iconStyle:"color: #0000ff",integer:"",min:1,max:100,class:"text-sm",modelValue:pe.packageCount,"onUpdate:modelValue":t[7]||(t[7]=e=>pe.packageCount=e)},null,8,["modelValue"]),c(a,{class:"ml-4 text-[#a3a3a3]"},{default:f((()=>[m("个")])),_:1})])),_:1}),c(s,{class:"flex items-center mt-[24rpx]"},{default:f((()=>[c(s,{class:"senddetail"},{default:f((()=>[m(" 物品体积 ")])),_:1}),c(s,{class:"w-48px"},{default:f((()=>[c(J,{border:"bottom",maxlength:"3",modelValue:pe.vloumLong,"onUpdate:modelValue":t[8]||(t[8]=e=>pe.vloumLong=e)},null,8,["modelValue"])])),_:1}),c(a,{class:"text-[#a3a3a3] mr-[8rpx]"},{default:f((()=>[m("x")])),_:1}),c(s,{class:"w-48px"},{default:f((()=>[c(J,{border:"bottom",maxlength:"3",modelValue:pe.vloumWidth,"onUpdate:modelValue":t[9]||(t[9]=e=>pe.vloumWidth=e)},null,8,["modelValue"])])),_:1}),c(a,{class:"text-[#a3a3a3] mr-[8rpx]"},{default:f((()=>[m("x")])),_:1}),c(s,{class:"w-48px"},{default:f((()=>[c(J,{border:"bottom",maxlength:"3",modelValue:pe.vloumHeight,"onUpdate:modelValue":t[10]||(t[10]=e=>pe.vloumHeight=e)},null,8,["modelValue"])])),_:1}),c(a,{class:"ml-4 text-[#a3a3a3]"},{default:f((()=>[m("单位：cm")])),_:1})])),_:1}),c(s,{class:"flex items-center mt-[24rpx]"},{default:f((()=>[c(s,{class:"senddetail"},{default:f((()=>[m(" 保价金额 ")])),_:1}),c(J,{placeholder:"不保价可不填",type:"number",modelValue:pe.guaranteeValueAmount,"onUpdate:modelValue":t[11]||(t[11]=e=>pe.guaranteeValueAmount=e)},null,8,["modelValue"]),c(a,{class:"ml-4 text-[#a3a3a3]"},{default:f((()=>[m("元")])),_:1})])),_:1}),c(s,{class:"mt-4 text-sm text-[#a3a3a3]"},{default:f((()=>[m("订单备注")])),_:1}),c(J,{class:"mt-[14px]",modelValue:pe.remark,"onUpdate:modelValue":t[12]||(t[12]=e=>pe.remark=e),placeholder:"小哥辛苦了!"},null,8,["modelValue"])])),_:1}),c(s,{class:"pl-2 pr-2"},{default:f((()=>[c(u,{title:me.value.title,type:"warning",closable:me.value.closable,description:me.value.description},null,8,["title","closable","description"])])),_:1}),1==se.value?(n(),p(ye,{key:0,class:"mt-4",duration:"1000",mode:"circle",on:"linear",color:"#4541c7",vertical:!0})):_("v-if",!0),_(' <view v-if="bjshow==false" class="tk-card butto text-xl" @click="closeShow()">获取报价</view>\r\n\t\t<view v-if="bjshow==true" class="tk-card butto text-xl" @click=" ">正在计算</view> '),0==se.value?(n(),p(s,{key:1,class:"flex flex-1 p-4"},{default:f((()=>[c(he,{class:"w-[100%] !h-[72rpx] leading-[72rpx] text-[26rpx] rounded-[50rpx]",style:{color:"#ffffff",backgroundColor:"#4541c7"},type:"default",onClick:t[13]||(t[13]=e=>(async()=>{if(""==pe.goods)return void uni.$u.toast("请填写物品名称");if(pe.startAddress==[])return xe("startaddress"),void uni.$u.toast("请填写取件地址");if(pe.endAddress==[])return xe("endaddress"),void uni.$u.toast("请填写送件地址");se.value=!0;const e=await Q(pe);pe.key=e.data.key,X.value=e.data.list,se.value=!1,ve.value=!1,pe.delivery_info=[]})())},{default:f((()=>[m(" 获取报价 ")])),_:1})])),_:1})):_("v-if",!0),1==se.value?(n(),p(s,{key:2,class:"flex flex-1 p-4"},{default:f((()=>[c(he,{class:"w-[100%] !h-[72rpx] leading-[72rpx] text-[26rpx] rounded-[50rpx]",style:{color:"#ffffff",backgroundColor:"#4541c7"},type:"default"},{default:f((()=>[m(" AI比价中 ")])),_:1})])),_:1})):_("v-if",!0),c(we)])),_:1},8,["show"]),c(s,{class:"mt-[98rpx]"}),c(s,{class:"b-tabbar safe-area-inset-bottom"},{default:f((()=>[c(s,{class:"b-tabbar-back fb items-center p-2"},{default:f((()=>[c(s,{class:""},{default:f((()=>[c(s,{class:"text-sm tk-sltext w-[400rpx]"},{default:f((()=>[m("快递："+v(Z.value?Z.value.channelName:"请选择快递"),1)])),_:1}),c(s,{class:"text-sm font-weight"},{default:f((()=>[m("快递费："+v(Z.value?Z.value.showPrice:"请先选择快递"),1)])),_:1})])),_:1}),c(a,{class:"tt-bbut text-center",onClick:t[14]||(t[14]=e=>(async()=>{var e;if(""==pe.goods)return ve.value=!0,void uni.$u.toast("请填写物品名称");if(pe.startAddress==[])return xe("startaddress"),void uni.$u.toast("请填写取件地址");if(pe.endAddress==[])return xe("endaddress"),void uni.$u.toast("请填写送件地址");if(null==X.value)return void uni.$u.toast("请完善信息再获取报价");if(null==Z.value)return void uni.$u.toast("请选择发货渠道");if(0==ae.value)return void uni.$u.toast("请先阅读并同意协议");const t=await Y(pe);pe.delivery_info=[],Z.value=null,X.value=null,te.value=!0,null==(e=ee.value)||e.open(t.data.trade_type,t.data.trade_id,"/addon/tk_jhkd/pages/orderlist")})())},{default:f((()=>[m("立即下单")])),_:1})])),_:1}),c(we)])),_:1}),c(he,{onClick:t[15]||(t[15]=e=>ce()),class:"fixed bottom-48 right-4 z-50 rounded-full p-2 text-white hover:bg-blue-700"},{default:f((()=>[c(o,{name:"share",color:"#000000",size:"24"})])),_:1}),c(je,{ref_key:"sharePosterRef",ref:oe,posterType:"tk_jhkd_poster",posterId:ie.value,posterParam:k(ne),copyUrlParam:k(ue)},null,8,["posterId","posterParam","copyUrlParam"]),c(Ce,{ref_key:"payRef",ref:ee,onClose:t[16]||(t[16]=e=>te.value=!1)},null,512)],64)}}}),[["__scopeId","data-v-88ccefb7"]]);export{J as default};
