import{_ as e}from"./u-input.9468a367.js";import{d as t,r as l,j as a,t as s,x as o,o as r,c,w as u,b as i,L as n,y as p,Y as x,I as d,J as m,K as f,f as _,u as g,n as v,a3 as b,a4 as h,g as y,h as k,D as w,i as j,z as F,l as S,a as C,G as V,Q as I}from"./index-d8a8f699.js";import{_ as M}from"./u-popup.0d48946e.js";import{_ as U}from"./u--image.2df700b8.js";import{_ as z}from"./tabbar.fdead755.js";import{b as D,c as T}from"./goods.69affd8d.js";import{M as E}from"./mescroll-body.f9302aea.js";import{M as N}from"./mescroll-empty.2fe85dec.js";import{u as P}from"./useMescroll.26ccf5de.js";import{_ as Y}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.5ba98c98.js";import"./u-transition.db07fff7.js";import"./u-safe-bottom.a4431b09.js";import"./u-image.e646392b.js";import"./u-badge.d38c6915.js";import"./u-tabbar.5fed7184.js";import"./mescroll-i18n.49872024.js";const B=Y(t({__name:"list",setup(t){const{mescrollInit:Y,downCallback:B,getMescroll:G}=P(h,b),J=l([]),K=l([]),L=l(""),Q=l(""),R=l(null),W=l(!1),Z=l(!1),$=l(""),q=l(""),A=l(""),H=l("all");l(!1);const O=l(!0);a((async e=>{Q.value=e.curr_goods_category||"",$.value=e.goods_name||"",L.value=e.coupon_id||"",await D().then((e=>{J.value.push({category_name:"全部",category_id:""}),J.value=J.value.concat(e.data)}))}));const X=e=>{W.value=!1;let t={goods_category:Q.value,page:e.num,limit:e.size,keyword:$.value,coupon_id:L.value,order:"all"===H.value?"":H.value,sort:"price"==H.value?q.value:A.value};T(t).then((t=>{let l=t.data.data;1===Number(e.num)&&(K.value=[]),K.value=K.value.concat(l),e.endSuccess(l.length),W.value=!0})).catch((()=>{W.value=!0,e.endErr()}))},ee=e=>{H.value=e,"all"==e&&(A.value="",q.value=""),"price"==e&&(A.value="",q.value?q.value="asc"==q.value?"desc":"asc":q.value="asc"),"sale_num"==e&&(q.value="",A.value?A.value="asc"==A.value?"desc":"asc":A.value="asc"),"label"==e?(A.value="asc",q.value="asc",Z.value=!0):(Z.value=!1,K.value=[],G().resetUpScroll())},te=()=>{O.value=!O.value},le=e=>{C({url:"/addon/shop/pages/goods/detail",param:{goods_id:e},mode:"navigateTo"})};s((()=>{setTimeout((()=>{G().optUp.textNoMore=o("end")}),500)}));const ae=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&V()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},se=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&V()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,parseFloat(t)};return(t,l)=>{const a=y(k("u-input"),e),s=w,o=j,b=y(k("u-popup"),M),h=I,C=y(k("u--image"),U),V=y(k("tabbar"),z);return r(),c(o,{class:"bg-gray-100 min-h-[100vh]",style:v(t.themeColor())},{default:u((()=>[i(o,{class:"fixed left-0 right-0 top-0 product-warp bg-[#fff] px-[30rpx]"},{default:u((()=>[i(o,{class:"py-[14rpx] flex items-center justify-between"},{default:u((()=>[i(o,{class:"flex-1 flex items-center h-[64rpx] bg-[#F6F8F8] rounded-[33rpx] px-[32rpx] mr-[30rpx]"},{default:u((()=>[i(a,{class:"flex-1",maxlength:"50",modelValue:$.value,"onUpdate:modelValue":l[0]||(l[0]=e=>$.value=e),onConfirm:l[1]||(l[1]=e=>ee("all")),placeholder:"请搜索您想要的商品",placeholderClass:"text-[#a5a6a6] text-[26rpx]",fontSize:"26rpx",clearable:"",border:"none"},null,8,["modelValue"]),i(s,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx] ml-[18rpx] !text-[#999]",onClick:l[2]||(l[2]=e=>ee("all"))})])),_:1}),i(o,{class:n(["nc-iconfont text-[34rpx] text-[#666]",O.value?"nc-icon-erweimaV6xx":"nc-icon-yingyongliebiaoV6xx"]),onClick:te},null,8,["class"])])),_:1}),i(o,{class:"flex justify-between tems-center py-[22rpx] px-[20rpx]"},{default:u((()=>[i(o,{class:"flex items-center justify-between text-[24rpx] text-[#666] flex-1"},{default:u((()=>[i(s,{class:n({"text-[#303133] ":"all"==H.value}),onClick:l[3]||(l[3]=e=>ee("all"))},{default:u((()=>[p("综合排序")])),_:1},8,["class"]),i(o,{class:n(["flex items-center",{"text-[#303133]":"sale_num"==H.value}]),onClick:l[4]||(l[4]=e=>ee("sale_num"))},{default:u((()=>[i(s,{class:"mr-[4rpx]"},{default:u((()=>[p("销量")])),_:1}),"asc"==A.value?(r(),c(s,{key:0,class:"text-[18rpx] text-[#666] nc-iconfont nc-icon-a-xiangshangV6xx1"})):(r(),c(s,{key:1,class:"text-[18rpx] text-[#666] nc-iconfont nc-icon-a-xiangxiaV6xx1"}))])),_:1},8,["class"]),i(o,{class:n(["flex items-center",{"text-[#303133]":"price"==H.value}]),onClick:l[5]||(l[5]=e=>ee("price"))},{default:u((()=>[i(s,{class:"mr-[4rpx]"},{default:u((()=>[p("价格")])),_:1}),"asc"==q.value?(r(),c(s,{key:0,class:"text-[18rpx] text-[#666] nc-iconfont nc-icon-a-xiangshangV6xx1"})):(r(),c(s,{key:1,class:"text-[18rpx] text-[#666] nc-iconfont nc-icon-a-xiangxiaV6xx1"}))])),_:1},8,["class"]),i(o,{class:n(["flex items-center",{"text-[#303133]":"label"==H.value}]),onClick:l[6]||(l[6]=e=>ee("label"))},{default:u((()=>[i(s,{class:"mr-[2rpx]"},{default:u((()=>[p("筛选")])),_:1}),i(s,{class:"nc-iconfont color-[#666] nc-icon-shaixuanV6xx text-[28rpx]"})])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),i(b,{show:Z.value,mode:"top",onClose:l[8]||(l[8]=e=>Z.value=!1)},{default:u((()=>[i(o,{onTouchmove:l[7]||(l[7]=x((()=>{}),["prevent","stop"]))},{default:u((()=>[i(o,{class:"text-sm font-bold px-[30rpx] mt-3"},{default:u((()=>[p("全部分类")])),_:1}),i(o,{class:"flex flex-wrap pl-[30rpx] pt-[30rpx]"},{default:u((()=>[(r(!0),d(f,null,m(J.value,((e,t)=>(r(),c(s,{onClick:t=>{return l=e.category_id,Q.value=l,K.value=[],G().resetUpScroll(),void(Z.value=!1);var l},key:e.category_id,class:n(["px-[26rpx] border-[2rpx] border-solid border-transparent h-[60rpx] mr-[30rpx] mb-[30rpx] flex items-center justify-center bg-[#F4F4F4] rounded-[8rpx] text-xs",{"label-select":Q.value==e.category_id}])},{default:u((()=>[p(F(e.category_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1})])),_:1},8,["show"]),i(E,{ref_key:"mescrollRef",ref:R,top:"160rpx",bottom:"50px",onInit:g(Y),down:{use:!1},onUp:X},{default:u((()=>[K.value.length?(r(),c(o,{key:0,class:n(["sidebar-marign",O.value?"":"flex justify-between flex-wrap"])},{default:u((()=>[(r(!0),d(f,null,m(K.value,((e,t)=>(r(),d(f,null,[O.value?(r(),c(o,{key:0,class:n(["bg-white flex p-[20rpx] rounded-[16rpx] overflow-hidden mt-[20rpx]",{"mb-[20rpx]":t+1==K.value.length}]),onClick:t=>le(e.goods_id)},{default:u((()=>[i(C,{class:"rounded-[10rpx] overflow-hidden",width:"190rpx",height:"190rpx",src:g(S)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:u((()=>[i(h,{class:"w-[190rpx] h-[190rpx] rounded-[10rpx] overflow-hidden",src:g(S)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(o,{class:"flex-1 flex flex-col ml-[20rpx] py-[6rpx]"},{default:u((()=>[i(o,{class:"text-[28rpx] text-[#303133] leading-[40rpx] multi-hidden mb-[10rpx]"},{default:u((()=>[p(F(e.goods_name),1)])),_:2},1024),i(o,{class:"mt-auto flex justify-between items-baseline"},{default:u((()=>[i(o,{class:"text-[var(--price-text-color)] price-font flex items-baseline"},{default:u((()=>[i(s,{class:"text-[26rpx] font-500"},{default:u((()=>[p("￥")])),_:1}),i(s,{class:"text-[36rpx] font-500"},{default:u((()=>[p(F(se(e).toFixed(2).split(".")[0]),1)])),_:2},1024),i(s,{class:"text-[24rpx] font-500"},{default:u((()=>[p("."+F(se(e).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==ae(e)?(r(),c(h,{key:0,class:"h-[24rpx] w-[72rpx] ml-[6rpx]",src:g(S)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):_("v-if",!0),"discount_price"==ae(e)?(r(),c(h,{key:1,class:"h-[24rpx] w-[72rpx] ml-[6rpx]",src:g(S)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):_("v-if",!0)])),_:2},1024),i(s,{class:"text-[22rpx] text-[#999]"},{default:u((()=>[p("已售"+F(e.sale_num)+F(e.unit),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])):(r(),c(o,{key:1,class:"goods-item-style-two flex flex-col bg-[#fff] box-border rounded-[12rpx] overflow-hidden mt-[20rpx]",onClick:t=>le(e.goods_id)},{default:u((()=>[i(C,{width:"100%",height:"350rpx",src:g(S)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:u((()=>[i(h,{class:"w-[100%] h-[350rpx]",src:g(S)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(o,{class:"px-[16rpx] flex-1 pt-[16rpx] pb-[20rpx] flex flex-col justify-between"},{default:u((()=>[i(o,{class:"text-[#303133] leading-[40rpx] text-[28rpx] multi-hidden"},{default:u((()=>[p(F(e.goods_name),1)])),_:2},1024),i(o,{class:"flex justify-between flex-wrap items-baseline mt-[16rpx]"},{default:u((()=>[i(o,{class:"text-[var(--price-text-color)] price-font flex items-baseline"},{default:u((()=>[_('\t\t\t\t\t\t\t\t\t\t<text class="text-[20rpx]  mr-[4rpx]">￥</text>'),_('\t\t\t\t\t\t\t\t\t\t<text class="text-[36rpx] font-500">{{ item.goodsSku.price }}</text>'),i(s,{class:"text-[26rpx] font-500"},{default:u((()=>[p("￥")])),_:1}),i(s,{class:"text-[36rpx] font-500"},{default:u((()=>[p(F(se(e).toFixed(2).split(".")[0]),1)])),_:2},1024),i(s,{class:"text-[24rpx] font-500"},{default:u((()=>[p("."+F(se(e).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==ae(e)?(r(),c(h,{key:0,class:"h-[24rpx] ml-[6rpx]",src:g(S)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):_("v-if",!0),"discount_price"==ae(e)?(r(),c(h,{key:1,class:"h-[24rpx] ml-[6rpx]",src:g(S)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):_("v-if",!0)])),_:2},1024),i(s,{class:"text-[22rpx] text-[#999]"},{default:u((()=>[p("已售"+F(e.sale_num)+F(e.unit),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]))],64)))),256))])),_:1},8,["class"])):_("v-if",!0),!K.value.length&&W.value?(r(),c(o,{key:1,class:"mx-[30rpx] mt-[20rpx] bg-[#fff] rounded-[16rpx] noData flex items-center justify-center"},{default:u((()=>[i(N,{option:{tip:"暂无商品"}})])),_:1})):_("v-if",!0)])),_:1},8,["onInit"]),i(V)])),_:1},8,["style"])}}}),[["__scopeId","data-v-eab1e9a8"]]);export{B as default};
