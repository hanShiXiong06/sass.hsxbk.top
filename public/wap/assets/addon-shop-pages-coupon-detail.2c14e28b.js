import{d as e,r as t,l as a,j as l,p as n,t as r,a as o,o as u,c as s,w as p,n as c,u as i,b as d,y as x,z as _,f as v,U as f,V as m,H as g,i as y,D as b,B as h,g as k,h as w,E as j,_ as T}from"./index-71c7df08.js";import{_ as D}from"./loading-page.vue_vue_type_script_setup_true_lang.c7dc2256.js";import{b as L}from"./browser.61094e65.js";import{t as E}from"./topTabbar.cb42d19f.js";import{e as F,d as C}from"./coupon.6319e3c7.js";const B=T(e({__name:"detail",setup(e){const T=t(!1),B=t(""),U=t({}),X=a(),z=l((()=>X.info));E().setTopTabbarParam({title:"优惠券详情"}),n((e=>{if(!e.coupon_id)return r({title:"优惠券不存在",icon:"none"}),setTimeout((()=>{o({url:"/addon/shop/pages/index",mode:"reLaunch"})}),600),!1;H(e.coupon_id),I(e.coupon_id)}));const H=e=>{T.value=!0,F(e).then((e=>{U.value=e.data,-1!=U.value.sum_count&&U.value.receive_count===U.value.sum_count?U.value.btnType="collected":z.value&&U.value.is_receive&&U.value.limit_count===U.value.member_receive_count?U.value.btnType="using":U.value.btnType="collecting",T.value=!1})).catch((()=>{T.value=!1,U.value={},setTimeout((()=>{o({url:"/addon/shop/pages/index",mode:"reLaunch"})}),600)}))},I=e=>{L.toDataURL(window.location.href,{errorCorrectionLevel:"L",margin:0,width:100}).then((e=>{B.value=e}))};return(e,t)=>{const a=y,l=b,n=h,r=k(w("loading-page"),D);return u(),s(a,{style:c(e.themeColor())},{default:p((()=>[Object.keys(U.value).length&&!T.value?(u(),s(a,{key:0,class:"overflow-hidden min-h-screen bg-style relative",style:c({background:"url("+i(j)("addon/shop/coupon/coupon_bg.png")+") no-repeat"})},{default:p((()=>[d(a,{class:"relative mt-[236rpx] w-[100%] h-[932rpx]",style:c({background:"url("+i(j)("addon/shop/coupon/coupon_bg_02.png")+") center / contain no-repeat"})},{default:p((()=>[U.value.limit_count?(u(),s(a,{key:0,style:c({background:"url("+i(j)("addon/shop/coupon/top_tab.png")+") center / cover no-repeat",transform:"translateX(-50%)"}),class:"text-[32rpx] leading-[56rpx] top-[2rpx] left-[50%] px-[30rpx] box-border justify-center absolute min-w-[196rpx] h-[56rpx] flex items-center text-[#FFF9DD]"},{default:p((()=>[x(" 限领"+_(U.value.limit_count)+"张 ",1)])),_:1},8,["style"])):v("v-if",!0),d(a,{class:"flex justify-center pt-[90rpx]"},{default:p((()=>[d(l,{class:"max-w-[380rpx] text-[var(--price-text-color)] text-[140rpx] truncate price-font"},{default:p((()=>[x(_(U.value.coupon_price||0),1)])),_:1}),d(l,{class:"flex items-center justify-center text-[44rpx] mt-[54rpx] ml-[8rpx] text-[#F7D894] bg-[var(--price-text-color)] rounded-full w-[70rpx] h-[70rpx]"},{default:p((()=>[x("元")])),_:1})])),_:1}),d(a,{class:"h-[64rpx] leading-[64rpx] text-[42rpx] text-[#E22D17] mt-[10rpx] text-center"},{default:p((()=>["0.00"===U.value.min_condition_money?(u(),s(l,{key:0},{default:p((()=>[x("无门槛")])),_:1})):(u(),s(l,{key:1},{default:p((()=>[x("满"+_(U.value.coupon_min_price)+"元可用",1)])),_:1}))])),_:1}),d(a,{class:"text-[26rpx] h-[36rpx] text-[#E22D17] mt-[44rpx] text-center flex justify-center items-center"},{default:p((()=>[1==U.value.valid_type?(u(),f(m,{key:0},[d(l,null,{default:p((()=>[x("领取之日起")])),_:1}),d(l,null,{default:p((()=>[x(_(U.value.length),1)])),_:1}),d(l,null,{default:p((()=>[x("天内有效")])),_:1})],64)):(u(),f(m,{key:1},[d(l,null,{default:p((()=>[x("有效期至")])),_:1}),d(l,null,{default:p((()=>[x(_(U.value.valid_end_time?U.value.valid_end_time.slice(0,10):""),1)])),_:1})],64))])),_:1}),d(a,{class:"flex justify-center items-center mt-[20rpx]"},{default:p((()=>["collected"===U.value.btnType?(u(),s(l,{key:0,class:"!leading-[100rpx] text-center text-[rgba(255,255,255,1)] text-[46rpx] min-w-[240rpx] h-[106rpx]",style:c({background:"url("+i(j)("addon/shop/coupon/coupon_btn_02.png")+")  center / contain no-repeat"})},{default:p((()=>[x("已领完 ")])),_:1},8,["style"])):v("v-if",!0),"collecting"===U.value.btnType?(u(),s(l,{key:1,class:"!leading-[100rpx] text-center text-[#E22D17] text-[46rpx] min-w-[240rpx] h-[106rpx]",style:c({background:"url("+i(j)("addon/shop/coupon/coupon_btn.png")+") center / contain no-repeat"}),onClick:t[0]||(t[0]=e=>(e=>{if(!z.value)return g().setLoginBack({url:"/addon/shop/pages/coupon/list"}),!1;C({coupon_id:e,number:1}).then((e=>{U.value.btnType="using"}))})(U.value.id))},{default:p((()=>[x("领取 ")])),_:1},8,["style"])):v("v-if",!0),"using"===U.value.btnType?(u(),s(l,{key:2,class:"!leading-[100rpx] text-center text-[#E22D17] text-[46rpx] min-w-[240rpx] h-[106rpx]",style:c({background:"url("+i(j)("addon/shop/coupon/coupon_btn.png")+") center / contain no-repeat"}),onClick:t[1]||(t[1]=e=>{return t=U.value.id,void o({url:"/addon/shop/pages/goods/list",param:{coupon_id:t}});var t})},{default:p((()=>[x("去使用 ")])),_:1},8,["style"])):v("v-if",!0)])),_:1}),d(a,{class:"w-[230rpx] h-[230rpx] box-border p-[15rpx] bg-[#fff] mx-[auto] mt-[50rpx]"},{default:p((()=>[d(n,{class:"w-[200rpx] h-[200rpx]",src:B.value,mode:"aspectFill"},null,8,["src"])])),_:1}),d(a,{class:"text-[24rpx] text-[rgba(255,255,255,0.7)] mt-[30rpx] text-center"},{default:p((()=>[x("注:扫描二维码或点击右上角进行分享")])),_:1})])),_:1},8,["style"])])),_:1},8,["style"])):v("v-if",!0),d(r,{loading:T.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-1828fbf2"]]);export{B as default};
