import{d as e,r as t,m as r,l,o as a,c as o,w as p,b as s,n,u as d,x as c,E as i,F as u,G as x,f,a5 as m,a6 as _,i as b,g,h as y,V as h,H as v,y as k,_ as F,B as w,a as C,C as j}from"./index-905183d4.js";import{_ as S}from"./u-button.d3798ecb.js";import{b as z,c as D}from"./coupon.a8cf1167.js";import{M as T}from"./mescroll-body.b8d008ed.js";import{M as I}from"./mescroll-empty.f9bce990.js";import{u as B}from"./useMescroll.26ccf5de.js";import{_ as H}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.c376267d.js";import"./u-icon.86a2aad0.js";import"./mescroll-uni-option.0af4878d.js";import"./mescroll-i18n.6025c811.js";/* empty css                                                                       */const M=H(e({__name:"list",setup(e){const{mescrollInit:H,downCallback:M,getMescroll:E}=B(_,m);let N={};t({title:"优惠券列表",topStatusBar:{style:"style-1",bgColor:"transparent",textColor:"#fff"}}),r((()=>{let e="";return e=2*Number(N.height)+2*N.top+368+"rpx;",e}));const R=t([]),A=t(!0),G=l(),L=r((()=>G.info)),U=e=>{A.value=!0;let t={page:e.num,limit:e.size};z(t).then((t=>{let r=t.data.data.map((e=>(-1!=e.sum_count&&e.receive_count===e.sum_count&&(e.btnType="collected"),L.value&&e.is_receive&&e.limit_count===e.member_receive_count?e.btnType="using":e.btnType="collecting",e)));1==e.num&&(R.value=[]),R.value=R.value.concat(r),e.endSuccess(r.length),A.value=!1})).catch((()=>{A.value=!1,e.endErr()}))},V=e=>{C({url:"/addon/shop/pages/coupon/detail",param:{coupon_id:e}})};return(e,t)=>{const r=b,l=j,m=g(y("u-button"),S);return a(),o(r,{class:"bg-[#F6F6F6] min-h-screen overflow-hidden",style:n(e.themeColor())},{default:p((()=>[s(r,{class:"coupon-header"},{default:p((()=>[s(r,{class:"h-[352rpx]",style:n({backgroundImage:"url("+d(h)("addon/shop/coupon/coupn_h5.png")+")",backgroundSize:"100%",backgroundRepeat:"no-repeat"})},{default:p((()=>[s(r,{class:"px-[38rpx] pt-[98rpx]"},{default:p((()=>[s(r,{class:"font-bold text-[36rpx] text-[#fff] leading-[42rpx]"},{default:p((()=>[c("领劵中心")])),_:1}),s(r,{class:"mt-[10rpx] font-400 text-[24rpx] text-[#fff] leading-[28rpx]"},{default:p((()=>[c("天天来领券，优惠看得见")])),_:1})])),_:1})])),_:1},8,["style"])])),_:1}),s(r,{class:"-mt-[74rpx] bg-[#F6F6F6] rounded-tl-[26rpx] rounded-tr-[26rpx]"},{default:p((()=>[s(T,{ref:"mescrollRef",onInit:d(H),onDown:d(M),onUp:U},{default:p((()=>[s(r,{class:"py-[30rpx] px-[30rpx]"},{default:p((()=>[(a(!0),i(x,null,u(R.value,((e,t)=>(a(),i(x,null,["collected"===e.btnType?(a(),o(r,{key:0,class:v(["flex items-center relative w-[100%] rounded-[20rpx] overflow-hidden bg-[#fff] py-[10rpx] background-size",{"mt-[20rpx]":t}]),style:n({backgroundImage:"url("+d(h)("addon/shop/coupon/coupn_loot.png")+")"}),onClick:t=>V(e.id)},{default:p((()=>[s(r,{class:"box-border flex-1 border-0 border-r-[1px] border-[#FFDCDC] border-dashed flex items-center"},{default:p((()=>[s(r,{class:"pl-[40rpx] w-[200rpx] box-border"},{default:p((()=>[s(r,{class:"price-font flex items-center text-[var(--primary-color)]"},{default:p((()=>[s(l,{class:"text-[38rpx] leading-[45rpx] text-center font-500"},{default:p((()=>[c("￥")])),_:1}),s(l,{class:"text-[56rpx] font-semibold text-left leading-[70rpx] truncate"},{default:p((()=>[c(k(e.coupon_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),s(r,{class:"flex-1 box-border ml-[10rpx]"},{default:p((()=>[s(r,{class:"text-[30rpx] leading-[35rpx] text-left font-500"},{default:p((()=>["0.00"===e.min_condition_money?(a(),o(l,{key:0},{default:p((()=>[c("无门槛")])),_:1})):(a(),o(l,{key:1},{default:p((()=>[c("满"+k(e.coupon_min_price)+"元可用",1)])),_:2},1024))])),_:2},1024),s(r,{class:"text-[20rpx] leading-[23rpx] mt-[4px] text-left flex items-center"},{default:p((()=>[s(l,{class:"bg-[var(--primary-color)] text-[#fff] text-[20rpx] h-[28rpx] leading-[28rpx] px-[10rpx] rounded-[16rpx] mr-[6rpx] shrink-0"},{default:p((()=>[c(k(e.type_name),1)])),_:2},1024),s(l,{class:"truncate max-w-[190rpx]"},{default:p((()=>[c(k(e.title),1)])),_:2},1024)])),_:2},1024),s(r,{class:"w-[100%] mt-[4px] mb-[11px] text-[20rpx] leading-[23rpx]"},{default:p((()=>[1==e.valid_type?(a(),o(l,{key:0},{default:p((()=>[c("领取之日起"+k(e.length||"")+"天内有效",1)])),_:2},1024)):(a(),o(l,{key:1},{default:p((()=>[c(" 有效期至"+k(e.valid_end_time?e.valid_end_time.slice(0,10):""),1)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1024),s(r,{class:"pr-[20rpx] pl-[30rpx]"},{default:p((()=>[s(m,{customStyle:{width:"150rpx",height:"60rpx",color:"#fff",fontSize:"24rpx",lineHeight:"60rpx",padding:"0",backgroundColor:"var(--primary-color)",opacity:"0.6",border:"none"},shape:"circle",disabled:""},{default:p((()=>[c("已领完")])),_:1},8,["customStyle"])])),_:1}),s(r,{class:"absolute top-0 right-[190rpx] h-[10rpx] w-[20rpx] rounded-br-[20rpx] rounded-bl-[20rpx] bg-[#F6F6F6]"}),s(r,{class:"absolute bottom-0 right-[190rpx] h-[10rpx] w-[20rpx] rounded-tr-[20rpx] rounded-tl-[20rpx] bg-[#F6F6F6]"})])),_:2},1032,["class","style","onClick"])):(a(),o(r,{key:1,class:v(["flex items-center relative w-[100%] rounded-[20rpx] overflow-hidden bg-[#fff] py-[10rpx] background-size",{"mt-[20rpx]":t}]),onClick:t=>V(e.id),style:n({backgroundImage:"using"===e.btnType?"url("+d(h)("addon/shop/coupon/coupn_bg.png")+")":"none"})},{default:p((()=>[s(r,{class:"relative box-border flex-1 border-0 border-r-[1px] border-[#FFDCDC] border-dashed flex items-center"},{default:p((()=>[s(r,{class:"pl-[40rpx] w-[200rpx] box-border"},{default:p((()=>[s(r,{class:"price-font flex items-center text-[var(--primary-color)]"},{default:p((()=>[s(l,{class:"text-[38rpx] leading-[45rpx] text-center font-500"},{default:p((()=>[c("￥")])),_:1}),s(l,{class:"text-[56rpx] font-semibold text-left leading-[70rpx] truncate"},{default:p((()=>[c(k(e.coupon_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),s(r,{class:"flex-1 box-border ml-[10rpx]"},{default:p((()=>[s(r,{class:"text-[30rpx] leading-[35rpx] text-left font-500"},{default:p((()=>["0.00"===e.min_condition_money?(a(),o(l,{key:0},{default:p((()=>[c("无门槛")])),_:1})):(a(),o(l,{key:1},{default:p((()=>[c("满"+k(e.coupon_min_price)+"元可用",1)])),_:2},1024))])),_:2},1024),s(r,{class:"text-[20rpx] leading-[23rpx] mt-[4px] text-left flex items-center"},{default:p((()=>[s(l,{class:"bg-[var(--primary-color)] text-[#fff] text-[20rpx] h-[28rpx] leading-[28rpx] px-[10rpx] rounded-[16rpx] mr-[6rpx] shrink-0"},{default:p((()=>[c(k(e.type_name),1)])),_:2},1024),s(l,{class:"truncate max-w-[190rpx]"},{default:p((()=>[c(k(e.title),1)])),_:2},1024)])),_:2},1024),s(r,{class:"w-[100%] mt-[4px] mb-[11px] text-[20rpx] leading-[23rpx]"},{default:p((()=>[1==e.valid_type?(a(),o(l,{key:0},{default:p((()=>[c("领取之日起"),s(l,null,{default:p((()=>[c(k(e.length||""),1)])),_:2},1024),c("天内有效")])),_:2},1024)):(a(),o(l,{key:1},{default:p((()=>[c(" 有效期至"),s(l,null,{default:p((()=>[c(k(e.valid_end_time?e.valid_end_time.slice(0,10):""),1)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1024),"collecting"===e.btnType?(a(),o(r,{key:0,onClick:F((r=>((e,t)=>{if(!L.value)return w().setLoginBack({url:"/addon/shop/pages/coupon/list"}),!1;D({coupon_id:e,number:1,type:"receive"}).then((e=>{R.value[t].btnType="using"}))})(e.id,t)),["stop"]),class:"pr-[20rpx] pl-[30rpx]"},{default:p((()=>[s(m,{customStyle:{width:"150rpx",height:"60rpx",color:"#fff",fontSize:"24rpx",lineHeight:"60rpx",padding:"0",backgroundColor:"var(--primary-color)",border:"none"},shape:"circle"},{default:p((()=>[c("立即领取")])),_:1},8,["customStyle"])])),_:2},1032,["onClick"])):f("v-if",!0),"using"===e.btnType?(a(),o(r,{key:1,onClick:F((t=>{return r=e.id,void C({url:"/addon/shop/pages/goods/list",param:{coupon_id:r}});var r}),["stop"]),class:"pr-[20rpx] pl-[30rpx]"},{default:p((()=>[s(m,{customStyle:{width:"150rpx",height:"60rpx",color:"var(--primary-color)",fontSize:"24rpx",lineHeight:"60rpx",padding:"0",backgroundColor:"transparent",border:"2rpx solid var(--primary-color)"},shape:"circle"},{default:p((()=>[c("去使用")])),_:1},8,["customStyle"])])),_:2},1032,["onClick"])):f("v-if",!0),s(r,{class:"absolute top-0 right-[190rpx] h-[10rpx] w-[20rpx] rounded-br-[20rpx] rounded-bl-[20rpx] bg-[#F6F6F6]"}),s(r,{class:"absolute bottom-0 right-[190rpx] h-[10rpx] w-[20rpx] rounded-tr-[20rpx] rounded-tl-[20rpx] bg-[#F6F6F6]"})])),_:2},1032,["class","onClick","style"]))],64)))),256)),R.value.length||A.value?f("v-if",!0):(a(),o(r,{key:0,class:"noData bg-[#fff] rounded-[20rpx] flex items-center justify-center"},{default:p((()=>[s(I,{option:{tip:"暂无优惠券"}})])),_:1}))])),_:1})])),_:1},8,["onInit","onDown"])])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-f5727f82"]]);export{M as default};
