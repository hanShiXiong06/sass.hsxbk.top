import{a as e,d as t,l as a,j as l,r as s,K as d,p as r,s as o,q as u,H as i,o as n,O as c,b as f,w as m,y as p,c as _,f as x,z as v,P as g,a6 as b,u as k,D as y,i as h,g as w,h as A,cf as j,c6 as C,cg as S,C as V,Q as $,E as P,B as U}from"./index-9317da28.js";import{_ as L}from"./u-icon.5e775659.js";import{_ as T}from"./u-alert.9575a35d.js";import{_ as z}from"./u-input.e030155a.js";import{_ as B}from"./u-tag.f8d2d4c7.js";import{_ as I}from"./u-number-box.3146e59e.js";import{_ as H}from"./u-loading-icon.aabe3d05.js";import{_ as W}from"./u-safe-bottom.3546c5bb.js";import{_ as q}from"./u-popup.1f2ebcae.js";import{_ as E}from"./share-poster.025b3e61.js";import{_ as K}from"./pay.b34fbbeb.js";import{c as N,b as R,p as D,d as M,a as O}from"./tkjhkd.71d3825e.js";import{c as Q}from"./orderadd.19c67a0f.js";import{_ as Y}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-transition.65be38eb.js";/* empty css                                                                *//* empty css                                                                       */import"./u-image.74ac23f6.js";import"./pay.25e81968.js";const F=Y(t({__name:"ordersubmit",setup(t){const Y=a(),F=l((()=>Y.info));Q().then((t=>{"redirect"===t.data.type&&(uni.$u.toast("请先支付未补差价订单"),e({url:t.data.page}))})),s([""]),s(null),s(null);const G=s();s();const J=s(),X=s(null),Z=s(!1);s(!1);const ee=s(!0),te=s(!1),ae=s(null),le=s({title:"快速下单必读",description:"先地址簿添加/编辑地址，选择取/收货地址，填写物品信息，选择渠道下单",closable:!1}),se=s(["普货","文件","美妆用品","数码产品","服装鞋帽","珠宝首饰","零食特产","办公用品"]);let de=s(null),re=s(""),oe={};const ue=s(0),ie=()=>{if(!F.value){let e=uni.getStorageSync("pid");return e&&e>0?(i().setLoginBack({url:"/addon/tk_jhkd/pages/ordersubmit?mid="+e}),!1):(i().setLoginBack({url:"/addon/tk_jhkd/pages/ordersubmit"}),!1)}F.value&&F.value.member_id&&(oe.member_id=F.value.member_id),F.value&&F.value.member_id&&(re.value+="?mid="+F.value.member_id),de.value.openShare()},ne=e=>{1==ee.value?ee.value=!1:ee.value=!0},ce=s({title:"填写须知",description:"物品名称必须填写，物品重量需按照实际重量填写,超长物品请填写实际尺寸，如需要保价请填写保价金额",closable:!1}),fe=d({startAddress:uni.getStorageSync("startAddress"),endAddress:uni.getStorageSync("endAddress"),customerType:"kd",goods:"",packageCount:1,weight:1,vloumLong:10,vloumWidth:10,vloumHeight:10,guaranteeValueAmount:null,remark:"",showPrice:"0",payMethod:"",delivery_info:[],key:"",delivery_index:"",price_rule:[],original_rule:[]}),me=()=>{pe.value=!1,te.value=!1},pe=s(!1);s(["0000","15222"]);const _e=t=>{uni.setStorage({key:"selectAddressCallback",data:{back:"/addon/tk_jhkd/pages/ordersubmit",delivery:t,value:t},success(){e({url:"/addon/tk_jhkd/pages/address/address",param:{type:"address"}})}})},xe=async e=>{if(e>0){return(await R(e)).data}},ve=uni.getStorageSync("selectAddressCallback");ve&&("startaddress"==ve.delivery&&xe(ve.address_id).then((e=>{uni.setStorageSync("startAddress",e),fe.startAddress=uni.getStorageSync("startAddress")})).catch((e=>{console.error(e)})),"endaddress"==ve.delivery&&xe(ve.address_id).then((e=>{uni.setStorageSync("endAddress",e),fe.endAddress=uni.getStorageSync("endAddress")})).catch((e=>{console.error(e)})),uni.removeStorage({key:"selectAddressCallback"}));const ge=s();return r((e=>{e.mid&&uni.setStorageSync("pid",e.mid);let t={type:""};if(!o()){const e=i();u()&&(t.query.code?e.authLogin(t.query.code):e.getAuthCode("snsapi_userinfo"))}setTimeout((()=>{if(!F.value){let e=uni.getStorageSync("pid");return e&&e>0?(i().setLoginBack({url:"/addon/tk_jhkd/pages/ordersubmit?mid="+e}),!1):(i().setLoginBack({url:"/addon/tk_jhkd/pages/ordersubmit"}),!1)}}),500);let a=uni.getStorageSync("pid");a&&a>0&&N({pid:a}),fe.customerType=e.type?e.type:"kd","ky"==fe.customerType&&(fe.weight=30),(async()=>{const e=await O("jhkdservice");ge.value=e.data})()})),(t,a)=>{const l=y,s=h,d=w(A("u-icon"),L),r=w(A("u-alert"),T),o=U,u=j,i=C,N=S,R=w(A("u-input"),z),O=w(A("u-tag"),B),Q=w(A("u-number-box"),I),Y=w(A("u-loading-icon"),H),F=V,xe=w(A("u-safe-bottom"),W),ve=w(A("u-popup"),q),be=w(A("share-poster"),E),ke=w(A("pay"),K);return n(),c(g,null,[f(s,{class:"tk-card !bg-[#f4f4f4]"},{default:m((()=>[f(s,{class:"fb flex item-center"},{default:m((()=>[f(s,{class:""},{default:m((()=>[f(l,{class:"tag"},{default:m((()=>[p("寄")])),_:1})])),_:1}),f(s,{class:"w-[380rpx]"},{default:m((()=>[fe.startAddress==[]?(n(),_(l,{key:0,class:"font-bold"},{default:m((()=>[p("从哪里寄？")])),_:1})):x("v-if",!0),fe.startAddress==[]?(n(),_(l,{key:1,class:"tk-sltext"},{default:m((()=>[p("请选择寄件地址")])),_:1})):x("v-if",!0),fe.startAddress?(n(),_(l,{key:2,class:"font-bold tk-sltext text-sm"},{default:m((()=>[p(v(fe.startAddress.name)+" ",1),f(l,{class:"font-bold text-xs text-slate-600"},{default:m((()=>[p(v(fe.startAddress.mobile),1)])),_:1})])),_:1})):x("v-if",!0),fe.startAddress?(n(),_(l,{key:3,class:"text-xs font-bold"},{default:m((()=>[p(v(fe.startAddress.address),1)])),_:1})):x("v-if",!0)])),_:1}),f(s,{class:""},{default:m((()=>[f(l,{class:"bt text-sm",onClick:a[0]||(a[0]=e=>_e("startaddress"))},{default:m((()=>[p("地址簿")])),_:1})])),_:1})])),_:1}),f(s,{class:"line-box1 mt-2"}),f(s,{class:"fb fb flex item-center mt-2"},{default:m((()=>[f(s,{class:""},{default:m((()=>[f(l,{class:"tag",style:{background:"#4541c7",color:"#ffffff"}},{default:m((()=>[p("收")])),_:1})])),_:1}),f(s,{class:"w-[380rpx]"},{default:m((()=>[fe.endAddress==[]?(n(),_(s,{key:0,class:"font-bold"},{default:m((()=>[p("收件人信息？")])),_:1})):x("v-if",!0),fe.endAddress==[]?(n(),_(l,{key:1,class:"tk-sltext"},{default:m((()=>[p("请选择收件地址")])),_:1})):x("v-if",!0),fe.endAddress?(n(),_(l,{key:2,class:"font-bold tk-sltext text-sm"},{default:m((()=>[p(v(fe.endAddress.name)+" ",1),f(l,{class:"font-bold text-xs text-slate-600"},{default:m((()=>[p(v(fe.endAddress.mobile),1)])),_:1})])),_:1})):x("v-if",!0),fe.endAddress?(n(),_(l,{key:3,class:"text-xs font-bold"},{default:m((()=>[p(v(fe.endAddress.address),1)])),_:1})):x("v-if",!0)])),_:1}),f(s,{class:""},{default:m((()=>[f(l,{class:"bt text-sm",onClick:a[1]||(a[1]=e=>_e("endaddress"))},{default:m((()=>[p("地址簿")])),_:1})])),_:1})])),_:1}),f(s,{class:"text-sm mt-2 text-[#686868] font-bold"},{default:m((()=>[p(" 请认真核实地址,填写实际重量再下单！ ")])),_:1})])),_:1}),f(s,{class:"tk-card"},{default:m((()=>[f(s,{class:"fb"},{default:m((()=>[f(s,{class:"fl items-center"},{default:m((()=>[f(s,{class:"text-xs tk-tag mr-1"},{default:m((()=>[p("必填")])),_:1}),f(s,{class:"mr-2"},{default:m((()=>[p("物品信息")])),_:1}),f(s,{class:"font-weight text-[#272822] text-sm"},{default:m((()=>[p(v(fe.goods)+","+v(fe.weight)+"kg",1)])),_:1})])),_:1}),f(d,{size:"22",name:"edit-pen",onClick:a[2]||(a[2]=e=>fe.startAddress==[]?(_e("startaddress"),void uni.$u.toast("请填写取件地址")):fe.endAddress==[]?(_e("endaddress"),void uni.$u.toast("请填写送件地址")):(pe.value=!0,void(fe.delivery_info=[])))})])),_:1})])),_:1}),f(s,{class:"pl-2 pr-2"},{default:m((()=>[f(r,{title:le.value.title,type:"info",closable:le.value.closable,description:le.value.description},null,8,["title","closable","description"])])),_:1}),G.value?(n(),_(s,{key:0,class:"mt-[40rpx] overflow-y-auto"},{default:m((()=>[(n(!0),c(g,null,b(G.value,((e,t)=>(n(),c(g,{key:t},["Y"==e.onlinePay?(n(),_(s,{key:0,class:$(["fb p-[12rpx] tk-card1",[{selectitemclass:ae.value==t}]]),onClick:e=>{return a=t,ae.value=a,J.value=G.value[a],fe.showPrice=J.value.showPrice,fe.delivery_info=J.value,fe.delivery_index=a,fe.price_rule=J.value.price_rule,void(fe.original_rule=J.value.original_rule);var a}},{default:m((()=>[f(s,{class:"fl"},{default:m((()=>[f(s,null,{default:m((()=>[f(o,{style:{width:"68rpx",height:"68rpx","border-radius":"8rpx"},src:k(P)(e.logo),mode:""},null,8,["src"])])),_:2},1024),f(s,{class:"ml-[18rpx]",style:{width:"100% !import"}},{default:m((()=>[f(s,{class:"flex items-center justify-between w-[580rpx]"},{default:m((()=>[f(s,{class:"flex items-center"},{default:m((()=>[f(s,{class:"font-weight text-xs text-sltext w-[260rpx]"},{default:m((()=>[p(v(e.channelName),1)])),_:2},1024),f(s,{class:"text-xs text-[#272822] ml-4 w-[160rpx]"},{default:m((()=>[p("限重:"+v(e.limitWeight)+"kg",1)])),_:2},1024)])),_:2},1024),f(s,{class:"font-weight text-sm w-[160rpx]"},{default:m((()=>[p(v(e.showPrice)+"元 ",1)])),_:2},1024)])),_:2},1024),f(s,{class:"line-box1 mt-1"}),e.price_rule.add?(n(),_(s,{key:0,class:"flex text-xs mt-1 font-bold"},{default:m((()=>[f(s,{class:"text-[24rpx] text-center p-1 bg-[#cbe3e0] rounded-lg text-slate-600 bg-opacity-50"},{default:m((()=>[p(" 首重:"+v(e.price_rule.first)+"元/"+v(e.price_rule.start)+"kg",1)])),_:2},1024),f(s,{class:"text-[24rpx] text-center ml-2 p-1 bg-[#cbe3e0] rounded-lg text-slate-600 bg-opacity-50"},{default:m((()=>[p(" 续重:"+v(e.price_rule.add)+"元/kg ",1)])),_:2},1024)])),_:2},1024)):x("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])):x("v-if",!0)],64)))),128))])),_:1})):x("v-if",!0),ge.value?(n(),_(s,{key:1,class:"tk-card"},{default:m((()=>[f(N,{class:"uni-list",onChange:ne},{default:m((()=>[f(i,{class:"text-xs fl items-center uni-list-cell uni-list-cell-pd"},{default:m((()=>[f(s,null,{default:m((()=>[f(u,{color:"#3c4cde",style:{transform:"scale(0.6)"},value:"true",checked:ee.value},null,8,["checked"])])),_:1}),f(s,{onClick:a[3]||(a[3]=t=>k(e)({url:"/addon/tk_jhkd/pages/agreement?type=jhkdyesgoods"}))},{default:m((()=>[p(" 阅读并同意《"+v(ge.value.title?ge.value.title:"寄件服务协议")+"》",1)])),_:1})])),_:1})])),_:1})])),_:1})):x("v-if",!0),f(s,{class:"mt-[380rpx] mb-[260rpx] flex items-center"}),x(" 物品信息弹出框 "),f(ve,{class:"safe-area-inset-bottom",round:10,onClose:me,closeable:"true",show:pe.value,mode:"bottom","border-radius":"12"},{default:m((()=>[f(s,{class:"tk-card h-[760rpx] overflow-y-auto"},{default:m((()=>[f(s,{class:"flex items-center"},{default:m((()=>[f(s,{class:"senddetail"},{default:m((()=>[p(" 物品名称 ")])),_:1}),f(R,{clearable:"true",border:"bottom",class:"mt-[8rpx] text-sm",modelValue:fe.goods,"onUpdate:modelValue":a[4]||(a[4]=e=>fe.goods=e),placeholder:"如:生活用品,点击标签快速填写"},null,8,["modelValue"])])),_:1}),f(s,{class:"fl flex-wrap mt-2"},{default:m((()=>[(n(!0),c(g,null,b(se.value,((e,t)=>(n(),_(s,{key:"index",class:"mt-1 mr-2 mb-1"},{default:m((()=>[f(O,{borderColor:"#444444",color:"#1d1d1d",text:e,type:"success",plain:"",onClick:e=>(e=>{uni.$u.toast(se.value[e]),fe.goods=se.value[e]})(t)},null,8,["text","onClick"])])),_:2},1024)))),128))])),_:1}),f(s,{class:"font-bold text-xs mt-2",onClick:a[5]||(a[5]=t=>k(e)({url:"/addon/tk_jhkd/pages/agreement?type=jhkdyesgoods"}))},{default:m((()=>[p(" 《违禁品查询》")])),_:1}),f(s,{class:"flex items-center mt-[24rpx]"},{default:m((()=>[f(s,{class:"senddetail"},{default:m((()=>[p(" 物品重量 ")])),_:1}),f(Q,{"button-size":"24",color:"#0000ff",bgColor:"#e6e6e6",iconStyle:"color: #0000ff",integer:"",min:"kd"==fe.customerType?1:30,max:1e4,class:"text-sm",modelValue:fe.weight,"onUpdate:modelValue":a[6]||(a[6]=e=>fe.weight=e)},null,8,["min","modelValue"]),f(l,{class:"ml-4 text-[#a3a3a3]"},{default:m((()=>[p("kg")])),_:1})])),_:1}),f(s,{class:"font-bold text-xs text-red"},{default:m((()=>[p("请填写打包完成后包裹的重量，超重需按照快递原价补差价，将不会享受寄件折扣")])),_:1}),f(s,{class:"flex items-center mt-[24rpx]"},{default:m((()=>[f(s,{class:"senddetail"},{default:m((()=>[p(" 包裹数量 ")])),_:1}),f(Q,{"button-size":"24",color:"#0000ff",bgColor:"#e6e6e6",iconStyle:"color: #0000ff",integer:"",min:1,max:100,class:"text-sm",modelValue:fe.packageCount,"onUpdate:modelValue":a[7]||(a[7]=e=>fe.packageCount=e)},null,8,["modelValue"]),f(l,{class:"ml-4 text-[#a3a3a3]"},{default:m((()=>[p("个")])),_:1})])),_:1}),f(s,{class:"flex items-center mt-[24rpx]"},{default:m((()=>[f(s,{class:"senddetail"},{default:m((()=>[p(" 物品体积 ")])),_:1}),f(s,{class:"w-48px"},{default:m((()=>[f(R,{border:"bottom",maxlength:"3",modelValue:fe.vloumLong,"onUpdate:modelValue":a[8]||(a[8]=e=>fe.vloumLong=e)},null,8,["modelValue"])])),_:1}),f(l,{class:"text-[#a3a3a3] mr-[8rpx]"},{default:m((()=>[p("x")])),_:1}),f(s,{class:"w-48px"},{default:m((()=>[f(R,{border:"bottom",maxlength:"3",modelValue:fe.vloumWidth,"onUpdate:modelValue":a[9]||(a[9]=e=>fe.vloumWidth=e)},null,8,["modelValue"])])),_:1}),f(l,{class:"text-[#a3a3a3] mr-[8rpx]"},{default:m((()=>[p("x")])),_:1}),f(s,{class:"w-48px"},{default:m((()=>[f(R,{border:"bottom",maxlength:"3",modelValue:fe.vloumHeight,"onUpdate:modelValue":a[10]||(a[10]=e=>fe.vloumHeight=e)},null,8,["modelValue"])])),_:1}),f(l,{class:"ml-4 text-[#a3a3a3]"},{default:m((()=>[p("单位：cm")])),_:1})])),_:1}),f(s,{class:"flex items-center mt-[24rpx]"},{default:m((()=>[f(s,{class:"senddetail"},{default:m((()=>[p(" 保价金额 ")])),_:1}),f(R,{placeholder:"不保价可不填",type:"number",modelValue:fe.guaranteeValueAmount,"onUpdate:modelValue":a[11]||(a[11]=e=>fe.guaranteeValueAmount=e)},null,8,["modelValue"]),f(l,{class:"ml-4 text-[#a3a3a3]"},{default:m((()=>[p("元")])),_:1})])),_:1}),f(s,{class:"mt-4 text-sm text-[#a3a3a3]"},{default:m((()=>[p("订单备注")])),_:1}),f(R,{class:"mt-[14px]",modelValue:fe.remark,"onUpdate:modelValue":a[12]||(a[12]=e=>fe.remark=e),placeholder:"小哥辛苦了!"},null,8,["modelValue"])])),_:1}),f(s,{class:"pl-2 pr-2"},{default:m((()=>[f(r,{title:ce.value.title,type:"warning",closable:ce.value.closable,description:ce.value.description},null,8,["title","closable","description"])])),_:1}),1==te.value?(n(),_(Y,{key:0,class:"mt-4",duration:"1000",mode:"circle",on:"linear",color:"#4541c7",vertical:!0})):x("v-if",!0),x(' <view v-if="bjshow==false" class="tk-card butto text-xl" @click="closeShow()">获取报价</view>\r\n\t\t<view v-if="bjshow==true" class="tk-card butto text-xl" @click=" ">正在计算</view> '),0==te.value?(n(),_(s,{key:1,class:"flex flex-1 p-4"},{default:m((()=>[f(F,{class:"w-[100%] !h-[72rpx] leading-[72rpx] text-[26rpx] rounded-[50rpx]",style:{color:"#ffffff",backgroundColor:"#4541c7"},type:"default",onClick:a[13]||(a[13]=e=>(async()=>{if(""==fe.goods)return void uni.$u.toast("请填写物品名称");if(fe.startAddress==[])return _e("startaddress"),void uni.$u.toast("请填写取件地址");if(fe.endAddress==[])return _e("endaddress"),void uni.$u.toast("请填写送件地址");te.value=!0;const e=await D(fe);fe.key=e.data.key,G.value=e.data.list,te.value=!1,pe.value=!1,fe.delivery_info=[]})())},{default:m((()=>[p(" 获取报价 ")])),_:1})])),_:1})):x("v-if",!0),1==te.value?(n(),_(s,{key:2,class:"flex flex-1 p-4"},{default:m((()=>[f(F,{class:"w-[100%] !h-[72rpx] leading-[72rpx] text-[26rpx] rounded-[50rpx]",style:{color:"#ffffff",backgroundColor:"#4541c7"},type:"default"},{default:m((()=>[p(" AI比价中 ")])),_:1})])),_:1})):x("v-if",!0),f(xe)])),_:1},8,["show"]),f(s,{class:"mt-[98rpx]"}),f(s,{class:"b-tabbar safe-area-inset-bottom"},{default:m((()=>[f(s,{class:"b-tabbar-back"},{default:m((()=>[J.value&&J.value.price_rule.add>0?(n(),_(s,{key:0,class:"flex text-xs font-bold p-2 text-[24rpx] bg-[#e5fffb] rounded-lg text-[#ff557f] bg-opacity-50"},{default:m((()=>[f(s,null,{default:m((()=>[p("首重:"+v(J.value.price_rule.first)+"元/"+v(J.value.price_rule.start)+"kg",1)])),_:1}),f(s,{class:"ml-2"},{default:m((()=>[p("续重:"+v(J.value.price_rule.add)+"元/kg",1)])),_:1})])),_:1})):x("v-if",!0),f(s,{class:"fb items-center pl-2 pr-2 pb-2 pt-2"},{default:m((()=>[f(s,{class:""},{default:m((()=>[f(s,{class:"flex"},{default:m((()=>[f(s,{class:"text-xs"},{default:m((()=>[p(" 快递： ")])),_:1}),f(s,{class:"text-xs font-bold tk-sltext"},{default:m((()=>[p(v(J.value?J.value.channelName:"请选择快递"),1)])),_:1})])),_:1}),f(s,{class:"flex items-center"},{default:m((()=>[f(s,{class:"text-xs"},{default:m((()=>[p("快递费：")])),_:1}),f(s,{class:"font-bold"},{default:m((()=>[p(v(J.value?J.value.showPrice+"元":"请先选择快递"),1)])),_:1})])),_:1})])),_:1}),f(l,{class:"tt-bbut text-center",onClick:a[14]||(a[14]=e=>(async()=>{var e;if(""==fe.goods)return pe.value=!0,void uni.$u.toast("请填写物品名称");if(fe.startAddress==[])return _e("startaddress"),void uni.$u.toast("请填写取件地址");if(fe.endAddress==[])return _e("endaddress"),void uni.$u.toast("请填写送件地址");if(null==G.value)return void uni.$u.toast("请完善信息再获取报价");if(null==J.value)return void uni.$u.toast("请选择发货渠道");if(0==ee.value)return void uni.$u.toast("请先阅读并同意协议");const t=await M(fe);fe.delivery_info=[],J.value=null,G.value=null,Z.value=!0,null==(e=X.value)||e.open(t.data.trade_type,t.data.trade_id,"/addon/tk_jhkd/pages/orderlist")})())},{default:m((()=>[p("立即下单")])),_:1})])),_:1})])),_:1}),f(xe)])),_:1}),f(F,{onClick:a[15]||(a[15]=e=>ie()),class:"fixed bottom-48 right-4 z-50 rounded-full p-2 text-white hover:bg-blue-700"},{default:m((()=>[f(d,{name:"share",color:"#000000",size:"24"})])),_:1}),f(be,{ref_key:"sharePosterRef",ref:de,posterType:"tk_jhkd_poster",posterId:ue.value,posterParam:k(oe),copyUrlParam:k(re)},null,8,["posterId","posterParam","copyUrlParam"]),f(ke,{ref_key:"payRef",ref:X,onClose:a[16]||(a[16]=e=>Z.value=!1)},null,512)],64)}}}),[["__scopeId","data-v-80cef336"]]);export{F as default};
