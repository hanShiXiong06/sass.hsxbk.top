import{d as e,r as t,j as r,a,o as l,c as s,w as o,u as i,b as d,x as n,y as u,E as x,F as p,G as m,f as c,n as f,bB as _,I as b,i as h,g as v,h as g,C as y,t as k,V as w,H as j,c1 as C}from"./index-e6ce9fbf.js";import{_ as z}from"./u-icon.c5d9cd81.js";import{_ as F,a as S}from"./u-steps.fa645337.js";import{_ as B}from"./u--image.2a363e1d.js";import{_ as I}from"./u-form.f2229701.js";import{_ as P}from"./u--form.134798dd.js";import{_ as T}from"./u-button.7a41d301.js";import{_ as A}from"./u-code-input.efce0104.js";import{_ as D}from"./u-modal.a2c072b7.js";import{_ as H}from"./u-loading-page.76c2d95f.js";import{c as O,b as V,T as L,f as M,d as N}from"./o2o.dee1bb7a.js";import{c as W}from"./technician.da0e3750.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-text.9aefeac5.js";import"./u-image.c9386d77.js";import"./u-transition.6919b33f.js";import"./u-line.ebbd60c6.js";import"./u-loading-icon.39fd4711.js";import"./u-popup.b16d6e1d.js";import"./u-safe-bottom.1ba5bfba.js";const G=E(e({__name:"detail",setup(e){let E=t({}),G=t(!1),R=t("");r((e=>{R.value=e.order_id,q()}));const q=()=>{W().then((e=>{Object.keys(e.data).length?J(R.value):a({url:"/addon/o2o/pages/index",mode:"reLaunch"})}))},J=e=>{G.value=!0,O(e).then((e=>{E.value=e.data,G.value=!1,re()})).catch((()=>{G.value=!1}))},K=()=>{O(R.value).then((e=>{E.value=e.data,re()})).catch((()=>{}))},Q=e=>{C({title:"提示",content:"您确定要转单吗？",success:t=>{t.confirm&&L({order_id:e.order_id}).then((e=>{a({url:"/addon/o2o/pages/master/task/list"})}))}})},U=t(!1),X=t(""),Y=e=>{X.value=e},Z=()=>{if(""==X.value)return void b({title:"请输入校验码",icon:"none",duration:1e3});let e={order_id:R.value,check_code:X.value};V(e).then((e=>{U.value=!1,J(R.value)})).catch((()=>{}))},$=e=>{M({order_id:e.order_id}).then((e=>{J(R.value)}))};function ee(e){var t=new Date(e).getTime();if(null!=t&&""!=t&&t>0){var r=new Date;r.setTime(t);var a=r.getMonth()+1;a=a<10?"0"+a:a;var l=r.getDate();l=l<10?"0"+l:l;var s=r.getHours();s=s<10?"0"+s:s;var o=r.getMinutes();return a+"-"+l+" "+s+":"+(o=o<10?"0"+o:o)}return""}let te=t(0);function re(){return"dispatch"==E.value.order_status_info.status?te.value=0:"wait_service"==E.value.order_status_info.status?te.value=1:"in_service"==E.value.order_status_info.status?te.value=2:"finish"==E.value.order_status_info.status?te.value=3:void 0}return(e,t)=>{const r=h,b=v(g("u-icon"),z),O=y,V=v(g("u-steps-item"),F),L=v(g("u-steps"),S),M=v(g("u--image"),B),W=v(g("u-form-item"),I),q=v(g("u--form"),P),X=v(g("u-button"),T),re=v(g("u-code-input"),A),ae=v(g("u-modal"),D),le=v(g("u-loading-page"),H);return l(),s(r,{style:f(e.themeColor())},{default:o((()=>[!i(G)&&Object.keys(i(E)).length?(l(),s(r,{key:0,class:"bg-[#f8f8f8] min-h-screen overflow-hidden"},{default:o((()=>[d(r,{class:"bg-linear h-[742rpx] pt-3"}),d(r,{class:"bg-[#fff] mx-3 py-4 px-3 rounded-md -mt-[740rpx]"},{default:o((()=>[d(r,{class:"flex"},{default:o((()=>[d(r,{class:"min-w-[50rpx] flex items-center justify-center"},{default:o((()=>[d(b,{name:"map",size:"20"})])),_:1}),d(r,{class:"flex flex-col ml-[20rpx]"},{default:o((()=>[d(O,{class:"text-[24rpx] mt-[10rpx] leading-[35rpx]"},{default:o((()=>[n(u(i(E).taker_full_address),1)])),_:1}),d(r,null,{default:o((()=>[d(O,{class:"text-[24rpx]"},{default:o((()=>[n(u(i(E).taker_name),1)])),_:1}),d(O,{class:"text-[24rpx] mt-[15rpx]"},{default:o((()=>[n(u(i(E).taker_mobile),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),d(r,{class:"flex py-4 px-3 bg-white rounded-md box-border mx-3 mt-[20rpx] task-steps"},{default:o((()=>[d(L,{current:i(te),activeColor:"var(--primary-color)"},{default:o((()=>[d(V,{title:i(k)("placeOrder"),desc:i(E).create_time?ee(i(E).create_time):"---"},null,8,["title","desc"]),d(V,{title:i(k)("takeOrders"),desc:i(E).dispatch_time?ee(i(E).dispatch_time):"---"},null,8,["title","desc"]),d(V,{title:i(k)("start"),desc:i(E).service_time?ee(i(E).service_time):"---"},null,8,["title","desc"]),d(V,{title:i(k)("finish"),desc:i(E).finish_time?ee(i(E).finish_time):"---"},null,8,["title","desc"])])),_:1},8,["current"])])),_:1}),d(r,{class:"bg-white py-4 px-3 rounded-md box-border mx-3 mt-[20rpx]"},{default:o((()=>[d(r,{class:"flex justify-between items-center pb-3 border-0 border-b-1 border-solid border-[#F0F0F0] mb-3 text-[26rpx] text-[#666]"},{default:o((()=>[d(O,null,{default:o((()=>[n(u(i(k)("serviceDate"))+u(i(E).reserve_service_time),1)])),_:1}),d(O,{class:"text-[var(--primary-color)]"},{default:o((()=>[n(u(i(E).order_status_info.name),1)])),_:1})])),_:1}),(l(!0),x(m,null,p(i(E).item,((e,t)=>(l(),x(m,{key:t},["buy"==e.item_type||"reservation"==e.item_type?(l(),s(r,{key:0},{default:o((()=>[d(r,{class:"flex items-center border-0"},{default:o((()=>[d(r,{class:"w-[124rpx] h-[124rpx] shrink-0"},{default:o((()=>[d(M,{class:"rounded-[10rpx] overflow-hidden",width:"124rpx",height:"124rpx",src:i(w)(e.item_image?e.item_image:""),model:"aspectFill"},{error:o((()=>[d(b,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024),d(r,{class:"flex-1 flex flex-col ml-[20rpx]"},{default:o((()=>[d(r,null,{default:o((()=>[d(O,{class:"text-[28rpx] text-item leading-[40rpx]"},{default:o((()=>[n(u(e.item_name),1)])),_:2},1024)])),_:2},1024),d(r,{class:"text-[24rpx] mt-[14rpx] flex"},{default:o((()=>[d(O,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:o((()=>[n(u(e.item_type_name),1)])),_:2},1024)])),_:2},1024),d(r,{class:"text-[28rpx] mt-[14rpx] flex justify-between"},{default:o((()=>[d(O,{class:"text-[var(--price-text-color)] price-font"},{default:o((()=>[n("￥"+u(e.price),1)])),_:2},1024),d(O,{class:"text-[22rpx] ml-[20rpx]"},{default:o((()=>[n("x"+u(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(r,{class:"flex justify-end self-end w-[100%] mt-[10rpx]"},{default:o((()=>[e.refund_no&&""!=e.refund_status&&"cancel"!=e.refund_status?(l(),s(r,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>i(a)({url:"/addon/o2o/pages/master/task/refund",param:{refund_no:e.refund_no}})},{default:o((()=>[n(u(i(k)("viewRefund")),1)])),_:2},1032,["onClick"])):c("v-if",!0)])),_:2},1024)])),_:2},1024)):c("v-if",!0)],64)))),128))])),_:1}),i(E).item.length>1?(l(),s(r,{key:0,class:"bg-white py-4 px-3 rounded-md box-border mx-3 mt-[20rpx]"},{default:o((()=>[d(r,{class:"pb-3 border-0 border-b-1 border-solid border-[#F0F0F0] mb-3 text-[26rpx] text-[#666]"},{default:o((()=>[d(O,null,{default:o((()=>[n(u(i(k)("addServiceItem")),1)])),_:1})])),_:1}),(l(!0),x(m,null,p(i(E).item,((e,t)=>(l(),x(m,{key:t},["custom"==e.item_type?(l(),s(r,{key:0,class:j({"mt-[20rpx]":t})},{default:o((()=>[d(r,{class:"flex items-center"},{default:o((()=>[d(r,{class:"w-[124rpx] h-[124rpx] shrink-0"},{default:o((()=>[d(M,{class:"rounded-[10rpx] overflow-hidden",width:"124rpx",height:"124rpx",src:i(w)(e.item_image?e.item_image:""),model:"aspectFill"},{error:o((()=>[d(b,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024),d(r,{class:"flex-1 flex flex-col ml-[20rpx]"},{default:o((()=>[d(r,{class:"flex justify-between"},{default:o((()=>[d(O,{class:"max-h-[80rpx] w-[420rpx] text-[28rpx] leading-[40rpx] multi-hidden"},{default:o((()=>[n(u(e.item_name),1)])),_:2},1024),d(O,{class:"shrink-0 ml-[10rpx] text-[24rpx] leading-[40rpx] text-[var(--primary-color)]"},{default:o((()=>[n(u(e.pay_time?i(k)("havePaid"):i(k)("notPaid")),1)])),_:2},1024)])),_:2},1024),d(r,{class:"text-[24rpx] mt-[14rpx] flex"},{default:o((()=>[d(O,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:o((()=>[n(u(e.item_type_name),1)])),_:2},1024)])),_:2},1024),d(r,{class:"text-[28rpx] mt-[14rpx] flex justify-between"},{default:o((()=>[d(O,{class:"text-[var(--price-text-color)] price-font"},{default:o((()=>[n("￥"+u(e.price),1)])),_:2},1024),d(O,{class:"text-[22rpx] ml-[20rpx]"},{default:o((()=>[n("x"+u(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(r,{class:"flex justify-end mt-[10rpx]"},{default:o((()=>[d(r,{class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{var r;a({url:"/addon/o2o/pages/master/task/show",param:{order_id:(r=e).order_id,order_item_id:r.order_item_id,item_name:r.item_name,price:r.item_money,item_images:r.item_images}})}},{default:o((()=>[n(u(i(k)("show")),1)])),_:2},1032,["onClick"]),e.pay_time?c("v-if",!0):(l(),s(r,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{var r;a({url:"/addon/o2o/pages/master/task/add",param:{order_id:(r=e).order_id,order_item_id:r.order_item_id,item_name:r.item_name,price:r.item_money,item_images:r.item_images}})}},{default:o((()=>[n(u(i(k)("edit")),1)])),_:2},1032,["onClick"])),e.pay_time?c("v-if",!0):(l(),s(r,{key:1,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{return r=e,void C({title:"提示",content:"您确定要删除该服务项吗？",success:e=>{e.confirm&&N(r.order_item_id).then((e=>{J(R.value)}))}});var r}},{default:o((()=>[n(u(i(k)("delete")),1)])),_:2},1032,["onClick"]))])),_:2},1024)])),_:2},1032,["class"])):c("v-if",!0)],64)))),128))])),_:1})):c("v-if",!0),d(r,{class:"mt-3 bg-white mx-3 px-3 py-4 rounded-md"},{default:o((()=>[d(r,{class:"text-[#1A2336] text-[28rpx] font-bold mb-4"},{default:o((()=>[n(u(i(k)("orderInfo")),1)])),_:1}),d(q,{labelPosition:"left",ref:"form1",labelWidth:"90",borderBottom:"false",labelStyle:{color:"#A3A3A3",fontSize:"14px"}},{default:o((()=>[d(W,{label:i(k)("orderNo"),borderBottom:!1},{default:o((()=>[d(r,{class:"border-style w-full !border-0 flex justify-between items-end"},{default:o((()=>[d(O,null,{default:o((()=>[n(u(i(E).order_no),1)])),_:1})])),_:1})])),_:1},8,["label"]),d(W,{label:i(k)("person"),prop:"userInfo.name",borderBottom:!1},{default:o((()=>[d(r,{class:"border-style"},{default:o((()=>[n(u(i(E).taker_name),1)])),_:1})])),_:1},8,["label"]),d(W,{label:i(k)("personTel"),borderBottom:!1},{default:o((()=>[d(r,{class:"border-style"},{default:o((()=>[n(u(i(E).taker_mobile),1)])),_:1})])),_:1},8,["label"]),d(W,{label:i(k)("remark"),borderBottom:!1},{default:o((()=>[d(r,{class:"border-style"},{default:o((()=>[n(u(i(E).member_message?i(E).member_message:"无"),1)])),_:1})])),_:1},8,["label"])])),_:1},512)])),_:1}),d(r,{class:"h-[160rpx] w-full"}),d(r,{class:"flex justify-end items-center bg-white px-3 py-1 fixed left-0 right-0 bottom-0 z-10"},{default:o((()=>[d(r,{class:"flex flex-col items-center justify-center w-[110rpx] mr-auto",onClick:t[0]||(t[0]=e=>{a({url:"/addon/o2o/pages/index",mode:"reLaunch"})})},{default:o((()=>[d(O,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[36rpx] text-[#333]"}),d(O,{class:"text-xs mt-[2rpx] font-scale"},{default:o((()=>[n(u(i(k)("index")),1)])),_:1})])),_:1}),d(r,{class:"flex flex-wrap justify-end"},{default:o((()=>[d(X,{text:i(k)("contact"),customStyle:{border:"solid 3rpx #999",width:"170rpx",height:"64rpx",lineHeight:"64rpx",fontSize:"26rpx",margin:"16px 0 16px 24rpx"},shape:"circle",onClick:t[1]||(t[1]=e=>{return t=i(E).taker_mobile,void _({phoneNumber:t});var t})},null,8,["text"]),(l(!0),x(m,null,p(i(E).order_status_info.technician_action,((e,t)=>(l(),s(X,{key:t,text:e.name,onClick:t=>{return r=i(E),void("transfer_order"==(l=e.key)?Q(r):"start"==l?U.value=!0:"finish"==l?$(r):"service_pay"==l&&a({url:"/addon/o2o/pages/master/task/add",param:{order_id:r.order_id}}));var r,l},shape:"circle",customStyle:{border:"solid 3rpx #999",width:"170rpx",height:"64rpx",lineHeight:"64rpx",fontSize:"26rpx",margin:"16px 0 16px 24rpx"}},null,8,["text","onClick"])))),128))])),_:1})])),_:1}),c(" 刷新 "),d(r,{class:"fixed bottom-[160rpx] right-[20rpx] rounded-full bg-[#fff] w-[80rpx] h-[80rpx] flex flex-col items-center justify-center shadow-xl",onClick:K},{default:o((()=>[d(O,{class:"nc-iconfont nc-icon-shuaxinV6xx text-[36rpx]"}),d(O,{class:"text-[22rpx] mt-[6rpx]"},{default:o((()=>[n(u(i(k)("refresh")),1)])),_:1})])),_:1})])),_:1})):c("v-if",!0),d(ae,{show:U.value,showCancelButton:"true",onCancel:t[2]||(t[2]=e=>U.value=!1),onConfirm:Z,width:"500rpx"},{default:o((()=>[d(q,{labelPosition:"left",class:"!w-[100%]",labelWidth:"100rpx"},{default:o((()=>[d(W,{label:i(k)("checkCode")},{default:o((()=>[d(re,{maxlength:4,focus:!0,size:"50rpx",fontSize:"32rpx",onFinish:Y})])),_:1},8,["label"])])),_:1})])),_:1},8,["show"]),d(le,{"bg-color":"rgb(248,248,248)",loading:i(G),fontSize:"16",color:"#333"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-44b1c35d"]]);export{G as default};
