import{d as e,j as l,o as a,c as r,w as t,O as o,a6 as u,u as s,P as i,b as d,y as m,z as n,f as p,t as c,au as _,g as f,h as x,i as g,Q as v,E as b,A as h,D as y,r as j,p as V,K as S,n as w,a as C,F as k}from"./index-2882a2d8.js";import{_ as I}from"./u-input.6410b5d0.js";import{_ as A}from"./u-form-item.03ed7ff5.js";import{_ as E}from"./u-button.0ab7ff00.js";import{_ as F}from"./u-form.54744837.js";import{_ as P}from"./u-loading-page.8280c7ab.js";import{e as q,h as z}from"./o2o.50b1eac4.js";import{_ as N}from"./u-icon.1104ad2f.js";import{_ as O}from"./u--image.d52c0594.js";import{_ as R}from"./u-upload.1bc71a50.js";import{_ as T}from"./_plugin-vue_export-helper.1b428a4d.js";/* empty css                                                                */import"./u-line.d7ff94e2.js";/* empty css                                                               */import"./u-loading-icon.a37f7e61.js";/* empty css                                                                       */import"./u-transition.4448d2e5.js";import"./u-image.46ebbbc1.js";/* empty css                                                                 */const U=e({__name:"upload-img",props:{modelValue:{type:String||Array},maxCount:{type:Number,default:9},multiple:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:j}){const V=e,S=l({get:()=>V.modelValue,set(e){j("update:modelValue",e)}}),w=l((()=>V.maxCount)),C=e=>{V.multiple?e.file.forEach((e=>{k({file:e})})):k(e)},k=e=>{var l;if((null==(l=S.value)?void 0:l.length)>=w.value)return c({title:`最多允许上传${w.value}张图片`,icon:"none"}),!1;_({filePath:e.file.url,name:"file"}).then((e=>{var l;(null==(l=S.value)?void 0:l.length)<w.value&&S.value.push(e.data.url)})).catch((()=>{}))};return(e,l)=>{const c=f(x("u-icon"),N),_=f(x("u--image"),O),j=y,k=g,I=f(x("u-upload"),R);return a(),r(k,{class:"flex flex-wrap"},{default:t((()=>[(a(!0),o(i,null,u(s(S),((e,l)=>(a(),r(k,{class:v(["mb-[18rpx] relative",(l+1)%3==0?"":"mr-[18rpx]"])},{default:t((()=>[d(_,{class:"rounded-[10rpx] overflow-hidden",width:"168rpx",height:"168rpx",src:s(b)(e||""),model:"aspectFill"},{error:t((()=>[d(c,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"]),d(j,{class:"nc-iconfont nc-icon-guanbiV6xx text-[32rpx] absolute top-0 right-[0rpx] text-[#fff] bg-[#888] rounded-bl-[16rpx]",onClick:h((e=>(e=>{S.value.splice(e,1)})(l)),["stop"])},null,8,["onClick"])])),_:2},1032,["class"])))),256)),s(S).length<s(w)?(a(),r(k,{key:0,class:"w-[168rpx] h-[168rpx]"},{default:t((()=>[d(I,{onAfterRead:C,maxCount:s(w),multiple:V.multiple},{default:t((()=>[d(k,{class:"flex items-center justify-center w-[168rpx] h-[168rpx] border-[2rpx] border-dashed border-[#ebebec] text-center text-[#888]"},{default:t((()=>[d(k,null,{default:t((()=>[d(k,{class:"nc-iconfont nc-icon-xiangjiV6xx text-[50rpx]"}),d(k,{class:"text-[24rpx] mt-[10rpx]"},{default:t((()=>[m(n(s(S).length)+"/"+n(s(w)),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["maxCount","multiple"])])),_:1})):p("v-if",!0)])),_:1})}}}),$=T(e({__name:"add",setup(e){const l=j(!1),o=j({order_id:"",order_item_id:"",item_name:"",price:0,images:[],item_images:""});V((e=>{Object.keys(o.value).forEach((l=>{if(null!=e[l]&&(o.value[l]=e[l]),"images"==l){o.value[l]=[];let a=e.item_images?e.item_images:null;o.value[l]=a?e.item_images.split(","):[]}}))}));const u=j(null),i=S({item_name:[{required:!0,message:"请输入服务项目",trigger:"blur"}],price:[{required:!0,validator:(e,l,a)=>{""===l||null==l?a(new Error("请输入价格")):Number(l)<=0?a(new Error("价格需大于0")):a()},trigger:"blur"}]});return(e,p)=>{const c=g,_=f(x("u-input"),I),v=f(x("u-form-item"),A),b=y,h=f(x("u-button"),E),j=f(x("u-form"),F),V=f(x("u-loading-page"),P);return a(),r(c,{class:"bg-[#F5F6FA] min-h-screen overflow-hidden",style:w(e.themeColor())},{default:t((()=>[d(c,{class:"mx-[30rpx] my-[20rpx] bg-[#fff] rounded-[16rpx]"},{default:t((()=>[d(c,{class:"text-[34rpx] p-[36rpx] border"},{default:t((()=>[m(n(o.value.order_item_id?s(k)("editServiceItem"):s(k)("addServiceItem")),1)])),_:1}),d(j,{labelPosition:"left",model:o.value,errorType:"toast",rules:i,ref_key:"serviceRef",ref:u,labelWidth:100,class:"px-[30rpx]",labelStyle:{paddingLeft:"30rpx",fontSize:"28rpx"}},{default:t((()=>[d(v,{label:s(k)("serviceItem"),prop:"item_name",required:""},{default:t((()=>[d(_,{modelValue:o.value.item_name,"onUpdate:modelValue":p[0]||(p[0]=e=>o.value.item_name=e),modelModifiers:{trim:!0},border:"surround",clearable:"",placeholder:s(k)("serviceItemPlaceholder"),maxlength:"50"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),d(v,{label:s(k)("price"),prop:"price",required:""},{default:t((()=>[d(_,{modelValue:o.value.price,"onUpdate:modelValue":p[1]||(p[1]=e=>o.value.price=e),border:"surround",clearable:"",placeholder:s(k)("pricePlaceholder"),type:"number",maxlength:"6"},{suffix:t((()=>[d(b,null,{default:t((()=>[m(n(s(k)("yuan")),1)])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"]),d(v,{label:s(k)("serviceImg"),prop:"images",class:"form-images"},{default:t((()=>[d(c,{class:"px-[30rpx]"},{default:t((()=>[d(U,{class:"mt-[20rpx]",modelValue:o.value.images,"onUpdate:modelValue":p[2]||(p[2]=e=>o.value.images=e),"max-count":6,multiple:!1},null,8,["modelValue"])])),_:1})])),_:1},8,["label"]),d(v,{class:"mt-[30rpx]"},{default:t((()=>[d(h,{text:s(k)("save"),onClick:p[3]||(p[3]=e=>(async()=>{u.value.validate().then((()=>{if(l.value)return;l.value=!0;const e=JSON.parse(JSON.stringify(o.value));e.item_images=e.images.toString(),(o.value.order_item_id?q:z)(e).then((e=>{l.value=!1,C({url:"/addon/o2o/pages/master/task/detail",param:{order_id:o.value.order_id}})})).catch((()=>{l.value=!1}))}))})()),customStyle:{borderRadius:"38rpx",color:"#fff",margin:"30rpx 0",backgroundColor:"var(--primary-color)"}},null,8,["text","customStyle"])])),_:1})])),_:1},8,["model","rules"])])),_:1}),d(V,{"bg-color":"rgb(248,248,248)",loading:l.value,fontSize:"14",color:"#333",loadingText:s(k)("loading")},null,8,["loading","loadingText"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-a11dfb8e"]]);export{$ as default};
