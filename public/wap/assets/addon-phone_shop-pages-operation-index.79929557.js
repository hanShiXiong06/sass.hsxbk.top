import{d as e,r as t,a7 as a,G as l,H as s,U as r,V as o,a as n,o as u,c as p,w as c,b as x,u as i,f as d,e as f,v as m,y as _,L as g,I as v,J as h,K as b,n as y,aS as k,bX as w,i as j,Q as C,D as S,a1 as V,g as F,h as I,l as z,z as U}from"./index-d8a8f699.js";import{_ as E}from"./u-loading-page.c740ef13.js";import{_ as X}from"./u-button.aa0eb212.js";import{_ as Z}from"./u-popup.0d48946e.js";import{g as D}from"./verify.577b693a.js";import{c as H,o as K}from"./goods.0e06a97b.js";import{_ as L}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.6808ae8c.js";import"./u-transition.db07fff7.js";import"./u-icon.5ba98c98.js";import"./u-safe-bottom.a4431b09.js";const Q=L(e({__name:"index",setup(e){const L=t("manualInput"),Q=t(!1),Y=t([]);L.value="manualInput";const A=t(!1),G=t(""),J=t(!0);a((()=>{l()&&O()}));const O=()=>{D().then((e=>{e.data?J.value=!1:(s({title:"非操作员无此权限",icon:"none"}),setTimeout((()=>{r().length>1?o({delta:1}):n({url:"/app/pages/member/index",mode:"reLaunch"})}),1e3))}))},R=()=>{k()&&(w.init(),w.scanQRCode((e=>{if(e.resultStr){let t=e.resultStr;H({sku_no:t,status:"all"}).then((e=>{Y.value=e.data.data,Q.value=!0,T=!1}))}})))};let T=!1;const W=()=>/[\S]+/.test(G.value)?!T&&(T=!0,void H({sku_no:G.value,status:"all"}).then((e=>{console.log(e),Y.value=e.data.data,Q.value=!0,T=!1}))):(s({title:"请输入核销码",icon:"none"}),!1),$=()=>{A.value=!A.value},q=()=>{Q.value=!1},B=()=>{Q.value=!0},M=e=>{K(e).then((e=>{console.log(e),1==e.code&&s({title:"操作成功",icon:"none"}),Q.value=!1}))},N=e=>{"sweepCode"!=e||k()?L.value=e:s({title:"H5端不支持扫码核销",icon:"none"})},P=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&l()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,parseFloat(t)};return(e,t)=>{const a=j,l=C,s=S,r=V,o=F(I("u-loading-page"),E),k=F(I("up-button"),X),w=F(I("up-popup"),Z);return u(),p(a,{style:y(e.themeColor())},{default:c((()=>[J.value?d("v-if",!0):(u(),p(a,{key:0,class:"w-[100vw] min-h-[100vh] bg-[#f8f8f8]"},{default:c((()=>[x(a,{class:"w-full bg-[#fff] verify-box h-[760rpx]"},{default:c((()=>[x(a,{class:"text-[var(--primary-color)] fixed top-[40rpx] right-[30rpx] flex items-center",onClick:t[0]||(t[0]=e=>i(n)({url:"/app/pages/verify/record"}))},{default:c((()=>[d(' <image class="w-[26rpx] h-[28rpx]" :src="img(\'static/resource/images/verify/history.png\')" /> '),d(' <text class="text-[26rpx] ml-[10rpx]">核销记录</text> ')])),_:1}),f(x(a,{class:"flex flex-col items-center justify-center"},{default:c((()=>[x(a,{class:"sweep-code flex items-center justify-center",onClick:R},{default:c((()=>[x(l,{class:"w-[354rpx] h-[354rpx]",src:i(z)("static/resource/images/verify/saoma.png")},null,8,["src"])])),_:1}),x(a,{class:"mt-[40rpx] text-[32rpx]"},{default:c((()=>[_("点击扫描二维码")])),_:1}),x(a,{class:"mt-[20rpx] text-[#8288A2] text-[26rpx] font-400 pb-[142rpx]"},{default:c((()=>[_("扫描二维码进行查找设备")])),_:1})])),_:1},512),[[m,"sweepCode"==L.value]]),f(x(a,null,{default:c((()=>[x(a,{class:"flex pt-[126rpx] items-center justify-center"},{default:c((()=>[x(a,{class:"flex justify-center items-center flex-col pr-[30rpx] w-[130rpx]"},{default:c((()=>[x(l,{class:"w-[100rpx] h-[100rpx]",src:i(z)("static/resource/images/verify/shuruhexiaoma.png")},null,8,["src"]),x(a,{class:"text-[26rpx] h-[36rpx] leading-[36rpx] mt-[12rpx]"},{default:c((()=>[_("操作设备")])),_:1})])),_:1}),x(l,{class:"w-[74rpx] h-[12rpx] mb-[50rpx]",src:i(z)("static/resource/images/verify/youjiantou.png")},null,8,["src"]),x(a,{class:"flex justify-center items-center flex-col pl-[30rpx] w-[130rpx]"},{default:c((()=>[x(l,{class:"w-[100rpx] h-[100rpx]",src:i(z)("static/resource/images/verify/hexiao1.png")},null,8,["src"]),x(a,{class:"text-[26rpx] h-[36rpx] leading-[36rpx] mt-[12rpx]"},{default:c((()=>[_("上/下架")])),_:1})])),_:1})])),_:1}),x(a,{class:"mt-[50rpx]"},{default:c((()=>[x(a,{class:"h-[90rpx] border-[2rpx] border-solid border-[#DCE0EF] rounded-[16rpx] box-border p-[20rpx] mx-[60rpx] flex items-center"},{default:c((()=>[x(s,{class:"nc-iconfont nc-icon-saotiaoxingmaV6xx text-[44rpx] text-[#EF000C]"}),x(r,{type:"text",placeholder:"请输入设备sn号",class:"h-[90rpx] border-none text-start ml-[30rpx] text-[28rpx] flex-1","placeholder-class":"_placeholder",modelValue:G.value,"onUpdate:modelValue":t[1]||(t[1]=e=>G.value=e),focus:A.value,ref:"input"},null,8,["modelValue","focus"])])),_:1}),x(a,{class:"h-[88rpx] min-w-[630rpx] text-[#fff] flex items-center justify-center !text-[32rpx] save-btn rounded-[50rpx] h-[88rpx] mx-[60rpx] mt-[146rpx] relative z-1",onClick:W},{default:c((()=>[_("确认")])),_:1})])),_:1})])),_:1},512),[[m,"manualInput"==L.value]])])),_:1}),x(a,{class:"w-[630rpx] h-[100rpx] bg-[#fff] mx-[auto] mt-[220rpx] rounded-[90rpx] flex relative action-type-wrap"},{default:c((()=>[x(a,{class:g(["relative w-[51%] pr-[50rpx] box-border rounded-[50rpx] z-0 flex flex-col items-center justify-center",{xuanZhong1:"sweepCode"==L.value}]),onClick:t[2]||(t[2]=e=>N("sweepCode"))},{default:c((()=>[x(s,{class:"nc-iconfont nc-icon-saoyisaoV6xx !text-[40rpx]"}),x(a,{class:"text-[24rpx] leading-[1] mt-[10rpx]"},{default:c((()=>[_("扫码操作")])),_:1})])),_:1},8,["class"]),x(a,{class:"flex flex-col items-center flex-col w-[120rpx] h-[120rpx] bg-[#FF7354] rounded-[50%] absolute top-[-10rpx] left-[255rpx] heXiao text-white z-10 shrink-0"},{default:c((()=>[x(a,{class:"nc-iconfont nc-icon-saotiaoxingmaV6xx ns-gradient-otherpages-member-balance-balance-rechange !text-[44rpx] mt-[19rpx]"}),x(a,{class:"text-[24rpx] mt-[8rpx] leading-[34rpx] h-[34rpx]"},{default:c((()=>[_("操作台")])),_:1})])),_:1}),x(a,{class:g(["relative w-[51%] pl-[50rpx] box-border rounded-[50rpx] z-0 flex flex-col items-center justify-center",{xuanZhong:"manualInput"==L.value}]),onClick:t[3]||(t[3]=e=>N("manualInput"))},{default:c((()=>[x(s,{class:"iconfont iconVector-77 !text-[40rpx]"}),x(a,{class:"ml-[20rpx] text-[24rpx] leading-[1] mt-[10rpx]",onClick:$},{default:c((()=>[_("手动输入")])),_:1})])),_:1},8,["class"])])),_:1})])),_:1})),x(o,{loading:J.value,"loading-text":"",loadingColor:"var(--primary-color)",iconSize:"35"},null,8,["loading"]),x(w,{round:10,show:Q.value,"onUpdate:show":t[4]||(t[4]=e=>Q.value=e),mode:"center",onClose:q,onOpen:B},{default:c((()=>[x(a,{class:"up-popup-wrap"},{default:c((()=>[(u(!0),v(b,null,h(Y.value,(e=>(u(),p(a,{class:"p-2 flex justify-between m-2"},{default:c((()=>[x(a,null,{default:c((()=>[x(a,null,{default:c((()=>[_(U(e.goods_name),1)])),_:2},1024),x(a,null,{default:c((()=>[_(U(e.sub_title),1)])),_:2},1024),x(a,null,{default:c((()=>[_(" sn:"+U(e.goodsSku.sku_no),1)])),_:2},1024),x(a,null,{default:c((()=>[_("入库时间:"+U(e.create_time),1)])),_:2},1024)])),_:2},1024),x(a,null,{default:c((()=>[x(a,null,{default:c((()=>[x(s,{class:"text-[26rpx] font-500"},{default:c((()=>[_("￥")])),_:1}),x(s,{class:"text-[36rpx] font-500"},{default:c((()=>[_(U(P(e).toFixed(2).split(".")[0]),1)])),_:2},1024),x(s,{class:"text-[24rpx] font-500"},{default:c((()=>[_("."+U(P(e).toFixed(2).split(".")[1]),1)])),_:2},1024)])),_:2},1024),x(a,null,{default:c((()=>[e.status?(u(),p(k,{key:0,type:"error",onClick:t=>M(e.goods_id),text:"下架"},null,8,["onClick"])):(u(),p(k,{key:1,type:"success",onClick:t=>M(e.goods_id),text:"上架"},null,8,["onClick"]))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])),_:1},8,["show"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-dea21a90"]]);export{Q as default};
