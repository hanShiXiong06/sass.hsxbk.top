import{d as e,r as t,p as l,o as a,c as r,w as s,u as o,b as d,cd as n,y as u,z as i,f as c,W as f,U as x,V as _,ad as p,n as m,a as y,D as b,g as v,h,i as g,B as k,E as w,bx as A,cg as C,cb as B,R as E,ca as j,bX as F,c1 as D,c2 as z,aA as S,_ as W}from"./index-71c7df08.js";import{_ as H}from"./pay.6aa36878.js";import{_ as I}from"./loading-page.vue_vue_type_script_setup_true_lang.c7dc2256.js";import{C as V,D as M,E as O,F as R,A as q,B as L}from"./tourism.86990a9a.js";import"./pay.4cfa8889.js";const P=W(e({__name:"detail",setup(e){let W=t({}),P=t(!0),T=t(""),U=t(""),X=t(1),$=t(!1),G=t(0);t(null),l((e=>{U.value=e.order_id,J(U.value)}));const J=e=>{P.value=!0,V(e).then((e=>{if(W.value=e.data,X.value=W.value.order_log.length?W.value.order_log.length-1:0,T.value=e.data.order_type,e.data.refund_id&&Y(e.data.refund_id),0==W.value.order_status_info.status){const e=(new Date).getTime()/1e3;G.value=1e3*(W.value.auto_close_time-e);let t=setInterval((()=>{G.value<=0&&clearInterval(t)}),1e3)}P.value=!1})).catch((()=>{P.value=!1}))};let K=t(!1),N=t({}),Q=t(1);const Y=e=>{M(e).then((e=>{N.value=e.data,Q.value=e.data.refund_log.length?e.data.refund_log.length-1:0}))},Z=t(null),ee=(e,t="")=>{var l;"pay"==t?null==(l=Z.value)||l.open(e.order_type,e.order_id,`/addon/tourism/pages/order/detail?order_id=${e.order_id}`):"cancel"==t?(e=>{q(e).then((e=>{J(U.value)})).catch((()=>{J(U.value)}))})(e):"delete"==t?(e=>{L(e.order_id).then((e=>{y({url:"/addon/tourism/pages/order/list"})})).catch((()=>{J(U.value)}))})(e):"buy"==t?"scenic"==e.order_type?y({url:"/addon/tourism/pages/scenic/list"}):"way"==e.order_type?y({url:"/addon/tourism/pages/way/list"}):"hotel"==e.order_type&&y({url:"/addon/tourism/pages/hotel/list"}):"index"==t&&y({url:"/addon/tourism/pages/index",mode:"reLaunch"})},te=(e,t)=>{let l,a;-1!=e.indexOf("/")?l=e.split("/"):-1!=e.indexOf("-")&&(l=e.split("-"));const r=new Date(e).getDay(),s=["周日","周一","周二","周三","周四","周五","周六"];return a="yearMonthDay"==t?l[0]+"年"+l[1]+"月"+l[2]+"日":"yearMonthDayWeek"==t?l[0]+"年"+l[1]+"月"+l[2]+"日 "+s[r]:"monthDayWeek"==t?l[1]+"月"+l[2]+"日 "+s[r]:l[1]+"月"+l[2]+"日",a};return(e,t)=>{const l=b,y=v(h("u-count-down"),B),V=g,M=k,q=v(h("u-form-item"),E),L=v(h("u--form"),j),Y=v(h("u-button"),F),le=v(h("pay"),H),ae=v(h("u-steps-item"),D),re=v(h("u-steps"),z),se=v(h("u-popup"),S),oe=v(h("loading-page"),I);return a(),r(V,{style:m(e.themeColor())},{default:s((()=>[o(P)?c("v-if",!0):(a(),r(V,{key:0,class:"bg-[#f8f8f8] min-h-screen overflow-hidden"},{default:s((()=>[d(V,{class:"bg-linear h-[480rpx] text-white px-4 pt-5"},{default:s((()=>{var e;return[d(V,{class:"text-[42rpx] flex items-baseline",onClick:t[0]||(t[0]=e=>n($)?$.value=!0:$=!0)},{default:s((()=>[d(l,{class:"nc-iconfont nc-icon-a-shijianV6xx-36 text-[42rpx] mr-1"}),d(l,{class:"font-bold"},{default:s((()=>{var e,t;return[u("订单"+i(null==(t=null==(e=o(W))?void 0:e.order_status_info)?void 0:t.name),1)]})),_:1}),o(G)>0&&0==o(W).order_status_info.status?(a(),r(V,{key:0,class:"text-xs flex items-center ml-[20rpx]"},{default:s((()=>[d(l,null,{default:s((()=>[u("剩余支付时间：")])),_:1}),d(y,{time:o(G),format:"HH:mm:ss"},null,8,["time"])])),_:1})):c("v-if",!0)])),_:1}),0==(null==(e=o(W))?void 0:e.order_status_info.status)?(a(),r(V,{key:0,class:"text-xs mt-3"},{default:s((()=>{var e,t;return[u("您的订单"+i(null==(t=null==(e=o(W))?void 0:e.order_status_info)?void 0:t.name)+"，欢迎再次预订！",1)]})),_:1})):(a(),r(V,{key:1,class:"text-xs mt-3"},{default:s((()=>{var e,t;return[u("您的订单"+i(null==(t=null==(e=o(W))?void 0:e.order_status_info)?void 0:t.name)+"，欢迎再次预订！",1)]})),_:1}))]})),_:1}),d(V,{class:"bg-white mx-3 py-4 px-3 rounded-md -mt-[340rpx] box-border"},{default:s((()=>[d(V,{class:f(["flex",{"pb-4 border-0 border-b-1 border-dashed border-[#EAEAEA] mb-4":["1","10"].includes(o(W).order_status)}])},{default:s((()=>[d(M,{class:"w-[124rpx] h-[124rpx] mr-2 rounded",src:o(w)(o(W).goods_image)},null,8,["src"]),d(V,{class:"flex-1 flex flex-col"},{default:s((()=>[d(V,{class:"text-[#1A2336] text-[30rpx] truncate font-bold w-[514rpx]"},{default:s((()=>[u(i(o(W)[o(T)][o(T)+"_name"])+"【"+i(o(W).goods_name)+"】",1)])),_:1}),d(V,{class:"flex items-center text-[#7F7F85] text-xs mt-[12rpx]"},{default:s((()=>[d(l,{class:"mr-1"},{default:s((()=>[u(i(te(o(W).start_time,"yearMonthDayWeek")),1)])),_:1}),c(' <text class="mr-1">周日</text> '),d(l,null,{default:s((()=>[u("当日有效")])),_:1})])),_:1}),d(V,{class:"font-bold text-sm text-[#222] mt-auto price-font"},{default:s((()=>[u("￥"+i(o(W).order_money),1)])),_:1})])),_:1})])),_:1},8,["class"]),["1","10"].includes(o(W).order_status)?(a(),x(_,{key:0},[d(V,{class:"bg-[#F9FBFF] rounded-lg overflow-hidden mb-4"},{default:s((()=>["hotel"==o(T)?(a(),r(V,{key:0,class:"bg-[#EEF3FF] flex items-center text-sm py-3 justify-center triangle"},{default:s((()=>[u(" 请提醒商家 "),d(l,{class:"text-[#EA4B69]"},{default:s((()=>[u("【扫码核销】")])),_:1}),u(" 使用 ")])),_:1})):(a(),r(V,{key:1,class:"bg-[#EEF3FF] flex items-center text-sm py-3 justify-center triangle"},{default:s((()=>[u(" 凭 "),d(l,{class:"text-[#EA4B69]"},{default:s((()=>[u("【身份证】")])),_:1}),u(" 或 "),d(l,{class:"text-[#EA4B69]"},{default:s((()=>[u("【手机号】")])),_:1}),u(" 可直接入园 ")])),_:1})),d(V,{class:"flex flex-col items-center pb-4"},{default:s((()=>[d(M,{class:"w-[326rpx] h-[326rpx] mt-4 mb-4",src:o(W).verify_code_qrcode},null,8,["src"]),d(M,{class:"w-[524rpx] h-[128rpx] mb-3",src:o(W).verify_code_barcode},null,8,["src"]),d(V,{class:"text-[var(--text-color-light6)] text-xs"},{default:s((()=>[u("未消费前请不要将券码提供给商家")])),_:1})])),_:1})])),_:1}),d(V,null,{default:s((()=>[d(V,{class:"flex items-center justify-between"},{default:s((()=>[d(V,{class:"flex items-center"},{default:s((()=>[d(l,{class:"text-sm"},{default:s((()=>[u(i("hotel"==o(T)?"券码":"入园码")+" "+i(o(W).verify_code),1)])),_:1}),d(l,{class:"nc-iconfont nc-icon-fuzhiV6xx text-[32rpx] ml-2 text-[#636363]",onClick:t[1]||(t[1]=e=>o(A)(o(W).verify_code))})])),_:1}),d(l,{class:"text-[#696969] text-[26rpx]"},{default:s((()=>[u(i(o(W).order_status_info.name),1)])),_:1})])),_:1})])),_:1})],64)):c("v-if",!0)])),_:1}),d(V,{class:"mt-3 bg-white mx-3 px-3 py-4 rounded-md"},{default:s((()=>[d(V,{class:"text-[#1A2336] text-[30rpx] font-bold mb-4"},{default:s((()=>[u("订单信息")])),_:1}),"hotel"==o(T)?(a(),r(V,{key:0,class:"border-0 border-b-1 border-solid border-[#EAEAEA] mb-1 pb-4"},{default:s((()=>[d(V,{class:"flex items-center"},{default:s((()=>[d(V,{class:"flex flex-col items-center"},{default:s((()=>[d(l,{class:"text-[26rpx] text-[#1A2336]"},{default:s((()=>[u(i(te(o(W).start_time,"monthDayWeek")),1)])),_:1}),d(l,{class:"text-xs text-[#888] mt-1"},{default:s((()=>[u("14:00后入住")])),_:1})])),_:1}),d(V,{class:"ml-4 mr-4 relative w-[136rpx] text-center"},{default:s((()=>[d(l,{class:"text-white relative z-10 text-xs font-scale bg-[#1C283E] px-2 py-1 rounded-xl w-[90rpx] box-border break-keep"},{default:s((()=>[u("共"+i(o(W).days)+"晚",1)])),_:1}),d(l,{class:"iconfont iconzhixiang absolute left-0 right-0 text-[90rpx] top-[50%] translate-y text-[#ABABAB]"})])),_:1}),d(V,{class:"flex flex-col items-center"},{default:s((()=>[d(l,{class:"text-[26rpx] text-[#1A2336]"},{default:s((()=>[u(i(te(o(W).end_time,"monthDayWeek")),1)])),_:1}),d(l,{class:"text-xs text-[#888] mt-1"},{default:s((()=>[u("12:00前离店")])),_:1})])),_:1})])),_:1}),d(V,{class:"mt-4 text-[#1A2336] text-[26rpx] font-bold"},{default:s((()=>[u(i(o(W).hotel.hotel_name)+"（"+i(o(W).goods_name)+"） ",1)])),_:1}),d(V,{class:"mt-1 text-[#1A2336] text-[26rpx] font-bold flex items-center"},{default:s((()=>[d(l,{class:"nc-iconfont nc-icon-fengefuV6xx text-[32rpx]"}),d(l,null,{default:s((()=>[u("共"+i(o(W).num)+"间",1)])),_:1})])),_:1}),c(' <view class="mt-3 text-[#1A2336] text-[26rpx] font-bold">\r\n                        无早餐\r\n                    </view> ')])),_:1})):c("v-if",!0),d(L,{labelPosition:"left",ref:"form1",labelWidth:"90",labelStyle:{color:"#A3A3A3",fontSize:"14px"}},{default:s((()=>["hotel"==o(W).order_type?(a(!0),x(_,{key:0},p(o(W).buyer_info,((e,t)=>(a(),x(_,null,[e.name?(a(),r(q,{key:0,label:"联系人姓名",prop:"userInfo.name",borderBottom:""},{default:s((()=>[d(V,{class:"border-style"},{default:s((()=>[u(i(e.name),1)])),_:2},1024)])),_:2},1024)):c("v-if",!0),e.id_card?(a(),r(q,{key:1,label:"身份证号",borderBottom:""},{default:s((()=>[d(V,{class:"border-style"},{default:s((()=>[u(i(e.id_card),1)])),_:2},1024)])),_:2},1024)):c("v-if",!0)],64)))),256)):(a(),x(_,{key:1},[o(W).buyer_info.name?(a(),r(q,{key:0,label:"联系人姓名",prop:"userInfo.name",borderBottom:""},{default:s((()=>[d(V,{class:"border-style"},{default:s((()=>[u(i(o(W).buyer_info.name),1)])),_:1})])),_:1})):c("v-if",!0),o(W).buyer_info.id_card?(a(),r(q,{key:1,label:"身份证号",borderBottom:""},{default:s((()=>[d(V,{class:"border-style"},{default:s((()=>[u(i(o(W).buyer_info.id_card),1)])),_:1})])),_:1})):c("v-if",!0)],64)),o(W).mobile?(a(),r(q,{key:2,label:"联系电话",borderBottom:""},{default:s((()=>[d(V,{class:"border-style"},{default:s((()=>[u(i(o(W).mobile),1)])),_:1})])),_:1})):c("v-if",!0),o(W).order_no?(a(),r(q,{key:3,label:"订单编号",borderBottom:""},{default:s((()=>[d(V,{class:"border-style w-full !border-0 flex justify-between items-end"},{default:s((()=>[d(l,null,{default:s((()=>[u(i(o(W).order_no),1)])),_:1}),d(l,{class:"text-xs text-[#7D7C82]",onClick:t[2]||(t[2]=e=>o(A)(o(W).order_no))},{default:s((()=>[u("复制")])),_:1})])),_:1})])),_:1})):c("v-if",!0),o(W).create_time?(a(),r(q,{key:4,label:"下单时间",borderBottom:""},{default:s((()=>[d(V,{class:"border-style !border-0"},{default:s((()=>[u(i(o(W).create_time),1)])),_:1})])),_:1})):c("v-if",!0),o(W).pay_time?(a(),r(q,{key:5,label:"支付时间",borderBottom:""},{default:s((()=>[d(V,{class:"border-style !border-0"},{default:s((()=>[u(i(o(W).pay_time),1)])),_:1})])),_:1})):c("v-if",!0)])),_:1},512)])),_:1}),d(V,{class:"h-[160rpx] w-full"}),d(V,{class:"flex justify-end items-center bg-white px-3 py-1 fixed left-0 right-0 bottom-0 z-10"},{default:s((()=>[d(V,{class:"flex flex-col items-center justify-center mr-auto",onClick:t[3]||(t[3]=e=>ee(o(W),"index"))},{default:s((()=>[d(l,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[46rpx] text-[#333]"}),d(l,{class:"text-xs mt-[2rpx] font-scale"},{default:s((()=>[u("首页")])),_:1})])),_:1}),d(V,{class:"flex flex-wrap justify-end"},{default:s((()=>[(a(!0),x(_,null,p(o(W).order_status_info.member_action,((e,t)=>(a(),r(Y,{text:e.name,color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},type:"primary",onClick:t=>ee(o(W),e.key)},null,8,["text","onClick"])))),256)),o(W).is_enable_refund&&["","refund_refuse"].includes(o(W).refund_status)?(a(),r(Y,{key:0,text:"申请退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[4]||(t[4]=e=>(e=>{let t={order_id:e.order_id};O(t).then((e=>{J(U.value)}))})(o(W)))})):c("v-if",!0),o(W).refund_no?(a(),r(Y,{key:1,text:"查看退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[5]||(t[5]=e=>n(K)?K.value=!0:K=!0)})):c("v-if",!0),o(W).refund_no&&"wait_refund"==o(W).refund_status?(a(),r(Y,{key:2,text:"取消退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[6]||(t[6]=e=>{return t=o(W),void R(t.refund_id).then((e=>{J(U.value)}));var t})})):c("v-if",!0)])),_:1})])),_:1}),d(le,{ref_key:"payRef",ref:Z,onClose:e.payClose},null,8,["onClose"]),d(se,{show:o($),onClose:t[7]||(t[7]=e=>n($)?$.value=!1:$=!1),closeable:!0},{default:s((()=>[d(V,{class:"text-center py-[30rpx] font-bold leading-none"},{default:s((()=>[d(l,null,{default:s((()=>[u("订单进度")])),_:1})])),_:1}),d(V,{class:"px-6 pb-5 pt-2"},{default:s((()=>[d(re,{current:o(X),direction:"column"},{default:s((()=>[(a(!0),x(_,null,p(o(W).order_log,((e,t)=>(a(),r(ae,{title:e.action,desc:e.action_time,key:t},null,8,["title","desc"])))),128))])),_:1},8,["current"])])),_:1})])),_:1},8,["show"]),d(se,{show:o(K),onClose:t[8]||(t[8]=e=>n(K)?K.value=!1:K=!1),closeable:!0},{default:s((()=>[o(N).refund_log?(a(),r(V,{key:0,class:"text-center py-[30rpx] font-bold leading-none"},{default:s((()=>[d(l,null,{default:s((()=>[u("退款进度")])),_:1})])),_:1})):c("v-if",!0),d(V,{class:"px-6 pb-5 pt-2"},{default:s((()=>[d(re,{current:o(Q),direction:"column"},{default:s((()=>[(a(!0),x(_,null,p(o(N).refund_log,((e,t)=>(a(),r(ae,{title:e.action_name,desc:e.action_time,key:t},C({_:2},["refuse"==e.action?{name:"desc",fn:s((()=>[d(V,{class:"text-xs text-red"},{default:s((()=>[u("拒绝原因："+i(o(N).refuse_reason),1)])),_:1}),d(V,{class:"text-xs text-[#909193]"},{default:s((()=>[u(i(e.action_time),1)])),_:2},1024)])),key:"0"}:void 0,"completed"==e.action?{name:"desc",fn:s((()=>[d(V,{class:"text-xs text-red"},{default:s((()=>[u("退款方式：原路退款，退款金额："+i(o(N).money),1)])),_:1}),d(V,{class:"text-xs text-[#909193]"},{default:s((()=>[u(i(e.action_time),1)])),_:2},1024)])),key:"1"}:void 0]),1032,["title","desc"])))),128))])),_:1},8,["current"])])),_:1})])),_:1},8,["show"])])),_:1})),d(oe,{loading:o(P)},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-1b6be176"]]);export{P as default};
