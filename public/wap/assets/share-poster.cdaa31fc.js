import{d as a,r as e,o as t,O as s,f as l,b as o,w as p,A as r,n as u,c as n,u as c,y as i,P as d,bv as f,bw as v,E as m,B as _,i as y,D as h,C as g,g as b,h as w}from"./index-2882a2d8.js";import{_ as x}from"./u-popup.2abbe959.js";import{_ as C}from"./_plugin-vue_export-helper.1b428a4d.js";const P=C(a({__name:"share-poster",props:{posterId:{type:String||Number,default:0},posterType:{type:String,default:""},posterParam:{type:Object,default:{}},copyUrl:{type:String,default:""},copyUrlParam:{type:String,default:""}},setup(a,{expose:C}){const P=a,S=e(!1),U=()=>{let a="";a=P.copyUrl?location.origin+P.copyUrl+P.copyUrlParam:location.origin+location.pathname+P.copyUrlParam,f(a,(()=>{S.value=!1}))},j=e(!1),k=e(!1),D=e(""),T=()=>{j.value=!0,k.value=!1;let a={id:P.posterId,type:P.posterType,param:P.posterParam},e=Date.parse(new Date);v(a).then((a=>{D.value=a.data&&m(a.data)||"";let t=Date.parse(new Date)-e;t<2200?setTimeout((()=>{j.value=!1,k.value=!0}),2200-t):(j.value=!1,k.value=!0)})).catch((()=>{F()}))},O=e(!1),I=()=>{O.value=!1},z=e(0),F=()=>{S.value=!1,j.value=!1,k.value=!1};return C({openShare:()=>{S.value=!0,T()}}),(a,e)=>{const f=_,v=y,C=h,P=g,T=b(w("u-popup"),x);return t(),s(d,null,[l(" 分享弹窗 "),o(v,{onTouchmove:e[2]||(e[2]=r((()=>{}),["prevent","stop"])),class:"share-popup"},{default:p((()=>[o(T,{show:S.value,type:"bottom",onClose:F,overlayOpacity:"0.8"},{default:p((()=>[o(v,{onTouchmove:e[0]||(e[0]=r((()=>{}),["prevent","stop"]))},{default:p((()=>[o(v,{class:"poster-img-wrap",style:u({top:z.value})},{default:p((()=>[j.value?(t(),n(f,{key:0,class:"poster-animation",src:c(m)("addon/shop/poster_animation.gif"),mode:"aspectFit"},null,8,["src"])):l("v-if",!0),k.value?(t(),n(f,{key:1,class:"poster-img",src:c(m)(D.value),mode:"aspectFit"},null,8,["src"])):l("v-if",!0)])),_:1},8,["style"]),o(v,{class:"share-content"},{default:p((()=>[o(v,{class:"share-box",onClick:U},{default:p((()=>[o(P,{class:"share-btn",plain:!0},{default:p((()=>[o(v,{class:"text-[#07c160] iconfont iconfuzhilianjie"}),o(C,null,{default:p((()=>[i("复制链接")])),_:1})])),_:1})])),_:1})])),_:1}),o(v,{class:"share-footer",onClick:F},{default:p((()=>[o(C,null,{default:p((()=>[i("取消分享")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"]),o(T,{show:O.value,mode:"center",round:10,closeable:!0,onClose:e[1]||(e[1]=a=>O.value=!1),"safe-area-inset-bottom":!1},{default:p((()=>[o(v,{class:"dialog-popup"},{default:p((()=>[o(v,{class:"title"},{default:p((()=>[i("提示")])),_:1}),o(v,{class:"message"},{default:p((()=>[i("您拒绝了保存图片到相册的授权请求，无法保存图片到相册，如需正常使用，请授权之后再进行操作。")])),_:1}),o(v,{class:"action-wrap"},{default:p((()=>[o(v,{onClick:I},{default:p((()=>[i("取消")])),_:1}),o(v,null,{default:p((()=>[o(P,{type:"default",class:"authorization-btn","open-type":"openSetting",onOpensetting:I,"hover-class":"none"},{default:p((()=>[i("立即授权")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})],2112)}}}),[["__scopeId","data-v-262fc328"]]);export{P as _};
