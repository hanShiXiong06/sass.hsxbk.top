import{d as e,r as a,o as t,P as s,f as l,b as o,w as p,A as n,n as r,c as u,u as c,y as i,Q as d,be as f,bu as _,E as v,B as m,i as y,D as h,C as g,g as b,h as w}from"./index-7bf68536.js";import{_ as x}from"./u-popup.be4bfacd.js";/* empty css                                                                     */import{_ as j}from"./_plugin-vue_export-helper.1b428a4d.js";const C=j(e({__name:"share-poster",props:{posterId:{type:String||Number,default:0},posterType:{type:String,default:""},posterParam:{type:Object,default:{}},copyUrl:{type:String,default:""},copyUrlParam:{type:String,default:""}},setup(e,{expose:j}){const C=e,P=a(!1),S=()=>{let e="";if(C.copyUrl){let a=location.pathname,t=["/app/","/addon/"];for(let e=0;e<t.length;e++)-1!=a.indexOf(t[e])&&(a=a.substr(0,a.indexOf(t[e])));e=location.origin+a+C.copyUrl+C.copyUrlParam}else e=location.origin+location.pathname+C.copyUrlParam;f(e,(()=>{P.value=!1}))},U=a(!1),k=a(!1),D=a(""),O=()=>{U.value=!0,k.value=!1;let e={id:C.posterId,type:C.posterType,param:C.posterParam},a=Date.parse(new Date);_(e).then((e=>{D.value=e.data&&v(e.data)||"";let t=Date.parse(new Date)-a;t<2200?setTimeout((()=>{U.value=!1,k.value=!0}),2200-t):(U.value=!1,k.value=!0)})).catch((()=>{F()}))},T=a(!1),z=()=>{T.value=!1},I=a(0),F=()=>{P.value=!1,U.value=!1,k.value=!1};return j({openShare:()=>{P.value=!0,O()}}),(e,a)=>{const f=m,_=y,j=h,C=g,O=b(w("u-popup"),x);return t(),s(d,null,[l(" 分享弹窗 "),o(_,{onTouchmove:a[2]||(a[2]=n((()=>{}),["prevent","stop"])),class:"share-popup"},{default:p((()=>[o(O,{show:P.value,type:"bottom",onClose:F,overlayOpacity:"0.8"},{default:p((()=>[o(_,{onTouchmove:a[0]||(a[0]=n((()=>{}),["prevent","stop"]))},{default:p((()=>[o(_,{class:"poster-img-wrap",style:r({top:I.value})},{default:p((()=>[U.value?(t(),u(f,{key:0,class:"poster-animation",src:c(v)("addon/shop/poster_animation.gif"),mode:"aspectFit"},null,8,["src"])):l("v-if",!0),k.value?(t(),u(f,{key:1,class:"poster-img",src:c(v)(D.value),mode:"aspectFit","show-menu-by-longpress":!0},null,8,["src"])):l("v-if",!0)])),_:1},8,["style"]),o(_,{class:"share-content"},{default:p((()=>[o(_,{class:"share-box",onClick:S},{default:p((()=>[o(C,{class:"share-btn",plain:!0},{default:p((()=>[o(_,{class:"text-[#07c160] iconfont iconfuzhilianjie"}),o(j,null,{default:p((()=>[i("复制链接")])),_:1})])),_:1})])),_:1})])),_:1}),o(_,{class:"share-footer",onClick:F},{default:p((()=>[o(j,null,{default:p((()=>[i("取消分享")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"]),o(O,{show:T.value,mode:"center",round:10,closeable:!0,onClose:a[1]||(a[1]=e=>T.value=!1),"safe-area-inset-bottom":!1},{default:p((()=>[o(_,{class:"dialog-popup"},{default:p((()=>[o(_,{class:"title"},{default:p((()=>[i("提示")])),_:1}),o(_,{class:"message"},{default:p((()=>[i("您拒绝了保存图片到相册的授权请求，无法保存图片到相册，如需正常使用，请授权之后再进行操作。")])),_:1}),o(_,{class:"action-wrap"},{default:p((()=>[o(_,{onClick:z},{default:p((()=>[i("取消")])),_:1}),o(_,null,{default:p((()=>[o(C,{type:"default",class:"authorization-btn","open-type":"openSetting",onOpensetting:z,"hover-class":"none"},{default:p((()=>[i("立即授权")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})],2112)}}}),[["__scopeId","data-v-c390c158"]]);export{C as s};
