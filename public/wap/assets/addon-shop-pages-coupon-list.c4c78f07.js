import{d as e,r as t,m as r,l,o as a,c as o,w as s,b as p,n,u as d,x as c,E as u,F as i,G as x,f,a5 as m,a6 as _,i as b,g,h as y,V as v,H as h,y as k,_ as F,B as w,a as C,C as j}from"./index-656dc629.js";import{_ as S}from"./u-button.e2de732d.js";import{b as z,c as T}from"./coupon.a0bc913c.js";import{M as I}from"./mescroll-body.cb3f7eec.js";import{M as D}from"./mescroll-empty.966dc165.js";import{u as H}from"./useMescroll.26ccf5de.js";import{_ as M}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.5e5c27a0.js";import"./u-icon.286409fc.js";import"./mescroll-uni-option.de83ded3.js";import"./mescroll-i18n.6025c811.js";/* empty css                                                                       */const B=M(e({__name:"list",setup(e){const{mescrollInit:M,downCallback:B,getMescroll:E}=H(_,m);let R={};t({title:"优惠券列表",topStatusBar:{style:"style-1",bgColor:"transparent",textColor:"#fff"}}),r((()=>2*Number(R.height)+2*R.top+368+"rpx;"));const A=t([]),G=t(!0),L=l(),N=r((()=>L.info)),P=e=>{G.value=!0;let t={page:e.num,limit:e.size};z(t).then((t=>{let r=t.data.data.map((e=>(-1!=e.sum_count&&e.receive_count===e.sum_count?e.btnType="collected":N.value&&e.is_receive&&e.limit_count===e.member_receive_count?e.btnType="using":e.btnType="collecting",e)));1==e.num&&(A.value=[]),A.value=A.value.concat(r),e.endSuccess(r.length),G.value=!1})).catch((()=>{G.value=!1,e.endErr()}))},U=e=>{C({url:"/addon/shop/pages/coupon/detail",param:{coupon_id:e}})};return(e,t)=>{const r=b,l=j,m=g(y("u-button"),S);return a(),o(r,{class:"bg-[#F6F6F6] min-h-screen overflow-hidden",style:n(e.themeColor())},{default:s((()=>[p(r,{class:"coupon-header"},{default:s((()=>[p(r,{class:"h-[352rpx]",style:n({backgroundImage:"url("+d(v)("addon/shop/coupon/coupn_h5.png")+")",backgroundSize:"100%",backgroundRepeat:"no-repeat"})},{default:s((()=>[p(r,{class:"px-[38rpx] pt-[98rpx]"},{default:s((()=>[p(r,{class:"font-bold text-[36rpx] text-[#fff] leading-[42rpx]"},{default:s((()=>[c("领劵中心")])),_:1}),p(r,{class:"mt-[10rpx] font-400 text-[24rpx] text-[#fff] leading-[28rpx]"},{default:s((()=>[c("天天来领券，优惠看得见")])),_:1})])),_:1})])),_:1},8,["style"])])),_:1}),p(r,{class:"-mt-[74rpx] bg-[#F6F6F6] rounded-tl-[26rpx] rounded-tr-[26rpx]"},{default:s((()=>[p(I,{ref:"mescrollRef",onInit:d(M),down:{use:!1},onUp:P},{default:s((()=>[p(r,{class:"py-[30rpx] px-[30rpx]"},{default:s((()=>[(a(!0),u(x,null,i(A.value,((e,t)=>(a(),u(x,null,["collected"===e.btnType?(a(),o(r,{key:0,class:h(["flex items-center relative w-[100%] rounded-[20rpx] overflow-hidden bg-[#fff] py-[22rpx] background-size",{"mt-[20rpx]":t}]),style:n({backgroundImage:"url("+d(v)("addon/shop/coupon/coupn_loot.png")+")"}),onClick:t=>U(e.id)},{default:s((()=>[p(r,{class:"box-border flex-1 border-0 border-r-[1px] border-[#FFDCDC] border-dashed flex items-center"},{default:s((()=>[p(r,{class:"pl-[40rpx] w-[200rpx] box-border"},{default:s((()=>[p(r,{class:"price-font flex items-baseline text-[var(--primary-color)]"},{default:s((()=>[p(l,{class:"text-[36rpx] mr-[4rpx] leading-[45rpx] text-center font-500"},{default:s((()=>[c("￥")])),_:1}),p(l,{class:"text-[54rpx] font-semibold text-left leading-[70rpx] truncate"},{default:s((()=>[c(k(e.coupon_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(r,{class:"flex-1 box-border ml-[10rpx]"},{default:s((()=>[p(r,{class:"text-[30rpx] leading-[35rpx] text-left font-500"},{default:s((()=>["0.00"===e.min_condition_money?(a(),o(l,{key:0},{default:s((()=>[c("无门槛")])),_:1})):(a(),o(l,{key:1},{default:s((()=>[c("满"+k(e.coupon_min_price)+"元可用",1)])),_:2},1024))])),_:2},1024),p(r,{class:"text-[20rpx] leading-[23rpx] mt-[4px] text-left flex items-center"},{default:s((()=>[p(l,{class:"bg-[var(--primary-color)] text-[#fff] text-[20rpx] h-[28rpx] leading-[28rpx] px-[10rpx] rounded-[16rpx] mr-[6rpx] shrink-0"},{default:s((()=>[c(k(e.type_name),1)])),_:2},1024),p(l,{class:"truncate max-w-[190rpx]"},{default:s((()=>[c(k(e.title),1)])),_:2},1024)])),_:2},1024),p(r,{class:"w-[100%] mt-[4px] text-[20rpx] leading-[23rpx]"},{default:s((()=>[1==e.valid_type?(a(),o(l,{key:0},{default:s((()=>[c("领取之日起"+k(e.length||"")+"天内有效",1)])),_:2},1024)):(a(),o(l,{key:1},{default:s((()=>[c(" 有效期至"+k(e.valid_end_time?e.valid_end_time.slice(0,10):""),1)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1024),p(r,{class:"pr-[20rpx] pl-[30rpx]"},{default:s((()=>[p(m,{text:"已领完",customStyle:{width:"150rpx",height:"60rpx",color:"#fff",fontSize:"24rpx",lineHeight:"60rpx",padding:"0",backgroundColor:"var(--primary-color)",opacity:"0.6",border:"none"},shape:"circle",disabled:""},null,8,["customStyle"])])),_:1}),p(r,{class:"absolute top-0 right-[190rpx] h-[10rpx] w-[20rpx] rounded-br-[20rpx] rounded-bl-[20rpx] bg-[#F6F6F6]"}),p(r,{class:"absolute bottom-0 right-[190rpx] h-[10rpx] w-[20rpx] rounded-tr-[20rpx] rounded-tl-[20rpx] bg-[#F6F6F6]"})])),_:2},1032,["class","style","onClick"])):(a(),o(r,{key:1,class:h(["flex items-center relative w-[100%] rounded-[20rpx] overflow-hidden bg-[#fff] py-[22rpx] background-size",{"mt-[20rpx]":t}]),onClick:t=>U(e.id),style:n({backgroundImage:"using"===e.btnType?"url("+d(v)("addon/shop/coupon/coupn_bg.png")+")":"none"})},{default:s((()=>[p(r,{class:"relative box-border flex-1 border-0 border-r-[1px] border-[#FFDCDC] border-dashed flex items-center"},{default:s((()=>[p(r,{class:"pl-[40rpx] w-[200rpx] box-border"},{default:s((()=>[p(r,{class:"price-font flex items-baseline text-[var(--primary-color)]"},{default:s((()=>[p(l,{class:"text-[38rpx] mr-[4rpx] leading-[45rpx] text-center font-500"},{default:s((()=>[c("￥")])),_:1}),p(l,{class:"text-[56rpx] font-semibold text-left leading-[70rpx] truncate"},{default:s((()=>[c(k(e.coupon_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(r,{class:"flex-1 box-border ml-[10rpx]"},{default:s((()=>[p(r,{class:"text-[30rpx] leading-[35rpx] text-left font-500"},{default:s((()=>["0.00"===e.min_condition_money?(a(),o(l,{key:0},{default:s((()=>[c("无门槛")])),_:1})):(a(),o(l,{key:1},{default:s((()=>[c("满"+k(e.coupon_min_price)+"元可用",1)])),_:2},1024))])),_:2},1024),p(r,{class:"text-[20rpx] leading-[23rpx] mt-[4px] text-left flex items-center"},{default:s((()=>[p(l,{class:"bg-[var(--primary-color)] text-[#fff] text-[20rpx] h-[28rpx] leading-[28rpx] px-[10rpx] rounded-[16rpx] mr-[6rpx] shrink-0"},{default:s((()=>[c(k(e.type_name),1)])),_:2},1024),p(l,{class:"truncate max-w-[190rpx]"},{default:s((()=>[c(k(e.title),1)])),_:2},1024)])),_:2},1024),p(r,{class:"w-[100%] mt-[4px] text-[20rpx] leading-[23rpx]"},{default:s((()=>[1==e.valid_type?(a(),o(l,{key:0},{default:s((()=>[c("领取之日起"),p(l,null,{default:s((()=>[c(k(e.length||""),1)])),_:2},1024),c("天内有效")])),_:2},1024)):(a(),o(l,{key:1},{default:s((()=>[c(" 有效期至"),p(l,null,{default:s((()=>[c(k(e.valid_end_time?e.valid_end_time.slice(0,10):""),1)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1024),"collecting"===e.btnType?(a(),o(r,{key:0,onClick:F((r=>((e,t)=>{if(!N.value)return w().setLoginBack({url:"/addon/shop/pages/coupon/list"}),!1;T({coupon_id:e,number:1,type:"receive"}).then((e=>{e.code>0&&(A.value[t].member_receive_count+=1,A.value[t].receive_count+=1,(A.value[t].member_receive_count==A.value[t].limit_count||-1!=A.value[t].sum_count&&A.value[t].receive_count===A.value[t].sum_count)&&(A.value[t].btnType="using"))}))})(e.id,t)),["stop"]),class:"pr-[20rpx] pl-[30rpx]"},{default:s((()=>[p(m,{text:"立即领取",customStyle:{width:"150rpx",height:"60rpx",color:"#fff",fontSize:"24rpx",lineHeight:"60rpx",padding:"0",backgroundColor:"var(--primary-color)",border:"none"},shape:"circle"},null,8,["customStyle"])])),_:2},1032,["onClick"])):f("v-if",!0),"using"===e.btnType?(a(),o(r,{key:1,onClick:F((t=>{return r=e.id,void C({url:"/addon/shop/pages/goods/list",param:{coupon_id:r}});var r}),["stop"]),class:"pr-[20rpx] pl-[30rpx]"},{default:s((()=>[p(m,{text:"去使用",customStyle:{width:"150rpx",height:"60rpx",color:"var(--primary-color)",fontSize:"24rpx",lineHeight:"60rpx",padding:"0",backgroundColor:"transparent",border:"2rpx solid var(--primary-color)"},shape:"circle"},null,8,["customStyle"])])),_:2},1032,["onClick"])):f("v-if",!0),p(r,{class:"absolute top-0 right-[190rpx] h-[10rpx] w-[20rpx] rounded-br-[20rpx] rounded-bl-[20rpx] bg-[#F6F6F6]"}),p(r,{class:"absolute bottom-0 right-[190rpx] h-[10rpx] w-[20rpx] rounded-tr-[20rpx] rounded-tl-[20rpx] bg-[#F6F6F6]"})])),_:2},1032,["class","onClick","style"]))],64)))),256)),A.value.length||G.value?f("v-if",!0):(a(),o(r,{key:0,class:"noData bg-[#fff] rounded-[20rpx] flex items-center justify-center"},{default:s((()=>[p(D,{option:{tip:"暂无优惠券"}})])),_:1}))])),_:1})])),_:1},8,["onInit"])])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-48272a45"]]);export{B as default};
