import{d as e,m as a,p as l,r as o,q as r,t,x as s,o as i,c as n,w as d,b as u,y as p,z as m,u as c,f as g,n as b,A as f,B as _,a as x,C as h,i as y,g as v,h as k,D as j,E as S,F as C}from"./index-d8a8f699.js";import{_ as V}from"./u-input.9468a367.js";import{_ as T,a as w}from"./u-form.11d92cf8.js";import{_ as A}from"./sms-code.vue_vue_type_script_setup_true_lang.ce239318.js";import{_ as P,a as z}from"./u-checkbox-group.00090a01.js";import{_ as q}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.5ba98c98.js";import"./u-line.d86b0940.js";import"./u-modal.3708081d.js";import"./u-loading-icon.6808ae8c.js";import"./u-popup.0d48946e.js";import"./u-transition.db07fff7.js";import"./u-safe-bottom.a4431b09.js";const E=q(e({__name:"bind",setup(e){const q=a(),E=l((()=>q.info)),O=l((()=>C().login)),U=o(!1),B=o(!1),I=r({mobile:"",mobile_code:"",mobile_key:""}),M=o(!0);t((()=>{setTimeout((()=>{M.value=!1}),800)})),uni.getStorageSync("openid")&&Object.assign(I,{openid:uni.getStorageSync("openid")}),uni.getStorageSync("pid")&&Object.assign(I,{pid:uni.getStorageSync("pid")}),uni.getStorageSync("unionid")&&Object.assign(I,{unionid:uni.getStorageSync("unionid")});const $={mobile:[{type:"string",required:!0,message:s("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,a,l){/^1[3-9]\d{9}$/.test(a)?l():l(new Error("请输入正确的手机号"))},message:s("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:s("codePlaceholder"),trigger:["blur","change"]}},D=()=>{B.value=!B.value},F=o(null),L=()=>{F.value.validate().then((()=>{if(U.value)return;U.value=!0;(E.value?f:_)(I).then((e=>{E.value?(q.getMemberInfo(),x({url:"/app/pages/member/personal",mode:"redirectTo"})):(q.setToken(e.data.token),h().handleLoginBack())})).catch((()=>{U.value=!1}))}))};return o(null),(e,a)=>{const l=y,o=v(k("u-input"),V),r=v(k("u-form-item"),T),t=v(k("sms-code"),A),f=v(k("u-checkbox"),P),_=v(k("u-checkbox-group"),z),h=j,C=S,q=v(k("u-form"),w);return i(),n(l,{class:"w-screen h-screen flex flex-col",style:b(e.themeColor())},{default:d((()=>[u(l,{class:"flex-1"},{default:d((()=>[u(l,{class:"h-[100rpx]"}),u(l,{class:"px-[60rpx] pt-[100rpx] mb-[100rpx]"},{default:d((()=>[u(l,{class:"font-bold text-lg"},{default:d((()=>[p(m(c(s)("bindMobile")),1)])),_:1})])),_:1}),u(l,{class:"px-[60rpx]"},{default:d((()=>[u(q,{labelPosition:"left",model:I,errorType:"toast",rules:$,ref_key:"formRef",ref:F},{default:d((()=>[u(r,{label:"",prop:"mobile","border-bottom":!0},{default:d((()=>[u(o,{modelValue:I.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>I.mobile=e),border:"none",clearable:"",placeholder:c(s)("mobilePlaceholder"),class:"!bg-transparent",disabled:M.value,fontSize:"26rpx",placeholderClass:"!text-[#8288A2]"},null,8,["modelValue","placeholder","disabled"])])),_:1}),u(l,{class:"mt-[40rpx]"},{default:d((()=>[u(r,{label:"",prop:"mobile_code","border-bottom":!0},{default:d((()=>[u(o,{modelValue:I.mobile_code,"onUpdate:modelValue":a[2]||(a[2]=e=>I.mobile_code=e),border:"none",clearable:"",placeholder:c(s)("codePlaceholder"),class:"!bg-transparent",disabled:M.value,fontSize:"26rpx",placeholderClass:"!text-[#8288A2]"},{suffix:d((()=>[u(t,{mobile:I.mobile,type:"bind_mobile",modelValue:I.mobile_key,"onUpdate:modelValue":a[1]||(a[1]=e=>I.mobile_key=e)},null,8,["mobile","modelValue"])])),_:1},8,["modelValue","placeholder","disabled"])])),_:1})])),_:1}),!c(E)&&c(O).agreement_show?(i(),n(l,{key:0,class:"flex items-start mt-[30rpx]"},{default:d((()=>[u(_,null,{default:d((()=>[u(f,{activeColor:"var(--primary-color)",checked:B.value,shape:"shape",size:"14",onChange:D,customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),u(l,{class:"text-xs text-gray-400 flex flex-wrap"},{default:d((()=>[p(m(c(s)("agreeTips"))+" ",1),u(l,{onClick:a[3]||(a[3]=e=>c(x)({url:"/app/pages/auth/agreement?key=service"}))},{default:d((()=>[u(h,{class:"text-primary"},{default:d((()=>[p("《"+m(c(s)("userAgreement"))+"》",1)])),_:1})])),_:1}),u(l,{onClick:a[4]||(a[4]=e=>c(x)({url:"/app/pages/auth/agreement?key=privacy"}))},{default:d((()=>[u(h,{class:"text-primary"},{default:d((()=>[p("《"+m(c(s)("privacyAgreement"))+"》",1)])),_:1})])),_:1})])),_:1})])),_:1})):g("v-if",!0),u(l,{class:"mt-[60rpx]"},{default:d((()=>[u(C,{"hover-class":"none",class:"bg-[var(--primary-color)] text-[#fff] h-[80rpx] leading-[80rpx] rounded-[100rpx] text-[28rpx]",loading:U.value,loadingText:c(s)("binding"),onClick:L},{default:d((()=>[p(m(c(s)("bind")),1)])),_:1},8,["loading","loadingText"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-e0a24ee2"]]);export{E as default};
