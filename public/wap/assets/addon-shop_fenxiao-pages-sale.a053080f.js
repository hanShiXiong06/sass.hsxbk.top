import{d as e,j as a,r as t,p as l,o as s,c as r,w as o,U as n,b as i,n as c,u,y as d,z as p,V as m,ad as f,f as x,ae as _,af as v,a as g,D as y,i as h,B as b,g as k,h as w,a7 as j,W as C,E as T,G as I,_ as z}from"./index-71c7df08.js";import{_ as M}from"./loading-page.vue_vue_type_script_setup_true_lang.c7dc2256.js";import{g as O,a as P,b as S,c as E}from"./sale.3ca960a4.js";import{M as R}from"./mescroll-body.49de0f6f.js";import{M as U}from"./mescroll-empty.95b8c17e.js";import{u as B}from"./useMescroll.26ccf5de.js";import{t as D}from"./topTabbar.cb42d19f.js";import{f as N}from"./cloneDeep.77735539.js";import"./mescroll-i18n.00218d15.js";/* empty css                                                                       */const F=z(e({__name:"sale",setup(e){let z={};const{mescrollInit:F,downCallback:G,getMescroll:Q}=B(v,_),V=D();V.setTopTabbarParam({title:"销售奖励"});const W=a((()=>{let e={backgroundImage:"url("+T("addon/shop_fenxiao/sale/head_bg.png")+") ",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPositionY:"-170rpx"};return e})),Y=a((()=>Object.keys(z).length?I(Number(z.height))+I(z.top)+I(8)+728+"rpx":"728rpx")),q=t(""),A=t(!0);l((async()=>{await O().then((e=>{q.value=e.data.is_open,0==q.value&&V.setTopTabbarParam({title:"销售奖励",topStatusBar:{textColor:"#333",bgColor:"#fff"}}),A.value=!1}))}));const H=t([{name:"全部",key:"all"},{name:"待发放",key:"0"},{name:"已发放",key:"1"}]),J=t("all"),K=t(0),L=t(!0),X=t(!0),Z=t([]),$=e=>{X.value=!0,P({page:e.num,limit:e.size,is_send:J.value}).then((a=>{let t=a.data.data;1==e.num&&(Z.value=[],"1"!=J.value&&ee(t)),Z.value=Z.value.concat(t),X.value=!1,e.endSuccess(t.length)})).catch((()=>{L.value=!1,X.value=!1,e.endErr()}))},ee=async e=>{L.value=!0;const a=await S();let t=e.map((e=>e.period_id));if(Object.keys(a.data).length&&(t.length&&-1==t.indexOf(a.data.id)||!t.length)){let e=N(a.data);e.reward_money=e.total_reward_money,e.period_id=e.id,e.order_money=e.total_order_money,Z.value.unshift(e)}L.value=!1},ae=t({});E().then((e=>{ae.value=e.data}));const te=()=>{g({url:"/app/pages/member/commission"})};return(e,a)=>{const t=y,l=h,_=b,v=k(w("loading-page"),M);return s(),r(l,{class:"bg-[var(--page-bg-color)] min-h-[100vh]",style:c(e.themeColor())},{default:o((()=>[1!=q.value||A.value?x("v-if",!0):(s(),n(m,{key:0},[i(l,{class:"fixed w-full z-2 !bg-[var(--page-bg-color)]"},{default:o((()=>[i(l,{class:"w-full overflow-hidden",style:c(u(W))},{default:o((()=>[i(l,{class:"card-template sidebar-margin mt-[312rpx]"},{default:o((()=>[i(l,{class:"flex flex-col mb-[56rpx]",onClick:te},{default:o((()=>[i(t,{class:"text-[30rpx] h-[36rpx] leading-[36rpx] text-[#333] mb-[16rpx]"},{default:o((()=>[d("销售奖励（元）")])),_:1}),i(t,{class:"text-[48rpx] price-font text-[var(--price-text-color)] min-h-[58rpx]"},{default:o((()=>[d(p(u(j)(ae.value.sale_commission)||0),1)])),_:1})])),_:1}),i(l,{class:"flex item-center justify-between"},{default:o((()=>[i(l,{class:"flex flex-col w-[50%]"},{default:o((()=>[i(t,{class:"text-[28rpx] h-[34rpx] text-[var(--text-color-light6)] mb-[10rpx]"},{default:o((()=>[d("待发放（元）")])),_:1}),i(t,{class:"text-[36rpx] min-h-[46rpx] text-[#333] price-font"},{default:o((()=>[d(p(u(j)(ae.value.wait_sale_commission)||0),1)])),_:1})])),_:1}),i(l,{class:"flex flex-col w-[50%]"},{default:o((()=>[i(t,{class:"text-[28rpx] h-[34rpx] text-[var(--text-color-light6)] mb-[10rpx]"},{default:o((()=>[d("已发放（元）")])),_:1}),i(t,{class:"text-[36rpx] min-h-[46rpx] text-[#333] price-font"},{default:o((()=>[d(p(u(j)(ae.value.sale_commission_send)||0),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),i(l,{class:"tab-style-1 mt-[40rpx]"},{default:o((()=>[i(l,{class:"tab-left"},{default:o((()=>[(s(!0),n(m,null,f(H.value,((e,a)=>(s(),r(l,{class:C(["tab-left-item",{"class-select":J.value===e.key}]),onClick:t=>((e,a)=>{J.value=e,K.value=a,Z.value=[],Q().resetUpScroll()})(e.key,a)},{default:o((()=>[d(p(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1}),i(R,{ref:"mescrollRef",down:{use:!1},onInit:u(F),onUp:$,top:u(Y)},{default:o((()=>[!Z.value.length||X.value||L.value?x("v-if",!0):(s(!0),n(m,{key:0},f(Z.value,((e,a)=>(s(),r(l,{keys:a,class:"flex justify-between items-center card-template mt-[var(--top-m)] sidebar-margin",onClick:a=>{return t=e.period_id,void g({url:"/addon/shop_fenxiao/pages/sale_detail",param:{id:t}});var t}},{default:o((()=>[i(l,{class:"flex flex-col"},{default:o((()=>[e.is_settlement?(s(),r(l,{key:0,class:"text-[#333] text-[28rpx] flex items-center"},{default:o((()=>[i(t,{class:"text-[28rpx] mr-[6rpx]"},{default:o((()=>[d("结算时间")])),_:1}),i(t,null,{default:o((()=>[d(p(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)):(s(),r(l,{key:1,class:"text-[#333] text-[28rpx] flex items-center"},{default:o((()=>[i(t,{class:"text-[28rpx] mr-[6rpx]"},{default:o((()=>[d("预计结算时间")])),_:1}),i(t,null,{default:o((()=>[d(p(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)),i(l,{class:"mt-[16rpx] h-[34rpx] flex items-center text-[24rpx] text-[var(--text-color-light6)]"},{default:o((()=>[d(" 销售金额："+p(e.order_money),1)])),_:2},1024)])),_:2},1024),i(l,{class:C(["text-[28rpx] text-[var(--text-color-light6)]",{"text-[#333]":e.is_send,"text-[var(--primary-color)]":!e.is_send}])},{default:o((()=>[d(p(e.is_send?"已发放":"待发放"),1)])),_:2},1032,["class"])])),_:2},1032,["keys","onClick"])))),256)),Z.value.length||X.value||L.value?x("v-if",!0):(s(),r(U,{key:1,option:{icon:u(T)("addon/shop_fenxiao/sale/empty.png"),tip:"暂无销售奖励记录",btnText:"去逛逛"},onEmptyclick:a[0]||(a[0]=e=>u(g)({url:"/addon/shop_fenxiao/pages/goods"}))},null,8,["option"]))])),_:1},8,["onInit","top"])],64)),0!=q.value||A.value?x("v-if",!0):(s(),r(l,{key:1,class:"h-[100vh] w-[100vw] overflow-hidden"},{default:o((()=>[i(l,{class:"empty-page"},{default:o((()=>[i(_,{class:"img",src:u(T)("static/resource/images/system/empty.png"),mode:"aspectFit"},null,8,["src"]),i(l,{class:"desc"},{default:o((()=>[d("销售奖励设置未开启")])),_:1})])),_:1})])),_:1})),i(v,{loading:A.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-9d9f2502"]]);export{F as default};
