import{d as e,r as t,p as a,s as r,H as l,o as s,c as o,w as d,b as c,U as n,ad as i,V as p,f as u,u as x,n as f,ae as _,af as m,i as g,ac as v,g as y,h,W as b,y as k,z as j,A as w,E as C,F,a as S,c0 as z,k as E,D as I,B as M,bl as U,_ as R}from"./index-71c7df08.js";import{_ as V}from"./pay.6aa36878.js";import{g as B,a as O,o as P}from"./order.9eeece48.js";import{M as A}from"./mescroll-body.49de0f6f.js";import{M as D}from"./mescroll-empty.95b8c17e.js";import{u as H}from"./useMescroll.26ccf5de.js";import"./pay.4cfa8889.js";import"./mescroll-i18n.00218d15.js";/* empty css                                                                       */const L=R(e({__name:"order_list",setup(e){const{mescrollInit:R,downCallback:L,getMescroll:N}=H(m,_),Q=t([]),W=t(!1),$=t(!1),q=t(""),G=t([]);t(null),a((e=>{if(!r())return l().setLoginBack({url:"/addon/shop_giftcard/pages/order_list"}),!1;q.value=e.status||"",K()}));const J=e=>{W.value=!1;let t={page:e.num,limit:e.size,status:q.value};O(t).then((t=>{let a=t.data.data;1==e.num&&(Q.value=[]),Q.value=Q.value.concat(a),e.endSuccess(a.length),W.value=!0})).catch((()=>{W.value=!0,e.endErr()}))},K=()=>{$.value=!1,G.value=[];G.value.push({name:"全部",status:""}),B().then((e=>{Object.values(e.data).forEach(((e,t)=>{G.value.push(e)})),$.value=!0})).catch((()=>{$.value=!0}))},T=t(null),X=(e,t="")=>{var a;"pay"==t?null==(a=T.value)||a.open(e.order_type,e.order_id,`/addon/shop_giftcard/pages/order_detail?order_id=${e.order_id}`):"close"==t&&Y(e)},Y=e=>{z({title:"提示",content:"您确定要关闭该订单吗？",confirmColor:E().themeColor["--primary-color"],success:t=>{t.confirm&&P(e.order_id).then((e=>{N().resetUpScroll()}))}})};return(e,t)=>{const a=g,r=v,l=I,_=M,m=y(h("u--image"),U),z=y(h("pay"),V);return s(),o(a,{class:"bg-[var(--page-bg-color)] min-h-screen overflow-hidden order-list",style:f(e.themeColor())},{default:d((()=>[$.value?(s(),o(a,{key:0,class:"fixed left-0 top-0 right-0 z-10"},{default:d((()=>[c(r,{"scroll-x":!0,class:"tab-style-2 !p-[0]"},{default:d((()=>[c(a,{class:"tab-content !justify-around"},{default:d((()=>[(s(!0),n(p,null,i(G.value,((e,t)=>(s(),o(a,{class:b(["tab-items",{"class-select":q.value===e.status.toString()}]),onClick:t=>{return a=e.status,q.value=a.toString(),Q.value=[],void N().resetUpScroll();var a}},{default:d((()=>[k(j(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1})):u("v-if",!0),c(A,{ref:"mescrollRef",top:"88rpx",onInit:x(R),down:{use:!1},onUp:J},{default:d((()=>[Q.value.length?(s(),o(a,{key:0,class:"sidebar-margin pt-[var(--top-m)]"},{default:d((()=>[(s(!0),n(p,null,i(Q.value,((e,t)=>(s(),o(a,{key:t,class:"mb-[var(--top-m)] card-template"},{default:d((()=>[c(a,{onClick:w((t=>{S({url:"/addon/shop_giftcard/pages/order_detail",param:{order_id:e.order_id}})}),["stop"])},{default:d((()=>[c(a,{class:"flex justify-between items-center"},{default:d((()=>[c(a,{class:"text-[#303133] text-[26rpx] font-400 leading-[36rpx]"},{default:d((()=>[c(l,{class:b(["iconfont text-[var(--primary-color)] text-[34rpx]",{"iconchuzhikaV6mm text-[#EF000C]":"balance"==e.card_right_type,"iconduihuankaV6mm-1 text-[#FF7700]":"goods"==e.card_right_type}])},null,8,["class"]),c(l,{class:"ml-[12rpx] text-[28rpx]"},{default:d((()=>[k(j(e.card_right_type_name),1)])),_:2},1024)])),_:2},1024),c(a,{class:b(["text-[#303133] text-[26rpx] leading-[34rpx]",{"text-primary":1==e.status,"!text-[var(--text-color-light9)]":-1==e.status}])},{default:d((()=>[k(j(e.status_name),1)])),_:2},1032,["class"])])),_:2},1024),(s(),o(a,{class:"flex box-border mt-[20rpx]",key:t},{default:d((()=>[c(m,{width:"240rpx",height:"170rpx",radius:"var(--goods-rounded-big)",src:x(C)(e.card_cover?e.card_cover:""),mode:"aspectFill"},{error:d((()=>["balance"==e.card_right_type?(s(),o(_,{key:0,class:"w-[240rpx] h-[170rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:x(C)("addon/shop_giftcard/diy/index/value_card.jpg"),mode:"aspectFill"},null,8,["src"])):(s(),o(_,{key:1,class:"w-[240rpx] h-[170rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:x(C)("addon/shop_giftcard/diy/index/redemption_card.jpg"),mode:"aspectFill"},null,8,["src"]))])),_:2},1032,["radius","src"]),c(a,{class:"ml-[20rpx] flex flex-1 flex-col box-border"},{default:d((()=>[c(a,{class:"max-w-[402rpx] text-[28rpx] leading-[40rpx] font-400 truncate text-[#303133]"},{default:d((()=>[k(j(e.body),1)])),_:2},1024),"balance"==e.card_right_type?(s(),o(a,{key:0,class:"max-w-[402rpx] text-[#303133] text-[24rpx] font-400 leading-[36rpx] text-[var(--text-color-light6)] truncate mt-[14rpx]"},{default:d((()=>[k(j(e.balance)+"元储值卡",1)])),_:2},1024)):u("v-if",!0),c(a,{class:"flex justify-between items-baseline mt-auto"},{default:d((()=>[c(a,{class:"leading-[42rpx]"},{default:d((()=>[c(l,{class:"text-[22rpx] font-400 price-font"},{default:d((()=>[k("￥")])),_:1}),c(l,{class:"text-[36rpx] font-500 price-font"},{default:d((()=>[k(j(parseFloat(e.card_price).toFixed(2).split(".")[0]),1)])),_:2},1024),c(l,{class:"text-[22rpx] font-500 price-font"},{default:d((()=>[k("."+j(parseFloat(e.card_price).toFixed(2).split(".")[1]),1)])),_:2},1024)])),_:2},1024),c(l,{class:"text-right text-[26rpx] font-400 w-[90rpx] text-[var(--text-color-light6)] leading-[36rpx]"},{default:d((()=>[k("x"+j(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024))])),_:2},1032,["onClick"]),c(a,{class:"flex items-baseline justify-between mt-[20rpx]"},{default:d((()=>[c(a,{class:"text-[22rpx] text-[var(--text-color-light9)] leading-[30rpx] mr-[6rpx]"},{default:d((()=>[k(j(e.create_time),1)])),_:2},1024),c(a,{class:"flex items-end"},{default:d((()=>[c(a,{class:"text-[22rpx] font-400 leading-[30rpx] text-[#303133]"},{default:d((()=>[k(j(x(F)("actualPayment"))+"：",1)])),_:1}),c(a,{class:"leading-[1] text-[var(--price-text-color)]"},{default:d((()=>[c(l,{class:"text-[22rpx] leading-[26rpx] price-font"},{default:d((()=>[k("￥")])),_:1}),c(l,{class:"text-[36rpx] font-500 leading-[40rpx] price-font"},{default:d((()=>[k(j(parseFloat(e.order_money).toFixed(2).split(".")[0]),1)])),_:2},1024),c(l,{class:"text-[22rpx] font-500 leading-[28rpx] price-font"},{default:d((()=>[k("."+j(parseFloat(e.order_money).toFixed(2).split(".")[1]),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),1==e.status?(s(),o(a,{key:0,class:"flex justify-end text-[28rpx] mt-[20rpx] items-center"},{default:d((()=>[1==e.status?(s(),o(a,{key:0,class:"text-[24rpx] font-500 leading-[52rpx] h-[56rpx] min-w-[150rpx] text-center border-[2rpx] border-solid border-[var(--text-color-light9)] rounded-full text-[var(--text-color-light6)] box-border",onClick:w((t=>X(e,"close")),["stop"])},{default:d((()=>[k(j(x(F)("orderClose")),1)])),_:2},1032,["onClick"])):u("v-if",!0),1==e.status?(s(),o(a,{key:1,class:"text-[24rpx] font-500 flex-center h-[56rpx] min-w-[150rpx] text-center border-[0] text-[#fff] primary-btn-bg rounded-full ml-[20rpx] box-border",onClick:w((t=>X(e,"pay")),["stop"])},{default:d((()=>[k(j(x(F)("topay")),1)])),_:2},1032,["onClick"])):u("v-if",!0)])),_:2},1024)):u("v-if",!0)])),_:2},1024)))),128))])),_:1})):u("v-if",!0),!Q.value.length&&W.value?(s(),o(D,{key:1,option:{tip:"暂无购卡记录",icon:x(C)("addon/shop_giftcard/empty.png")}},null,8,["option"])):u("v-if",!0)])),_:1},8,["onInit"]),c(z,{ref_key:"payRef",ref:T,onClose:e.payClose},null,8,["onClose"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-c6656710"]]);export{L as default};
