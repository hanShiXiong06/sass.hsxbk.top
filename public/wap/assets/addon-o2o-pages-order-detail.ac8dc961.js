import{d as e,r as t,j as r,o as l,c as a,w as s,E as o,b as d,x as i,y as u,u as n,f,G as p,F as x,n as c,a as _,c1 as m,bB as v,C as b,i as y,g,h,t as k,V as j}from"./index-e6ce9fbf.js";import{_ as w}from"./u-icon.c5d9cd81.js";import{_ as C,a as T}from"./u-steps.fa645337.js";import{_ as P}from"./u--image.2a363e1d.js";import{_ as z}from"./u-empty.c4d60006.js";import{_ as M}from"./pay.16fd6339.js";import{_ as O}from"./u-loading-page.76c2d95f.js";import{e as S,c as V,d as D}from"./order.4818855c.js";import{_ as N}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-text.9aefeac5.js";import"./u-image.c9386d77.js";import"./u-transition.6919b33f.js";import"./u-button.7a41d301.js";import"./u-loading-icon.39fd4711.js";import"./u-popup.b16d6e1d.js";import"./u-safe-bottom.1ba5bfba.js";import"./pay.f23cf994.js";const R=N(e({__name:"detail",setup(e){let N=0;const R=t(null),B=t(!1);r((e=>{N=e.order_id||0,F()}));const F=()=>{B.value=!0,S(N).then((e=>{R.value=e.data,B.value=!1,q()})).catch((()=>{B.value=!1}))},$=()=>{S(N).then((e=>{R.value=e.data,q()})).catch((()=>{}))},E=t(null),G=(e="",t="")=>{var r,l;"pay"==e?null==(r=E.value)||r.open(R.value.order_type,R.value.order_id,`/addon/o2o/pages/order/detail?order_id=${R.value.order_id}`):"item_pay"==e?null==(l=E.value)||l.open("o2o_item",t.order_item_id,`/addon/o2o/pages/order/detail?order_id=${R.value.order_id}`):"cancel"==e?H(R.value):"delete"==e?I(R.value):"index"==e&&_({url:"/addon/o2o/pages/index",mode:"reLaunch"})},H=e=>{m({title:"提示",content:"您确定要取消该订单吗？",success:t=>{t.confirm&&V(e.order_id).then((e=>{F()}))}})},I=e=>{m({title:"提示",content:"您确定要删除该订单吗？",success:t=>{t.confirm&&D(e.order_id).then((e=>{_({url:"/addon/o2o/pages/order/list"})})).catch((()=>{}))}})};function L(e){var t=new Date(e).getTime();if(null!=t&&""!=t&&t>0){var r=new Date;r.setTime(t);var l=r.getMonth()+1;l=l<10?"0"+l:l;var a=r.getDate();a=a<10?"0"+a:a;var s=r.getHours();s=s<10?"0"+s:s;var o=r.getMinutes();return l+"-"+a+" "+s+":"+(o=o<10?"0"+o:o)}return""}let U=t(0);function q(){return"dispatch"==R.value.order_status_info.status?U.value=0:"wait_service"==R.value.order_status_info.status?U.value=1:"in_service"==R.value.order_status_info.status?U.value=2:"finish"==R.value.order_status_info.status?U.value=3:void 0}return(e,t)=>{const r=b,m=y,S=g(h("u-icon"),w),V=g(h("u-steps-item"),C),D=g(h("u-steps"),T),N=g(h("u--image"),P),F=g(h("u-empty"),z),H=g(h("pay"),M),I=g(h("u-loading-page"),O);return l(),a(m,{style:c(e.themeColor())},{default:s((()=>[B.value?f("v-if",!0):(l(),o(p,{key:0},[R.value?(l(),a(m,{key:0,class:"bg-[#f7f7f7] min-h-screen overflow-hidden"},{default:s((()=>[d(m,{class:"bg-linear h-[480rpx] text-white px-3 pt-5"},{default:s((()=>[d(m,{class:"text-[42rpx] flex items-baseline text-[#fff]"},{default:s((()=>[d(r,{class:"nc-iconfont nc-icon-shijianV6xx text-[42rpx] mr-1"}),d(r,{class:"font-bold"},{default:s((()=>{var e,t;return[i(u(n(k)("order"))+u(null==(t=null==(e=R.value)?void 0:e.order_status_info)?void 0:t.name),1)]})),_:1})])),_:1})])),_:1}),d(m,{class:"bg-[#fff] mx-3 p-[30rpx] -mt-[360rpx] rounded-[10rpx]"},{default:s((()=>[d(m,{class:"flex"},{default:s((()=>[d(m,{class:"min-w-[50rpx] flex items-center justify-center"},{default:s((()=>[d(S,{name:"map",size:"20"})])),_:1}),d(m,{class:"flex flex-col ml-[20rpx]"},{default:s((()=>[d(r,{class:"text-[24rpx] mt-[10rpx] leading-[35rpx] line-feed"},{default:s((()=>[i(u(R.value.taker_full_address),1)])),_:1}),d(m,null,{default:s((()=>[d(r,{class:"text-[24rpx]"},{default:s((()=>[i(u(R.value.taker_name),1)])),_:1}),d(r,{class:"text-[24rpx] mt-[15rpx]"},{default:s((()=>[i(u(R.value.taker_mobile),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),R.value.pay_time?(l(),a(m,{key:0,class:"flex py-4 px-3 bg-white rounded-md box-border mx-3 mt-[20rpx] task-steps"},{default:s((()=>[d(D,{current:n(U),activeColor:"var(--primary-color)"},{default:s((()=>[d(V,{title:n(k)("placeOrder"),desc:R.value.create_time?L(R.value.create_time):"---"},null,8,["title","desc"]),d(V,{title:n(k)("takeOrders"),desc:R.value.dispatch_time?L(R.value.dispatch_time):"---"},null,8,["title","desc"]),d(V,{title:n(k)("start"),desc:R.value.service_time?L(R.value.service_time):"---"},null,8,["title","desc"]),d(V,{title:n(k)("finish"),desc:R.value.finish_time?L(R.value.finish_time):"---"},null,8,["title","desc"])])),_:1},8,["current"])])),_:1})):f("v-if",!0),d(m,{class:"mt-[20rpx]"},{default:s((()=>[d(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] rounded-[10rpx]"},{default:s((()=>[(l(!0),o(p,null,x(R.value.item,((e,t)=>(l(),a(m,{class:"order-goods-item py-[20rpx]",key:t},{default:s((()=>[d(m,{class:"flex justify-between items-center",onClick:t=>{var r;"reservation"!=(r=e).item_type&&"buy"!=r.item_type||_({url:"/addon/o2o/pages/goods/detail",param:{sku_id:r.item_id}})}},{default:s((()=>[d(m,{class:"w-[160rpx] h-[160rpx] flex-2"},{default:s((()=>[d(N,{class:"rounded-[10rpx] overflow-hidden",width:"160rpx",height:"160rpx",src:n(j)(e.item_image?e.item_image:""),model:"aspectFill"},{error:s((()=>[d(S,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024),d(m,{class:"ml-[20rpx] flex-1"},{default:s((()=>[d(m,{class:"flex justify-between"},{default:s((()=>[d(r,{class:"text-[28rpx] text-item leading-[40rpx] max-h-[80rpx] w-[360rpx] multi-hidden"},{default:s((()=>[i(u(e.item_name),1)])),_:2},1024),d(r,{class:"shrink-0 text-[24rpx] text-[var(--primary-color)] ml-[10rpx] leading-[40rpx]"},{default:s((()=>[i(u(e.pay_time?n(k)("havePaid"):n(k)("notPaid")),1)])),_:2},1024)])),_:2},1024),d(m,{class:"text-[24rpx] mt-[20rpx] flex"},{default:s((()=>[d(r,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:s((()=>[i(u(e.item_type_name),1)])),_:2},1024)])),_:2},1024),d(m,{class:"flex justify-between mt-[26rpx] items-center"},{default:s((()=>[d(r,{class:"text-right text-[28rpx] text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(e.price),1)])),_:2},1024),d(r,{class:"text-right text-sm"},{default:s((()=>[d(r,{class:"text-[26rpx]"},{default:s((()=>[i("x")])),_:1}),i(u(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),d(m,{class:"flex justify-end self-end w-[100%] mt-[10rpx]"},{default:s((()=>[e.refund_no&&""!=e.refund_status&&"cancel"!=e.refund_status?(l(),a(m,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>n(_)({url:"/addon/o2o/pages/refund/detail",param:{refund_no:e.refund_no}})},{default:s((()=>[i(u(n(k)("viewRefund")),1)])),_:2},1032,["onClick"])):f("v-if",!0),R.value.order_status_info.is_refund&&e.is_enable_refund&&-1!=["","cancel"].indexOf(e.refund_status)?(l(),a(m,{key:1,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{return r=e.order_item_id,void _({url:"/addon/o2o/pages/refund/apply",param:{order_id:R.value.order_id,order_item_id:r}});var r}},{default:s((()=>[i(u(n(k)("applyRefund")),1)])),_:2},1032,["onClick"])):f("v-if",!0),"custom"==e.item_type?(l(),o(p,{key:2},[e.pay_time?f("v-if",!0):(l(),a(m,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>G("item_pay",e)},{default:s((()=>[i(u(n(k)("goToPay")),1)])),_:2},1032,["onClick"])),d(m,{class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{var r;_({url:"/addon/o2o/pages/master/task/show",param:{order_id:(r=e).order_id,order_item_id:r.order_item_id,item_name:r.item_name,price:r.item_money,item_images:r.item_images}})}},{default:s((()=>[i(u(n(k)("show")),1)])),_:2},1032,["onClick"])],64)):f("v-if",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),R.value.check_code?(l(),a(m,{key:0,class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[R.value.technician_id?(l(),a(m,{key:0,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("servicePersonal")),1)])),_:1}),d(m,{class:"text-[#999]",onClick:t[0]||(t[0]=e=>n(_)({url:"/addon/o2o/pages/technician/detail",param:{id:R.value.technician_id}}))},{default:s((()=>[i(u(R.value.technician_id?R.value.technician_info.name:n(k)("orderToBeSent")),1)])),_:1})])),_:1})):f("v-if",!0),R.value.technician_id?(l(),a(m,{key:1,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("contactNumber")),1)])),_:1}),d(m,{class:"text-[#999]",onClick:t[1]||(t[1]=e=>{return t=R.value.technician_info.mobile,void v({phoneNumber:t});var t})},{default:s((()=>[i(u(R.value.technician_info.mobile),1)])),_:1})])),_:1})):f("v-if",!0),d(m,{class:"flex justify-between text-[28rpx] mt-[30rpx]"},{default:s((()=>[d(r,null,{default:s((()=>[i(u(n(k)("serviceCode")),1)])),_:1}),d(r,{class:"text-[#999]"},{default:s((()=>[i(u(R.value.check_code),1)])),_:1})])),_:1}),d(m,{class:"text-[20rpx] mt-[20rpx] text-[#999]"},{default:s((()=>[i(u(n(k)("explain")),1)])),_:1})])),_:1})):f("v-if",!0),d(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("onOrder")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(R.value.order_no),1)])),_:1})])),_:1}),R.value.out_trade_no?(l(),a(m,{key:0,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("transactionNumber")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(R.value.out_trade_no),1)])),_:1})])),_:1})):f("v-if",!0),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("createTime")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(R.value.create_time),1)])),_:1})])),_:1}),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("reserveServiceTime")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(R.value.reserve_service_time),1)])),_:1})])),_:1}),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx] box-border"},{default:s((()=>[d(m,{class:"shrink-0 mr-[18rpx]"},{default:s((()=>[i(u(n(k)("remark")),1)])),_:1}),d(m,{class:"max-w-[510rpx] leading-[38rpx] line-feed"},{default:s((()=>[i(u(R.value.member_message?R.value.member_message:"无"),1)])),_:1})])),_:1}),R.value.pay?(l(),a(m,{key:1,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("modePayment")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(R.value.pay.type_name),1)])),_:1})])),_:1})):f("v-if",!0),R.value.pay?(l(),a(m,{key:2,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("payTime")),1)])),_:1}),d(m,null,{default:s((()=>[i(u(R.value.pay.pay_time),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1}),d(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[d(m,{class:"flex justify-between text-[28rpx] pt-[20rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("goodsMoney")),1)])),_:1}),d(m,{class:"text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(R.value.total_money),1)])),_:1})])),_:1}),d(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[40rpx]"},{default:s((()=>[d(m,null,{default:s((()=>[i(u(n(k)("realMoney")),1)])),_:1}),d(m,{class:"text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(R.value.total_pay_money),1)])),_:1})])),_:1})])),_:1})])),_:1}),d(m,{class:"h-[160rpx] w-full"}),d(m,{class:"flex z-2 justify-between items-center bg-[#fff] fixed left-0 right-0 bottom-0 min-h-[100rpx] px-1 flex-wrap pb-ios"},{default:s((()=>[d(m,{class:"flex ml-[30rpx] w-[70rpx] flex-col justify-center items-center",onClick:t[2]||(t[2]=e=>G("index"))},{default:s((()=>[d(r,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[36rpx]"}),d(r,{class:"text-xs mt-1"},{default:s((()=>[i(u(n(k)("index")),1)])),_:1})])),_:1}),R.value.order_status_info?(l(),a(m,{key:0,class:"flex justify-end mr-[30rpx]"},{default:s((()=>[(l(!0),o(p,null,x(R.value.order_status_info.member_action,((e,t)=>(l(),a(m,{key:t,class:"inline-block text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>G(e.key)},{default:s((()=>[i(u(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})):f("v-if",!0)])),_:1})])),_:1})):(l(),a(m,{key:1,class:"w-screen h-screen flex flex-col justify-center items-center"},{default:s((()=>[d(F,{icon:n(j)("static/resource/images/order_empty.png"),text:"未获取到订单信息"},null,8,["icon"])])),_:1})),f(" 刷新 "),d(m,{class:"fixed bottom-[calc(160rpx+env(safe-area-inset-bottom))] right-[30rpx] rounded-full bg-[#fff] w-[80rpx] h-[80rpx] flex flex-col items-center justify-center shadow-xl",onClick:$},{default:s((()=>[d(r,{class:"nc-iconfont nc-icon-shuaxinV6xx text-[36rpx]"}),d(r,{class:"text-[22rpx] mt-[6rpx]"},{default:s((()=>[i(u(n(k)("refresh")),1)])),_:1})])),_:1})],64)),d(H,{ref_key:"payRef",ref:E},null,512),d(I,{loading:B.value,"loading-text":"","bg-color":"none",loadingColor:"var(--primary-color)",iconSize:"35"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-21a79b77"]]);export{R as default};
