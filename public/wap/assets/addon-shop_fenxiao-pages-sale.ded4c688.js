import{d as e,j as a,r as t,p as l,o as s,c as o,w as r,O as n,b as i,n as c,u as p,y as u,z as d,P as m,a6 as _,f as x,a7 as f,a8 as v,a as g,D as y,i as b,B as h,g as k,h as j,a0 as w,Q as C,E as T,G as I}from"./index-2882a2d8.js";import{_ as S}from"./loading-page.vue_vue_type_script_setup_true_lang.cb99ee23.js";import{g as z,a as M,b as O,c as P}from"./sale.7b87516b.js";import{M as E}from"./mescroll-body.e69cb222.js";import{M as R}from"./mescroll-empty.7f392528.js";import{u as U}from"./useMescroll.26ccf5de.js";import{t as B}from"./topTabbar.ab70b119.js";import{c as D}from"./cloneDeep.065904ad.js";import{_ as Q}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-page.8280c7ab.js";import"./u-loading-icon.a37f7e61.js";/* empty css                                                                       */import"./u-transition.4448d2e5.js";import"./mescroll-i18n.c2747603.js";/* empty css                                                                       */import"./isArrayLike.512b2e7f.js";const Y=Q(e({__name:"sale",setup(e){let Q={};const{mescrollInit:Y,downCallback:Z,getMescroll:A}=U(v,f),F=B();F.setTopTabbarParam({title:"销售奖励"});const G=a((()=>{let e={backgroundImage:"url("+T("addon/shop_fenxiao/sale/head_bg.png")+") ",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPositionY:"-170rpx"};return e})),L=a((()=>Object.keys(Q).length?I(Number(Q.height))+I(Q.top)+I(8)+728+"rpx":"728rpx")),N=t(""),$=t(!0);l((async()=>{await z().then((e=>{N.value=e.data.is_open,0==N.value&&F.setTopTabbarParam({title:"销售奖励",topStatusBar:{textColor:"#333",bgColor:"#fff"}}),$.value=!1}))}));const q=t([{name:"全部",key:"all"},{name:"待发放",key:"0"},{name:"已发放",key:"1"}]),H=t("all"),J=t(0),K=t(!0),V=t(!0),W=t([]),X=e=>{V.value=!0,M({page:e.num,limit:e.size,is_send:H.value}).then((a=>{let t=a.data.data;1==e.num&&(W.value=[],"1"!=H.value&&ee(t)),W.value=W.value.concat(t),V.value=!1,e.endSuccess(t.length)})).catch((()=>{K.value=!1,V.value=!1,e.endErr()}))},ee=async e=>{K.value=!0;const a=await O();let t=e.map((e=>e.period_id));if(Object.keys(a.data).length&&(t.length&&-1==t.indexOf(a.data.id)||!t.length)){let e=D(a.data);e.reward_money=e.total_reward_money,e.period_id=e.id,e.order_money=e.total_order_money,W.value.unshift(e)}K.value=!1},ae=t({});P().then((e=>{ae.value=e.data}));const te=()=>{g({url:"/app/pages/member/commission"})};return(e,a)=>{const t=y,l=b,f=h,v=k(j("loading-page"),S);return s(),o(l,{class:"bg-[var(--page-bg-color)] min-h-[100vh]",style:c(e.themeColor())},{default:r((()=>[1!=N.value||$.value?x("v-if",!0):(s(),n(m,{key:0},[i(l,{class:"fixed w-full z-2 !bg-[var(--page-bg-color)]"},{default:r((()=>[i(l,{class:"w-full overflow-hidden",style:c(p(G))},{default:r((()=>[i(l,{class:"card-template sidebar-marign mt-[312rpx]"},{default:r((()=>[i(l,{class:"flex flex-col mb-[56rpx]",onClick:te},{default:r((()=>[i(t,{class:"text-[30rpx] h-[36rpx] leading-[36rpx] text-[#333] mb-[16rpx]"},{default:r((()=>[u("销售奖励（元）")])),_:1}),i(t,{class:"text-[48rpx] price-font text-[var(--price-text-color)] min-h-[58rpx]"},{default:r((()=>[u(d(p(w)(ae.value.sale_commission)||0),1)])),_:1})])),_:1}),i(l,{class:"flex item-center justify-between"},{default:r((()=>[i(l,{class:"flex flex-col w-[50%]"},{default:r((()=>[i(t,{class:"text-[28rpx] h-[34rpx] text-[var(--text-color-light6)] mb-[10rpx]"},{default:r((()=>[u("待发放（元）")])),_:1}),i(t,{class:"text-[36rpx] min-h-[46rpx] text-[#333] price-font"},{default:r((()=>[u(d(p(w)(ae.value.wait_sale_commission)||0),1)])),_:1})])),_:1}),i(l,{class:"flex flex-col w-[50%]"},{default:r((()=>[i(t,{class:"text-[28rpx] h-[34rpx] text-[var(--text-color-light6)] mb-[10rpx]"},{default:r((()=>[u("已发放（元）")])),_:1}),i(t,{class:"text-[36rpx] min-h-[46rpx] text-[#333] price-font"},{default:r((()=>[u(d(p(w)(ae.value.sale_commission_send)||0),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),i(l,{class:"tab-style-1 mt-[40rpx]"},{default:r((()=>[i(l,{class:"tab-left"},{default:r((()=>[(s(!0),n(m,null,_(q.value,((e,a)=>(s(),o(l,{class:C(["tab-left-item",{"class-select":H.value===e.key}]),onClick:t=>((e,a)=>{H.value=e,J.value=a,W.value=[],A().resetUpScroll()})(e.key,a)},{default:r((()=>[u(d(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1}),i(E,{ref:"mescrollRef",down:{use:!1},onInit:p(Y),onUp:X,top:p(L)},{default:r((()=>[!W.value.length||V.value||K.value?x("v-if",!0):(s(!0),n(m,{key:0},_(W.value,((e,a)=>(s(),o(l,{keys:a,class:"flex justify-between items-center card-template mt-[var(--top-m)] sidebar-marign",onClick:a=>{return t=e.period_id,void g({url:"/addon/shop_fenxiao/pages/sale_detail",param:{id:t}});var t}},{default:r((()=>[i(l,{class:"flex flex-col"},{default:r((()=>[e.is_settlement?(s(),o(l,{key:0,class:"text-[#333] text-[28rpx] flex items-center"},{default:r((()=>[i(t,{class:"text-[28rpx] mr-[6rpx]"},{default:r((()=>[u("结算时间")])),_:1}),i(t,null,{default:r((()=>[u(d(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)):(s(),o(l,{key:1,class:"text-[#333] text-[28rpx] flex items-center"},{default:r((()=>[i(t,{class:"text-[28rpx] mr-[6rpx]"},{default:r((()=>[u("预计结算时间")])),_:1}),i(t,null,{default:r((()=>[u(d(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)),i(l,{class:"mt-[16rpx] h-[34rpx] flex items-center text-[24rpx] text-[var(--text-color-light6)]"},{default:r((()=>[u(" 销售金额："+d(e.order_money),1)])),_:2},1024)])),_:2},1024),i(l,{class:C(["text-[28rpx] text-[var(--text-color-light6)]",{"text-[#333]":e.is_send,"text-[var(--primary-color)]":!e.is_send}])},{default:r((()=>[u(d(e.is_send?"已发放":"待发放"),1)])),_:2},1032,["class"])])),_:2},1032,["keys","onClick"])))),256)),W.value.length||V.value||K.value?x("v-if",!0):(s(),o(R,{key:1,option:{icon:p(T)("addon/shop_fenxiao/sale/empty.png"),tip:"暂无销售奖励记录",btnText:"去逛逛"},onEmptyclick:a[0]||(a[0]=e=>p(g)({url:"/addon/shop_fenxiao/pages/goods"}))},null,8,["option"]))])),_:1},8,["onInit","top"])],64)),0!=N.value||$.value?x("v-if",!0):(s(),o(l,{key:1,class:"h-[100vh] w-[100vw] overflow-hidden"},{default:r((()=>[i(l,{class:"empty-page"},{default:r((()=>[i(f,{class:"img",src:p(T)("static/resource/images/system/empty.png"),mode:"aspectFit"},null,8,["src"]),i(l,{class:"desc"},{default:r((()=>[u("销售奖励设置未开启")])),_:1})])),_:1})])),_:1})),i(v,{loading:$.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-923cac5b"]]);export{Y as default};
