import{d as e,l as a,j as l,r as t,p as o,o as s,P as r,b as u,w as n,c as p,y as d,z as i,u as f,f as c,n as m,Q as x,t as _,H as v,i as y,g as b,h as g,a5 as j,C,E as h}from"./index-7bf68536.js";import{_ as k}from"./u-icon.0c1c54c7.js";import{_ as w}from"./u-input.09a5cedd.js";import{_ as V}from"./u-popup.be4bfacd.js";import{_ as B}from"./pay.d2e850e8.js";import{c as F}from"./pay.d8c8791c.js";import{g as z}from"./config.634448d3.js";import{_ as D}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-transition.cdf87992.js";import"./u-safe-bottom.908eeae4.js";import"./u-image.e46f68ef.js";import"./pay.2db06871.js";const N=D(e({__name:"pay",setup(e){const D=a(),N=l((()=>D.info)),E=t(""),I=t(""),L=t(!1),O=t(null),S=t(!1),U=t();(async()=>{const e=await z();U.value=e.data})();const A=()=>{L.value=!1},H=()=>{L.value=!0},M=e=>{let a=e.detail.value;return isNaN(a)?(_({title:"请输入有效金额",icon:"none"}),void(E.value="")):-1!=a.indexOf(".")&&a.split(".")[1].length>2?(_({title:"最多输入两位小数",icon:"none"}),void(E.value="")):(a.startsWith(".")&&(a="0"+a),parseFloat(a)<0?(_({title:"金额必须大于或等于0",icon:"none"}),void(E.value="")):void(E.value=a))};return o((e=>{e.price&&(E.value=e.price)})),(e,a)=>{const l=y,t=b(g("u-icon"),k),o=j,z=C,D=b(g("up-input"),w),P=b(g("up-popup"),V),Q=b(g("pay"),B);return s(),r(x,null,[u(l,{style:m(e.themeColor())},{default:n((()=>[U.value?(s(),p(l,{key:0,class:"tk-card flex justify-between items-center"},{default:n((()=>[u(l,null,{default:n((()=>[u(l,{class:"font-bold text-[30rpx] mt-1"},{default:n((()=>[d(i(U.value.business_name),1)])),_:1}),u(l,{class:"text-[#21231E] text-[18rpx] mt-2"},{default:n((()=>[d("付款给商户")])),_:1})])),_:1}),u(l,null,{default:n((()=>[u(t,{name:f(h)(U.value.business_logo),size:"42"},null,8,["name"])])),_:1})])),_:1})):c("v-if",!0),u(l,{class:"p-4 pl-8 pr-8"},{default:n((()=>[u(l,null,{default:n((()=>[u(l,null,{default:n((()=>[d("金额")])),_:1}),u(l,{class:"flex items-center mt-3 mb-2"},{default:n((()=>[u(l,{class:"text--[48rpx] font-bold mr-2"},{default:n((()=>[d("￥")])),_:1}),u(o,{type:"digit",class:"h-[76rpx] leading-[76rpx] pl-[10rpx] flex-1 font-bold text-[54rpx] bg-[#fff]",modelValue:E.value,"onUpdate:modelValue":a[0]||(a[0]=e=>E.value=e),maxlength:"7","placeholder-class":"apply-price","adjust-position":!1,onInput:M,autofocus:""},null,8,["modelValue"])])),_:1}),u(l,{class:"line-box"}),u(l,{class:"mt-4 text-[#297bff]",onClick:a[1]||(a[1]=e=>H())},{default:n((()=>[d("添加备注")])),_:1})])),_:1})])),_:1}),u(l,{class:"h-[66rpx]"}),u(l,{class:"b-tabbar safe-area-inset-bottom flex justify-between"},{default:n((()=>[u(l,{class:"flex flex-1"},{default:n((()=>[u(z,{class:"w-[100%] !h-[72rpx] leading-[72rpx] text-[26rpx] rounded-[50rpx]",style:{color:"#ffffff",backgroundColor:"#07C160",borderColor:"#07C160"},onClick:a[2]||(a[2]=e=>(async()=>{var e;if(!E.value)return void _({title:"请输入金额",icon:"none"});if(!N.value){let e=uni.getStorageSync("pid");return e&&e>0?(v().setLoginBack({url:"/addon/fast_pay/pages/pay/pay?mid="+e}),!1):(v().setLoginBack({url:"/addon/fast_pay/pages/pay/pay"}),!1)}if(!/^(0|[1-9]\d*)(\.\d{1,2})?$/.test(E.value))return _({title:"金额必须大于0且最多只能有两位小数",icon:"none"}),void(E.value="");const a=await F({price:E.value,remark:I.value});S.value=!0,null==(e=O.value)||e.open(a.data.trade_type,a.data.trade_id,"/addon/fast_pay/pages/pay/pay")})())},{default:n((()=>[d("立即支付")])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),u(P,{round:10,show:L.value,onClose:A,onOpen:H,mode:"bottom"},{default:n((()=>[u(l,{class:"pl-4 pr-4 mb-4 mt-4"},{default:n((()=>[u(l,{class:"font-bold text-[28rpx]"},{default:n((()=>[d("添加备注")])),_:1}),u(l,{class:"flex items-center mt-4"},{default:n((()=>[u(D,{placeholder:" ",border:"surround",modelValue:I.value,"onUpdate:modelValue":a[3]||(a[3]=e=>I.value=e),clearable:!0},null,8,["modelValue"])])),_:1}),u(l,{class:"flex mt-4"},{default:n((()=>[u(z,{class:"w-[100%] !h-[72rpx] leading-[72rpx] text-[26rpx] rounded-[10rpx] mr-2",style:{color:"#000000",backgroundColor:"#d8d8d8",borderColor:"#29DB6F"},onClick:a[4]||(a[4]=e=>A())},{default:n((()=>[d("取消")])),_:1}),u(z,{class:"w-[100%] !h-[72rpx] leading-[72rpx] text-[26rpx] rounded-[10rpx]",style:{color:"#ffffff",backgroundColor:"#29DB6F",borderColor:"#29DB6F"},onClick:a[5]||(a[5]=e=>A())},{default:n((()=>[d("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"]),u(Q,{ref_key:"payRef",ref:O,onClose:a[6]||(a[6]=e=>S.value=!1)},null,512)],64)}}}),[["__scopeId","data-v-f5a674da"]]);export{N as default};
