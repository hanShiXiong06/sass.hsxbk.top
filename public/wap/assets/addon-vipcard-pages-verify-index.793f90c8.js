import{d as e,r as a,j as t,o as l,c as r,w as u,P as s,b as d,y as n,z as c,u as o,f as i,R as m,Q as p,n as x,t as f,F as _,i as v,B as y,g,h,C as b,D as w,E as j,a as k}from"./index-7bf68536.js";import{_ as V}from"./u-number-box.30c0ab2e.js";import{_ as C}from"./u-button.359d7329.js";import{_ as T}from"./u-input.09a5cedd.js";import{_ as E}from"./u-empty.68b4529f.js";import{_ as F}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{C as M,D as N,E as R}from"./vipcard.fb0aea23.js";import"./u-icon.0c1c54c7.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.b37701e7.js";import"./u-loading-page.566c330a.js";import"./u-transition.cdf87992.js";const D=e({__name:"index",setup(e){const D=a(!0),I=a(!1),P=a(""),U=a(!1),$=a(null),K=a(1);M().then((()=>{I.value=!0,D.value=!1})).catch((()=>{D.value=!1}));const O=()=>{uni.$u.test.isEmpty(P.value)?f({title:_("inputPlaceholder"),icon:"none"}):N(P.value).then((e=>{Object.values(e.data).length?($.value=e.data,P.value=""):f({title:_("notSearchResult"),icon:"none"})})).catch((()=>{f({title:_("notSearchResult"),icon:"none"})}))},S=()=>{U.value||(U.value=!0,R({verify_code:$.value.verify_code,num:K.value}).then((()=>{$.value=null,U.value=!1})).catch((()=>{U.value=!1})))},z=t((()=>$.value?"timecard"==$.value.card.card_type?100:"commoncard"==$.value.card.card_type?$.value.card.total_num-$.value.card.total_use_num:"oncecard"==$.value.card.card_type?$.value.num-$.value.use_num:void 0:1)),A=t((()=>!!$.value&&(!("timecard"==$.value.card.card_type&&$.value.card.expire_time<parseInt((new Date).getTime()/1e3))&&!(z.value<=0))));return(e,a)=>{const t=v,f=y,M=g(h("u-number-box"),V),N=b,R=g(h("u-button"),C),U=g(h("u-input"),T),B=w,L=g(h("u-empty"),E),Q=g(h("loading-page"),F);return l(),r(t,{style:x(e.themeColor())},{default:u((()=>[D.value?i("v-if",!0):(l(),s(p,{key:0},[I.value?(l(),r(t,{key:0,class:"bg-[#f7f7f7] min-h-screen overflow-hidden"},{default:u((()=>[d(t,{class:"h-[30rpx]"}),$.value?(l(),r(t,{key:0,class:"mx-[30rpx]"},{default:u((()=>[d(t,{class:"bg-white px-[30rpx] py-[40rpx] rounded"},{default:u((()=>[d(t,{class:"text-center font-bold"},{default:u((()=>[n(c($.value.verify_code),1)])),_:1}),d(t,{class:"text-center font-bold text-[#f00] mt-[10rpx] text-sm"},{default:u((()=>[n(c(o(A)?o(_)("waitUse"):o(_)("used")),1)])),_:1})])),_:1}),d(t,{class:"bg-white px-[30rpx] py-[40rpx] rounded flex mt-[20rpx]"},{default:u((()=>[d(t,{class:"w-[180rpx] mr-3 overflow-hidden rounded leading-none"},{default:u((()=>[d(f,{src:o(j)($.value.cover_thumb_small),mode:"widthFix",class:"w-full leading-none"},null,8,["src"])])),_:1}),d(t,{class:"flex-1 w-0"},{default:u((()=>[d(t,{class:"font-bold truncate text-sm"},{default:u((()=>[n(c($.value.goods_name),1)])),_:1}),d(t,{class:"flex justify-between"})])),_:1})])),_:1}),d(t,{class:"bg-white px-[30rpx] py-[30rpx] rounded mt-[20rpx]"},{default:u((()=>[d(t,{class:"flex text-sm mt-[20rpx]"},{default:u((()=>[d(t,{class:"text-gray-400 w-[150rpx]"},{default:u((()=>[n(c(o(_)("createTime"))+"：",1)])),_:1}),d(t,null,{default:u((()=>[n(c(e.$u.timeFormat($.value.card.create_time,"yyyy-mm-dd hh:MM:ss")),1)])),_:1})])),_:1}),d(t,{class:"flex text-sm mt-[20rpx]"},{default:u((()=>[d(t,{class:"text-gray-400 w-[150rpx]"},{default:u((()=>[n(c(o(_)("expireTime"))+"：",1)])),_:1}),d(t,null,{default:u((()=>[n(c($.value.expire_time?e.$u.timeFormat($.value.expire_time,"yyyy-mm-dd\n                                hh:MM: ss"):o(_)("longTerm")),1)])),_:1})])),_:1}),d(t,{class:"flex text-sm mt-[20rpx]"},{default:u((()=>[d(t,{class:"text-gray-400 w-[150rpx]"},{default:u((()=>[n(c(o(_)("availableNum"))+"：",1)])),_:1}),"timecard"==$.value.card.card_type?(l(),r(t,{key:0},{default:u((()=>[n(c(o(_)("noLimitNum")),1)])),_:1})):(l(),r(t,{key:1},{default:u((()=>[n(c("oncecard"==$.value.card.card_type?$.value.num:$.value.card.total_num),1)])),_:1}))])),_:1}),d(t,{class:"flex text-sm mt-[20rpx]"},{default:u((()=>[d(t,{class:"text-gray-400 w-[180rpx]"},{default:u((()=>[n(c(o(_)("useNum"))+"：",1)])),_:1}),d(t,null,{default:u((()=>[n(c($.value.use_num),1)])),_:1})])),_:1}),o(A)?(l(),r(t,{key:0,class:"flex text-sm mt-[20rpx]"},{default:u((()=>[d(t,{class:"text-gray-400 w-[150rpx]"},{default:u((()=>[n(c(o(_)("verifyNum"))+"：",1)])),_:1}),d(t,null,{default:u((()=>[d(M,{min:1,max:o(z),modelValue:K.value,"onUpdate:modelValue":a[0]||(a[0]=e=>K.value=e)},null,8,["max","modelValue"])])),_:1})])),_:1})):i("v-if",!0)])),_:1}),o(A)?(l(),r(t,{key:0,class:"mt-[30rpx]"},{default:u((()=>[d(N,{class:"bg-[var(--primary-color)] text-[#fff] h-[80rpx] leading-[80rpx] rounded-[100rpx] text-[28rpx]",onClick:S},{default:u((()=>[n(c(o(_)("confirmVerify")),1)])),_:1})])),_:1})):i("v-if",!0),d(t,{class:"mt-[30rpx]"},{default:u((()=>[d(R,{text:o(_)("verifyOther"),type:"primary",shape:"circle",onClick:a[1]||(a[1]=e=>$.value=null),plain:!0},null,8,["text"])])),_:1})])),_:1})):(l(),r(t,{key:1,class:"bg-white px-[30rpx] py-[50rpx] mx-[30rpx] rounded"},{default:u((()=>[d(t,{class:"text-center mt-[30rpx]"},{default:u((()=>[n(c(o(_)("verifyTitle")),1)])),_:1}),d(t,{class:"my-[60rpx]"},{default:u((()=>[d(U,{placeholder:o(_)("inputPlaceholder"),border:"surround",inputAlign:"center",modelValue:P.value,"onUpdate:modelValue":a[2]||(a[2]=e=>P.value=e)},null,8,["placeholder","modelValue"])])),_:1}),d(N,{class:m(["!bg-[var(--primary-color)] !text-[#fff] h-[80rpx] leading-[80rpx] rounded-[100rpx] text-[28rpx]",{"opacity-50":!P.value}]),disabled:!P.value,onClick:O},{default:u((()=>[n(c(o(_)("search")),1)])),_:1},8,["class","disabled"])])),_:1})),d(t,{class:"text-center mt-[20rpx]"},{default:u((()=>[d(t,{onClick:a[3]||(a[3]=e=>o(k)({url:"/addon/vipcard/pages/verify/record"}))},{default:u((()=>[d(B,{class:"text-primary text-sm"},{default:u((()=>[n(c(o(_)("verifyRecord")),1)])),_:1})])),_:1})])),_:1})])),_:1})):(l(),r(t,{key:1,class:"w-screen h-screen flex flex-col justify-center items-center"},{default:u((()=>[d(L,{icon:o(j)("static/resource/images/order_empty.png"),text:o(_)("notIsVerifier")},null,8,["icon","text"])])),_:1}))],64)),d(Q,{loading:D.value},null,8,["loading"])])),_:1},8,["style"])}}});export{D as default};
