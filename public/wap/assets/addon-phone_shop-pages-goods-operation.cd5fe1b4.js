import{d as e,r as t,x as a,s,t as l,T as r,U as o,a as n,o as u,c as p,w as c,b as i,u as x,f as d,e as f,v as m,y as _,Q as g,O as v,a6 as h,P as b,n as y,q as k,bV as w,i as j,B as C,D as S,a4 as V,g as F,h as z,E as I,z as E}from"./index-9317da28.js";import{_ as U}from"./u-loading-page.de89bca9.js";import{_ as D}from"./u-button.c3400270.js";import{_ as H}from"./u-popup.1f2ebcae.js";import{g as O}from"./verify.05584230.js";import{c as Q,o as T}from"./goods.c916db1a.js";import{_ as Z}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.aabe3d05.js";/* empty css                                                                       */import"./u-transition.65be38eb.js";import"./u-icon.5e775659.js";import"./u-safe-bottom.3546c5bb.js";const q=Z(e({__name:"operation",setup(e){const Z=t("manualInput"),q=t(!1),A=t([]);Z.value="manualInput";const B=t(!1),L=t(""),P=t(!0);a((()=>{s()&&R()}));const R=()=>{O().then((e=>{e.data?P.value=!1:(l({title:"非操作员无此权限",icon:"none"}),setTimeout((()=>{r().length>1?o({delta:1}):n({url:"/app/pages/member/index",mode:"reLaunch"})}),1e3))}))},X=()=>{k()&&(w.init(),w.scanQRCode((e=>{if(e.resultStr){let t=e.resultStr;Q({sku_no:t,status:"all"}).then((e=>{A.value=e.data.data,q.value=!0,G=!1}))}})))};let G=!1;const J=()=>/[\S]+/.test(L.value)?!G&&(G=!0,void Q({sku_no:L.value,status:"all"}).then((e=>{console.log(e),A.value=e.data.data,q.value=!0,G=!1}))):(l({title:"请输入核销码",icon:"none"}),!1),K=()=>{B.value=!B.value},M=()=>{q.value=!1},N=()=>{q.value=!0},W=e=>{T(e).then((e=>{console.log(e),1==e.code&&l({title:"操作成功",icon:"none"}),q.value=!1}))},Y=e=>{"sweepCode"!=e||k()?Z.value=e:l({title:"H5端不支持扫码核销",icon:"none"})},$=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&s()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,parseFloat(t)};return(e,t)=>{const a=j,s=C,l=S,r=V,o=F(z("u-loading-page"),U),k=F(z("up-button"),D),w=F(z("up-popup"),H);return u(),p(a,{style:y(e.themeColor())},{default:c((()=>[P.value?d("v-if",!0):(u(),p(a,{key:0,class:"w-[100vw] min-h-[100vh] bg-[#f8f8f8]"},{default:c((()=>[i(a,{class:"w-full bg-[#fff] verify-box h-[760rpx]"},{default:c((()=>[i(a,{class:"text-[var(--primary-color)] fixed top-[40rpx] right-[30rpx] flex items-center",onClick:t[0]||(t[0]=e=>x(n)({url:"/app/pages/verify/record"}))},{default:c((()=>[d(' <image class="w-[26rpx] h-[28rpx]" :src="img(\'static/resource/images/verify/history.png\')" /> '),d(' <text class="text-[26rpx] ml-[10rpx]">核销记录</text> ')])),_:1}),f(i(a,{class:"flex flex-col items-center justify-center"},{default:c((()=>[i(a,{class:"sweep-code flex items-center justify-center",onClick:X},{default:c((()=>[i(s,{class:"w-[354rpx] h-[354rpx]",src:x(I)("static/resource/images/verify/saoma.png")},null,8,["src"])])),_:1}),i(a,{class:"mt-[40rpx] text-[32rpx]"},{default:c((()=>[_("点击扫描二维码")])),_:1}),i(a,{class:"mt-[20rpx] text-[#8288A2] text-[26rpx] font-400 pb-[142rpx]"},{default:c((()=>[_("扫描二维码进行查找设备")])),_:1})])),_:1},512),[[m,"sweepCode"==Z.value]]),f(i(a,null,{default:c((()=>[i(a,{class:"flex pt-[126rpx] items-center justify-center"},{default:c((()=>[i(a,{class:"flex justify-center items-center flex-col pr-[30rpx] w-[130rpx]"},{default:c((()=>[i(s,{class:"w-[100rpx] h-[100rpx]",src:x(I)("static/resource/images/verify/shuruhexiaoma.png")},null,8,["src"]),i(a,{class:"text-[26rpx] h-[36rpx] leading-[36rpx] mt-[12rpx]"},{default:c((()=>[_("操作设备")])),_:1})])),_:1}),i(s,{class:"w-[74rpx] h-[12rpx] mb-[50rpx]",src:x(I)("static/resource/images/verify/youjiantou.png")},null,8,["src"]),i(a,{class:"flex justify-center items-center flex-col pl-[30rpx] w-[130rpx]"},{default:c((()=>[i(s,{class:"w-[100rpx] h-[100rpx]",src:x(I)("static/resource/images/verify/hexiao1.png")},null,8,["src"]),i(a,{class:"text-[26rpx] h-[36rpx] leading-[36rpx] mt-[12rpx]"},{default:c((()=>[_("上/下架")])),_:1})])),_:1})])),_:1}),i(a,{class:"mt-[50rpx]"},{default:c((()=>[i(a,{class:"h-[90rpx] border-[2rpx] border-solid border-[#DCE0EF] rounded-[16rpx] box-border p-[20rpx] mx-[60rpx] flex items-center"},{default:c((()=>[i(l,{class:"nc-iconfont nc-icon-saotiaoxingmaV6xx text-[44rpx] text-[#EF000C]"}),i(r,{type:"text",placeholder:"请输入设备sn号",class:"h-[90rpx] border-none text-start ml-[30rpx] text-[28rpx] flex-1","placeholder-class":"_placeholder",modelValue:L.value,"onUpdate:modelValue":t[1]||(t[1]=e=>L.value=e),focus:B.value,ref:"input"},null,8,["modelValue","focus"])])),_:1}),i(a,{class:"h-[88rpx] min-w-[630rpx] text-[#fff] flex items-center justify-center !text-[32rpx] save-btn rounded-[50rpx] h-[88rpx] mx-[60rpx] mt-[146rpx] relative z-1",onClick:J},{default:c((()=>[_("确认")])),_:1})])),_:1})])),_:1},512),[[m,"manualInput"==Z.value]])])),_:1}),i(a,{class:"w-[630rpx] h-[100rpx] bg-[#fff] mx-[auto] mt-[220rpx] rounded-[90rpx] flex relative action-type-wrap"},{default:c((()=>[i(a,{class:g(["relative w-[51%] pr-[50rpx] box-border rounded-[50rpx] z-0 flex flex-col items-center justify-center",{xuanZhong1:"sweepCode"==Z.value}]),onClick:t[2]||(t[2]=e=>Y("sweepCode"))},{default:c((()=>[i(l,{class:"nc-iconfont nc-icon-saoyisaoV6xx !text-[40rpx]"}),i(a,{class:"text-[24rpx] leading-[1] mt-[10rpx]"},{default:c((()=>[_("扫码操作")])),_:1})])),_:1},8,["class"]),i(a,{class:"flex flex-col items-center flex-col w-[120rpx] h-[120rpx] bg-[#FF7354] rounded-[50%] absolute top-[-10rpx] left-[255rpx] heXiao text-white z-10 shrink-0"},{default:c((()=>[i(a,{class:"nc-iconfont nc-icon-saotiaoxingmaV6xx ns-gradient-otherpages-member-balance-balance-rechange !text-[44rpx] mt-[19rpx]"}),i(a,{class:"text-[24rpx] mt-[8rpx] leading-[34rpx] h-[34rpx]"},{default:c((()=>[_("操作台")])),_:1})])),_:1}),i(a,{class:g(["relative w-[51%] pl-[50rpx] box-border rounded-[50rpx] z-0 flex flex-col items-center justify-center",{xuanZhong:"manualInput"==Z.value}]),onClick:t[3]||(t[3]=e=>Y("manualInput"))},{default:c((()=>[i(l,{class:"iconfont iconVector-77 !text-[40rpx]"}),i(a,{class:"ml-[20rpx] text-[24rpx] leading-[1] mt-[10rpx]",onClick:K},{default:c((()=>[_("手动输入")])),_:1})])),_:1},8,["class"])])),_:1})])),_:1})),i(o,{loading:P.value,"loading-text":"",loadingColor:"var(--primary-color)",iconSize:"35"},null,8,["loading"]),i(w,{round:10,show:q.value,"onUpdate:show":t[4]||(t[4]=e=>q.value=e),mode:"center",onClose:M,onOpen:N},{default:c((()=>[i(a,{class:"up-popup-wrap"},{default:c((()=>[(u(!0),v(b,null,h(A.value,(e=>(u(),p(a,{class:"p-2 flex justify-between m-2"},{default:c((()=>[i(a,null,{default:c((()=>[i(a,null,{default:c((()=>[_(E(e.goods_name),1)])),_:2},1024),i(a,null,{default:c((()=>[_(E(e.sub_title),1)])),_:2},1024),i(a,null,{default:c((()=>[_(" sn:"+E(e.goodsSku.sku_no),1)])),_:2},1024),i(a,null,{default:c((()=>[_("入库时间:"+E(e.create_time),1)])),_:2},1024)])),_:2},1024),i(a,null,{default:c((()=>[i(a,null,{default:c((()=>[i(l,{class:"text-[26rpx] font-500"},{default:c((()=>[_("￥")])),_:1}),i(l,{class:"text-[36rpx] font-500"},{default:c((()=>[_(E($(e).toFixed(2).split(".")[0]),1)])),_:2},1024),i(l,{class:"text-[24rpx] font-500"},{default:c((()=>[_("."+E($(e).toFixed(2).split(".")[1]),1)])),_:2},1024)])),_:2},1024),i(a,null,{default:c((()=>[e.status?(u(),p(k,{key:0,type:"error",onClick:t=>W(e.goods_id),text:"下架"},null,8,["onClick"])):(u(),p(k,{key:1,type:"success",onClick:t=>W(e.goods_id),text:"上架"},null,8,["onClick"]))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])),_:1},8,["show"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-eaf39082"]]);export{q as default};
