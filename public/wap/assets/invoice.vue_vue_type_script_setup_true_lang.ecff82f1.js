import{d as e,r as l,p as a,g as t,h as r,o,c as s,w as u,b as d,_ as n,x as i,E as p,G as m,F as c,H as _,y as f,f as x,u as b,V as v,bc as h,I as y,i as g,C as k,a4 as V,b9 as C,m as j,e as w,v as U}from"./index-905183d4.js";import{_ as M}from"./u-loading-icon.c376267d.js";import{_ as T}from"./u-empty.09c683e5.js";import{_ as F}from"./u-button.d3798ecb.js";import{_ as $}from"./u-popup.e3f6594b.js";import{i as q}from"./order.f2e9a9a3.js";import{_ as E,a as P}from"./u-form.7ae4e9da.js";import{_ as z}from"./u-input.07f64251.js";const A=e({__name:"select-store",emits:["confirm"],setup(e,{expose:C,emit:j}){const w=l(!1),U=l(!1),E=l(!0),P=l([]),z=l(null),A=a({lat:0,lng:0}),G=()=>{j("confirm",z.value),w.value=!1},H=e=>{if((e=parseFloat(e))<1e3)return`${e}m`;return`${(e/1e3).toFixed(2)}km`};return C({open:()=>{U.value||(U.value=!0,h({type:"gcj02",success:e=>{A.lat=e.latitude,A.lng=e.longitude},fail:e=>{if(e.errMsg&&e.errno)if(104==e.errno){y({title:"用户未授权隐私权限，获取位置失败",icon:"none"})}else if(112==e.errno){y({title:"隐私协议中未声明，获取位置失败",icon:"none"})}else if("getLocation:fail auth deny"==e.errMsg){y({title:"用户未授权获取位置的权限",icon:"none"})}else y({title:e.errMsg,icon:"none"})}}),setTimeout((()=>{q({latlng:A}).then((({data:e})=>{P.value=e,E.value=!1})).catch((()=>{E.value=!1}))}),1500)),w.value=!0}}),(e,l)=>{const a=g,h=k,y=t(r("u-loading-icon"),M),C=t(r("u-empty"),T),j=V,U=t(r("u-button"),F),q=t(r("u-popup"),$);return o(),s(q,{show:w.value,onClose:l[1]||(l[1]=e=>w.value=!1),mode:"bottom",round:10,closeable:!0},{default:u((()=>[d(a,{onTouchmove:l[0]||(l[0]=n((()=>{}),["prevent","stop"]))},{default:u((()=>[d(a,{class:"text-center p-[30rpx]"},{default:u((()=>[i("请选择自提点")])),_:1}),d(j,{"scroll-y":"true",class:"h-[50vh]"},{default:u((()=>[d(a,{class:"p-[30rpx] pt-0 text-sm"},{default:u((()=>[(o(!0),p(m,null,c(P.value,(e=>(o(),s(a,{class:_(["mt-[30rpx] p-[30rpx] border-1 !border-[#eee] border-solid rounded-[20rpx]",{"!border-primary bg-primary-light":z.value&&z.value.store_id==e.store_id}]),onClick:l=>{return a=e,void(z.value?z.value=z.value.store_id!=a.store_id?a:null:z.value=a);var a}},{default:u((()=>[d(a,{class:"font-bold flex"},{default:u((()=>[d(a,{class:"flex-1 w-0"},{default:u((()=>[d(h,null,{default:u((()=>[i(f(e.store_name),1)])),_:2},1024),d(h,{class:"text-[26rpx] ml-[20rpx]"},{default:u((()=>[i(f(e.store_mobile),1)])),_:2},1024)])),_:2},1024),e.distance?(o(),s(a,{key:0},{default:u((()=>[d(h,{class:"text-red text-xs font-normal"},{default:u((()=>[i(f(H(e.distance)),1)])),_:2},1024)])),_:2},1024)):x("v-if",!0)])),_:2},1024),d(a,{class:"mt-[16rpx] text-[26rpx]"},{default:u((()=>[i(f(e.full_address),1)])),_:2},1024),d(a,{class:"mt-[16rpx] text-[26rpx]"},{default:u((()=>[i("营业时间："+f(e.trade_time),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),256))])),_:1}),E.value?(o(),s(a,{key:0,class:"h-[50vh] flex items-center flex-col justify-center"},{default:u((()=>[d(y,{vertical:!0})])),_:1})):x("v-if",!0),E.value||P.value.length?x("v-if",!0):(o(),s(a,{key:1,class:"h-[50vh] flex items-center flex-col justify-center"},{default:u((()=>[d(C,{text:"没有可选择的自提点",icon:b(v)("static/resource/images/empty.png")},null,8,["icon"])])),_:1}))])),_:1}),d(a,{class:"p-[30rpx]"},{default:u((()=>[d(U,{type:"primary",shape:"circle",onClick:G},{default:u((()=>[i("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])}}});const G=e({__name:"invoice",emits:["confirm"],setup(e,{expose:a,emit:v}){const h=l(!1),y=l({is_invoice:2,invoice_content:[]}),M=l(!1),T=l(!1),q=l({header_type:1,header_name:"",type:"",name:"",tax_number:"",telephone:"",address:"",bank_name:"",bank_card_number:""}),A=j((()=>1==y.value.is_invoice));C.get("shop/config/invoice").then((({data:e})=>{y.value=e,e.invoice_content.length&&(q.value.name=e.invoice_content[0])})).catch();const G=l(null),H=j((()=>({header_name:{type:"string",required:M.value,message:"请输入发票抬头",trigger:["blur","change"]},tax_number:[{type:"string",required:M.value&&2==q.value.header_type,message:"请输入纳税人识别号",trigger:["blur","change"]},{validator(e,l,a){/^[0-9a-zA-Z]+$/.test(l)||2!=q.header_type?a():a(new Error("请输入正确的纳税人识别号"))}}]}))),I=()=>{G.value.validate().then((()=>{const e=M.value?q.value:{};v("confirm",e),h.value=!1}))};return a({open:()=>{h.value=!0},invoiceOpen:A}),(e,l)=>{const a=g,v=t(r("u-form-item"),E),C=t(r("u-input"),z),j=k,A=t(r("u-form"),P),K=V,L=t(r("u-button"),F),N=t(r("u-popup"),$);return o(),s(N,{show:h.value,onClose:l[12]||(l[12]=e=>h.value=!1),mode:"bottom",round:10,closeable:!0},{default:u((()=>[d(a,{onTouchmove:l[11]||(l[11]=n((()=>{}),["prevent","stop"]))},{default:u((()=>[d(a,{class:"text-center p-[30rpx]"},{default:u((()=>[i("请填写发票信息")])),_:1}),d(K,{"scroll-y":"true",class:"max-h-[50vh]"},{default:u((()=>[d(a,{class:"p-[30rpx] pt-0 text-sm"},{default:u((()=>[d(A,{labelPosition:"left",model:q.value,labelWidth:"200rpx",errorType:"toast",rules:b(H),ref_key:"formRef",ref:G},{default:u((()=>[d(a,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"需要发票","border-bottom":!0},{default:u((()=>[d(a,{class:"flex"},{default:u((()=>[d(a,{class:_(["rounded px-[30rpx] py-[10rpx] mr-[20rpx] border-1 !border-[#eee] border-solid text-sm",{"bg-primary text-white !border-primary":!M.value}]),onClick:l[0]||(l[0]=e=>M.value=!1)},{default:u((()=>[i("不需要")])),_:1},8,["class"]),d(a,{class:_(["rounded px-[30rpx] py-[10rpx] border-1 !border-[#eee] border-solid text-sm",{"bg-primary text-white !border-primary":M.value}]),onClick:l[1]||(l[1]=e=>M.value=!0)},{default:u((()=>[i("需要")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),w(d(a,null,{default:u((()=>[d(a,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"抬头类型","border-bottom":!0},{default:u((()=>[d(a,{class:"flex"},{default:u((()=>[d(a,{class:_(["rounded px-[30rpx] py-[10rpx] mr-[20rpx] border-1 !border-[#eee] border-solid text-sm",{"bg-primary text-white !border-primary":1==q.value.header_type}]),onClick:l[2]||(l[2]=e=>q.value.header_type=1)},{default:u((()=>[i("个人")])),_:1},8,["class"]),d(a,{class:_(["rounded px-[30rpx] py-[10rpx] border-1 !border-[#eee] border-solid text-sm",{"bg-primary text-white !border-primary":2==q.value.header_type}]),onClick:l[3]||(l[3]=e=>q.value.header_type=2)},{default:u((()=>[i("企业")])),_:1},8,["class"])])),_:1})])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"发票内容",prop:"header_name","border-bottom":!0},{default:u((()=>[d(a,{class:"flex"},{default:u((()=>[(o(!0),p(m,null,c(y.value.invoice_content,(e=>(o(),s(a,{class:_(["rounded px-[30rpx] py-[10rpx] mr-[20rpx] border-1 !border-[#eee] border-solid text-sm",{"bg-primary text-white !border-primary":q.value.name==e}]),onClick:l=>q.value.name=e},{default:u((()=>[i(f(e),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"发票抬头",prop:"header_name","border-bottom":!0},{default:u((()=>[d(C,{modelValue:q.value.header_name,"onUpdate:modelValue":l[4]||(l[4]=e=>q.value.header_name=e),modelModifiers:{trim:!0},border:"none",clearable:"",placeholder:"请输入发票抬头"},null,8,["modelValue"])])),_:1})])),_:1}),2==q.value.header_type?(o(),s(a,{key:0},{default:u((()=>[d(a,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"纳税人识别号",prop:"tax_number","border-bottom":!0},{default:u((()=>[d(C,{modelValue:q.value.tax_number,"onUpdate:modelValue":l[5]||(l[5]=e=>q.value.tax_number=e),modelModifiers:{trim:!0},border:"none",clearable:"",placeholder:"请输入纳税人识别号"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"py-[20rpx] flex items-baseline"},{default:u((()=>[d(j,{class:"text-[30rpx]"},{default:u((()=>[i("更多选填内容")])),_:1}),d(j,{class:"text-xs text-gray-subtitle ml-[10rpx]"},{default:u((()=>[i("注册地址、电话、开户银行及账号")])),_:1}),d(a,{class:"text-xs text-right flex-1",onClick:l[6]||(l[6]=e=>T.value=!T.value)},{default:u((()=>[d(j,null,{default:u((()=>[i(f(T.value?"收起":"展开"),1)])),_:1}),d(j,{class:_(["text-xs iconfont text-gray-subtitle ml-[5rpx]",T.value?"iconjiantoushang":"iconxialajiantouxiao"])},null,8,["class"])])),_:1})])),_:1}),w(d(a,null,{default:u((()=>[d(a,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"注册地址","border-bottom":!0},{default:u((()=>[d(C,{modelValue:q.value.address,"onUpdate:modelValue":l[7]||(l[7]=e=>q.value.address=e),border:"none",clearable:"",placeholder:"(选填)请输入企业注册地址"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"注册电话","border-bottom":!0},{default:u((()=>[d(C,{modelValue:q.value.telephone,"onUpdate:modelValue":l[8]||(l[8]=e=>q.value.telephone=e),border:"none",clearable:"",placeholder:"(选填)请输入企业注册电话"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"开户银行","border-bottom":!0},{default:u((()=>[d(C,{modelValue:q.value.bank_name,"onUpdate:modelValue":l[9]||(l[9]=e=>q.value.bank_name=e),border:"none",clearable:"",placeholder:"(选填)请输入企业开户银行"},null,8,["modelValue"])])),_:1})])),_:1}),d(a,{class:"mt-[10rpx]"},{default:u((()=>[d(v,{label:"银行账号","border-bottom":!0},{default:u((()=>[d(C,{modelValue:q.value.bank_card_number,"onUpdate:modelValue":l[10]||(l[10]=e=>q.value.bank_card_number=e),border:"none",clearable:"",placeholder:"(选填)请输入企业开户银行账号"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},512),[[U,T.value]])])),_:1})):x("v-if",!0)])),_:1},512),[[U,M.value]])])),_:1},8,["model","rules"])])),_:1})])),_:1}),d(a,{class:"p-[30rpx]"},{default:u((()=>[d(L,{type:"primary",shape:"circle",onClick:I},{default:u((()=>[i("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])}}});export{A as _,G as a};
