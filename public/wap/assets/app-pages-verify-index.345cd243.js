import{d as a,r as e,a9 as s,X as t,I as l,Y as o,o as n,c,w as i,u as r,b as u,x as f,e as p,v as d,aN as _,f as x,n as m,aR as g,bU as v,a as y,C as h,i as b,a3 as C,ab as w,g as j,h as V}from"./index-656dc629.js";import{_ as k}from"./u-loading-page.f8275a02.js";import{g as I,a as S}from"./verify.d14a700e.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.5e5c27a0.js";import"./u-transition.825c0e35.js";const U=R(a({__name:"index",setup(a){let R=e("manualInput");R.value="manualInput";let U=e(!1),z=e(""),H=e(!0);s((()=>{t()&&N()}));const N=()=>{I().then((a=>{a.data?H.value=!1:(l({title:"非核销员无此权限",icon:"none"}),setTimeout((()=>{o()}),1e3))}))},Q=()=>{g()&&(v.init(),v.scanQRCode((a=>{if(a.resultStr){let e=a.resultStr;y({url:"/app/pages/verify/verify",param:{code:e}})}})))};let T=!1;const X=()=>{if(T)return!1;T=!0;if(!/[\S]+/.test(z.value))return l({title:"请输入核销码",icon:"none"}),!1;S(z.value).then((a=>{T=!1,y({url:"/app/pages/verify/verify",param:{code:z.value}})})).catch((()=>{T=!1}))},Y=()=>{U.value=!U.value},q=a=>{"sweepCode"!=a||g()?R.value=a:l({title:"H5端不支持扫码核销",icon:"none"})};return(a,e)=>{const s=h,t=b,l=C,o=w,g=j(V("u-loading-page"),k);return n(),c(t,{style:m(a.themeColor())},{default:i((()=>[r(H)?x("v-if",!0):(n(),c(t,{key:0,class:"container"},{default:i((()=>[u(t,{class:"action-wrap"},{default:i((()=>[u(t,{class:"record-wrap text-[var(--primary-color)]",onClick:e[0]||(e[0]=a=>r(y)({url:"/app/pages/verify/record"}))},{default:i((()=>[u(s,{class:"iconfont iconjilu color-base-text"}),u(s,{class:"text-[28rpx]"},{default:i((()=>[f("核销记录")])),_:1})])),_:1}),p(u(t,{class:"sweep-code flex items-center justify-center ns-gradient-otherpages-member-balance-balance-rechange",onClick:Q},{default:i((()=>[u(s,{class:"nc-iconfont nc-icon-saoyisaoV6xx text-[130rpx] text-[#fff]"})])),_:1},512),[[d,"sweepCode"==r(R)]]),p(u(t,{class:"manual-input"},{default:i((()=>[u(t,{class:"process-wrap"},{default:i((()=>[u(t,{class:"wrap"},{default:i((()=>[u(t,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconVector-77 color-base-text"})])),_:1}),u(t,{class:"_text"},{default:i((()=>[f("输入核销码")])),_:1})])),_:1}),u(t,null,{default:i((()=>[u(t,null,{default:i((()=>[u(s,{class:"nc-iconfont nc-icon-changjiantouV6xx color-tip"})])),_:1})])),_:1}),u(t,{class:"wrap"},{default:i((()=>[u(t,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconhexiao color-base-text"})])),_:1}),u(t,{class:"_text"},{default:i((()=>[f("核销")])),_:1})])),_:1})])),_:1}),u(l,{type:"text",placeholder:"请输入核销码",class:"_input","placeholder-class":"_placeholder",modelValue:r(z),"onUpdate:modelValue":e[1]||(e[1]=a=>_(z)?z.value=a:z=a),focus:r(U),ref:"input"},null,8,["modelValue","focus"]),u(t,{class:"_btn",onClick:X},{default:i((()=>[u(o,{class:"h-[80rpx] flex items-center justify-center !text-[28rpx]",type:"primary"},{default:i((()=>[f("确认")])),_:1})])),_:1})])),_:1},512),[[d,"manualInput"==r(R)]])])),_:1}),u(t,{class:"arc-edge"}),u(t,{class:"action-type-wrap"},{default:i((()=>[u(t,{class:"action",onClick:e[2]||(e[2]=a=>q("sweepCode"))},{default:i((()=>[u(t,{class:"_icon"},{default:i((()=>[u(s,{class:"nc-iconfont nc-icon-saoyisaoV6xx"})])),_:1}),u(t,{class:"_text"},{default:i((()=>[f("扫码核销")])),_:1})])),_:1}),u(t,{class:"nc-iconfont nc-icon-saotiaoxingmaV6xx ns-gradient-otherpages-member-balance-balance-rechange"}),u(t,{class:"action",onClick:e[3]||(e[3]=a=>q("manualInput"))},{default:i((()=>[u(t,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconVector-77"})])),_:1}),u(t,{class:"_text",onClick:Y},{default:i((()=>[f("手动输入")])),_:1})])),_:1})])),_:1})])),_:1})),u(g,{loading:r(H),"loading-text":"",loadingColor:"var(--primary-color)",iconSize:"35"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-fb8aefc2"]]);export{U as default};
