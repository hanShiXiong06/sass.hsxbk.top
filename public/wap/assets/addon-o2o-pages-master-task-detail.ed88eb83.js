import{d as e,r as t,p as r,a,o as l,c as s,w as o,b as i,y as d,z as u,u as n,P as p,a7 as m,Q as x,f as c,n as f,aT as _,t as v,i as b,g as h,h as g,D as y,F as k,E as w,R as j,c3 as C,k as z}from"./index-7bf68536.js";import{_ as F}from"./u-icon.0c1c54c7.js";import{_ as S,a as B}from"./u-steps.9fc55f35.js";import{_ as A}from"./u--image.b3bf1d5c.js";import{_ as D}from"./u-form.78a4f7c2.js";import{_ as I}from"./u--form.632a93a1.js";import{_ as P}from"./u-button.359d7329.js";import{_ as T}from"./u-code-input.0bb27fda.js";import{_ as N}from"./u-modal.b47eb877.js";import{_ as O}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{c as H,b as L,T as M,f as V,d as R}from"./o2o.b941d7a5.js";import{c as W}from"./technician.3e30e06a.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-text.df478cbc.js";import"./u-image.e46f68ef.js";import"./u-transition.cdf87992.js";import"./u-line.463a2a45.js";import"./u-loading-icon.b37701e7.js";import"./u-popup.be4bfacd.js";import"./u-safe-bottom.908eeae4.js";import"./u-loading-page.566c330a.js";const Q=E(e({__name:"detail",setup(e){const E=t({}),Q=t(!1),U=t("");r((e=>{U.value=e.order_id,Y()}));const Y=()=>{W().then((e=>{Object.keys(e.data).length?q(U.value):a({url:"/addon/o2o/pages/index",mode:"reLaunch"})}))},q=e=>{Q.value=!0,H(e).then((e=>{E.value=e.data,Q.value=!1,ae()})).catch((()=>{Q.value=!1}))},G=()=>{H(U.value).then((e=>{E.value=e.data,ae()})).catch((()=>{}))},J=e=>{C({title:"提示",content:"您确定要转单吗？",confirmColor:z().themeColor["--primary-color"],success:t=>{t.confirm&&M({order_id:e.order_id}).then((e=>{a({url:"/addon/o2o/pages/master/task/list"})}))}})},K=t(!1),X=t(""),Z=e=>{X.value=e},$=()=>{if(""==X.value)return void v({title:"请输入校验码",icon:"none",duration:1e3});let e={order_id:U.value,check_code:X.value};L(e).then((e=>{K.value=!1,q(U.value)})).catch((()=>{}))},ee=e=>{V({order_id:e.order_id}).then((e=>{q(U.value)}))};function te(e){var t=new Date(e).getTime();if(null!=t&&""!=t&&t>0){var r=new Date;r.setTime(t);var a=r.getMonth()+1;a=a<10?"0"+a:a;var l=r.getDate();l=l<10?"0"+l:l;var s=r.getHours();s=s<10?"0"+s:s;var o=r.getMinutes();return a+"-"+l+" "+s+":"+(o=o<10?"0"+o:o)}return""}const re=t(0);function ae(){return"dispatch"==E.value.order_status_info.status?re.value=0:"wait_service"==E.value.order_status_info.status?re.value=1:"in_service"==E.value.order_status_info.status?re.value=2:"finish"==E.value.order_status_info.status?re.value=3:void 0}return(e,t)=>{const r=b,v=h(g("u-icon"),F),H=y,L=h(g("u-steps-item"),S),M=h(g("u-steps"),B),V=h(g("u--image"),A),W=h(g("u-form-item"),D),Y=h(g("u--form"),I),X=h(g("u-button"),P),ae=h(g("u-code-input"),T),le=h(g("u-modal"),N),se=h(g("loading-page"),O);return l(),s(r,{style:f(e.themeColor())},{default:o((()=>[!Q.value&&Object.keys(E.value).length?(l(),s(r,{key:0,class:"bg-[#f8f8f8] min-h-screen overflow-hidden"},{default:o((()=>[i(r,{class:"bg-linear h-[742rpx] pt-3"}),i(r,{class:"bg-[#fff] mx-3 py-4 px-3 rounded-md -mt-[740rpx]"},{default:o((()=>[i(r,{class:"flex"},{default:o((()=>[i(r,{class:"min-w-[50rpx] flex items-center justify-center"},{default:o((()=>[i(v,{name:"map",size:"20"})])),_:1}),i(r,{class:"flex flex-col ml-[20rpx]"},{default:o((()=>[i(H,{class:"text-[24rpx] mt-[10rpx] leading-[35rpx]"},{default:o((()=>[d(u(E.value.taker_full_address),1)])),_:1}),i(r,null,{default:o((()=>[i(H,{class:"text-[24rpx]"},{default:o((()=>[d(u(E.value.taker_name),1)])),_:1}),i(H,{class:"text-[24rpx] mt-[15rpx]"},{default:o((()=>[d(u(E.value.taker_mobile),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),i(r,{class:"flex py-4 px-3 bg-white rounded-md box-border mx-3 mt-[20rpx] task-steps"},{default:o((()=>[i(M,{current:re.value,activeColor:"var(--primary-color)"},{default:o((()=>[i(L,{title:n(k)("placeOrder"),desc:E.value.create_time?te(E.value.create_time):"---"},null,8,["title","desc"]),i(L,{title:n(k)("takeOrders"),desc:E.value.dispatch_time?te(E.value.dispatch_time):"---"},null,8,["title","desc"]),i(L,{title:n(k)("start"),desc:E.value.service_time?te(E.value.service_time):"---"},null,8,["title","desc"]),i(L,{title:n(k)("finish"),desc:E.value.finish_time?te(E.value.finish_time):"---"},null,8,["title","desc"])])),_:1},8,["current"])])),_:1}),i(r,{class:"bg-white py-4 px-3 rounded-md box-border mx-3 mt-[20rpx]"},{default:o((()=>[i(r,{class:"flex justify-between items-center pb-3 border-0 border-b-1 border-solid border-[#F0F0F0] mb-3 text-[26rpx] text-[var(--text-color-light6)]"},{default:o((()=>[i(H,null,{default:o((()=>[d(u(n(k)("serviceDate"))+u(E.value.reserve_service_time),1)])),_:1}),i(H,{class:"text-[var(--primary-color)]"},{default:o((()=>[d(u(E.value.order_status_info.name),1)])),_:1})])),_:1}),(l(!0),p(x,null,m(E.value.item,((e,t)=>(l(),p(x,{key:t},["buy"==e.item_type||"reservation"==e.item_type?(l(),s(r,{key:0},{default:o((()=>[i(r,{class:"flex items-center border-0"},{default:o((()=>[i(r,{class:"w-[124rpx] h-[124rpx] shrink-0"},{default:o((()=>[i(V,{class:"rounded-[10rpx] overflow-hidden",width:"124rpx",height:"124rpx",src:n(w)(e.item_image?e.item_image:""),model:"aspectFill"},{error:o((()=>[i(v,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024),i(r,{class:"flex-1 flex flex-col ml-[20rpx]"},{default:o((()=>[i(r,null,{default:o((()=>[i(H,{class:"text-[28rpx] text-item leading-[40rpx]"},{default:o((()=>[d(u(e.item_name),1)])),_:2},1024)])),_:2},1024),i(r,{class:"text-[24rpx] mt-[14rpx] flex"},{default:o((()=>[i(H,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:o((()=>[d(u(e.item_type_name),1)])),_:2},1024)])),_:2},1024),i(r,{class:"text-[28rpx] mt-[14rpx] flex justify-between"},{default:o((()=>[i(H,{class:"text-[var(--price-text-color)] price-font"},{default:o((()=>[d("￥"+u(e.price),1)])),_:2},1024),i(H,{class:"text-[22rpx] ml-[20rpx]"},{default:o((()=>[d("x"+u(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(r,{class:"flex justify-end self-end w-[100%] mt-[10rpx]"},{default:o((()=>[e.refund_no&&""!=e.refund_status&&"cancel"!=e.refund_status?(l(),s(r,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>n(a)({url:"/addon/o2o/pages/master/task/refund",param:{refund_no:e.refund_no}})},{default:o((()=>[d(u(n(k)("viewRefund")),1)])),_:2},1032,["onClick"])):c("v-if",!0)])),_:2},1024)])),_:2},1024)):c("v-if",!0)],64)))),128))])),_:1}),E.value.item.length>1?(l(),s(r,{key:0,class:"bg-white py-4 px-3 rounded-md box-border mx-3 mt-[20rpx]"},{default:o((()=>[i(r,{class:"pb-3 border-0 border-b-1 border-solid border-[#F0F0F0] mb-3 text-[26rpx] text-[var(--text-color-light6)]"},{default:o((()=>[i(H,null,{default:o((()=>[d(u(n(k)("addServiceItem")),1)])),_:1})])),_:1}),(l(!0),p(x,null,m(E.value.item,((e,t)=>(l(),p(x,{key:t},["custom"==e.item_type?(l(),s(r,{key:0,class:j({"mt-[20rpx]":t})},{default:o((()=>[i(r,{class:"flex items-center"},{default:o((()=>[i(r,{class:"w-[124rpx] h-[124rpx] shrink-0"},{default:o((()=>[i(V,{class:"rounded-[10rpx] overflow-hidden",width:"124rpx",height:"124rpx",src:n(w)(e.item_image?e.item_image:""),model:"aspectFill"},{error:o((()=>[i(v,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024),i(r,{class:"flex-1 flex flex-col ml-[20rpx]"},{default:o((()=>[i(r,{class:"flex justify-between"},{default:o((()=>[i(H,{class:"max-h-[80rpx] w-[420rpx] text-[28rpx] leading-[40rpx] multi-hidden"},{default:o((()=>[d(u(e.item_name),1)])),_:2},1024),i(H,{class:"shrink-0 ml-[10rpx] text-[24rpx] leading-[40rpx] text-[var(--primary-color)]"},{default:o((()=>[d(u(e.pay_time?n(k)("havePaid"):n(k)("notPaid")),1)])),_:2},1024)])),_:2},1024),i(r,{class:"text-[24rpx] mt-[14rpx] flex"},{default:o((()=>[i(H,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:o((()=>[d(u(e.item_type_name),1)])),_:2},1024)])),_:2},1024),i(r,{class:"text-[28rpx] mt-[14rpx] flex justify-between"},{default:o((()=>[i(H,{class:"text-[var(--price-text-color)] price-font"},{default:o((()=>[d("￥"+u(e.price),1)])),_:2},1024),i(H,{class:"text-[22rpx] ml-[20rpx]"},{default:o((()=>[d("x"+u(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(r,{class:"flex justify-end mt-[10rpx]"},{default:o((()=>[i(r,{class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{var r;a({url:"/addon/o2o/pages/master/task/show",param:{order_id:(r=e).order_id,order_item_id:r.order_item_id,item_name:r.item_name,price:r.item_money,item_images:r.item_images}})}},{default:o((()=>[d(u(n(k)("show")),1)])),_:2},1032,["onClick"]),e.pay_time?c("v-if",!0):(l(),s(r,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{var r;a({url:"/addon/o2o/pages/master/task/add",param:{order_id:(r=e).order_id,order_item_id:r.order_item_id,item_name:r.item_name,price:r.item_money,item_images:r.item_images}})}},{default:o((()=>[d(u(n(k)("edit")),1)])),_:2},1032,["onClick"])),e.pay_time?c("v-if",!0):(l(),s(r,{key:1,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{return r=e,void C({title:"提示",content:"您确定要删除该服务项吗？",confirmColor:z().themeColor["--primary-color"],success:e=>{e.confirm&&R(r.order_item_id).then((e=>{q(U.value)}))}});var r}},{default:o((()=>[d(u(n(k)("delete")),1)])),_:2},1032,["onClick"]))])),_:2},1024)])),_:2},1032,["class"])):c("v-if",!0)],64)))),128))])),_:1})):c("v-if",!0),i(r,{class:"mt-3 bg-white mx-3 px-3 py-4 rounded-md"},{default:o((()=>[i(r,{class:"text-[#1A2336] text-[28rpx] font-bold mb-4"},{default:o((()=>[d(u(n(k)("orderInfo")),1)])),_:1}),i(Y,{labelPosition:"left",ref:"form1",labelWidth:"90",borderBottom:"false",labelStyle:{color:"#A3A3A3",fontSize:"14px"}},{default:o((()=>[i(W,{label:n(k)("orderNo"),borderBottom:!1},{default:o((()=>[i(r,{class:"border-style w-full !border-0 flex justify-between items-end"},{default:o((()=>[i(H,null,{default:o((()=>[d(u(E.value.order_no),1)])),_:1})])),_:1})])),_:1},8,["label"]),i(W,{label:n(k)("person"),prop:"userInfo.name",borderBottom:!1},{default:o((()=>[i(r,{class:"border-style"},{default:o((()=>[d(u(E.value.taker_name),1)])),_:1})])),_:1},8,["label"]),i(W,{label:n(k)("personTel"),borderBottom:!1},{default:o((()=>[i(r,{class:"border-style"},{default:o((()=>[d(u(E.value.taker_mobile),1)])),_:1})])),_:1},8,["label"]),i(W,{label:n(k)("remark"),borderBottom:!1},{default:o((()=>[i(r,{class:"border-style"},{default:o((()=>[d(u(E.value.member_message?E.value.member_message:"无"),1)])),_:1})])),_:1},8,["label"])])),_:1},512)])),_:1}),i(r,{class:"h-[160rpx] w-full"}),i(r,{class:"flex justify-end items-center bg-white px-3 py-1 fixed left-0 right-0 bottom-0 z-10"},{default:o((()=>[i(r,{class:"flex flex-col items-center justify-center w-[110rpx] mr-auto",onClick:t[0]||(t[0]=e=>{a({url:"/addon/o2o/pages/index",mode:"reLaunch"})})},{default:o((()=>[i(H,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[36rpx] text-[#333]"}),i(H,{class:"text-xs mt-[2rpx] font-scale"},{default:o((()=>[d(u(n(k)("index")),1)])),_:1})])),_:1}),i(r,{class:"flex flex-wrap justify-end"},{default:o((()=>[i(X,{text:n(k)("contact"),customStyle:{border:"solid 3rpx #999",width:"170rpx",height:"64rpx",lineHeight:"64rpx",fontSize:"26rpx",margin:"16px 0 16px 24rpx"},shape:"circle",onClick:t[1]||(t[1]=e=>{return t=E.value.taker_mobile,void _({phoneNumber:t});var t})},null,8,["text"]),(l(!0),p(x,null,m(E.value.order_status_info.technician_action,((e,t)=>(l(),s(X,{key:t,text:e.name,onClick:t=>{return r=E.value,void("transfer_order"==(l=e.key)?J(r):"start"==l?K.value=!0:"finish"==l?ee(r):"service_pay"==l&&a({url:"/addon/o2o/pages/master/task/add",param:{order_id:r.order_id}}));var r,l},shape:"circle",customStyle:{border:"solid 3rpx #999",width:"170rpx",height:"64rpx",lineHeight:"64rpx",fontSize:"26rpx",margin:"16px 0 16px 24rpx"}},null,8,["text","onClick"])))),128))])),_:1})])),_:1}),c(" 刷新 "),i(r,{class:"fixed bottom-[160rpx] right-[20rpx] rounded-full bg-[#fff] w-[80rpx] h-[80rpx] flex flex-col items-center justify-center shadow-xl",onClick:G},{default:o((()=>[i(H,{class:"nc-iconfont nc-icon-shuaxinV6xx text-[36rpx]"}),i(H,{class:"text-[22rpx] mt-[6rpx]"},{default:o((()=>[d(u(n(k)("refresh")),1)])),_:1})])),_:1})])),_:1})):c("v-if",!0),i(le,{show:K.value,showCancelButton:"true",onCancel:t[2]||(t[2]=e=>K.value=!1),onConfirm:$,width:"500rpx",confirmColor:"var(--primary-color)"},{default:o((()=>[i(Y,{labelPosition:"left",class:"!w-[100%]",labelWidth:"100rpx"},{default:o((()=>[i(W,{label:n(k)("checkCode")},{default:o((()=>[i(ae,{maxlength:4,focus:!0,size:"50rpx",fontSize:"32rpx",onFinish:Z})])),_:1},8,["label"])])),_:1})])),_:1},8,["show"]),i(se,{loading:Q.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-a076928e"]]);export{Q as default};
