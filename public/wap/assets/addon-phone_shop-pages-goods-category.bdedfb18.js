import{d as e,r as t,O as o,o as l,c as r,w as a,u as s,b as i,R as c,f as d,A as u,P as n,a7 as p,Q as x,a as f,a5 as _,g,h as v,D as m,i as h,a6 as b,y as k,z as y,E as w,B as C,j as S,_ as j,s as F,t as I,C as V,aM as N,l as E,e as z,v as A,n as B,a8 as L,a9 as R,H as O,k as M,p as D,x as T,J as U}from"./index-7bf68536.js";import{_ as H}from"./u-icon.0c1c54c7.js";import{_ as $}from"./u--image.b3bf1d5c.js";import{_ as P}from"./tabbar.e049672c.js";import{_ as J}from"./u-loading-page.566c330a.js";import{c as W,i as Y,b as K,j as Q}from"./goods.501e5f32.js";import{M as X}from"./mescroll-empty.fcefb74e.js";import{_ as Z}from"./_plugin-vue_export-helper.1b428a4d.js";import{M as q}from"./mescroll-body.b6d57b41.js";import{u as G}from"./useMescroll.26ccf5de.js";import{_ as ee}from"./u-number-box.30c0ab2e.js";import{_ as te}from"./u-popup.be4bfacd.js";import{u as oe}from"./cart.b4d15020.js";import{b as le}from"./bind-mobile.37d1c6df.js";import{f as re}from"./cloneDeep.77735539.js";import"./u-image.e46f68ef.js";import"./u-transition.cdf87992.js";import"./u-badge.d8d91719.js";import"./u-tabbar.d98653fa.js";import"./u-safe-bottom.908eeae4.js";import"./u-loading-icon.b37701e7.js";import"./mescroll-i18n.14e7fe02.js";/* empty css                                                                       */import"./u-form.78a4f7c2.js";import"./u-line.463a2a45.js";import"./sms-code.vue_vue_type_script_setup_true_lang.eace8f61.js";import"./u-input.09a5cedd.js";import"./u-modal.b47eb877.js";import"./u-checkbox-group.b2a485bf.js";const ae=Z(e({__name:"category-template-two-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const S=e;let j=S.config,F=S.categoryId;const I=t(""),V=t(!0);o((()=>{E()}));const N=t([]),E=()=>{V.value=!0,W().then((e=>{if(N.value=e.data,F)for(let t=0;t<N.value.length;t++){if(N.value[t].category_id==F){z.value=t;break}if(N.value[t].child_list)for(let e=0;e<N.value[t].child_list.length;e++)if(N.value[t].child_list[e].category_id==F){z.value=t;break}}V.value=!1})).catch((()=>{V.value=!1}))},z=t(0),A=()=>{I.value&&f({url:"/addon/phone_shop/pages/goods/list",param:{goods_name:I.value}})};return(e,t)=>{const o=_,S=g(v("u-icon"),H),F=m,E=h,B=b,L=C,R=g(v("u--image"),$),O=g(v("tabbar"),P),M=g(v("u-loading-page"),J);return l(),r(E,{class:"bg-[#F4F6F8] min-h-screen"},{default:a((()=>[N.value.length?(l(),r(E,{key:0,class:"mescroll-box"},{default:a((()=>[s(j).search.control?(l(),r(E,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[106rpx] box-border"},{default:a((()=>[i(o,{class:c(["search-ipt pl-[32rpx] text-[24rpx]",{"pr-[106rpx]":I.value,"pr-[32rpx]":!I.value}]),type:"text",modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=e=>I.value=e),placeholder:s(j).search.title,onConfirm:A},null,8,["class","modelValue","placeholder"]),i(E,{class:"flex items-center h-[70rpx] absolute right-[56rpx] top-[18rpx] z-2"},{default:a((()=>[I.value?(l(),r(S,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:t[1]||(t[1]=e=>I.value="")})):d("v-if",!0),i(E,{class:"h-[70rpx] w-[40rpx] text-center leading-[70rpx]",onClick:u(A,["stop"])},{default:a((()=>[i(F,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx]"})])),_:1},8,["onClick"])])),_:1})])),_:1})):d("v-if",!0),i(E,{class:c(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[106rpx]":s(j).search.control}])},{default:a((()=>[i(B,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(E,{class:"bg-[#F4F6F8]"},{default:a((()=>[(l(!0),n(x,null,p(N.value,((e,t)=>(l(),r(E,{class:c(["tab-item truncate",{"tab-item-active":t==z.value,"rounded-br-[12rpx]":z.value-1===t,"rounded-tr-[12rpx]":z.value+1===t}]),key:t,onClick:e=>((e,t)=>{z.value=e})(t)},{default:a((()=>[i(E,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(B,{class:"h-[100vh]","scroll-y":!0},{default:a((()=>[i(E,{class:c(["pl-[202rpx] scroll-ios pt-[20rpx] pr-[20rpx]",{"!pt-[126rpx]":s(j).search.control}])},{default:a((()=>{var e,t;return[(null==(e=N.value[z.value])?void 0:e.child_list)&&!V.value?(l(),r(E,{key:0,class:"bg-[#fff] grid grid-cols-3 gap-x-[50rpx] gap-y-[32rpx] py-[33rpx] px-[23rpx] rounded-[16rpx]"},{default:a((()=>{var e;return[(l(!0),n(x,null,p(null==(e=N.value[z.value])?void 0:e.child_list,((e,t)=>(l(),r(E,{key:e.category_id,class:"",onClick:t=>{return o=e.category_id,void f({url:"/addon/phone_shop/pages/goods/list",param:{curr_goods_category:o}});var o}},{default:a((()=>[i(R,{radius:"12rpx",width:"129rpx",height:"129rpx",src:s(w)(e.image?e.image:""),model:"aspectFill"},{error:a((()=>[i(L,{class:"rounded-[12rpx] overflow-hidden w-[129rpx] h-[129rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(E,{class:"text-[24rpx] text-center mt-[12rpx] leading-[34rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))]})),_:1})):d("v-if",!0),(null==(t=N.value[z.value])?void 0:t.child_list)||V.value?d("v-if",!0):(l(),r(E,{key:1,class:c(["flex justify-center w-[100%] rounded-[16rpx] flex items-center",{noData1:s(j).search.control,noData2:!s(j).search.control}])},{default:a((()=>[i(X,{option:{tip:"暂无商品分类"}})])),_:1},8,["class"]))]})),_:1},8,["class"])])),_:1})])),_:1})):d("v-if",!0),i(O),N.value.length||V.value?d("v-if",!0):(l(),r(E,{key:1,class:"flex justify-center w-[100%] items-center justify-center h-[100vh]"},{default:a((()=>[i(X,{option:{tip:"暂无商品分类"}})])),_:1})),i(M,{"bg-color":"rgb(248,248,248)",loading:V.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"])])),_:1})}}}),[["__scopeId","data-v-e90d35ae"]]),se=Z(e({__name:"add-cart-popup",setup(e,{expose:o}){const f=oe(),_=S((()=>f.cartList)),E=t(!1),z=t({skuId:"",name:[]}),A=t({}),B=t({}),L=t(1),R=()=>{E.value=!1},O=S((()=>{let e=JSON.parse(JSON.stringify(A.value));return Object.keys(e).length&&(Object.keys(z.value.name).length||(z.value.name=e.sku_spec_format.split(",")),e.goodsSpec.forEach(((e,t)=>{let o=e.spec_values.split(",");e.values=[],o.forEach(((o,l)=>{e.values[l]={},e.values[l].name=o,e.values[l].selected=!1,e.values[l].disabled=!1,z.value.name.forEach(((r,a)=>{a==t&&r==o&&(e.values[l].selected=!0)}))}))})),M(),e.skuList&&Object.keys(e.skuList).length&&e.skuList.forEach((e=>{e.sku_id==z.value.skuId&&(B.value=e)}))),e}));j((()=>B.value),((e,t)=>{_.value["goods_"+B.value.goods_id]&&_.value["goods_"+B.value.goods_id]["sku_"+B.value.sku_id]?(L.value=N(_.value["goods_"+B.value.goods_id]["sku_"+B.value.sku_id].num),B.value.cart_id=N(_.value["goods_"+B.value.goods_id]["sku_"+B.value.sku_id].id)):(L.value=1,B.value.cart_id="")}));const M=()=>{A.value.skuList.forEach(((e,t)=>{let o=e.sku_spec_format.split(",");z.value.name.every((e=>o.includes(e)))&&(z.value.skuId=e.sku_id)}))},D=()=>{if(0==L.value)f.reduce({id:B.value.cart_id||"",goods_id:B.value.goods_id,sale_price:B.value.sale_price,sku_id:B.value.sku_id});else{let e=0;e=O.value.goods.is_discount&&B.value.sale_price!=B.value.price?B.value.sale_price?B.value.sale_price:B.value.price:O.value.goods.member_discount&&F()&&B.value.member_price!=B.value.price&&B.value.member_price?B.value.member_price:B.value.price,f.increase({id:B.value.cart_id||"",goods_id:B.value.goods_id,sku_id:B.value.sku_id,stock:B.value.stock,sale_price:e,num:L.value},0,(()=>{I({title:"加入购物车成功",icon:"none"})}))}E.value=!1},T=e=>{let t="0.00";return t=O.value.goods.is_discount&&e.sale_price!=e.price?e.sale_price?e.sale_price:e.price:O.value.goods.member_discount&&F()&&e.member_price!=e.price&&e.member_price?e.member_price:e.price,t},U=e=>{let t="";return t=O.value.goods.is_discount&&e.sale_price!=e.price?"discount_price":O.value.goods.member_discount&&F()&&e.member_price!=e.price?"member_price":"",t};return o({open:e=>{(e=>{Y(e).then((t=>{A.value=t.data,z.value.sku_id=e,A.value.skuList&&Object.keys(A.value.skuList).length&&A.value.skuList.forEach((t=>{t.sku_id==e&&(B.value=t,z.value.name=t.sku_spec_format.split(","))})),E.value=!0}))})(e)}}),(e,t)=>{const o=C,f=g(v("u--image"),$),S=h,j=m,F=g(v("u-number-box"),ee),I=b,N=V,A=g(v("u-popup"),te);return l(),r(S,{onTouchmove:t[3]||(t[3]=u((()=>{}),["prevent","stop"]))},{default:a((()=>[i(A,{show:E.value,onClose:R,mode:"bottom"},{default:a((()=>[Object.keys(s(O)).length?(l(),r(S,{key:0,onTouchmove:t[2]||(t[2]=u((()=>{}),["prevent","stop"])),class:"rounded-t-[20rpx] overflow-hidden bg-[#fff] p-[32rpx] relative"},{default:a((()=>[i(S,{class:"flex mb-[58rpx]"},{default:a((()=>[i(S,{class:"rounded-[8rpx] overflow-hidden"},{default:a((()=>[i(f,{width:"180rpx",height:"180rpx",src:s(w)(B.value.sku_image),model:"aspectFill"},{error:a((()=>[i(o,{class:"w-[180rpx] h-[180rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:1},8,["src"])])),_:1}),i(S,{class:"flex flex-1 flex-col ml-[20rpx] py-[10rpx]"},{default:a((()=>[i(S,{class:"w-[100%]"},{default:a((()=>[i(S,{class:"text-[var(--price-text-color)] flex items-baseline"},{default:a((()=>[i(j,{class:"text-[28rpx] font-bold price-font mr-[4rpx]"},{default:a((()=>[k("￥")])),_:1}),i(j,{class:"text-[42rpx] font-bold price-font"},{default:a((()=>[k(y(parseFloat(T(B.value)).toFixed(2).split(".")[0]),1)])),_:1}),i(j,{class:"text-[28rpx] font-bold price-font"},{default:a((()=>[k("."+y(parseFloat(T(B.value)).toFixed(2).split(".")[1]),1)])),_:1}),"member_price"==U(B.value)?(l(),r(o,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0),"discount_price"==U(B.value)?(l(),r(o,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0)])),_:1}),i(S,{class:"text-[24rpx] leading-[32rpx] text-[#303133] mt-[12rpx]"},{default:a((()=>[k("库存"+y(B.value.stock)+y(s(O).goods.unit),1)])),_:1})])),_:1}),s(O).goodsSpec&&s(O).goodsSpec.length?(l(),r(S,{key:0,class:"w-[100%] mt-auto",style:{"max-height":"calc(204rpx - 126rpx)",overflow:"hidden"}},{default:a((()=>[i(j,{class:"text-[24rpx] leading-[30rpx] text-[#666]"},{default:a((()=>[k("已选规格："+y(B.value.sku_spec_format),1)])),_:1})])),_:1})):d("v-if",!0)])),_:1})])),_:1}),i(I,{class:"h-[500rpx] mb-[30rpx]","scroll-y":"true"},{default:a((()=>[(l(!0),n(x,null,p(s(O).goodsSpec,((e,t)=>(l(),r(S,{class:c({"mt-[36rpx]":0!=t}),key:t},{default:a((()=>[i(S,{class:"text-[26rpx] leading-[36rpx] mb-[24rpx]"},{default:a((()=>[k(y(e.spec_name),1)])),_:2},1024),i(S,{class:"flex flex-wrap"},{default:a((()=>[(l(!0),n(x,null,p(e.values,((e,o)=>(l(),r(S,{class:c(["box-border bg-[#f2f2f2] text-[24rpx] px-[44rpx] text-center h-[56rpx] leading-[52rpx] mr-[20rpx] mb-[20rpx] border-1 border-solid rounded-[50rpx] border-[#f2f2f2]",{"!border-[var(--primary-color)] text-[var(--primary-color)] !bg-[var(--primary-color-light)]":e.selected}]),key:o,onClick:o=>((e,t)=>{z.value.name[t]=e.name,L.value=1})(e,t)},{default:a((()=>[k(y(e.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1032,["class"])))),128)),i(S,{class:"flex justify-between items-center mt-[30rpx]"},{default:a((()=>[i(S,{class:"text-[26rpx]"},{default:a((()=>[k("购买数量")])),_:1}),s(_)["goods_"+B.value.goods_id]&&s(_)["goods_"+B.value.goods_id]["sku_"+B.value.sku_id]?(l(),r(F,{key:0,modelValue:L.value,"onUpdate:modelValue":t[0]||(t[0]=e=>L.value=e),min:0,max:B.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(j,{class:c(["text-[34rpx] nc-iconfont nc-icon-jianV6xx",{"!text-[#c8c9cc]":0===L.value}])},null,8,["class"])])),input:a((()=>[i(j,{class:"text-[#303133] text-[24rpx] mx-[10rpx] min-w-[56rpx] h-[38rpx] leading-[40rpx] text-center border-[1rpx] border-solid border-[#ddd] rounded-[4rpx]"},{default:a((()=>[k(y(L.value),1)])),_:1})])),plus:a((()=>[i(j,{class:c(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx",{"!text-[#c8c9cc]":L.value===B.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"])):(l(),r(F,{key:1,modelValue:L.value,"onUpdate:modelValue":t[1]||(t[1]=e=>L.value=e),min:1,max:B.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(j,{class:c(["text-[34rpx] nc-iconfont nc-icon-jianV6xx",{"!text-[#c8c9cc]":1===L.value}])},null,8,["class"])])),input:a((()=>[i(j,{class:"text-[#303133] text-[24rpx] mx-[10rpx] min-w-[56rpx] h-[38rpx] leading-[40rpx] text-center border-[1rpx] border-solid border-[#ddd] rounded-[4rpx]"},{default:a((()=>[k(y(L.value),1)])),_:1})])),plus:a((()=>[i(j,{class:c(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx",{"!text-[#c8c9cc]":L.value===B.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"]))])),_:1})])),_:1}),B.value.stock>0?(l(),r(N,{key:0,class:"!h-[72rpx] primary-btn-bg leading-[72rpx] text-[26rpx] rounded-[50rpx]",type:"primary",onClick:D},{default:a((()=>[k("确定")])),_:1})):(l(),r(N,{key:1,class:"!h-[72rpx] leading-[72rpx] text-[26rpx] text-[#fff] bg-[#ccc] rounded-[50rpx]"},{default:a((()=>[k("已售罄")])),_:1}))])),_:1})):d("v-if",!0)])),_:1},8,["show"])])),_:1})}}}),[["__scopeId","data-v-582bd32f"]]),ie=Z(e({__name:"category-template-one-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const j=e,N=oe();N.getList();const M=S((()=>N.cartList)),D=S((()=>N.totalNum)),T=S((()=>N.totalMoney)),U=E(),Y=S((()=>U.info)),{mescrollInit:Q,getMescroll:Z}=G(R,L);let ee=j.config,te=j.categoryId;const ae=t([]),ie=t(""),ce=t(!0),de=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const ue=e=>{de.value=!1,K({page:e.num,limit:e.size,keyword:"",goods_category:te,brand_id:"",label_ids:"",start_price:"",end_price:"",order:"price",sort:"desc"}).then((t=>{let o=t.data.data;1==e.num&&(ae.value=[]),ae.value=ae.value.concat(o),ce.value=!1,e.endSuccess(o.length),ae.value.length||(de.value=!0)})).catch((()=>{ce.value=!1,de.value=!0,e.endErr()}))},ne=e=>{f({url:"/addon/phone_shop/pages/goods/detail",param:{goods_id:e}})};o((()=>{ve()}));const pe=t(""),xe=t(!1),fe=t(!1),_e=(e,t)=>{if(xe.value||fe.value)return!1;xe.value=!0,fe.value=!0;let o={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:je(e),stock:e.goodsSku.stock};e.id&&(o.num=e.num,o.id=e.id),N.increase(o,1,(()=>{fe.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),o=e.getBoundingClientRect().left,l=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;pe.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{pe.value=`top: ${l+e.offsetHeight/2-r.offsetHeight/2}px; left: ${o+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{pe.value="",xe.value=!1}),1020)}),100)},ge=t([]),ve=()=>{ce.value=!0,W().then((e=>{if(ge.value=e.data,te)for(let t=0;t<ge.value.length;t++){if(ge.value[t].category_id==te){me.value=t;break}if(ge.value[t].child_list)for(let e=0;e<ge.value[t].child_list.length;e++)if(ge.value[t].child_list[e].category_id==te){me.value=t;break}}else te=e.data[0].category_id;ce.value=!1})).catch((()=>{ce.value=!1}))},me=t(0),he=()=>{ie.value&&f({url:"/addon/phone_shop/pages/goods/list",param:{goods_name:ie.value}})},be=t(null),ke=t(),ye=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return ne(e.goodsSku.goods_id);if("cart"!==ee.cart.event)return ne(e.goodsSku.goods_id);if(!Y.value)return O().setLoginBack({url:"/addon/phone_shop/pages/goods/category"}),!1;if(uni.getStorageSync("isbindmobile"))return be.value.open(),!1;if(e.goodsSku.sku_spec_format)ke.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void I({title:"商品库存不足",icon:"none"});_e(e,t)}},we=()=>{f({url:"/addon/phone_shop/pages/goods/cart"})},Ce=()=>{if(uni.getStorageSync("isbindmobile"))return be.value.open(),!1;if(!D.value)return void I({title:"还没有选择商品",icon:"none"});const e=[];Object.values(M.value).forEach((t=>{Object.keys(t).forEach((o=>{"totalNum"!=o&&"totalMoney"!=o&&e.push(t[o].id)}))})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/phone_shop/pages/order/payment"})}})},Se=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},je=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const o=_,f=g(v("u-icon"),H),S=m,j=h,F=b,E=C,L=g(v("u--image"),$),R=V,O=g(v("u-loading-page"),J),U=g(v("tabbar"),P);return l(),r(j,{class:"min-h-screen"},{default:a((()=>[ge.value.length?(l(),r(j,{key:0,class:c(["mescroll-box bg-[#F4F6F8]",{cart:s(ee).cart.control&&"cart"===s(ee).cart.event,detail:!(s(ee).cart.control&&"cart"===s(ee).cart.event)}])},{default:a((()=>[i(q,{ref:"mescrollRef",down:{use:!1},onInit:s(Q),onUp:ue},{default:a((()=>[s(ee).search.control?(l(),r(j,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[106rpx] box-border"},{default:a((()=>[i(o,{class:c(["search-ipt pl-[32rpx] text-[24rpx]",{"pr-[106rpx]":ie.value,"pr-[32rpx]":!ie.value}]),type:"text",modelValue:ie.value,"onUpdate:modelValue":t[0]||(t[0]=e=>ie.value=e),placeholder:s(ee).search.title,onConfirm:he},null,8,["class","modelValue","placeholder"]),i(j,{class:"flex items-center h-[70rpx] absolute right-[56rpx] top-[18rpx] z-2"},{default:a((()=>[ie.value?(l(),r(f,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:t[1]||(t[1]=e=>ie.value="")})):d("v-if",!0),i(j,{class:"h-[70rpx] w-[40rpx] text-center leading-[70rpx]",onClick:u(he,["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx]"})])),_:1},8,["onClick"])])),_:1})])),_:1})):d("v-if",!0),i(j,{class:c(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[106rpx]":s(ee).search.control,"pb-[98rpx]":s(ee).cart.control&&"cart"===s(ee).cart.event}])},{default:a((()=>[i(F,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(j,{class:"bg-[#F4F6F8]"},{default:a((()=>[(l(!0),n(x,null,p(ge.value,((e,t)=>(l(),r(j,{class:c(["tab-item truncate",{"tab-item-active":t==me.value,"rounded-br-[12rpx]":me.value-1===t,"rounded-tr-[12rpx]":me.value+1===t}]),key:t,onClick:o=>((e,t)=>{me.value=e,te=t.category_id,ae.value=[],Z().resetUpScroll()})(t,e)},{default:a((()=>[i(j,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(j,{class:c(["flex justify-center flex-wrap pl-[182rpx] pb-[20rpx]",{" pt-[126rpx]":s(ee).search.control," pt-[20rpx]":!s(ee).search.control}])},{default:a((()=>[(l(!0),n(x,null,p(ae.value,((e,t)=>(l(),r(j,{key:e.goods_id,class:c(["w-[536rpx] box-border bg-white w-full flex mx-[16rpx] px-[24rpx] py-[20rpx] rounded-[12rpx]",{"mt-[16rpx]":t}]),onClick:u((t=>ne(e.goods_id)),["stop"])},{default:a((()=>[i(j,{class:"mr-[8rpx]"},{default:a((()=>[i(L,{width:"168rpx",height:"168rpx",radius:"12rpx",src:s(w)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(E,{class:"rounded-[12rpx] overflow-hidden w-[168rpx] h-[168rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"])])),_:2},1024),i(j,{class:"flex flex-1 ml-[8rpx] flex-wrap"},{default:a((()=>[i(j,{class:"w-[316rpx] max-h-[80rpx] text-[28rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),i(j,{class:"w-[316rpx] flex self-end items-end justify-between"},{default:a((()=>[i(j,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(S,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(S,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(je(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(S,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(je(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==Se(e)?(l(),r(E,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0),"discount_price"==Se(e)?(l(),r(E,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(ee).cart.control&&"cart"===s(ee).cart.event?(l(),r(j,{key:0,class:"flex items-center"},{default:a((()=>[i(S,{class:"text-[44rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:u((t=>(e=>{if(fe.value)return!1;fe.value=!0,N.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{fe.value=!1}))})(s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(S,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(S,{class:"text-[44rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:u((o=>((e,t,o)=>{if(parseInt(t.num)>=parseInt(t.stock))return void I({title:"商品库存不足",icon:"none"});let l=re(e);l.num=t.num,l.id=t.id,_e(l,o)})(e,s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(ee).cart.event||"real"==e.goods_type?(l(),n(x,{key:1},[s(ee).cart.control&&"style-1"===s(ee).cart.style?(l(),r(j,{key:0,class:"h-[44rpx] relative"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"text-[#fff] bg-color h-[44rpx] text-[24rpx] px-[10px] leading-[44rpx] rounded-[22rpx]",onClick:u((o=>ye(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(ee).cart.text),1)])),_:2},1032,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ee).cart.control&&"style-2"===s(ee).cart.style?(l(),r(j,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:u((o=>ye(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ee).cart.control&&"style-3"===s(ee).cart.style?(l(),r(j,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:u((o=>ye(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ee).cart.control&&"style-4"===s(ee).cart.style?(l(),r(j,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:u((o=>ye(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0)],64)):d("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),ae.value.length||ce.value||!de.value?d("v-if",!0):(l(),r(j,{key:0,class:c(["mx-[24rpx] w-[536rpx] rounded-[12rpx] flex items-center justify-center",{noData1:s(ee).search.control,noData2:!s(ee).search.control}])},{default:a((()=>[i(X,{option:{tip:"暂无商品"}})])),_:1},8,["class"]))])),_:1},8,["class"]),i(se,{ref_key:"cartRef",ref:ke},null,512)])),_:1},8,["onInit"]),s(ee).cart.control&&"cart"===s(ee).cart.event?(l(),r(j,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios"},{default:a((()=>[i(j,{class:"flex items-center"},{default:a((()=>[i(j,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(j,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:u(we,["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(D)?(l(),r(j,{key:0,class:c(["absolute left-[50rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(D)>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(D)>99?"99+":s(D)),1)])),_:1},8,["class"])):d("v-if",!0)])),_:1}),i(S,{class:"text-[32rpx] font-500 text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(S,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(S,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(S,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(s(T)).toFixed(2).split(".")[0]),1)])),_:1}),i(S,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(s(T)).toFixed(2).split(".")[1]),1)])),_:1})])),_:1})])),_:1}),i(R,{class:"w-[180rpx] h-[66rpx] text-[28rpx] leading-[66rpx] !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",shape:"circle",onClick:Ce},{default:a((()=>[k("去结算")])),_:1})])),_:1})):d("v-if",!0)])),_:1},8,["class"])):d("v-if",!0),z(i(j,{style:B(pe.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[A,pe.value]]),ge.value.length||ce.value?d("v-if",!0):(l(),r(j,{key:1,class:"flex justify-center items-center w-[100%] h-[100vh]"},{default:a((()=>[i(X,{option:{tip:"暂无商品分类"}})])),_:1})),i(O,{"bg-color":"rgb(248,248,248)",loading:ce.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"]),i(U),d(" 强制绑定手机号 "),i(le,{ref_key:"bindMobileRef",ref:be},null,512)])),_:1})}}}),[["__scopeId","data-v-ee1a9f08"]]),ce=Z(e({__name:"category-template-two-two",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const j=e,N=oe();N.getList();const D=S((()=>N.cartList)),T=S((()=>N.totalNum)),U=S((()=>N.totalMoney)),Y=E(),Q=S((()=>Y.info)),{mescrollInit:Z,getMescroll:ee}=G(R,L);let ae=j.config,ie=j.categoryId;const ce=t([]),de=t(""),ue=t(!0),ne=t(!1),pe=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const xe=e=>{ne.value=!1,K({page:e.num,limit:e.size,keyword:"",goods_category:ie,brand_id:"",label_ids:"",start_price:"",end_price:"",order:"price",sort:"desc"}).then((t=>{let o=t.data.data;const l=new Date;o=o.map((e=>{const t=new Date(e.create_time),o=+l-+t<1728e5;return{...e,flag:o}})),1==e.num&&(ce.value=[]),ce.value=ce.value.concat(o),ue.value=!1,e.endSuccess(o.length),ce.value.length||(ne.value=!0)})).catch((()=>{ue.value=!1,ne.value=!0,e.endErr()}))},fe=e=>{f({url:"/addon/phone_shop/pages/goods/detail",param:{goods_id:e}})};o((()=>{be()}));const _e=t(""),ge=t(!1),ve=t(!1),me=(e,t)=>{if(ge.value||ve.value)return!1;ge.value=!0,ve.value=!0;let o={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:Ee(e),stock:e.goodsSku.stock};e.id&&(o.num=e.num,o.id=e.id),N.increase(o,1,(()=>{ve.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),o=e.getBoundingClientRect().left,l=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;_e.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{_e.value=`top: ${l+e.offsetHeight/2-r.offsetHeight/2}px; left: ${o+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{_e.value="",ge.value=!1}),1020)}),100)};t({allActive:-1,data:{category_name:"全部",category_id:""}});const he=t([]),be=()=>{ue.value=!0,W().then((e=>{he.value=e.data;for(let t=0;t<he.value.length;t++)if(he.value[t].child_list){let e={category_name:"全部",category_id:he.value[t].category_id};he.value[t].child_list.unshift(e)}if(ie)for(let t=0;t<he.value.length;t++){if(he.value[t].category_id==ie){ke.value=t;break}if(he.value[t].child_list)for(let e=0;e<he.value[t].child_list.length;e++)if(he.value[t].child_list[e].category_id==ie){ke.value=t,ye.value=e;break}}else ie=e.data[0].category_id;ue.value=!1})).catch((()=>{ue.value=!1}))},ke=t(0),ye=t(0),we=(e,t)=>{ye.value=e,ie=t.category_id,pe.value=!1,ce.value=[],ee().resetUpScroll()},Ce=()=>{de.value&&f({url:"/addon/phone_shop/pages/goods/list",param:{goods_name:de.value}})};M();const Se=t(null),je=t(),Fe=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return fe(e.goodsSku.goods_id);if("cart"!==ae.cart.event)return fe(e.goods_id);if(!Q.value)return O().setLoginBack({url:"/addon/phone_shop/pages/goods/category"}),!1;if(uni.getStorageSync("isbindmobile"))return Se.value.open(),!1;if(e.goodsSku.sku_spec_format)je.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void I({title:"商品库存不足",icon:"none"});me(e,t)}},Ie=()=>{f({url:"/addon/phone_shop/pages/goods/cart"})},Ve=()=>{if(uni.getStorageSync("isbindmobile"))return Se.value.open(),!1;if(!T.value)return void I({title:"还没有选择商品",icon:"none"});const e=[];Object.values(D.value).forEach((t=>{Object.keys(t).forEach((o=>{"totalNum"!=o&&"totalMoney"!=o&&e.push(t[o].id)}))})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/phone_shop/pages/order/payment"})}})},Ne=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},Ee=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const o=_,f=g(v("u-icon"),H),S=m,j=h,F=b,E=g(v("u-popup"),te),L=g(v("u--image"),$),R=C,O=V,M=g(v("u-loading-page"),J),W=g(v("tabbar"),P);return l(),r(j,{class:"min-h-screen"},{default:a((()=>[he.value.length?(l(),r(j,{key:0,class:c(["mescroll-box bg-[#F4F6F8]",{cart:s(ae).cart.control&&"cart"===s(ae).cart.event,detail:!(s(ae).cart.control&&"cart"===s(ae).cart.event)}])},{default:a((()=>[i(q,{ref:"mescrollRef",down:{use:!1},onInit:s(Z),onUp:xe},{default:a((()=>{var e,_,g,v,m,h;return[s(ae).search.control?(l(),r(j,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[106rpx] box-border"},{default:a((()=>[i(o,{class:c(["search-ipt pl-[32rpx] text-[24rpx]",{"pr-[106rpx]":de.value,"pr-[32rpx]":!de.value}]),type:"text",modelValue:de.value,"onUpdate:modelValue":t[0]||(t[0]=e=>de.value=e),placeholder:s(ae).search.title,onConfirm:Ce},null,8,["class","modelValue","placeholder"]),i(j,{class:"flex items-center h-[70rpx] absolute right-[56rpx] top-[18rpx] z-2"},{default:a((()=>[de.value?(l(),r(f,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:t[1]||(t[1]=e=>de.value="")})):d("v-if",!0),i(j,{class:"h-[70rpx] w-[40rpx] text-center leading-[70rpx]",onClick:u(Ce,["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx]"})])),_:1},8,["onClick"])])),_:1})])),_:1})):d("v-if",!0),i(j,{class:c(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[106rpx]":s(ae).search.control,"pb-[98rpx]":s(ae).cart.control&&"cart"===s(ae).cart.event}])},{default:a((()=>[i(F,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(j,{class:"bg-[#F4F6F8]"},{default:a((()=>[(l(!0),n(x,null,p(he.value,((e,t)=>(l(),r(j,{class:c(["tab-item truncate",{"tab-item-active ":t==ke.value,"rounded-br-[12rpx]":!(ke.value-1!==t||he.value[ke.value].child_list&&he.value[ke.value].child_list.length),"rounded-tr-[12rpx]":!(ke.value+1!==t||he.value[ke.value].child_list&&he.value[ke.value].child_list.length)}]),key:t,onClick:o=>((e,t)=>{ke.value=e,t.child_list&&t.child_list.length?we(0,t.child_list[0]):(ie=t.category_id,ce.value=[],ee().resetUpScroll())})(t,e)},{default:a((()=>[i(j,{class:"text-box truncate px-[24rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),(null==(e=he.value[ke.value])?void 0:e.child_list)&&(null==(_=he.value[ke.value])?void 0:_.child_list.length)?(l(),r(j,{key:1,class:c(["flex justify-center items-center h-[92rpx] px-[24rpx] py-[20rpx] z-10 bg-white fixed left-[182rpx] right-0 box-border top-0",{"!top-[106rpx]":s(ae).search.control}])},{default:a((()=>[pe.value?(l(),n(x,{key:1},[i(j,{class:"flex-1 h-[48rpx] text-[22rpx] text-[#A5A6A6] pr-[24rpx] leading-[48rpx]"},{default:a((()=>[k("全部分类 ")])),_:1}),i(S,{class:"nc-iconfont nc-icon-shangV6xx-1 text-[30rpx]",onClick:t[3]||(t[3]=e=>pe.value=!1)})],64)):(l(),n(x,{key:0},[i(F,{"scroll-x":!0,"scroll-with-animation":"","scroll-into-view":"id"+(ye.value?ye.value-1:0),class:"flex-1 h-[49rpx] scroll-Y box-border pr-[24rpx] bg-white"},{default:a((()=>[i(j,{class:"flex items-center h-[48rpx] box-border"},{default:a((()=>{var e;return[(l(!0),n(x,null,p(null==(e=he.value[ke.value])?void 0:e.child_list,((e,t)=>(l(),r(S,{class:c(["flex-shrink-0 ml-[24rpx] px-[24rpx] h-[48rpx] text-[22rpx] leading-[44rpx] border-[2rpx] border-solid rounded-[24rpx] box-border",{"sub-tab-active text-color border-color":t===ye.value,"border-[#E2E2E2]":t!=ye.value}]),key:he.value[ke.value].category_id,id:"id"+t,onClick:o=>we(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","id","onClick"])))),128))]})),_:1})])),_:1},8,["scroll-into-view"]),i(j,{class:"nc-iconfont nc-icon-xiaV6xx text-[30rpx] w-[30rpx] h-[30rpx] text-center transform",onClick:t[2]||(t[2]=e=>pe.value=!0)})],64))])),_:1},8,["class"])):d("v-if",!0),i(j,{class:c(["labelPopup",{active:s(ae).search.control}])},{default:a((()=>[i(E,{show:pe.value,mode:"top",onClose:t[5]||(t[5]=e=>pe.value=!1)},{default:a((()=>[i(j,{class:"flex flex-wrap py-[24rpx]",onTouchmove:t[4]||(t[4]=u((()=>{}),["prevent","stop"]))},{default:a((()=>{var e;return[d(' <text\r\n\t\t\t\t\t\t\t\tclass="flex-shrink-0 w-[160rpx] ml-[22rpx] mb-[24rpx] text-center h-[48rpx] text-[22rpx] leading-[48rpx] border-[2rpx] border-solid rounded-[24rpx] box-border"\r\n\t\t\t\t\t\t\t\t:class="{ \'sub-tab-active text-color border-color\': initAll.allActive === subActive, \'border-[#E2E2E2]\': initAll.allActive != subActive }"\r\n\t\t\t\t\t\t\t\t @click="subMenuClick(initAll.allActive,initAll.data)">全部</text> '),(l(!0),n(x,null,p(null==(e=he.value[ke.value])?void 0:e.child_list,((e,t)=>(l(),r(S,{class:c(["flex-shrink-0 w-auto pl-2 pr-2 ml-[22rpx] mb-[24rpx] text-center h-[48rpx] text-[22rpx] leading-[48rpx] border-[2rpx] border-solid rounded-[24rpx] box-border",{"sub-tab-active text-color border-color":t===ye.value,"border-[#E2E2E2]":t!=ye.value}]),key:he.value[ke.value].category_id,onClick:o=>we(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1},8,["show"])])),_:1},8,["class"]),i(j,{class:c(["flex justify-center flex-wrap pl-[182rpx] pt-[20rpx] pb-[20rpx]",{"!pt-[218rpx]":s(ae).search.control&&(null==(g=he.value[ke.value])?void 0:g.child_list)&&(null==(v=he.value[ke.value])?void 0:v.child_list.length),"pt-[126rpx]":s(ae).search.control&&(!he.value[ke.value].child_list||!he.value[ke.value].child_list.length),"pt-[112rpx]":(null==(m=he.value[ke.value])?void 0:m.child_list)&&(null==(h=he.value[ke.value])?void 0:h.child_list.length)&&!s(ae).search.control}])},{default:a((()=>{var e,t,o,_;return[(l(!0),n(x,null,p(ce.value,((e,t)=>(l(),r(j,{key:e.goods_id,class:c(["w-[536rpx] box-border bg-white w-full flex mx-[16rpx] px-[24rpx] py-[20rpx] rounded-[12rpx]",{"mt-[16rpx]":t}]),onClick:u((t=>fe(e.goods_id)),["stop"])},{default:a((()=>[i(j,{class:"overflow-hidden mr-[8rpx] rounded-md position-r"},{default:a((()=>[i(j,{class:"position-a"},{default:a((()=>[e.flag?(l(),r(L,{key:0,class:"position-a",width:"58rpx",height:"28rpx",src:"https://vip.123pan.cn/1832133965/tiantai/1717078717e95d5ba5e4287e7131ff27478e746976_ott.png",model:"aspectFill"})):d("v-if",!0)])),_:2},1024),i(j,{class:"position-b"},{default:a((()=>[i(L,{width:"168rpx",height:"168rpx",src:s(w)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(f,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024)])),_:2},1024),i(j,{class:"flex flex-1 flex-wrap"},{default:a((()=>[i(j,{class:"w-[316rpx] max-h-[80rpx] text-[28rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),e.sub_title?(l(),r(j,{key:0,class:"w-[316rpx] max-h-[80rpx] text-[20rpx] leading-[40rpx] truncate"},{default:a((()=>[k(y(e.sub_title),1)])),_:2},1024)):d("v-if",!0),e.goodsSku.sku_no?(l(),r(j,{key:1,class:"w-[316rpx] max-h-[80rpx] text-[20rpx] leading-[40rpx] truncate"},{default:a((()=>[k(" sn: "+y(e.goodsSku.sku_no),1)])),_:2},1024)):d("v-if",!0),i(j,{class:"w-[316rpx] flex self-end items-end justify-between"},{default:a((()=>[i(j,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(S,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(S,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(Ee(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(S,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(Ee(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==Ne(e)?(l(),r(R,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/VIP.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0),"discount_price"==Ne(e)?(l(),r(R,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/phone_shop/discount.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(D)["goods_"+e.goods_id]&&s(D)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(ae).cart.control&&"cart"===s(ae).cart.event?(l(),r(j,{key:0,class:"flex items-center"},{default:a((()=>[i(S,{class:"text-[44rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:u((t=>(e=>{if(ve.value)return!1;ve.value=!0,N.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{ve.value=!1}))})(s(D)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(S,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(D)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(S,{class:"text-[44rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:u((o=>((e,t,o)=>{if(parseInt(t.num)>=parseInt(t.stock))return void I({title:"商品库存不足",icon:"none"});let l=re(e);l.num=t.num,l.id=t.id,me(l,o)})(e,s(D)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(ae).cart.event||"real"==e.goods_type?(l(),n(x,{key:1},[s(ae).cart.control&&"style-1"===s(ae).cart.style?(l(),r(j,{key:0,class:"h-[44rpx] relative pl-[20rpx]"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"text-[#fff] bg-color h-[44rpx] text-[24rpx] px-[10px] leading-[44rpx] rounded-[22rpx]",onClick:u((o=>Fe(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(ae).cart.text),1)])),_:2},1032,["id","onClick"]),s(D)["goods_"+e.goods_id]&&s(D)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(D)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(D)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ae).cart.control&&"style-2"===s(ae).cart.style?(l(),r(j,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:u((o=>Fe(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(D)["goods_"+e.goods_id]&&s(D)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(D)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(D)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ae).cart.control&&"style-3"===s(ae).cart.style?(l(),r(j,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:u((o=>Fe(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(D)["goods_"+e.goods_id]&&s(D)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(D)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(D)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ae).cart.control&&"style-4"===s(ae).cart.style?(l(),r(j,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:u((o=>Fe(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(D)["goods_"+e.goods_id]&&s(D)["goods_"+e.goods_id].totalNum?(l(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(D)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(D)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0)],64)):d("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),ce.value.length||ue.value||!ne.value?d("v-if",!0):(l(),r(j,{key:0,class:c(["w-[536rpx] mx-[16rpx] rounded-[12rpx] flex items-center justify-center",{noData1:s(ae).search.control,noData2:!s(ae).search.control,child:(null==(e=he.value[ke.value])?void 0:e.child_list)&&(null==(t=he.value[ke.value])?void 0:t.child_list.length),noChild:!(null==(o=he.value[ke.value])?void 0:o.child_list)||!(null==(_=he.value[ke.value])?void 0:_.child_list.length)}])},{default:a((()=>[i(X,{option:{tip:"暂无商品"}})])),_:1},8,["class"]))]})),_:1},8,["class"]),i(se,{ref_key:"cartRef",ref:je},null,512)]})),_:1},8,["onInit"]),s(ae).cart.control&&"cart"===s(ae).cart.event?(l(),r(j,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios"},{default:a((()=>[i(j,{class:"flex items-center"},{default:a((()=>[i(j,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(j,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:u(Ie,["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(T)?(l(),r(j,{key:0,class:c(["absolute left-[50rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(T)>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(T)>99?"99+":s(T)),1)])),_:1},8,["class"])):d("v-if",!0)])),_:1}),i(S,{class:"text-[32rpx] font-500 text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(S,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(S,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(S,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(s(U)).toFixed(2).split(".")[0]),1)])),_:1}),i(S,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(s(U)).toFixed(2).split(".")[1]),1)])),_:1})])),_:1})])),_:1}),i(O,{class:"w-[180rpx] h-[66rpx] text-[28rpx] leading-[66rpx] !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",shape:"circle",onClick:Ve},{default:a((()=>[k("去结算")])),_:1})])),_:1})):d("v-if",!0)])),_:1},8,["class"])):d("v-if",!0),z(i(j,{style:B(_e.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[A,_e.value]]),he.value.length||ue.value?d("v-if",!0):(l(),r(j,{key:1,class:"flex justify-center items-center w-[100%]"},{default:a((()=>[i(X,{option:{tip:"暂无商品分类"}})])),_:1})),i(M,{"bg-color":"rgb(248,248,248)",loading:ue.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"]),i(W),d(" 强制绑定手机号 "),i(le,{ref_key:"bindMobileRef",ref:Se},null,512)])),_:1})}}}),[["__scopeId","data-v-25c58f1c"]]),de=Z(e({__name:"category",setup(e){const o=E(),s=S((()=>o.info)),i=oe(),c=t({}),u=t(0);return D((e=>{if(!s.value){let e=uni.getStorageSync("pid");e&&e>0?O().setLoginBack({url:"/addon/phone_shop/pages/goods/category?mid="+e}):O().setLoginBack({url:"/addon/phone_shop/pages/goods/category"})}u.value=e.category_id||0,Q().then((e=>{c.value=e.data,U({title:c.value.page_title})}))})),T((()=>{i.getList()})),(e,t)=>{const o=h;return l(),r(o,{style:B(e.themeColor())},{default:a((()=>[1===c.value.level&&"style-1"===c.value.template?(l(),r(ie,{key:0,class:"category",categoryId:u.value,config:c.value},null,8,["categoryId","config"])):d("v-if",!0),2===c.value.level&&"style-1"===c.value.template?(l(),r(ae,{key:1,categoryId:u.value,config:c.value},null,8,["categoryId","config"])):d("v-if",!0),2===c.value.level&&"style-2"===c.value.template?(l(),r(ce,{key:2,class:"category",categoryId:u.value,config:c.value},null,8,["categoryId","config"])):d("v-if",!0)])),_:1},8,["style"])}}}),[["__scopeId","data-v-3cd2179b"]]);export{de as default};
