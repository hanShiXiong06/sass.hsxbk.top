import{d as e,r as t,p as r,o as l,c as a,w as s,U as d,b as o,y as i,z as u,u as n,f,V as x,ad as p,n as c,a as _,c0 as m,k as v,b1 as b,D as y,i as h,g,h as k,F as w,E as j,b7 as C,c1 as T,c2 as P,bl as z,a$ as D,_ as M}from"./index-71c7df08.js";import{_ as O}from"./pay.6aa36878.js";import{_ as V}from"./loading-page.vue_vue_type_script_setup_true_lang.c7dc2256.js";import{e as N,c as R,d as $}from"./order.7a0e41bc.js";import"./pay.4cfa8889.js";const F=M(e({__name:"detail",setup(e){let M=0;const F=t(null),S=t(!1);r((e=>{M=e.order_id||0,B()}));const B=()=>{S.value=!0,N(M).then((e=>{F.value=e.data,S.value=!1,G()})).catch((()=>{S.value=!1}))},E=()=>{N(M).then((e=>{F.value=e.data,G()})).catch((()=>{}))},H=t(null),I=(e="",t="")=>{var r,l;"pay"==e?null==(r=H.value)||r.open(F.value.order_type,F.value.order_id,`/addon/o2o/pages/order/detail?order_id=${F.value.order_id}`):"item_pay"==e?null==(l=H.value)||l.open("o2o_item",t.order_item_id,`/addon/o2o/pages/order/detail?order_id=${F.value.order_id}`):"cancel"==e?L(F.value):"delete"==e?U(F.value):"index"==e&&_({url:"/addon/o2o/pages/index",mode:"reLaunch"})},L=e=>{m({title:"提示",content:"您确定要取消该订单吗？",confirmColor:v().themeColor["--primary-color"],success:t=>{t.confirm&&R(e.order_id).then((e=>{B()}))}})},U=e=>{m({title:"提示",content:"您确定要删除该订单吗？",confirmColor:v().themeColor["--primary-color"],success:t=>{t.confirm&&$(e.order_id).then((e=>{_({url:"/addon/o2o/pages/order/list"})})).catch((()=>{}))}})};function q(e){var t=new Date(e).getTime();if(null!=t&&""!=t&&t>0){var r=new Date;r.setTime(t);var l=r.getMonth()+1;l=l<10?"0"+l:l;var a=r.getDate();a=a<10?"0"+a:a;var s=r.getHours();s=s<10?"0"+s:s;var d=r.getMinutes();return l+"-"+a+" "+s+":"+(d=d<10?"0"+d:d)}return""}const A=t(0);function G(){return"dispatch"==F.value.order_status_info.status?A.value=0:"wait_service"==F.value.order_status_info.status?A.value=1:"in_service"==F.value.order_status_info.status?A.value=2:"finish"==F.value.order_status_info.status?A.value=3:void 0}return(e,t)=>{const r=y,m=h,v=g(k("u-icon"),C),M=g(k("u-steps-item"),T),N=g(k("u-steps"),P),R=g(k("u--image"),z),$=g(k("u-empty"),D),B=g(k("pay"),O),L=g(k("loading-page"),V);return l(),a(m,{style:c(e.themeColor())},{default:s((()=>[S.value?f("v-if",!0):(l(),d(x,{key:0},[F.value?(l(),a(m,{key:0,class:"bg-[#f7f7f7] min-h-screen overflow-hidden"},{default:s((()=>[o(m,{class:"bg-linear h-[480rpx] text-white px-3 pt-5"},{default:s((()=>[o(m,{class:"text-[42rpx] flex items-baseline text-[#fff]"},{default:s((()=>[o(r,{class:"nc-iconfont nc-icon-a-shijianV6xx-36 text-[42rpx] mr-1"}),o(r,{class:"font-bold"},{default:s((()=>{var e,t;return[i(u(n(w)("order"))+u(null==(t=null==(e=F.value)?void 0:e.order_status_info)?void 0:t.name),1)]})),_:1})])),_:1})])),_:1}),o(m,{class:"bg-[#fff] mx-3 p-[30rpx] -mt-[360rpx] rounded-[10rpx]"},{default:s((()=>[o(m,{class:"flex"},{default:s((()=>[o(m,{class:"min-w-[50rpx] flex items-center justify-center"},{default:s((()=>[o(v,{name:"map",size:"20"})])),_:1}),o(m,{class:"flex flex-col ml-[20rpx]"},{default:s((()=>[o(r,{class:"text-[24rpx] mt-[10rpx] leading-[35rpx] line-feed"},{default:s((()=>[i(u(F.value.taker_full_address),1)])),_:1}),o(m,null,{default:s((()=>[o(r,{class:"text-[24rpx]"},{default:s((()=>[i(u(F.value.taker_name),1)])),_:1}),o(r,{class:"text-[24rpx] mt-[15rpx]"},{default:s((()=>[i(u(F.value.taker_mobile),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),F.value.pay_time?(l(),a(m,{key:0,class:"flex py-4 px-3 bg-white rounded-md box-border mx-3 mt-[20rpx] task-steps"},{default:s((()=>[o(N,{current:A.value,activeColor:"var(--primary-color)"},{default:s((()=>[o(M,{title:n(w)("placeOrder"),desc:F.value.create_time?q(F.value.create_time):"---"},null,8,["title","desc"]),o(M,{title:n(w)("takeOrders"),desc:F.value.dispatch_time?q(F.value.dispatch_time):"---"},null,8,["title","desc"]),o(M,{title:n(w)("start"),desc:F.value.service_time?q(F.value.service_time):"---"},null,8,["title","desc"]),o(M,{title:n(w)("finish"),desc:F.value.finish_time?q(F.value.finish_time):"---"},null,8,["title","desc"])])),_:1},8,["current"])])),_:1})):f("v-if",!0),o(m,{class:"mt-[20rpx]"},{default:s((()=>[o(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] rounded-[10rpx]"},{default:s((()=>[(l(!0),d(x,null,p(F.value.item,((e,t)=>(l(),a(m,{class:"order-goods-item py-[20rpx]",key:t},{default:s((()=>[o(m,{class:"flex justify-between items-center",onClick:t=>{var r;"reservation"!=(r=e).item_type&&"buy"!=r.item_type||_({url:"/addon/o2o/pages/goods/detail",param:{sku_id:r.item_id}})}},{default:s((()=>[o(m,{class:"w-[160rpx] h-[160rpx] flex-2"},{default:s((()=>[o(R,{class:"rounded-[10rpx] overflow-hidden",width:"160rpx",height:"160rpx",src:n(j)(e.item_image?e.item_image:""),model:"aspectFill"},{error:s((()=>[o(v,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024),o(m,{class:"ml-[20rpx] flex-1"},{default:s((()=>[o(m,{class:"flex justify-between"},{default:s((()=>[o(r,{class:"text-[28rpx] text-item leading-[40rpx] max-h-[80rpx] w-[360rpx] multi-hidden"},{default:s((()=>[i(u(e.item_name),1)])),_:2},1024),o(r,{class:"shrink-0 text-[24rpx] text-[var(--primary-color)] ml-[10rpx] leading-[40rpx]"},{default:s((()=>[i(u(e.pay_time?n(w)("havePaid"):n(w)("notPaid")),1)])),_:2},1024)])),_:2},1024),o(m,{class:"text-[24rpx] mt-[20rpx] flex"},{default:s((()=>[o(r,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:s((()=>[i(u(e.item_type_name),1)])),_:2},1024)])),_:2},1024),o(m,{class:"flex justify-between mt-[26rpx] items-center"},{default:s((()=>[o(r,{class:"text-right text-[28rpx] text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(e.price),1)])),_:2},1024),o(r,{class:"text-right text-sm"},{default:s((()=>[o(r,{class:"text-[26rpx]"},{default:s((()=>[i("x")])),_:1}),i(u(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),o(m,{class:"flex justify-end self-end w-[100%] mt-[10rpx]"},{default:s((()=>[e.refund_no&&""!=e.refund_status&&"cancel"!=e.refund_status?(l(),a(m,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>n(_)({url:"/addon/o2o/pages/refund/detail",param:{refund_no:e.refund_no}})},{default:s((()=>[i(u(n(w)("viewRefund")),1)])),_:2},1032,["onClick"])):f("v-if",!0),F.value.order_status_info.is_refund&&e.is_enable_refund&&-1!=["","cancel"].indexOf(e.refund_status)?(l(),a(m,{key:1,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{return r=e.order_item_id,void _({url:"/addon/o2o/pages/refund/apply",param:{order_id:F.value.order_id,order_item_id:r}});var r}},{default:s((()=>[i(u(n(w)("applyRefund")),1)])),_:2},1032,["onClick"])):f("v-if",!0),"custom"==e.item_type?(l(),d(x,{key:2},[e.pay_time?f("v-if",!0):(l(),a(m,{key:0,class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>I("item_pay",e)},{default:s((()=>[i(u(n(w)("goToPay")),1)])),_:2},1032,["onClick"])),o(m,{class:"text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>{var r;_({url:"/addon/o2o/pages/master/task/show",param:{order_id:(r=e).order_id,order_item_id:r.order_item_id,item_name:r.item_name,price:r.item_money,item_images:r.item_images}})}},{default:s((()=>[i(u(n(w)("show")),1)])),_:2},1032,["onClick"])],64)):f("v-if",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),F.value.check_code?(l(),a(m,{key:0,class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[F.value.technician_id?(l(),a(m,{key:0,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("servicePersonal")),1)])),_:1}),o(m,{class:"text-[var(--text-color-light9)]",onClick:t[0]||(t[0]=e=>n(_)({url:"/addon/o2o/pages/technician/detail",param:{id:F.value.technician_id}}))},{default:s((()=>[i(u(F.value.technician_id?F.value.technician_info.name:n(w)("orderToBeSent")),1)])),_:1})])),_:1})):f("v-if",!0),F.value.technician_id?(l(),a(m,{key:1,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("contactNumber")),1)])),_:1}),o(m,{class:"text-[var(--text-color-light9)]",onClick:t[1]||(t[1]=e=>{return t=F.value.technician_info.mobile,void b({phoneNumber:t});var t})},{default:s((()=>[i(u(F.value.technician_info.mobile),1)])),_:1})])),_:1})):f("v-if",!0),o(m,{class:"flex justify-between text-[28rpx] mt-[30rpx]"},{default:s((()=>[o(r,null,{default:s((()=>[i(u(n(w)("serviceCode")),1)])),_:1}),o(r,{class:"text-[var(--text-color-light9)]"},{default:s((()=>[i(u(F.value.check_code),1)])),_:1})])),_:1}),o(m,{class:"text-[20rpx] mt-[20rpx] text-[var(--text-color-light9)]"},{default:s((()=>[i(u(n(w)("explain")),1)])),_:1})])),_:1})):f("v-if",!0),o(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[o(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("onOrder")),1)])),_:1}),o(m,null,{default:s((()=>[i(u(F.value.order_no),1)])),_:1})])),_:1}),F.value.out_trade_no?(l(),a(m,{key:0,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("transactionNumber")),1)])),_:1}),o(m,null,{default:s((()=>[i(u(F.value.out_trade_no),1)])),_:1})])),_:1})):f("v-if",!0),o(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("createTime")),1)])),_:1}),o(m,null,{default:s((()=>[i(u(F.value.create_time),1)])),_:1})])),_:1}),o(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("reserveServiceTime")),1)])),_:1}),o(m,null,{default:s((()=>[i(u(F.value.reserve_service_time),1)])),_:1})])),_:1}),o(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx] box-border"},{default:s((()=>[o(m,{class:"shrink-0 mr-[18rpx]"},{default:s((()=>[i(u(n(w)("remark")),1)])),_:1}),o(m,{class:"max-w-[510rpx] leading-[38rpx] line-feed"},{default:s((()=>[i(u(F.value.member_message?F.value.member_message:"无"),1)])),_:1})])),_:1}),F.value.pay?(l(),a(m,{key:1,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("modePayment")),1)])),_:1}),o(m,null,{default:s((()=>[i(u(F.value.pay.type_name),1)])),_:1})])),_:1})):f("v-if",!0),F.value.pay?(l(),a(m,{key:2,class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[30rpx]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("payTime")),1)])),_:1}),o(m,null,{default:s((()=>[i(u(F.value.pay.pay_time),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1}),o(m,{class:"bg-[#fff] mx-[30rpx] p-[30rpx] mt-[30rpx] rounded-[10rpx]"},{default:s((()=>[o(m,{class:"flex justify-between text-[28rpx] pt-[20rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("goodsMoney")),1)])),_:1}),o(m,{class:"text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(F.value.total_money),1)])),_:1})])),_:1}),o(m,{class:"flex justify-between text-[28rpx] border-top-[2rpx] border-[solid] border-[#f1f1f1] mt-[40rpx]"},{default:s((()=>[o(m,null,{default:s((()=>[i(u(n(w)("realMoney")),1)])),_:1}),o(m,{class:"text-[var(--price-text-color)] price-font"},{default:s((()=>[i("￥"+u(F.value.total_pay_money),1)])),_:1})])),_:1})])),_:1})])),_:1}),o(m,{class:"h-[160rpx] w-full"}),o(m,{class:"flex z-2 justify-between items-center bg-[#fff] fixed left-0 right-0 bottom-0 min-h-[100rpx] px-1 flex-wrap pb-ios"},{default:s((()=>[o(m,{class:"flex ml-[30rpx] w-[70rpx] flex-col justify-center items-center",onClick:t[2]||(t[2]=e=>I("index"))},{default:s((()=>[o(r,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[36rpx]"}),o(r,{class:"text-xs mt-1"},{default:s((()=>[i(u(n(w)("index")),1)])),_:1})])),_:1}),F.value.order_status_info?(l(),a(m,{key:0,class:"flex justify-end mr-[30rpx]"},{default:s((()=>[(l(!0),d(x,null,p(F.value.order_status_info.member_action,((e,t)=>(l(),a(m,{key:t,class:"inline-block text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[10rpx]",onClick:t=>I(e.key)},{default:s((()=>[i(u(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})):f("v-if",!0)])),_:1})])),_:1})):(l(),a(m,{key:1,class:"w-screen h-screen flex flex-col justify-center items-center"},{default:s((()=>[o($,{icon:n(j)("static/resource/images/order_empty.png"),text:"未获取到订单信息"},null,8,["icon"])])),_:1})),f(" 刷新 "),o(m,{class:"fixed bottom-[calc(160rpx+env(safe-area-inset-bottom))] right-[30rpx] rounded-full bg-[#fff] w-[80rpx] h-[80rpx] flex flex-col items-center justify-center shadow-xl",onClick:E},{default:s((()=>[o(r,{class:"nc-iconfont nc-icon-shuaxinV6xx text-[36rpx]"}),o(r,{class:"text-[22rpx] mt-[6rpx]"},{default:s((()=>[i(u(n(w)("refresh")),1)])),_:1})])),_:1})],64)),o(B,{ref_key:"payRef",ref:H},null,512),o(L,{loading:S.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-ad4ab945"]]);export{F as default};
