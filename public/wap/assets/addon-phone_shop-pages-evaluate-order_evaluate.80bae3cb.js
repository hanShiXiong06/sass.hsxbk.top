import{d as e,p as a,g as l,h as t,o as r,c as o,w as s,I as u,K as n,J as d,u as i,L as p,b as c,l as x,Y as m,e as f,y as _,z as v,v as g,H as h,at as b,D as y,i as j,r as w,j as V,a as C,n as z,E as U,c2 as k}from"./index-d8a8f699.js";import{_ as E}from"./u-icon.5ba98c98.js";import{_ as I}from"./u--image.2df700b8.js";import{_ as A}from"./u-rate.3877ed5b.js";import{_ as S}from"./u-tabbar.5fed7184.js";import{_ as B}from"./u-loading-page.c740ef13.js";import{a as F}from"./order.6a01647a.js";import{s as N}from"./evaluate.2ac980e8.js";import{_ as T}from"./u-upload.2fbab84f.js";import{_ as Y}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-image.e646392b.js";import"./u-transition.db07fff7.js";import"./u-safe-bottom.a4431b09.js";import"./u-loading-icon.6808ae8c.js";/* empty css                                                                 */const $=e({__name:"upload-img",props:{modelValue:{type:String||Array},maxCount:{type:Number,default:9},multiple:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:w}){const V=e,C=a({get:()=>V.modelValue,set(e){w("update:modelValue",e)}}),z=a((()=>V.maxCount)),U=e=>{V.multiple?e.file.forEach((e=>{k({file:e})})):k(e)},k=e=>{var a;if((null==(a=C.value)?void 0:a.length)>=z.value)return h({title:`最多允许上传${z.value}张图片`,icon:"none"}),!1;b({filePath:e.file.url,name:"file"}).then((e=>{var a;(null==(a=C.value)?void 0:a.length)<z.value&&C.value.push(e.data.url)})).catch((()=>{}))};return(e,a)=>{const h=l(t("u-icon"),E),b=l(t("u--image"),I),w=y,k=j,A=l(t("u-upload"),T);return r(),o(k,{class:"flex flex-wrap"},{default:s((()=>[(r(!0),u(n,null,d(i(C),((e,a)=>(r(),o(k,{class:p(["mb-[18rpx] relative",(a+1)%3==0?"":"mr-[18rpx]"])},{default:s((()=>[c(b,{class:"rounded-[10rpx] overflow-hidden",width:"204rpx",height:"204rpx",src:i(x)(e||""),model:"aspectFill"},{error:s((()=>[c(h,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"]),c(w,{class:"nc-iconfont nc-icon-guanbiV6xx absolute top-0 right-[5rpx] text-[#fff] bg-[#888] rounded-bl-[16rpx]",onClick:m((e=>(e=>{C.value.splice(e,1)})(a)),["stop"])},null,8,["onClick"])])),_:2},1032,["class"])))),256)),f(c(k,{class:"w-[204rpx] h-[204rpx]"},{default:s((()=>[c(A,{onAfterRead:U,maxCount:i(z),multiple:V.multiple},{default:s((()=>[c(k,{class:"flex items-center justify-center w-[204rpx] h-[204rpx] border-[2rpx] border-dashed border-[#ebebec] text-center text-[#888]"},{default:s((()=>[c(k,null,{default:s((()=>[c(k,{class:"nc-iconfont nc-icon-xiangjiV6xx text-[50rpx]"}),c(k,{class:"text-[24rpx] mt-[10rpx]"},{default:s((()=>[_(v(i(C).length)+"/"+v(i(z)),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["maxCount","multiple"])])),_:1},512),[[g,i(C).length<i(z)]])])),_:1})}}}),q=Y(e({__name:"order_evaluate",setup(e){const a=w([]),m=w([]),f=w("2"),g=w(!1),b=w("");V((e=>{b.value=e.order_id,T(b.value)}));const T=e=>{g.value=!0,F(e).then((e=>{if(e.data.is_evaluate)return D(b.value),!1;a.value=e.data.order_goods,e.data.order_goods.forEach((e=>{m.value.push({order_id:e.order_id,order_goods_id:e.order_goods_id,goods_id:e.goods_id,content:"",images:[],scores:5})})),g.value=!1})).catch((()=>{g.value=!1}))},Y=()=>{f.value="1"===f.value?"2":"1"},q=()=>{if(m.value.some((e=>""==e.content)))return h({title:"请输入你的评价",icon:"none"}),!1;for(let e=0;e<m.value.length;e++){let a=m.value[e];a.content.length>200&&(a.content=a.content.substr(0,200))}m.value.forEach((e=>e.is_anonymous=f.value)),g.value=!0,N({evaluate_array:m.value}).then((e=>{g.value=!1,D(b.value)})).catch((()=>{g.value=!1}))},D=e=>{C({url:"/addon/phone_shop/pages/evaluate/order_evaluate_view",param:{order_id:e},mode:"redirectTo"})};return(e,h)=>{const b=l(t("u-icon"),E),w=l(t("u--image"),I),V=j,C=y,F=l(t("u-rate"),A),N=k,T=U,D=l(t("u-tabbar"),S),H=l(t("u-loading-page"),B);return r(),o(V,{class:"bg-[#f8f8f8] min-h-screen",style:z(e.themeColor())},{default:s((()=>[c(V,{class:"px-[24rpx] py-[20rpx]"},{default:s((()=>[(r(!0),u(n,null,d(a.value,((e,a)=>(r(),o(V,{key:a,class:"bg-white py-[20rpx] px-[24rpx] mb-[20rpx] rounded-[16rpx]"},{default:s((()=>[c(V,{class:"flex mb-[20rpx]"},{default:s((()=>[c(w,{class:"rounded-[10rpx] overflow-hidden",width:"200rpx",height:"200rpx",src:i(x)(e.goods_image_thumb_small?e.goods_image_thumb_small:""),model:"aspectFill"},{error:s((()=>[c(b,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"]),c(V,{class:"flex-1 flex flex-wrap ml-[20rpx]"},{default:s((()=>[c(V,null,{default:s((()=>[c(V,{class:"text-[26rpx] h-[80rpx] leading-[40rpx] multi-hidden mb-[10rpx]"},{default:s((()=>[_(v(e.goods_name),1)])),_:2},1024),c(V,{class:"w-[404rpx] mt-[12rpx] truncate text-[#888] text-[24rpx] leading-[32rpx]"},{default:s((()=>[_(v(e.sku_name),1)])),_:2},1024)])),_:2},1024),c(V,{class:"mt-auto flex self-end justify-between w-[100%]"},{default:s((()=>[c(V,{class:"flex flex-col"},{default:s((()=>[c(C,{class:"text-[28rpx] text-[var(--price-text-color)] price-font"},{default:s((()=>[_("￥"+v(e.price),1)])),_:2},1024)])),_:2},1024),c(C,{class:"text--[24rpx] text-[#666]"},{default:s((()=>[_("x"+v(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),c(V,{class:"pt-[20rpx] flex items-center border-0 border-t-[2rpx] border-solid border-[#ebebec]"},{default:s((()=>[c(F,{count:5,modelValue:m.value[a].scores,"onUpdate:modelValue":e=>m.value[a].scores=e,"active-color":"var(--primary-color)",size:"32rpx"},null,8,["modelValue","onUpdate:modelValue"]),c(C,{class:"ml-[20rpx] text-[26rpx] text-[#888]"},{default:s((()=>[_(v(1===m.value[a].scores?"差评":2===m.value[a].scores||3===m.value[a].scores?"中评":"好评"),1)])),_:2},1024)])),_:2},1024),c(N,{class:"!text-[26rpx] mt-[20rpx] w-[100%]",modelValue:m.value[a].content,"onUpdate:modelValue":e=>m.value[a].content=e,modelModifiers:{trim:!0},placeholder:"请在此处输入你的评价",maxlength:"200"},null,8,["modelValue","onUpdate:modelValue"]),c(V,{class:"text-right text-[24rpx] text-[#888]"},{default:s((()=>[_(v(m.value[a].content.length>=200?200:m.value[a].content.length)+"/200",1)])),_:2},1024),c(i($),{class:"mt-[20rpx]",modelValue:m.value[a].images,"onUpdate:modelValue":e=>m.value[a].images=e,"max-count":9,multiple:!0},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)))),128))])),_:1}),c(D,{fixed:!0,placeholder:!0,safeAreaInsetBottom:!0,zIndex:"9999"},{default:s((()=>[c(V,{class:"flex items-center px-[30rpx] py-[10rpx] box-border justify-between w-[100%]"},{default:s((()=>[c(V,{class:"flex items-center",onClick:Y},{default:s((()=>[c(C,{class:p(["iconfont text-color text-[34rpx] mr-[12rpx]",{"iconxuanze1 text-[var(--primary-color)]":"1"===f.value,"nc-iconfont nc-icon-yuanquanV6xx":"1"!==f.value}])},null,8,["class"]),c(C,{class:p(["font-500 text-[28rpx]",{"text-[var(--primary-color)]":"1"===f.value,"text-[#676767]":"1"!==f.value}])},{default:s((()=>[_("匿名")])),_:1},8,["class"])])),_:1}),c(T,{class:"!w-[444rpx] !h-[80rpx] text-[32rpx] !m-0 leading-[80rpx] rounded-full text-white bg-[var(--primary-color)] remove-border",onClick:q},{default:s((()=>[_("提交")])),_:1})])),_:1})])),_:1}),c(H,{"bg-color":"rgb(248,248,248)",loading:g.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-c1ded404"]]);export{q as default};
