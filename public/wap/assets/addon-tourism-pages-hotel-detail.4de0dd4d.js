import{d as e,r as t,m as l,p as a,j as s,l as o,s as r,o as n,c as u,w as c,u as i,b as d,y as x,z as f,I as m,J as p,K as _,bw as b,f as h,Y as g,n as v,c8 as y,g as k,h as w,i as j,D as F,c9 as C,Q as V,a2 as P,E as T,L as D,x as z,H as I,G as O,C as S,a as E}from"./index-d8a8f699.js";import{_ as U}from"./u-swiper.efc69b22.js";import{_ as Y}from"./u-popup.0d48946e.js";import{_ as H}from"./u-parse.8b113dfe.js";import{_ as K}from"./u-loading-page.c740ef13.js";import{_ as L}from"./u-calendar.b777e5f2.js";import{k as R,l as $,m as q}from"./tourism.93d35d7c.js";import{_ as B}from"./share-poster.b1e17ebe.js";import{_ as G}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.6808ae8c.js";import"./u-transition.db07fff7.js";import"./u-icon.5ba98c98.js";import"./u-safe-bottom.a4431b09.js";import"./u-button.aa0eb212.js";import"./index.a605aec4.js";const J=G(e({__name:"detail",setup(e){let G=t([]),J=t([]),M=t(!0),N=t(!1),Q=t(!1),W=t(!1),X=t([]),Z=t({start_time:"",end_time:"",day:1}),A={room_id:"",start_time:"",end_time:"",num:1},ee=t(!1),te=t(!1);const le=l(),ae=a((()=>le.info)),se=e=>(y(Date.parse(e.date)/1e3,"year_month_day"),e),oe=e=>{A.start_time=e[0],A.end_time=e[e.length-1],Z.value.start_time=ie(e[0]),Z.value.end_time=ie(e[e.length-1]),Z.value.day=e.length-1,ee.value=!1,fe(A.start_time)};let re=t(""),ne=t([]);s((e=>{var t;re.value=e.id,M.value=!0,t=e.id,$(t).then((e=>{e.data,te.value=!0})).catch((()=>{M.value=!0})),R(e.id).then((e=>{J.value=e.data,ne.value.push({id:1,latitude:J.value.latitude,longitude:J.value.longitude,iconPath:o("addon/tourism/tourism/map_icon.png"),height:25}),r({title:J.value.hotel_name}),G.value=[],J.value.image_thumb_big&&J.value.image_thumb_big.length?J.value.image_thumb_big.forEach(((e,t)=>{G.value.push(o(e))})):G.value.push(o(J.value.cover_thumb_big)),J.value.hotel_tag&&(J.value.hotel_tag=J.value.hotel_tag.split("，").join(",").split(","),J.value.hotel_tag=J.value.hotel_tag.filter((e=>e&&e.trim()))),J.value.hotel_attribute&&(J.value.hotel_attribute=J.value.hotel_attribute.split("，").join(",").split(","),J.value.hotel_attribute=J.value.hotel_attribute.filter((e=>e&&e.trim()))),J.value.room_list&&J.value.room_list.forEach(((e,t)=>{e.attr_name=e.attr_name.split("|").filter(((e,t)=>e&&e.trim()))})),X.value=J.value.room_list||[],be(),M.value=!1}))}));let ue=t({});const ce=(e,t)=>"empty"==t?(I({title:"入住时间当日房间已售空",icon:"none"}),!1):O()?(A.room_id=e.goods_id,uni.setStorageSync("hotelCreateData",A),void E({url:"/addon/tourism/pages/hotel/order"})):(S().setLoginBack({url:"/addon/tourism/pages/hotel/detail",param:{id:re.value}}),!1),ie=e=>{var t=[];return-1!=e.indexOf("-")?t=e.split("-"):-1!=e.indexOf("/")&&(t=e.split("/")),t[1]+"月"+t[2]+"日"},de=e=>{var t=864e5*e;return new Date(Date.now()+t)},xe=e=>{let t=e.getFullYear(),l=e.getMonth()+1,a=e.getDate();return""+(t+"-"+(l<10?"0"+l:l)+"-"+(a<10?"0"+a:a))};Z.value.start_time=ie(xe(de(0))),Z.value.end_time=ie(xe(de(1))),A.start_time=xe(de(0)),A.end_time=xe(de(1));const fe=e=>{let t={};t.date=e,t.hotel_id=J.value.hotel_id,q(t).then((e=>{X.value=e.data,X.value&&X.value.forEach(((e,t)=>{e.attr_name=e.attr_name.split("|").filter(((e,t)=>e&&e.trim()))}))}))};let me=t(null),pe=t(""),_e={};const be=()=>{pe.value="?id="+J.value.hotel_id,ae.value&&ae.value.member_id&&(pe.value+="&mid="+ae.value.member_id)},he=()=>{_e.id=J.value.hotel_id,ae.value&&ae.value.member_id&&(_e.member_id=ae.value.member_id),me.value.openShare()};let ge=e=>{let t="";return t=e.member_discount&&O()?"member_price":"",t},ve=e=>{let t="0.00";return t=e.member_discount&&O()&&e.member_price||e.price,parseFloat(t).toFixed(2)};return(e,t)=>{const l=k(w("u-swiper"),U),a=j,s=F,r=k(w("u-popup"),Y),y=C,I=V,O=k(w("u-parse"),H),S=P,E=T,R=k(w("u-loading-page"),K),$=k(w("u-calendar"),L);return n(),u(a,{class:"bg-[#f7f7f7] min-h-screen overflow-hidden",style:v(e.themeColor())},{default:c((()=>[i(M)?h("v-if",!0):(n(),u(a,{key:0},{default:c((()=>[d(l,{list:i(G),height:"380rpx",radius:"0"},null,8,["list"]),d(a,{class:"chunk-wrap pt-4 pb-3 rounded-t-2xl relative -mt-[30rpx]"},{default:c((()=>[d(a,{class:"flex flex-wrap items-center"},{default:c((()=>[d(a,{class:"font-bold multi-hidden"},{default:c((()=>[x(f(i(J).hotel_name),1)])),_:1}),d(a,{class:"font-bold multi-hidden text-[#ffaf00] flex items-center text-xs mt-[-4rpx] ml-2"},{default:c((()=>[d(s,{class:"iconfont iconxingxing mr-[4rpx] text-xs mt-[-4rpx]"}),d(s,null,{default:c((()=>[x(f(i(J).hotel_star)+"星",1)])),_:1})])),_:1})])),_:1}),d(a,{class:"flex mt-[16rpx] justify-between items-center"},{default:c((()=>[d(a,{class:"flex"},{default:c((()=>[i(J).hotel_tag.length?(n(!0),m(_,{key:0},p(i(J).hotel_tag,((e,t)=>(n(),m(_,null,[t<4?(n(),u(s,{key:0,class:D(["bg-[#F6F8F9] text-xs px-[10rpx] py-[4rpx] rounded",{"mr-[20rpx]":t<3}])},{default:c((()=>[x(f(e),1)])),_:2},1032,["class"])):h("v-if",!0)],64)))),256)):(n(!0),m(_,{key:1},p(i(J).hotel_attribute,((e,t)=>(n(),m(_,null,[t<4?(n(),u(s,{key:0,class:D(["bg-[#F6F8F9] text-xs px-[10rpx] py-[4rpx] rounded",{"mr-[20rpx]":t<3}])},{default:c((()=>[x(f(e),1)])),_:2},1032,["class"])):h("v-if",!0)],64)))),256))])),_:1}),d(a,{class:"flex items-center",onClick:t[0]||(t[0]=e=>b(N)?N.value=!i(N):N=!i(N))},{default:c((()=>[d(a,{class:"text-xs flex items-baseline"},{default:c((()=>[x("详情"),d(s,{class:"nc-iconfont nc-icon-fengefuV6xx text-xs"}),x("设施")])),_:1}),d(s,{class:"nc-iconfont nc-icon-youV6xx text-[26rpx]"})])),_:1})])),_:1}),d(r,{show:i(N),mode:"bottom",round:10,onClose:t[2]||(t[2]=e=>b(N)?N.value=!1:N=!1)},{default:c((()=>[d(a,{class:"flex flex-col p-3 rounded-t-3xl"},{default:c((()=>[d(a,{class:"text-base font-bold flex justify-between items-center"},{default:c((()=>[d(s,null,{default:c((()=>[x(f(i(z)("hotelTab")),1)])),_:1}),d(s,{class:"nc-iconfont nc-icon-guanbiV6xx text-[#666]",onClick:t[1]||(t[1]=e=>b(N)?N.value=!1:N=!1)})])),_:1}),d(a,{class:"mt-2 flex flex-col"},{default:c((()=>[i(J).hotel_tag?(n(),u(a,{key:0},{default:c((()=>[d(a,{class:"flex flex-wrap"},{default:c((()=>[(n(!0),m(_,null,p(i(J).hotel_tag,((e,t)=>(n(),u(s,{class:D(["my-2 whitespace-nowrap text-xs px-[10rpx] py-[4rpx]",{"mr-[20rpx]":t<i(J).hotel_attribute.length-1}])},{default:c((()=>[x(f(e),1)])),_:2},1032,["class"])))),256))])),_:1})])),_:1})):h("v-if",!0),i(J).hotel_attribute?(n(),u(a,{key:1},{default:c((()=>[(n(!0),m(_,null,p(Object.values(i(J).hotel_attribute_array),((e,t)=>(n(),u(a,{class:"mt-2"},{default:c((()=>[d(a,{class:"text-sm font-bold"},{default:c((()=>[x(f(e.name),1)])),_:2},1024),d(a,{class:"flex flex-wrap"},{default:c((()=>[(n(!0),m(_,null,p(e.attr,((e,t)=>(n(),m(_,null,[e[1]?(n(),u(s,{key:0,class:"m-2 whitespace-nowrap bg-[#F6F8F9] text-xs px-[10rpx] py-[4rpx] rounded"},{default:c((()=>[x(f(e[0]),1)])),_:2},1024)):h("v-if",!0)],64)))),256))])),_:2},1024)])),_:2},1024)))),256))])),_:1})):h("v-if",!0)])),_:1})])),_:1})])),_:1},8,["show"]),d(a,{class:"flex items-center mt-3"},{default:c((()=>[d(a,{class:"flex-1 leading-tight text-[#19293F] text-[26rpx] font-bold"},{default:c((()=>[x(f(i(J).full_address),1)])),_:1}),d(a,{class:"flex ml-auto"},{default:c((()=>[d(a,{class:"flex flex-col items-center justify-center mr-[20rpx]",onClick:t[3]||(t[3]=e=>b(W)?W.value=!0:W=!0)},{default:c((()=>[d(s,{class:"nc-iconfont nc-icon-dizhiguanliV6xx bg-[#F1F1F1] w-[44rpx] h-[44rpx] rounded-full flex items-center justify-center"}),d(s,{class:"text-xs mt-1"},{default:c((()=>[x(f(i(z)("map")),1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center mr-[20rpx]",onClick:he},{default:c((()=>[d(s,{class:"nc-iconfont nc-icon-fenxiangV6xx text-[30rpx] bg-[#F1F1F1] w-[44rpx] h-[44rpx] rounded-full flex items-center justify-center"}),d(s,{class:"text-xs mt-1"},{default:c((()=>[x("分享")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),d(r,{show:i(W),onClose:t[4]||(t[4]=e=>b(W)?W.value=!1:W=!1),closeable:!0},{default:c((()=>[d(a,{class:"text-center py-[30rpx] font-bold leading-none"},{default:c((()=>[d(s,null,{default:c((()=>[x("地图")])),_:1})])),_:1}),d(a,null,{default:c((()=>[d(y,{class:"map-body w-full h-[600rpx]",latitude:i(J).latitude,longitude:i(J).longitude,markers:i(ne)},null,8,["latitude","longitude","markers"])])),_:1})])),_:1},8,["show"]),d(a,{class:"chunk-wrap pt-[34rpx] scheduling"},{default:c((()=>{var e;return[d(a,{class:"flex justify-between items-center",onClick:t[5]||(t[5]=e=>b(ee)?ee.value=!0:ee=!0)},{default:c((()=>[d(a,{class:"flex"},{default:c((()=>[d(a,{class:"flex items-center"},{default:c((()=>[d(s,{class:"font-bold text-[30rpx]"},{default:c((()=>[x(f(i(Z).start_time),1)])),_:1}),d(s,{class:"text-xs ml-1"},{default:c((()=>[x(f(i(z)("checkToday")),1)])),_:1})])),_:1}),d(a,{class:"flex items-center ml-[30rpx]"},{default:c((()=>[d(s,{class:"font-bold text-[30rpx]"},{default:c((()=>[x(f(i(Z).end_time),1)])),_:1}),d(s,{class:"text-xs ml-1"},{default:c((()=>[x(f(i(z)("checkTomorrow")),1)])),_:1})])),_:1})])),_:1}),d(a,{class:"text-sm flex items-center"},{default:c((()=>[d(s,{class:"text-color"},{default:c((()=>[x(f(i(z)("common"))+f(i(Z).day)+f(i(z)("lateness")),1)])),_:1}),d(s,{class:"nc-iconfont nc-icon-youV6xx text-[26rpx] text-[#666]"})])),_:1})])),_:1}),(null==(e=i(X))?void 0:e.length)?(n(),u(a,{key:0,class:"py-[20rpx]"},{default:c((()=>[(n(!0),m(_,null,p(i(X),((e,t)=>(n(),u(a,{class:"flex mb-[30rpx]",key:e.goods_id,onClick:e=>(e=>{ue.value=J.value.room_list[e],Q.value=!0})(t)},{default:c((()=>[d(I,{class:"w-[162rpx] h-[184rpx] mr-[20rpx] rounded-md",src:i(o)(e.cover_thumb_mid),mode:"aspectFill"},null,8,["src"]),d(a,{class:"flex flex-col flex-1 py-[4rpx] relative"},{default:c((()=>[d(a,{class:"text-sm font-bold truncate"},{default:c((()=>[x(f(e.goods_name),1)])),_:2},1024),d(a,{class:"text-xs text-[#626262] mt-[10rpx]"},{default:c((()=>[(n(!0),m(_,null,p(e.attr_name,((e,t)=>(n(),u(s,{class:"mr-[10rpx]"},{default:c((()=>[x(f(e),1)])),_:2},1024)))),256))])),_:2},1024),h(' <view class="text-color text-[26rpx] mt-[10rpx]">15分钟内可免费取消</view> '),d(a,{class:"flex items-center mt-auto text-[#F55246] text-base font-bold price-font"},{default:c((()=>[d(s,{class:"text-xs"},{default:c((()=>[x("￥")])),_:1}),x(" "+f(i(ve)(e))+" ",1),"member_price"==i(ge)(e)?(n(),u(I,{key:0,class:"h-[22rpx] ml-[6rpx] w-[55rpx]",src:i(o)("addon/tourism/VIP.png"),mode:"widthFix"},null,8,["src"])):h("v-if",!0)])),_:2},1024),e.stock?(n(),u(a,{key:0,class:"flex flex-col border-[2rpx] border-solid border-[#FC565F] border-md absolute right-0 bottom-[4rpx] rounded w-[90rpx]",onClick:g((t=>ce(e)),["stop"])},{default:c((()=>[d(s,{class:"bg-[#FC565F] font-bold text-white font-bold text-[34rpx] text-center py-[8rpx]"},{default:c((()=>[x(f(i(z)("rob")),1)])),_:1}),d(s,{class:"text-xs text-scale py-[2rpx] text-center text-[#FC565F]"},{default:c((()=>[x(f(i(z)("onlinePayment")),1)])),_:1})])),_:2},1032,["onClick"])):(n(),u(a,{key:1,class:"flex flex-col border-[2rpx] border-solid border-[#999] border-md absolute right-0 bottom-[4rpx] rounded w-[90rpx]",onClick:g((t=>ce(e,"empty")),["stop"])},{default:c((()=>[d(s,{class:"bg-[#999] font-bold text-white font-bold text-[34rpx] text-center py-[8rpx]"},{default:c((()=>[x(f(i(z)("rob")),1)])),_:1}),d(s,{class:"text-xs text-scale py-[2rpx] text-center text-[#999]"},{default:c((()=>[x(f(i(z)("onlinePayment")),1)])),_:1})])),_:2},1032,["onClick"]))])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):h("v-if",!0),h(" 酒店房型详情 "),Object.keys(i(ue)).length?(n(),u(r,{key:1,show:i(Q),mode:"bottom",round:10,onClose:t[9]||(t[9]=e=>b(Q)?Q.value=!1:Q=!1)},{default:c((()=>[d(a,{class:"h-[1000rpx] relative rounded-t-3xl bg-[#f8f8f8] overflow-hidden"},{default:c((()=>[d(a,{class:"text-base font-bold flex justify-between items-center h-[96rpx] px-[26rpx] bg-[#fff] absolute top-0 left-0 right-0 z-10"},{default:c((()=>[d(s,{class:"text-[30rpx]"},{default:c((()=>[x(f(i(ue).goods_name),1)])),_:1}),d(s,{class:"nc-iconfont nc-icon-guanbiV6xx text-[32rpx] text-[#666]",onClick:t[6]||(t[6]=e=>b(Q)?Q.value=!1:Q=!1)})])),_:1}),d(S,{"scroll-y":"true",class:"flex h-[1000rpx] flex-col bg-[#f8f8f8] !rounded-none"},{default:c((()=>[d(a,{class:"pt-[96rpx]"}),d(I,{src:i(o)(i(ue).cover_thumb_big),class:"w-[750rpx] h-[218]",mode:"aspectFill"},null,8,["src"]),d(a,{class:"px-4 bg-[#fff]"},{default:c((()=>[d(a,{class:"flex justify-between border-0 border-b-1 border-[#F2F2F2] border-solid px-1 py-4"},{default:c((()=>[d(a,{class:"flex flex-col items-center justify-center"},{default:c((()=>[d(s,{class:"nc-iconfont nc-icon-chuangV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:c((()=>[x(f(i(ue).room_bed||"双人床"),1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center"},{default:c((()=>[d(s,{class:"nc-iconfont nc-icon-loucengV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:c((()=>[x(f(i(ue).room_floor||"1层"),1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center"},{default:c((()=>[d(s,{class:"nc-iconfont nc-icon-fangziV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:c((()=>[x(f(i(ue).room_area||0)+"m²",1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center"},{default:c((()=>[d(s,{class:"nc-iconfont nc-icon-jiamengV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:c((()=>[x(f(i(ue).room_stay||"0人"),1)])),_:1})])),_:1}),d(a,{class:"flex flex-col items-center justify-center"},{default:c((()=>[d(s,{class:"nc-iconfont nc-icon-liebiaoV6xx text-[36rpx] text-[#555] mb-1"}),d(s,{class:"text-xs font-bold"},{default:c((()=>[x(f(i(ue).stock||"0间"),1)])),_:1})])),_:1})])),_:1}),i(ue).goods_attribute?(n(),u(a,{key:0,class:"flex items-baseline py-4"},{default:c((()=>[d(s,{class:"mr-3 text-sm"},{default:c((()=>[x("房间设施")])),_:1}),d(a,{class:"flex-1 flex flex-wrap"},{default:c((()=>[(n(!0),m(_,null,p(i(ue).goods_attribute.split(","),((e,t)=>{var l,a;return n(),u(s,{class:D(["mr-1 text-sm",{"class-select":t<(null==(a=null==(l=i(ue).goods_attribute)?void 0:l.split(","))?void 0:a.length)-1}])},{default:c((()=>[x(f(e),1)])),_:2},1032,["class"])})),256))])),_:1})])),_:1})):h("v-if",!0)])),_:1}),d(a,{class:"mt-2 px-3 bg-[#fff]"},{default:c((()=>[d(a,{class:"border-0 border-b-1 border-[#F2F2F2] border-solid py-3 text-[30rpx] font-bold"},{default:c((()=>[x(" 房型详情 ")])),_:1}),d(a,{class:"py-3 px-1"},{default:c((()=>[i(ue).goods_content?(n(),u(O,{key:0,content:i(ue).goods_content,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(n(),u(a,{key:1},{default:c((()=>[x("暂无房型详情")])),_:1}))])),_:1})])),_:1}),d(a,{class:"h-[136rpx]"})])),_:1}),d(a,{class:"flex justify-between items-center px-4 py-3 mt-2 bg-[#fff] absolute bottom-0 left-0 right-0 z-10"},{default:c((()=>[d(s,{class:"text-[var(--price-color)] price-font"},{default:c((()=>[x(" ￥"+f(i(ve)(i(ue)))+" ",1),"member_price"==i(ge)(i(ue))?(n(),u(I,{key:0,class:"h-[22rpx] ml-[6rpx] w-[55rpx]",src:i(o)("addon/tourism/VIP.png"),mode:"widthFix"},null,8,["src"])):h("v-if",!0)])),_:1}),i(ue).stock?(n(),u(E,{key:0,type:"primary",class:"w-[276rpx] h-[88rpx] rounded-3xl flex items-center justify-center text-base m-0 !bg-[var(--primary-color)]",onClick:t[7]||(t[7]=g((e=>ce(i(ue))),["stop"]))},{default:c((()=>[x("立即抢购")])),_:1})):(n(),u(E,{key:1,type:"primary",class:"w-[276rpx] h-[88rpx] rounded-3xl flex items-center justify-center text-base m-0 !bg-[#999]",onClick:t[8]||(t[8]=g((e=>ce(i(ue),"empty")),["stop"]))},{default:c((()=>[x("立即抢购")])),_:1}))])),_:1})])),_:1})])),_:1},8,["show"])):h("v-if",!0)]})),_:1}),d(a,{class:"chunk-wrap pt-[34rpx] pb-[24rpx] scheduling"},{default:c((()=>[d(a,{class:"text-center text-[34rpx] font-bold"},{default:c((()=>[x("-- 酒店介绍 --")])),_:1}),d(a,{class:"scheduling-content"},{default:c((()=>[i(J).hotel_desc?(n(),u(O,{key:0,content:i(J).hotel_desc,tagStyle:{img:"vertical-align: top;"}},null,8,["content"])):(n(),u(a,{key:1},{default:c((()=>[x("暂无酒店介绍")])),_:1}))])),_:1})])),_:1})])),_:1})),d(R,{"bg-color":"rgb(248,248,248)",loading:i(M),fontSize:"16",color:"#333"},null,8,["loading"]),i(te)?(n(),u($,{key:1,show:i(ee),mode:"range",onConfirm:oe,onClose:t[10]||(t[10]=e=>b(ee)?ee.value=!1:ee=!1),formatter:se,startText:i(z)("inHotel"),endText:i(z)("checkOut"),confirmDisabledText:i(z)("checkOutDate"),ref:"calendar",monthNum:"2"},null,8,["show","startText","endText","confirmDisabledText"])):h("v-if",!0),d(B,{ref_key:"sharePosterRef",ref:me,posterType:"tourism_hotel",posterId:i(J).poster_id,posterParam:i(_e),copyUrlParam:i(pe)},null,8,["posterId","posterParam","copyUrlParam"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-fe1cc8e7"]]);export{J as default};
