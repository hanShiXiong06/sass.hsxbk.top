import{d as e,j as a,r as t,p as l,o as s,c as r,w as o,O as n,b as i,n as c,u,y as p,z as d,P as m,a6 as x,f as _,a7 as f,a8 as v,a as g,D as y,i as b,B as h,g as k,h as j,a0 as w,Q as C,E as T,G as I}from"./index-9317da28.js";import{_ as O}from"./loading-page.vue_vue_type_script_setup_true_lang.c92b07c2.js";import{g as P,a as z,b as M,c as S}from"./sale.c5a7dd4d.js";import{M as E}from"./mescroll-body.c2f6fcce.js";import{M as B}from"./mescroll-empty.82e9c349.js";import{u as D}from"./useMescroll.26ccf5de.js";import{t as N}from"./topTabbar.9a918190.js";import{c as Q}from"./cloneDeep.fb425223.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-page.de89bca9.js";import"./u-loading-icon.aabe3d05.js";/* empty css                                                                       */import"./u-transition.65be38eb.js";import"./mescroll-i18n.f3c5a2b0.js";import"./isArrayLike.512b2e7f.js";const U=R(e({__name:"sale",setup(e){let R={};const{mescrollInit:U,downCallback:Y,getMescroll:A}=D(v,f),F=N();F.setTopTabbarParam({title:"销售奖励"});const G=a((()=>{let e={backgroundImage:"url("+T("addon/shop_fenxiao/sale/head_bg.png")+") ",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPositionY:"-170rpx"};return e})),L=a((()=>Object.keys(R).length?I(Number(R.height))+I(R.top)+I(8)+728+"rpx":"728rpx")),X=t(""),q=t(!0);l((async()=>{await P().then((e=>{X.value=e.data.is_open,0==X.value&&F.setTopTabbarParam({title:"销售奖励",topStatusBar:{textColor:"#333",bgColor:"#fff"}}),q.value=!1}))}));const H=t([{name:"全部",key:"all"},{name:"待发放",key:"0"},{name:"已发放",key:"1"}]),J=t("all"),K=t(0),V=t(!0),W=t(!0),Z=t([]),$=e=>{W.value=!0,z({page:e.num,limit:e.size,is_send:J.value}).then((a=>{let t=a.data.data;1==e.num&&(Z.value=[],"1"!=J.value&&ee(t)),Z.value=Z.value.concat(t),W.value=!1,e.endSuccess(t.length)})).catch((()=>{V.value=!1,W.value=!1,e.endErr()}))},ee=async e=>{V.value=!0;const a=await M();let t=e.map((e=>e.period_id));if(Object.keys(a.data).length&&(t.length&&-1==t.indexOf(a.data.id)||!t.length)){let e=Q(a.data);e.reward_money=e.total_reward_money,e.period_id=e.id,e.order_money=e.total_order_money,Z.value.unshift(e)}V.value=!1},ae=t({});S().then((e=>{ae.value=e.data}));const te=()=>{g({url:"/app/pages/member/commission"})};return(e,a)=>{const t=y,l=b,f=h,v=k(j("loading-page"),O);return s(),r(l,{class:"bg-[var(--page-bg-color)] min-h-[100vh]",style:c(e.themeColor())},{default:o((()=>[1!=X.value||q.value?_("v-if",!0):(s(),n(m,{key:0},[i(l,{class:"fixed w-full z-2 !bg-[var(--page-bg-color)]"},{default:o((()=>[i(l,{class:"w-full overflow-hidden",style:c(u(G))},{default:o((()=>[i(l,{class:"card-template sidebar-marign mt-[312rpx]"},{default:o((()=>[i(l,{class:"flex flex-col mb-[56rpx]",onClick:te},{default:o((()=>[i(t,{class:"text-[30rpx] h-[36rpx] leading-[36rpx] text-[#333] mb-[16rpx]"},{default:o((()=>[p("销售奖励（元）")])),_:1}),i(t,{class:"text-[48rpx] price-font text-[var(--price-text-color)] min-h-[58rpx]"},{default:o((()=>[p(d(u(w)(ae.value.sale_commission)||0),1)])),_:1})])),_:1}),i(l,{class:"flex item-center justify-between"},{default:o((()=>[i(l,{class:"flex flex-col w-[50%]"},{default:o((()=>[i(t,{class:"text-[28rpx] h-[34rpx] text-[var(--text-color-light6)] mb-[10rpx]"},{default:o((()=>[p("待发放（元）")])),_:1}),i(t,{class:"text-[36rpx] min-h-[46rpx] text-[#333] price-font"},{default:o((()=>[p(d(u(w)(ae.value.wait_sale_commission)||0),1)])),_:1})])),_:1}),i(l,{class:"flex flex-col w-[50%]"},{default:o((()=>[i(t,{class:"text-[28rpx] h-[34rpx] text-[var(--text-color-light6)] mb-[10rpx]"},{default:o((()=>[p("已发放（元）")])),_:1}),i(t,{class:"text-[36rpx] min-h-[46rpx] text-[#333] price-font"},{default:o((()=>[p(d(u(w)(ae.value.sale_commission_send)||0),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),i(l,{class:"tab-style-1 mt-[40rpx]"},{default:o((()=>[i(l,{class:"tab-left"},{default:o((()=>[(s(!0),n(m,null,x(H.value,((e,a)=>(s(),r(l,{class:C(["tab-left-item",{"class-select":J.value===e.key}]),onClick:t=>((e,a)=>{J.value=e,K.value=a,Z.value=[],A().resetUpScroll()})(e.key,a)},{default:o((()=>[p(d(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1}),i(E,{ref:"mescrollRef",down:{use:!1},onInit:u(U),onUp:$,top:u(L)},{default:o((()=>[!Z.value.length||W.value||V.value?_("v-if",!0):(s(!0),n(m,{key:0},x(Z.value,((e,a)=>(s(),r(l,{keys:a,class:"flex justify-between items-center card-template mt-[var(--top-m)] sidebar-marign",onClick:a=>{return t=e.period_id,void g({url:"/addon/shop_fenxiao/pages/sale_detail",param:{id:t}});var t}},{default:o((()=>[i(l,{class:"flex flex-col"},{default:o((()=>[e.is_settlement?(s(),r(l,{key:0,class:"text-[#333] text-[28rpx] flex items-center"},{default:o((()=>[i(t,{class:"text-[28rpx] mr-[6rpx]"},{default:o((()=>[p("结算时间")])),_:1}),i(t,null,{default:o((()=>[p(d(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)):(s(),r(l,{key:1,class:"text-[#333] text-[28rpx] flex items-center"},{default:o((()=>[i(t,{class:"text-[28rpx] mr-[6rpx]"},{default:o((()=>[p("预计结算时间")])),_:1}),i(t,null,{default:o((()=>[p(d(e.sale_end_time),1)])),_:2},1024)])),_:2},1024)),i(l,{class:"mt-[16rpx] h-[34rpx] flex items-center text-[24rpx] text-[var(--text-color-light6)]"},{default:o((()=>[p(" 销售金额："+d(e.order_money),1)])),_:2},1024)])),_:2},1024),i(l,{class:C(["text-[28rpx] text-[var(--text-color-light6)]",{"text-[#333]":e.is_send,"text-[var(--primary-color)]":!e.is_send}])},{default:o((()=>[p(d(e.is_send?"已发放":"待发放"),1)])),_:2},1032,["class"])])),_:2},1032,["keys","onClick"])))),256)),Z.value.length||W.value||V.value?_("v-if",!0):(s(),r(B,{key:1,option:{icon:u(T)("addon/shop_fenxiao/sale/empty.png"),tip:"暂无销售奖励记录",btnText:"去逛逛"},onEmptyclick:a[0]||(a[0]=e=>u(g)({url:"/addon/shop_fenxiao/pages/goods"}))},null,8,["option"]))])),_:1},8,["onInit","top"])],64)),0!=X.value||q.value?_("v-if",!0):(s(),r(l,{key:1,class:"h-[100vh] w-[100vw] overflow-hidden"},{default:o((()=>[i(l,{class:"empty-page"},{default:o((()=>[i(f,{class:"img",src:u(T)("static/resource/images/system/empty.png"),mode:"aspectFit"},null,8,["src"]),i(l,{class:"desc"},{default:o((()=>[p("销售奖励设置未开启")])),_:1})])),_:1})])),_:1})),i(v,{loading:q.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-923cac5b"]]);export{U as default};
