import{d as e,l as t,j as s,r as o,x as l,Z as a,F as r,o as d,c as u,w as i,u as c,b as p,y as n,z as x,O as f,a6 as m,P as _,f as g,Q as v,n as b,H as h,t as k,a as y,B as j,i as w,C as S,D as F,g as C,h as E,a5 as V,E as z,A as I,s as P,ag as A}from"./index-2882a2d8.js";import{_ as B}from"./u--image.d52c0594.js";import{_ as D}from"./u-number-box.86ecacda.js";import{_ as L}from"./u-swipe-action-item.0ac4441e.js";import{_ as O}from"./u-swipe-action.4803e6c2.js";import{_ as U}from"./loading-page.vue_vue_type_script_setup_true_lang.cb99ee23.js";import{_ as Z}from"./tabbar.f422f3d5.js";import{u as $,g as q}from"./cart.3c40bcc5.js";import{b as H}from"./bind-mobile.7168b221.js";import{_ as M}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-image.46ebbbc1.js";import"./u-icon.1104ad2f.js";import"./u-transition.4448d2e5.js";import"./u-loading-page.8280c7ab.js";import"./u-loading-icon.a37f7e61.js";/* empty css                                                                       */import"./u-badge.e8ba7dff.js";import"./u-tabbar.b113c065.js";import"./u-safe-bottom.f13b01b8.js";import"./u-form-item.03ed7ff5.js";import"./u-line.d7ff94e2.js";/* empty css                                                               */import"./u-form.54744837.js";import"./sms-code.vue_vue_type_script_setup_true_lang.c0821f07.js";/* empty css                                                               */import"./u-input.6410b5d0.js";/* empty css                                                                */import"./u-modal.c146ecea.js";import"./u-popup.2abbe959.js";import"./u-overlay.1a317a4e.js";/* empty css                                                                */import"./u-checkbox-group.5e46c6da.js";/* empty css                                                                         *//* empty css                                                                    */const Q=M(e({__name:"cart",setup(e){const M=t(),Q=s((()=>M.info)),R=o(!0),G=o(!1),J=o("0.00"),K=o([]),N=o([]),T=o(!1),W=o(!0),X=$(),Y=()=>{q({}).then((({data:e})=>{K.value=[],N.value=[],R.value=!1,e.forEach((e=>{e.checked=!1,e.goodsSku&&(e.goods.status&&0==e.goods.delete_time&&e.goodsSku.stock?(e.num>e.goodsSku.stock&&(e.num=e.goodsSku.stock),K.value.push(e)):N.value.push(e))})),ae(),W.value&&(W.value=!1)})).catch((e=>{401==e.code&&(K.value=[],N.value=[],R.value=!1)}))};l((()=>{Y(),X.getList()}));const ee=s((()=>{let e=0;return K.value.forEach((t=>{t.checked&&(e+=1)})),e}));a((()=>K.value),(()=>{let e=0;K.value.forEach((t=>{if(t.checked&&t.goodsSku){let s=0;s=t.goods.is_discount&&t.goodsSku.sale_price!=t.goodsSku.price?t.goodsSku.sale_price:t.goods.member_discount&&P()&&t.goodsSku.member_price!=t.goodsSku.price?t.goodsSku.member_price:t.goodsSku.price,e+=parseFloat(s)*t.num}})),J.value=e.toFixed(2)}),{deep:!0});const te=()=>{h().setLoginBack({url:"/addon/shop/pages/goods/cart"})},se=e=>({min:1,max:e.goodsSku.stock||1}),oe=o([{text:r("delete"),style:{backgroundColor:"#EF000C"}}]),le=o(),ae=()=>{const e=K.value.length!=ee.value;K.value.forEach((t=>{t.checked=e}))},re=o(null);o(uni.getStorageSync("isbindmobile"));const de=()=>{if(uni.getStorageSync("isbindmobile"))return re.value.open(),!1;if(!ee.value)return void k({title:"还没有选择商品",icon:"none"});const e=[];K.value.forEach((t=>{t.checked&&e.push(t.id)})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){y({url:"/addon/shop/pages/order/payment"})}})},ue=()=>{if(!ee.value)return void k({title:"还没有选择商品",icon:"none"});if(G.value)return;G.value=!0;const e=[];K.value.forEach((t=>{t.checked&&e.push(t.id)})),X.delete(e,(()=>{Y(),G.value=!1}))},ie=()=>{if(G.value)return;G.value=!0;const e=N.value.map((e=>e.id));X.delete(e,(()=>{Y(),G.value=!1})),N.value=[]},ce=e=>{let t="";return t=e.goods.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.goods.member_discount&&P()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},pe=e=>{let t="0.00";return t=e.goods.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.goods.member_discount&&P()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const s=j,o=w,l=S,a=F,r=C(E("u--image"),B),h=C(E("u-number-box"),D),k=C(E("u-swipe-action-item"),L),P=C(E("u-swipe-action"),O),$=V,q=C(E("loading-page"),U),M=C(E("tabbar"),Z);return d(),u(o,{style:b(e.themeColor())},{default:i((()=>[R.value?g("v-if",!0):(d(),u(o,{key:0,class:"bg-page h-screen overflow-hidden flex flex-col"},{default:i((()=>[c(Q)?K.value.length||N.value.length?(d(),u(o,{key:2,class:"flex-1 h-0"},{default:i((()=>[p($,{class:"scroll-height box-border","scroll-y":!0},{default:i((()=>[p(o,{class:"py-[var(--top-m)] sidebar-marign"},{default:i((()=>[K.value.length?(d(),u(o,{key:0,class:"bg-[#fff] pb-[10rpx] box-border rounded-[var(--rounded-big)]"},{default:i((()=>[p(o,{class:"flex mx-[var(--rounded-big)] pt-[var(--pad-top-m)] justify-between items-center box-border font-400 text-[24rpx] mb-[24rpx] leading-[30rpx]"},{default:i((()=>[p(o,{class:"flex items-baseline text-[24rpx] text-[#333]"},{default:i((()=>[p(a,null,{default:i((()=>[n("共")])),_:1}),p(a,{class:"text-[32rpx] mx-[2rpx] text-[var(--price-text-color)]"},{default:i((()=>[n(x(K.value.length),1)])),_:1}),p(a,null,{default:i((()=>[n("件商品")])),_:1})])),_:1}),p(a,{onClick:t[1]||(t[1]=e=>T.value=!T.value),class:"text-[var(--text-color-light6)] text-[24rpx]"},{default:i((()=>[n(x(T.value?"完成":"管理"),1)])),_:1})])),_:1}),p(P,{ref_key:"swipeActive",ref:le},{default:i((()=>[(d(!0),f(_,null,m(K.value,((e,t)=>(d(),f(_,null,[e.goodsSku?(d(),u(o,{key:0,class:"py-[20rpx] overflow-hidden w-full"},{default:i((()=>[p(k,{options:oe.value,onClick:s=>((e,t)=>{G.value||(G.value=!0,X.delete(t.id,(()=>{K.value.splice(e,1),A((()=>{le.value&&le.value.closeOther()})),G.value=!1})))})(t,e)},{default:i((()=>[p(o,{class:"flex px-[var(--pad-sidebar-m)]",onClick:I((t=>e.checked=!e.checked),["stop"])},{default:i((()=>[p(o,{class:"self-center w-[58rpx] h-[60rpx] flex items-center"},{default:i((()=>[p(a,{class:v(["iconfont text-color text-[34rpx] w-[34rpx] h-[34rpx] rounded-[17rpx] overflow-hidden shrink-0",{iconxuanze1:e.checked,"bg-[#F5F5F5]":!e.checked}])},null,8,["class"])])),_:2},1024),p(r,{radius:"var(--goods-rounded-big)",width:"200rpx",height:"200rpx",onClick:t=>{y({url:"/addon/shop/pages/goods/detail",param:{goods_id:e.goods_id}})},src:c(z)(e.goodsSku.sku_image_thumb_mid||""),model:"aspectFill"},{error:i((()=>[p(s,{class:"w-[200rpx] h-[200rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:c(z)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["onClick","src"]),p(o,{class:"flex flex-1 flex-wrap ml-[20rpx]"},{default:i((()=>[p(o,{class:"w-[100%] flex flex-col items-baseline"},{default:i((()=>[p(o,{class:"text-[#333] text-[28rpx] max-h-[80rpx] leading-[40rpx] multi-hidden font-400"},{default:i((()=>[n(x(e.goods.goods_name),1)])),_:2},1024),e.goodsSku&&e.goodsSku.sku_spec_format?(d(),u(o,{key:0,class:"box-border max-w-[376rpx] mt-[10rpx] px-[14rpx] h-[36rpx] leading-[36rpx] truncate text-[var(--text-color-light6)] bg-[#F5F5F5] text-[22rpx] rounded-[20rpx]"},{default:i((()=>[n(x(e.goodsSku.sku_spec_format),1)])),_:2},1024)):g("v-if",!0)])),_:2},1024),p(o,{class:"flex justify-between items-end self-end w-[100%]"},{default:i((()=>[p(o,{class:"flex items-end text-[var(--price-text-color)] leading-[40rpx] price-font"},{default:i((()=>[p(o,{class:"text-[var(--price-text-color)] price-font"},{default:i((()=>[p(a,{class:"text-[24rpx] font-500"},{default:i((()=>[n("￥")])),_:1}),p(a,{class:"text-[40rpx] font-500"},{default:i((()=>[n(x(parseFloat(pe(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),p(a,{class:"text-[24rpx] font-500"},{default:i((()=>[n("."+x(parseFloat(pe(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==ce(e)?(d(),u(s,{key:0,class:"h-[24rpx] ml-[6rpx]",src:c(z)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):g("v-if",!0),"discount_price"==ce(e)?(d(),u(s,{key:1,class:"h-[24rpx] ml-[6rpx]",src:c(z)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):g("v-if",!0)])),_:2},1024)])),_:2},1024),p(h,{modelValue:e.num,"onUpdate:modelValue":t=>e.num=t,min:se(e).min,max:se(e).max,integer:"",step:1,"input-width":"68rpx","input-height":"52rpx","button-size":"52rpx",disabledInput:"",onChange:e=>((e,t)=>{uni.$u.debounce((e=>{const s=K.value[t];X.increase({id:s.id,goods_id:s.goods_id,sku_id:s.sku_id,stock:s.goodsSku.stock,sale_price:s.goodsSku.sale_price,num:s.num},0)}),500)})(0,t)},{minus:i((()=>[p(a,{class:v([{"text-[var(--text-color-light9)]":e.num===se(e).min,"text-[#303133]":e.num!==se(e).min},"text-[24rpx] font-500 nc-iconfont nc-icon-jianV6xx"])},null,8,["class"])])),input:i((()=>[p(a,{class:"px-[6rpx] box-border overflow-hidden text-[#303133] text-[24rpx] mx-[10rpx] w-[72rpx] h-[44rpx] bg-[var(--temp-bg)] leading-[44rpx] text-center rounded-[6rpx]"},{default:i((()=>[n(x(e.num),1)])),_:2},1024)])),plus:i((()=>[p(a,{class:v([{"text-[var(--text-color-light9)]":e.num===se(e).max," text-[#303133]":e.num!==se(e).max},"text-[24rpx] font-500 nc-iconfont nc-icon-jiahaoV6xx"])},null,8,["class"])])),_:2},1032,["modelValue","onUpdate:modelValue","min","max","onChange"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1032,["options","onClick"])])),_:2},1024)):g("v-if",!0)],64)))),256))])),_:1},512)])),_:1})):g("v-if",!0),N.value.length?(d(),u(o,{key:1,class:"bg-[#fff] pb-[10rpx] box-border rounded-[var(--rounded-big)] mt-[var(--top-m)]"},{default:i((()=>[p(o,{class:"flex mx-[var(--pad-sidebar-m)] pt-[var(--pad-top-m)] justify-between items-center box-border font-400 text-[#303133] text-[24rpx] mb-[24rpx] leading-[30rpx]"},{default:i((()=>[p(o,{class:"flex items-center text-[24rpx] text-[#333]"},{default:i((()=>[p(a,null,{default:i((()=>[n("共")])),_:1}),p(a,{class:"text-[28rpx] text-[var(--price-text-color)]"},{default:i((()=>[n(x(N.value.length),1)])),_:1}),p(a,null,{default:i((()=>[n("件失效商品")])),_:1})])),_:1}),p(a,{class:"text-[var(--text-color-light6)] text-[24rpx]",onClick:ie},{default:i((()=>[n("清空")])),_:1})])),_:1}),(d(!0),f(_,null,m(N.value,((e,t)=>(d(),u(o,{class:"py-[20rpx] overflow-hidden"},{default:i((()=>[p(o,{class:"flex px-[var(--pad-sidebar-m)]"},{default:i((()=>[p(a,{class:"self-center iconfont iconxuanze1 text-[34rpx] mr-[32rpx] text-[#F5F5F5] rounded-[50%] overflow-hidden shrink-0"}),p(o,{class:"relative w-[200rpx] h-[200rpx] rounded-[var(--goods-rounded-big)] overflow-hidden"},{default:i((()=>[p(r,{radius:"var(--goods-rounded-big)",width:"200rpx",height:"200rpx",src:c(z)(e.goodsSku.sku_image_thumb_mid),model:"aspectFill"},{error:i((()=>[p(s,{class:"w-[200rpx] h-[200rpx] rounded-[var(--goods-rounded-big)] overflow-hidden",src:c(z)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),0==e.goodsSku.stock?(d(),u(o,{key:0,class:"absolute left-0 top-0 w-[200rpx] h-[200rpx] leading-[200rpx] text-center",style:{"background-color":"rgba(0,0,0,0.3)"}},{default:i((()=>[p(a,{class:"text-[#fff] text-[28rpx]"},{default:i((()=>[n("已售罄")])),_:1})])),_:1})):g("v-if",!0),0!=e.goodsSku.stock?(d(),u(o,{key:1,class:"absolute left-0 top-0 w-[200rpx] h-[200rpx] leading-[200rpx] text-center",style:{"background-color":"rgba(0,0,0,0.3)"}},{default:i((()=>[p(a,{class:"text-[#fff] text-[28rpx]"},{default:i((()=>[n("已失效")])),_:1})])),_:1})):g("v-if",!0)])),_:2},1024),p(o,{class:"flex flex-1 flex-wrap ml-[20rpx]"},{default:i((()=>[p(o,{class:"w-[100%] flex flex-col items-baseline"},{default:i((()=>[p(o,{class:"text-[#333] text-[28rpx] max-h-[80rpx] leading-[40rpx] font-400 multi-hidden"},{default:i((()=>[n(x(e.goods.goods_name),1)])),_:2},1024),e.goodsSku&&e.goodsSku.sku_spec_format?(d(),u(o,{key:0,class:"box-border max-w-[376rpx] mt-[10rpx] px-[14rpx] h-[36rpx] leading-[36rpx] truncate text-[var(--text-color-light6)] bg-[#F5F5F5] text-[22rpx] rounded-[20rpx]"},{default:i((()=>[n(x(e.goodsSku.sku_spec_format),1)])),_:2},1024)):g("v-if",!0)])),_:2},1024),p(o,{class:"flex justify-between items-end self-end w-[100%]"},{default:i((()=>[p(o,{class:"flex items-end text-[var(--price-text-color)] leading-[40rpx] price-font"},{default:i((()=>[p(o,{class:"text-[var(--price-text-color)] price-font"},{default:i((()=>[p(a,{class:"text-[24rpx] font-500"},{default:i((()=>[n("￥")])),_:1}),p(a,{class:"text-[36rpx] font-500"},{default:i((()=>[n(x(parseFloat(pe(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),p(a,{class:"text-[24rpx] font-500"},{default:i((()=>[n("."+x(parseFloat(pe(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==ce(e)?(d(),u(s,{key:0,class:"h-[24rpx] ml-[6rpx]",src:c(z)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):g("v-if",!0),"discount_price"==ce(e)?(d(),u(s,{key:1,class:"h-[24rpx] ml-[6rpx]",src:c(z)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):g("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),256))])),_:1})):g("v-if",!0)])),_:1})])),_:1})])),_:1})):(d(),u(o,{key:1,class:"empty-page"},{default:i((()=>[p(s,{class:"img",src:c(z)("addon/shop/cart-empty.png"),model:"aspectFit"},null,8,["src"]),p(o,{class:"desc"},{default:i((()=>[n("赶紧去逛逛, 购买心仪的商品吧")])),_:1}),p(l,{shape:"circle",plain:"true",class:"btn",onClick:t[0]||(t[0]=e=>c(y)({url:"/addon/shop/pages/goods/list"}))},{default:i((()=>[n("去逛逛")])),_:1})])),_:1})):(d(),u(o,{key:0,class:"empty-page"},{default:i((()=>[p(s,{class:"img",src:c(z)("static/resource/images/system/login.png"),model:"aspectFit"},null,8,["src"]),p(o,{class:"desc"},{default:i((()=>[n("暂未登录")])),_:1}),p(l,{shape:"circle",plain:"true",class:"btn",onClick:te},{default:i((()=>[n("去登录")])),_:1})])),_:1}))])),_:1})),K.value.length?(d(),u(o,{key:1,class:"flex h-[96rpx] items-center bg-[#fff] fixed left-0 right-0 bottom-[50px] pl-[30rpx] pr-[20rpx] box-solid mb-ios justify-between"},{default:i((()=>[p(o,{class:"flex items-center",onClick:ae},{default:i((()=>[p(a,{class:v(["self-center iconfont text-color text-[34rpx] mr-[10rpx] w-[34rpx] h-[34rpx] rounded-[17rpx] overflow-hidden shrink-0",K.value.length==c(ee)?"iconxuanze1":"bg-[#F5F5F5]"])},null,8,["class"]),p(a,{class:"font-400 text-[#303133] text-[26rpx]"},{default:i((()=>[n("全选")])),_:1})])),_:1}),p(o,{class:"flex items-center"},{default:i((()=>[T.value?(d(),u(o,{key:1,class:"flex-1 flex items-center justify-end"},{default:i((()=>[p(l,{class:"w-[188rpx] h-[70rpx] font-500 text-[26rpx] leading-[70rpx] !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",onClick:ue},{default:i((()=>[n("删除")])),_:1})])),_:1})):(d(),u(o,{key:0,class:"flex-1 flex items-center justify-between"},{default:i((()=>[p(o,{class:"flex items-center mr-[20rpx] text-[var(--price-text-color)] leading-[45rpx]"},{default:i((()=>[p(o,{class:"font-400 text-[#303133] text-[28rpx]"},{default:i((()=>[n("合计：")])),_:1}),p(a,{class:"text-[var(--price-text-color)] price-font text-[32rpx] font-bold"},{default:i((()=>[n(" ￥"+x(parseFloat(J.value)),1)])),_:1})])),_:1}),p(l,{class:"w-[188rpx] h-[70rpx] font-500 text-[26rpx] leading-[70rpx] !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",onClick:de},{default:i((()=>[n("结算")])),_:1})])),_:1}))])),_:1})])),_:1})):g("v-if",!0),p(q,{loading:R.value},null,8,["loading"]),p(M),g(" 强制绑定手机号 "),p(H,{ref_key:"bindMobileRef",ref:re},null,512)])),_:1},8,["style"])}}}),[["__scopeId","data-v-fbdf2968"]]);export{Q as default};
