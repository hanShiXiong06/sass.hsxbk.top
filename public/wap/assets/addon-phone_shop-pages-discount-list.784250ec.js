import{bG as e,d as t,j as a,r as l,o as s,c as o,w as r,b as n,u as i,f as c,n as u,U as d,ad as p,V as x,W as f,y as v,ae as _,af as g,E as h,bL as m,bD as b,s as y,H as k,ci as w,g as F,h as j,B as C,i as z,ac as E,C as G,z as S,a as T,G as I,t as M,b_ as U,D as L,bl as O,a$ as B,b8 as D,_ as N}from"./index-71c7df08.js";import{M as P}from"./mescroll-body.49de0f6f.js";import{M as R}from"./mescroll-empty.95b8c17e.js";import{u as $}from"./useMescroll.26ccf5de.js";import{t as H}from"./topTabbar.cb42d19f.js";import"./mescroll-i18n.00218d15.js";/* empty css                                                                       */const Q=N(t({__name:"list",setup(t){let N={};const Q=a((()=>Object.keys(N).length?I(Number(N.height))+I(N.top)+I(8)+368+"rpx":"490rpx")),{mescrollInit:V,downCallback:W,getMescroll:q}=$(g,_),A=l([]),J=l([]),K=l(0),X=l(""),Y=l([]),Z=l(!0),ee=l(!0);H().setTopTabbarParam({title:"限时折扣"});const te=l([]);ee.value=!0,e.get("phone_shop/discount/config").then((e=>{A.value=e.data,te.value=A.value.map((e=>h(e.imageUrl))),ee.value=!1})).catch((()=>{ee.value=!1}));var ae;(ae={limit:4},e.get("phone_shop/discount",ae)).then((e=>{J.value=e.data,ne(),J.value&&J.value.length?le(e.data[0]):Z.value=!1}));const le=e=>{var t;K.value=e.active_id,X.value=e.active_status_name,null==(t=q())||t.resetUpScroll(),m({scrollTop:0,duration:1})},se=t=>{if(0==J.value.length)return;Z.value=!0,function(t){return e.get("phone_shop/discount/goods",t)}({page:t.num,limit:t.size,active_id:K.value}).then((e=>{let a=e.data.data.map((e=>e));1==t.num&&(Y.value=[]),Y.value=Y.value.concat(a),t.endSuccess(a.length),Z.value=!1})).catch((()=>{Z.value=!1,t.endErr()}))},oe=e=>{let t=A.value[e].toLink;if(Object.keys(t).length){if(!t.name)return;if("app/pages/member/index"==b()&&!y())return void k().setLoginBack({url:t.url});w(t)}},re=l(""),ne=()=>{re.value=J.value.length?590:520,re.value=re.value+"rpx"};return(e,t)=>{const a=F(j("u-swiper"),U),l=C,_=z,g=L,m=E,b=F(j("u--image"),O),y=F(j("u-empty"),B),k=G,w=F(j("u-loading-page"),D);return s(),o(_,{class:"discount bg-[#f6f6f6] min-h-[100vh]",style:u(e.themeColor())},{default:r((()=>[n(_,{class:"fixed top-0 left-0 w-full z-10 text-[0]"},{default:r((()=>[A.value.length?(s(),o(a,{key:0,list:te.value,indicator:A.value.length,indicatorStyle:{bottom:"46rpx"},autoplay:!0,height:i(Q),onClick:oe},null,8,["list","indicator","height"])):c("v-if",!0),ee.value||A.value.length?c("v-if",!0):(s(),o(l,{key:1,src:i(h)("addon/phone_shop/discount/discount_banner.png"),mode:"scaleToFill",class:"w-full",style:u({height:i(Q)}),"show-menu-by-longpress":!0},null,8,["src","style"])),J.value.length?(s(),o(_,{key:2,class:"relative w-full h-[110rpx] mt-[-40rpx] z-5"},{default:r((()=>[n(_,{class:"bg-[#f24f3d] w-[750rpx] rounded-tl-[24rpx] rounded-tr-[24rpx] h-[96rpx] absolute left-0 bottom-0"}),n(m,{"scroll-x":!0,class:"h-[110rpx] absolute left-0 bottom-0 z-5"},{default:r((()=>[n(_,{class:"flex items-end h-[100%]",style:u({width:187.5*J.value.length+"rpx"})},{default:r((()=>[(s(!0),d(x,null,p(J.value,((e,t)=>(s(),o(_,{class:"w-[187.5rpx] h-[96rpx] relative flex-shrink-0",onClick:t=>le(e)},{default:r((()=>[n(_,{class:"w-full absolute left-0 top-0 z-10 text-[#fff] text-center pt-[10rpx]"},{default:r((()=>[n(_,{class:f(["text-[28rpx] leading-[39rpx] font-500 px-[10rpx] h-[39rpx] overflow-hidden",{"!text-[#333]":K.value==e.active_id}])},{default:r((()=>[v(S(e.active_desc),1)])),_:2},1032,["class"]),n(_,{class:"flex justify-center w-full"},{default:r((()=>[n(g,{class:f(["text-[22rpx] leading-[34rpx] font-400 mt-[5rpx]",{"active flex items-center justify-center":K.value==e.active_id}])},{default:r((()=>[v(S("not_active"==e.active_status?"预告":e.active_status_name),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),K.value==e.active_id?(s(),d(x,{key:0},[J.value.length<4?(s(),o(l,{key:0,class:f(["absolute bottom-0 z-5 h-[110rpx] z-5",{"left-0 w-[230rpx]":0==t,"left-[-41.25rpx] w-[270rpx]":0!=t}]),src:i(h)(0==t?"addon/phone_shop/discount/nav-left.png":"addon/phone_shop/discount/nav-center.png")},null,8,["class","src"])):c("v-if",!0),J.value.length>=4?(s(),o(l,{key:1,class:f(["absolute bottom-0 z-5 h-[110rpx] z-5",{"left-0 w-[230rpx]":0==t,"left-[-41.25rpx] w-[270rpx]":0!=t&&t!=J.value.length-1,"right-0 w-[230rpx]":t==J.value.length-1}]),src:i(h)(0==t?"addon/phone_shop/discount/nav-left.png":t==J.value.length-1?"addon/phone_shop/discount/nav-right.png":"addon/phone_shop/discount/nav-center.png")},null,8,["class","src"])):c("v-if",!0)],64)):c("v-if",!0)])),_:2},1032,["onClick"])))),256))])),_:1},8,["style"])])),_:1})])),_:1})):c("v-if",!0)])),_:1}),J.value.length?(s(),o(P,{key:0,ref:"mescrollRef",top:re.value,onInit:i(V),down:{use:!1},onUp:se},{default:r((()=>[n(_,{class:"sidebar-marign bg-[#F4F6F8]"},{default:r((()=>[(s(!0),d(x,null,p(Y.value,((e,t)=>(s(),o(_,{key:t,class:f(["bg-[#fff] p-[20rpx] flex rounded-[16rpx]",{"mb-[20rpx]":t<Y.value.length-1,"mb-[30rpx]":t==Y.value.length-1}]),onClick:t=>(e=>{"active"==e.activeGoods.active_goods_status?T({url:"/addon/phone_shop/pages/goods/detail",param:{sku_id:e.goodsSku.sku_id}}):M({title:`活动${e.activeGoods.active_goods_status_name}`,icon:"none"})})(e)},{default:r((()=>[n(_,{class:"w-[240rpx] h-[240rpx]"},{default:r((()=>[n(b,{width:"240rpx",height:"240rpx",radius:"16rpx",src:i(h)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:r((()=>[n(l,{class:"rounded-[16rpx] overflow-hidden w-[240rpx] h-[240rpx]",src:i(h)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"])])),_:2},1024),n(_,{class:"ml-[20rpx] flex-1 flex flex-col justify-between"},{default:r((()=>[n(_,null,{default:r((()=>[n(_,{class:"text-[28rpx] font-500 leading-[39rpx] multi-hidden"},{default:r((()=>[v(S(e.goods_name),1)])),_:2},1024),e.goods_label_name&&e.goods_label_name.length?(s(),o(_,{key:0,class:"mt-[10rpx] text-[#999999] text-[24rpx] font-400 multi-hidden"},{default:r((()=>[v(S(e.goods_label_name.map((e=>e.label_name)).join(" | ")),1)])),_:2},1024)):c("v-if",!0)])),_:2},1024),n(_,{class:"w-full h-[80rpx] bg-[#FFECEC] flex justify-between rounded-[40rpx]"},{default:r((()=>[n(_,{class:"mr-[20rpx] pl-[20rpx] flex-1 flex flex-col justify-center"},{default:r((()=>[n(_,{class:"text-[#EF000C] flex items-baseline"},{default:r((()=>[n(g,{class:"text-[20rpx] leading-[26rpx] font-400 price-font"},{default:r((()=>[v("￥")])),_:1}),n(g,{class:"text-[32rpx] leading-[40rpx] font-500 price-font"},{default:r((()=>[v(S(parseFloat(e.goodsSku.active_discount_price).toFixed(2).split(".")[0])+".",1)])),_:2},1024),n(g,{class:"text-[22rpx] leading-[28rpx] font-500 price-font"},{default:r((()=>[v(S(parseFloat(e.goodsSku.active_discount_price).toFixed(2).split(".")[1]),1)])),_:2},1024),e.goodsSku.active_discount_rate<10?(s(),o(_,{key:0,class:"px-[4rpx] border-[1rpx] border-[#EF000C] border-solid text-[18rpx] ml-[6rpx] rounded-[4rpx] leading-[24rpx] transform translate-y-[-4rpx]"},{default:r((()=>[v(S(e.goodsSku.active_discount_rate)+"折",1)])),_:2},1024)):c("v-if",!0)])),_:2},1024),n(_,{class:"flex items-center mt-[2rpx]"},{default:r((()=>[n(_,{class:f(["w-[20rpx] h-[20rpx] mr-[4rpx] rounded-[12.5rpx] text-[#fff] bg-[#EF000C] flex items-center justify-center",{"!bg-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[n(g,{class:"text-[10rpx] iconzhekou iconfont"})])),_:2},1032,["class"]),n(_,{class:f(["text-[18rpx] font-400 text-[#EF000C] leading-[24rpx]",{"!text-[#FF8540]":"active"!=e.activeGoods.active_goods_status}])},{default:r((()=>[v(" 已省"+S(e.goodsSku.active_reduce_money)+"元",1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),n(_,{class:f(["active-button w-[106rpx] h-[78rpx] box-border pl-[25rpx] leading-[78rpx] text-[#fff]",{"!w-[116rpx]":"active"!=e.activeGoods.active_goods_status}]),style:u({"background-image":"url("+i(h)("active"!=e.activeGoods.active_goods_status?"addon/phone_shop/discount/no-active.png":"addon/phone_shop/discount/active.png")+")"})},{default:r((()=>["active"!=e.activeGoods.active_goods_status?(s(),o(g,{key:0,class:"text-[26rpx] font-500"},{default:r((()=>[v(S(e.activeGoods.active_goods_status_name),1)])),_:2},1024)):(s(),o(_,{key:1,class:"h-full flex items-center justify-between"},{default:r((()=>[n(g,{class:"text-[40rpx]"},{default:r((()=>[v("抢")])),_:1}),n(g,{class:"text-[20rpx] iconxiayibu iconfont mr-[16rpx]"})])),_:1}))])),_:2},1032,["class","style"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),Y.value.length||Z.value?c("v-if",!0):(s(),o(_,{key:0,class:f(["flex justify-center w-[100%] items-center",{"h-[calc(100vh-620rpx)]":J.value.length,"h-[calc(100vh-550rpx)]":!J.value.length}])},{default:r((()=>[n(R,{option:{tip:"暂无商品，请看看其他商品吧！"}})])),_:1},8,["class"]))])),_:1})])),_:1},8,["top","onInit"])):c("v-if",!0),J.value.length||Z.value?c("v-if",!0):(s(),o(_,{key:1,class:"flex flex-col justify-center items-center h-[calc(100vh-550rpx)] fixed left-[30rpx] right-[30rpx]",style:u({top:re.value})},{default:r((()=>[n(y,{text:"暂无活动，请看看其他商品吧！",width:"347rpx",height:"265rpx",icon:i(h)("static/resource/images/system/empty.png")},null,8,["icon"]),n(k,{shape:"circle",plain:"true",class:"w-[220rpx] mt-[42rpx] text-[28rpx] h-[66rpx] leading-[62rpx] !text-[#EF000C] !border-[#EF000C] border-[2rpx] rounded-full",onClick:t[0]||(t[0]=e=>i(T)({url:"/addon/phone_shop/pages/goods/list"}))},{default:r((()=>[v("去逛逛")])),_:1})])),_:1},8,["style"])),n(w,{"bg-color":"rgb(248,248,248)",loading:Z.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-fba9dc8e"]]);export{Q as default};
