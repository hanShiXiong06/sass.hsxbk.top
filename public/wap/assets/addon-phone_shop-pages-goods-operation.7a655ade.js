import{d as e,r as t,x as a,s as l,t as s,Z as r,$ as o,a as n,o as u,c,w as p,b as x,u as i,f as d,e as f,v as m,y as _,W as g,U as v,ad as h,V as b,n as y,q as k,bU as w,i as C,B as S,D as j,ab as V,g as F,h as z,E as I,z as E,b8 as U,bX as Z,aA as A,_ as D}from"./index-71c7df08.js";import{g as X}from"./verify.39d2411f.js";import{b as q,o as B}from"./goods.7a0dade1.js";const G=D(e({__name:"operation",setup(e){const D=t("manualInput"),G=t(!1),H=t([]);D.value="manualInput";const L=t(!1),O=t(""),Q=t(!0);a((()=>{l()&&R()}));const R=()=>{X().then((e=>{e.data?Q.value=!1:(s({title:"非操作员无此权限",icon:"none"}),setTimeout((()=>{r().length>1?o({delta:1}):n({url:"/app/pages/member/index",mode:"reLaunch"})}),1e3))}))},T=()=>{k()&&(w.init(),w.scanQRCode((e=>{if(e.resultStr){let t=e.resultStr;q({sku_no:t,status:"all"}).then((e=>{H.value=e.data.data,G.value=!0,W=!1}))}})))};let W=!1;const $=()=>/[\S]+/.test(O.value)?!W&&(W=!0,void q({sku_no:O.value,status:"all"}).then((e=>{console.log(e),H.value=e.data.data,G.value=!0,W=!1}))):(s({title:"请输入核销码",icon:"none"}),!1),J=()=>{L.value=!L.value},K=()=>{G.value=!1},M=()=>{G.value=!0},N=e=>{B(e).then((e=>{console.log(e),1==e.code&&s({title:"操作成功",icon:"none"}),G.value=!1}))},P=e=>{"sweepCode"!=e||k()?D.value=e:s({title:"H5端不支持扫码核销",icon:"none"})},Y=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&l()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,parseFloat(t)};return(e,t)=>{const a=C,l=S,s=j,r=V,o=F(z("u-loading-page"),U),k=F(z("up-button"),Z),w=F(z("up-popup"),A);return u(),c(a,{style:y(e.themeColor())},{default:p((()=>[Q.value?d("v-if",!0):(u(),c(a,{key:0,class:"w-[100vw] min-h-[100vh] bg-[#f8f8f8]"},{default:p((()=>[x(a,{class:"w-full bg-[#fff] verify-box h-[760rpx]"},{default:p((()=>[x(a,{class:"text-[var(--primary-color)] fixed top-[40rpx] right-[30rpx] flex items-center",onClick:t[0]||(t[0]=e=>i(n)({url:"/app/pages/verify/record"}))},{default:p((()=>[d(' <image class="w-[26rpx] h-[28rpx]" :src="img(\'static/resource/images/verify/history.png\')" /> '),d(' <text class="text-[26rpx] ml-[10rpx]">核销记录</text> ')])),_:1}),f(x(a,{class:"flex flex-col items-center justify-center"},{default:p((()=>[x(a,{class:"sweep-code flex items-center justify-center",onClick:T},{default:p((()=>[x(l,{class:"w-[354rpx] h-[354rpx]",src:i(I)("static/resource/images/verify/saoma.png")},null,8,["src"])])),_:1}),x(a,{class:"mt-[40rpx] text-[32rpx]"},{default:p((()=>[_("点击扫描二维码")])),_:1}),x(a,{class:"mt-[20rpx] text-[#8288A2] text-[26rpx] font-400 pb-[142rpx]"},{default:p((()=>[_("扫描二维码进行查找设备")])),_:1})])),_:1},512),[[m,"sweepCode"==D.value]]),f(x(a,null,{default:p((()=>[x(a,{class:"flex pt-[126rpx] items-center justify-center"},{default:p((()=>[x(a,{class:"flex justify-center items-center flex-col pr-[30rpx] w-[130rpx]"},{default:p((()=>[x(l,{class:"w-[100rpx] h-[100rpx]",src:i(I)("static/resource/images/verify/shuruhexiaoma.png")},null,8,["src"]),x(a,{class:"text-[26rpx] h-[36rpx] leading-[36rpx] mt-[12rpx]"},{default:p((()=>[_("操作设备")])),_:1})])),_:1}),x(l,{class:"w-[74rpx] h-[12rpx] mb-[50rpx]",src:i(I)("static/resource/images/verify/youjiantou.png")},null,8,["src"]),x(a,{class:"flex justify-center items-center flex-col pl-[30rpx] w-[130rpx]"},{default:p((()=>[x(l,{class:"w-[100rpx] h-[100rpx]",src:i(I)("static/resource/images/verify/hexiao1.png")},null,8,["src"]),x(a,{class:"text-[26rpx] h-[36rpx] leading-[36rpx] mt-[12rpx]"},{default:p((()=>[_("上/下架")])),_:1})])),_:1})])),_:1}),x(a,{class:"mt-[50rpx]"},{default:p((()=>[x(a,{class:"h-[90rpx] border-[2rpx] border-solid border-[#DCE0EF] rounded-[16rpx] box-border p-[20rpx] mx-[60rpx] flex items-center"},{default:p((()=>[x(s,{class:"nc-iconfont nc-icon-saotiaoxingmaV6xx text-[44rpx] text-[#EF000C]"}),x(r,{type:"text",placeholder:"请输入设备sn号",class:"h-[90rpx] border-none text-start ml-[30rpx] text-[28rpx] flex-1","placeholder-class":"_placeholder",modelValue:O.value,"onUpdate:modelValue":t[1]||(t[1]=e=>O.value=e),focus:L.value,ref:"input"},null,8,["modelValue","focus"])])),_:1}),x(a,{class:"h-[88rpx] min-w-[630rpx] text-[#fff] flex items-center justify-center !text-[32rpx] save-btn rounded-[50rpx] h-[88rpx] mx-[60rpx] mt-[146rpx] relative z-1",onClick:$},{default:p((()=>[_("确认")])),_:1})])),_:1})])),_:1},512),[[m,"manualInput"==D.value]])])),_:1}),x(a,{class:"w-[630rpx] h-[100rpx] bg-[#fff] mx-[auto] mt-[220rpx] rounded-[90rpx] flex relative action-type-wrap"},{default:p((()=>[x(a,{class:g(["relative w-[51%] pr-[50rpx] box-border rounded-[50rpx] z-0 flex flex-col items-center justify-center",{xuanZhong1:"sweepCode"==D.value}]),onClick:t[2]||(t[2]=e=>P("sweepCode"))},{default:p((()=>[x(s,{class:"nc-iconfont nc-icon-saoyisaoV6xx !text-[40rpx]"}),x(a,{class:"text-[24rpx] leading-[1] mt-[10rpx]"},{default:p((()=>[_("扫码操作")])),_:1})])),_:1},8,["class"]),x(a,{class:"flex flex-col items-center flex-col w-[120rpx] h-[120rpx] bg-[#FF7354] rounded-[50%] absolute top-[-10rpx] left-[255rpx] heXiao text-white z-10 shrink-0"},{default:p((()=>[x(a,{class:"nc-iconfont nc-icon-saotiaoxingmaV6xx ns-gradient-otherpages-member-balance-balance-rechange !text-[44rpx] mt-[19rpx]"}),x(a,{class:"text-[24rpx] mt-[8rpx] leading-[34rpx] h-[34rpx]"},{default:p((()=>[_("操作台")])),_:1})])),_:1}),x(a,{class:g(["relative w-[51%] pl-[50rpx] box-border rounded-[50rpx] z-0 flex flex-col items-center justify-center",{xuanZhong:"manualInput"==D.value}]),onClick:t[3]||(t[3]=e=>P("manualInput"))},{default:p((()=>[x(s,{class:"iconfont iconVector-77 !text-[40rpx]"}),x(a,{class:"ml-[20rpx] text-[24rpx] leading-[1] mt-[10rpx]",onClick:J},{default:p((()=>[_("手动输入")])),_:1})])),_:1},8,["class"])])),_:1})])),_:1})),x(o,{loading:Q.value,"loading-text":"",loadingColor:"var(--primary-color)",iconSize:"35"},null,8,["loading"]),x(w,{round:10,show:G.value,"onUpdate:show":t[4]||(t[4]=e=>G.value=e),mode:"center",onClose:K,onOpen:M},{default:p((()=>[x(a,{class:"up-popup-wrap"},{default:p((()=>[(u(!0),v(b,null,h(H.value,(e=>(u(),c(a,{class:"p-2 flex justify-between m-2"},{default:p((()=>[x(a,null,{default:p((()=>[x(a,null,{default:p((()=>[_(E(e.goods_name),1)])),_:2},1024),x(a,null,{default:p((()=>[_(E(e.sub_title),1)])),_:2},1024),x(a,null,{default:p((()=>[_(" sn:"+E(e.goodsSku.sku_no),1)])),_:2},1024),x(a,null,{default:p((()=>[_("入库时间:"+E(e.create_time),1)])),_:2},1024)])),_:2},1024),x(a,null,{default:p((()=>[x(a,null,{default:p((()=>[x(s,{class:"text-[26rpx] font-500"},{default:p((()=>[_("￥")])),_:1}),x(s,{class:"text-[36rpx] font-500"},{default:p((()=>[_(E(Y(e).toFixed(2).split(".")[0]),1)])),_:2},1024),x(s,{class:"text-[24rpx] font-500"},{default:p((()=>[_("."+E(Y(e).toFixed(2).split(".")[1]),1)])),_:2},1024)])),_:2},1024),x(a,null,{default:p((()=>[e.status?(u(),c(k,{key:0,type:"error",onClick:t=>N(e.goods_id),text:"下架"},null,8,["onClick"])):(u(),c(k,{key:1,type:"success",onClick:t=>N(e.goods_id),text:"上架"},null,8,["onClick"]))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])),_:1},8,["show"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-eaf39082"]]);export{G as default};
