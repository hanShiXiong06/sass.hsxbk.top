import{_ as e}from"./u-input.b98e66b2.js";import{d as o,r as a,o as t,E as s,b as r,w as l,u as n,G as i,F as c,c as p,f as u,a5 as d,a6 as m,U as f,g as _,h,i as g,x as j,y as b,V as y,a as v,N as w}from"./index-e6ce9fbf.js";import{_ as x}from"./tabbar.2cc8e58f.js";import{_ as k}from"./pay.16fd6339.js";import{g as C,a as S}from"./cps.7acda8ab.js";import{M as E}from"./mescroll-body.dc3de07c.js";import{M as I}from"./mescroll-empty.b423055b.js";import{u as M}from"./useMescroll.26ccf5de.js";import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.c5d9cd81.js";import"./u-badge.7d0ca9d8.js";import"./u-tabbar.2615c204.js";import"./u-safe-bottom.1ba5bfba.js";import"./u-image.c9386d77.js";import"./u-transition.6919b33f.js";import"./u-button.7a41d301.js";import"./u-loading-icon.39fd4711.js";import"./u-popup.b16d6e1d.js";import"./pay.f23cf994.js";import"./mescroll-uni-option.2f7b06f4.js";import"./mescroll-i18n.6025c811.js";/* empty css                                                                       */const V=U(o({__name:"act",setup(o){const{mescrollInit:U,downCallback:V,getMescroll:D}=M(m,d),{setShare:O,onShareAppMessage:R,onShareTimeline:F}=f();let G=a([]),z=a(!1);O(),R(),F(),a([]);const A=a(""),H=e=>{if(-1===e.url.indexOf("style=embedded"))-1!=e.url.indexOf("http")||-1!=e.url.indexOf("http")?window.location.href=e.url:v({url:e.url});else{let o=function(e){const o={},a=e.split("&");for(const t of a){const[e,a]=t.split("=");o[e]=decodeURIComponent(a)}return o};const a=e.url.split("?")[1];if(a){const e=o(a),t=e.type,s=e.act_id;S({type:t,act_id:s}).then((e=>{""!=e.data.h5&&(window.location.href=e.data.h5),""!=e.data.wap_url&&(window.location.href=e.data.wap_url)})).catch((e=>{console.error("获取CPS信息失败",e)}))}else console.error("链接中没有查询参数")}},L=e=>{z.value=!1;let o={page:e.num,limit:e.size,act_name:A.value};C(o).then((o=>{let a=o.data.data;1==e.num&&(G.value=[]),G.value=G.value.concat(a),e.endSuccess(a.length),z.value=!0})).catch((()=>{z.value=!0,e.endErr()}))};return(o,a)=>{const d=_(h("u-input"),e),m=g,f=w,v=_(h("tabbar"),x),C=_(h("pay"),k);return t(),s(i,null,[r(m,{class:"bg-[#f8f8f8] min-h-screen overflow-hidden"},{default:l((()=>[r(m,{class:"tk-card fl items-center"},{default:l((()=>[r(d,{clearable:"",modelValue:A.value,"onUpdate:modelValue":a[0]||(a[0]=e=>A.value=e),placeholder:"如美团|饿了么|点餐|滴滴等",onChange:a[1]||(a[1]=e=>{D().resetUpScroll()})},null,8,["modelValue"])])),_:1}),r(E,{ref:"mescrollRef",top:"0",onInit:n(U),onDown:n(V),onUp:L},{default:l((()=>[(t(!0),s(i,null,c(n(G),((e,a)=>(t(),p(m,{class:"tk-card",onClick:o=>(e=>{const o="/addon/tk_cps/pages/index?type="+e.type+"&act_id="+e.act_id+"&style=embedded";H({url:o})})(e)},{default:l((()=>[r(f,{style:{width:"100%",height:"120px","background-color":"#eeeeee","border-radius":"8px"},mode:e.mode,src:e.img,onError:o.imageError},null,8,["mode","src","onError"]),r(m,{class:"font-bold"},{default:l((()=>[j(b(e.act_name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),256)),!n(G).length&&n(z)?(t(),p(I,{key:0,option:{icon:n(y)("static/resource/images/empty.png")}},null,8,["option"])):u("v-if",!0)])),_:1},8,["onInit","onDown"])])),_:1}),r(v,{addon:"tk_cps"}),r(C,{ref:"payRef",onClose:a[2]||(a[2]=e=>o.payLoading=!1)},null,512)],64)}}}),[["__scopeId","data-v-e4a1adcd"]]);export{V as default};
