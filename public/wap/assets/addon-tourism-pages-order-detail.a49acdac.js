import{d as e,r as t,j as l,o as r,c as a,w as s,u as o,b as n,aN as d,x as i,y as u,f,H as c,E as x,G as _,F as m,n as p,a as y,C as b,g as h,h as v,i as g,N as k,V as w,bv as j,c8 as A}from"./index-905183d4.js";import{_ as C}from"./u-count-down.eabeb208.js";import{_ as B}from"./u-form.7ae4e9da.js";import{_ as E}from"./u--form.8d42ab01.js";import{_ as F}from"./u-button.d3798ecb.js";import{_ as D}from"./pay.2560ca84.js";import{_ as S,a as z}from"./u-steps.454f3fcd.js";import{_ as H}from"./u-popup.e3f6594b.js";import{_ as W}from"./u-loading-page.7aa0a449.js";import{C as I,D as V,E as M,F as N,A as O,B as q}from"./tourism.31e9949d.js";import{_ as G}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.86a2aad0.js";import"./u-line.9e44f7cf.js";import"./u-loading-icon.c376267d.js";import"./u-image.44c969ef.js";import"./u-transition.dbaca185.js";import"./pay.01186f9d.js";import"./u-text.86301043.js";import"./u-safe-bottom.e94b03c1.js";const K=G(e({__name:"detail",setup(e){let G=t({}),K=t(!0),L=t(""),P=t(""),R=t(1),T=t(!1),$=t(0);l((e=>{P.value=e.order_id,J(P.value)}));const J=e=>{K.value=!0,I(e).then((e=>{if(G.value=e.data,R.value=G.value.order_log.length?G.value.order_log.length-1:0,L.value=e.data.order_type,e.data.refund_id&&Y(e.data.refund_id),0==G.value.order_status_info.status){const e=(new Date).getTime()/1e3;$.value=1e3*(G.value.auto_close_time-e);let t=setInterval((()=>{$.value<=0&&clearInterval(t)}),1e3)}K.value=!1})).catch((()=>{K.value=!1}))};let Q=t(!1),U=t({}),X=t(1);const Y=e=>{V(e).then((e=>{U.value=e.data,X.value=e.data.refund_log.length?e.data.refund_log.length-1:0}))},Z=t(null),ee=(e,t="")=>{var l;"pay"==t?null==(l=Z.value)||l.open(e.order_type,e.order_id,`/addon/tourism/pages/order/detail?order_id=${e.order_id}`):"cancel"==t?(e=>{O(e).then((e=>{J(P.value)})).catch((()=>{J(P.value)}))})(e):"delete"==t?(e=>{q(e.order_id).then((e=>{y({url:"/addon/tourism/pages/order/list"})})).catch((()=>{J(P.value)}))})(e):"buy"==t?"scenic"==e.order_type?y({url:"/addon/tourism/pages/scenic/list"}):"way"==e.order_type?y({url:"/addon/tourism/pages/way/list"}):"hotel"==e.order_type&&y({url:"/addon/tourism/pages/hotel/list"}):"index"==t&&y({url:"/addon/tourism/pages/index",mode:"reLaunch"})},te=(e,t)=>{let l,r;-1!=e.indexOf("/")?l=e.split("/"):-1!=e.indexOf("-")&&(l=e.split("-"));const a=new Date(e).getDay(),s=["周日","周一","周二","周三","周四","周五","周六"];return r="yearMonthDay"==t?l[0]+"年"+l[1]+"月"+l[2]+"日":"yearMonthDayWeek"==t?l[0]+"年"+l[1]+"月"+l[2]+"日 "+s[a]:"monthDayWeek"==t?l[1]+"月"+l[2]+"日 "+s[a]:l[1]+"月"+l[2]+"日",r};return(e,t)=>{const l=b,y=h(v("u-count-down"),C),I=g,V=k,O=h(v("u-form-item"),B),q=h(v("u--form"),E),Y=h(v("u-button"),F),le=h(v("pay"),D),re=h(v("u-steps-item"),S),ae=h(v("u-steps"),z),se=h(v("u-popup"),H),oe=h(v("u-loading-page"),W);return r(),a(I,{style:p(e.themeColor())},{default:s((()=>[o(K)?f("v-if",!0):(r(),a(I,{key:0,class:"bg-[#f8f8f8] min-h-screen overflow-hidden"},{default:s((()=>[n(I,{class:"bg-linear h-[480rpx] text-white px-4 pt-5"},{default:s((()=>{var e;return[n(I,{class:"text-[42rpx] flex items-baseline",onClick:t[0]||(t[0]=e=>d(T)?T.value=!0:T=!0)},{default:s((()=>[n(l,{class:"nc-iconfont nc-icon-shijianV6xx text-[42rpx] mr-1"}),n(l,{class:"font-bold"},{default:s((()=>{var e,t;return[i("订单"+u(null==(t=null==(e=o(G))?void 0:e.order_status_info)?void 0:t.name),1)]})),_:1}),o($)>0&&0==o(G).order_status_info.status?(r(),a(I,{key:0,class:"text-xs flex items-center ml-[20rpx]"},{default:s((()=>[n(l,null,{default:s((()=>[i("剩余支付时间：")])),_:1}),n(y,{time:o($),format:"HH:mm:ss"},null,8,["time"])])),_:1})):f("v-if",!0)])),_:1}),0==(null==(e=o(G))?void 0:e.order_status_info.status)?(r(),a(I,{key:0,class:"text-xs mt-3"},{default:s((()=>{var e,t;return[i("您的订单"+u(null==(t=null==(e=o(G))?void 0:e.order_status_info)?void 0:t.name)+"，欢迎再次预订！",1)]})),_:1})):(r(),a(I,{key:1,class:"text-xs mt-3"},{default:s((()=>{var e,t;return[i("您的订单"+u(null==(t=null==(e=o(G))?void 0:e.order_status_info)?void 0:t.name)+"，欢迎再次预订！",1)]})),_:1}))]})),_:1}),n(I,{class:"bg-white mx-3 py-4 px-3 rounded-md -mt-[340rpx] box-border"},{default:s((()=>[n(I,{class:c(["flex",{"pb-4 border-0 border-b-1 border-dashed border-[#EAEAEA] mb-4":["1","10"].includes(o(G).order_status)}])},{default:s((()=>[n(V,{class:"w-[124rpx] h-[124rpx] mr-2 rounded",src:o(w)(o(G).goods_image)},null,8,["src"]),n(I,{class:"flex-1 flex flex-col"},{default:s((()=>[n(I,{class:"text-[#1A2336] text-[30rpx] truncate font-bold w-[514rpx]"},{default:s((()=>[i(u(o(G)[o(L)][o(L)+"_name"])+"【"+u(o(G).goods_name)+"】",1)])),_:1}),n(I,{class:"flex items-center text-[#7F7F85] text-xs mt-[12rpx]"},{default:s((()=>[n(l,{class:"mr-1"},{default:s((()=>[i(u(te(o(G).start_time,"yearMonthDayWeek")),1)])),_:1}),f(' <text class="mr-1">周日</text> '),n(l,null,{default:s((()=>[i("当日有效")])),_:1})])),_:1}),n(I,{class:"font-bold text-sm text-[#222] mt-auto price-font"},{default:s((()=>[i("￥"+u(o(G).order_money),1)])),_:1})])),_:1})])),_:1},8,["class"]),["1","10"].includes(o(G).order_status)?(r(),x(_,{key:0},[n(I,{class:"bg-[#F9FBFF] rounded-lg overflow-hidden mb-4"},{default:s((()=>["hotel"==o(L)?(r(),a(I,{key:0,class:"bg-[#EEF3FF] flex items-center text-sm py-3 justify-center triangle"},{default:s((()=>[i(" 请提醒商家 "),n(l,{class:"text-[#EA4B69]"},{default:s((()=>[i("【扫码核销】")])),_:1}),i(" 使用 ")])),_:1})):(r(),a(I,{key:1,class:"bg-[#EEF3FF] flex items-center text-sm py-3 justify-center triangle"},{default:s((()=>[i(" 凭 "),n(l,{class:"text-[#EA4B69]"},{default:s((()=>[i("【身份证】")])),_:1}),i(" 或 "),n(l,{class:"text-[#EA4B69]"},{default:s((()=>[i("【手机号】")])),_:1}),i(" 可直接入园 ")])),_:1})),n(I,{class:"flex flex-col items-center pb-4"},{default:s((()=>[n(V,{class:"w-[326rpx] h-[326rpx] mt-4 mb-4",src:o(G).verify_code_qrcode},null,8,["src"]),n(V,{class:"w-[524rpx] h-[128rpx] mb-3",src:o(G).verify_code_barcode},null,8,["src"]),n(I,{class:"text-[#666] text-xs"},{default:s((()=>[i("未消费前请不要将券码提供给商家")])),_:1})])),_:1})])),_:1}),n(I,null,{default:s((()=>[n(I,{class:"flex items-center justify-between"},{default:s((()=>[n(I,{class:"flex items-center"},{default:s((()=>[n(l,{class:"text-sm"},{default:s((()=>[i(u("hotel"==o(L)?"券码":"入园码")+" "+u(o(G).verify_code),1)])),_:1}),n(l,{class:"nc-iconfont nc-icon-fuzhiV6xx text-[32rpx] ml-2 text-[#636363]",onClick:t[1]||(t[1]=e=>o(j)(o(G).verify_code))})])),_:1}),n(l,{class:"text-[#696969] text-[26rpx]"},{default:s((()=>[i(u(o(G).order_status_info.name),1)])),_:1})])),_:1})])),_:1})],64)):f("v-if",!0)])),_:1}),n(I,{class:"mt-3 bg-white mx-3 px-3 py-4 rounded-md"},{default:s((()=>[n(I,{class:"text-[#1A2336] text-[30rpx] font-bold mb-4"},{default:s((()=>[i("订单信息")])),_:1}),"hotel"==o(L)?(r(),a(I,{key:0,class:"border-0 border-b-1 border-solid border-[#EAEAEA] mb-1 pb-4"},{default:s((()=>[n(I,{class:"flex items-center"},{default:s((()=>[n(I,{class:"flex flex-col items-center"},{default:s((()=>[n(l,{class:"text-[26rpx] text-[#1A2336]"},{default:s((()=>[i(u(te(o(G).start_time,"monthDayWeek")),1)])),_:1}),n(l,{class:"text-xs text-[#888] mt-1"},{default:s((()=>[i("14:00后入住")])),_:1})])),_:1}),n(I,{class:"ml-4 mr-4 relative w-[136rpx] text-center"},{default:s((()=>[n(l,{class:"text-white relative z-10 text-xs font-scale bg-[#1C283E] px-2 py-1 rounded-xl w-[90rpx] box-border break-keep"},{default:s((()=>[i("共"+u(o(G).days)+"晚",1)])),_:1}),n(l,{class:"iconfont iconzhixiang absolute left-0 right-0 text-[90rpx] top-[50%] translate-y text-[#ABABAB]"})])),_:1}),n(I,{class:"flex flex-col items-center"},{default:s((()=>[n(l,{class:"text-[26rpx] text-[#1A2336]"},{default:s((()=>[i(u(te(o(G).end_time,"monthDayWeek")),1)])),_:1}),n(l,{class:"text-xs text-[#888] mt-1"},{default:s((()=>[i("12:00前离店")])),_:1})])),_:1})])),_:1}),n(I,{class:"mt-4 text-[#1A2336] text-[26rpx] font-bold"},{default:s((()=>[i(u(o(G).hotel.hotel_name)+"（"+u(o(G).goods_name)+"） ",1)])),_:1}),n(I,{class:"mt-1 text-[#1A2336] text-[26rpx] font-bold flex items-center"},{default:s((()=>[n(l,{class:"nc-iconfont nc-icon-fengefuV6xx text-[32rpx]"}),n(l,null,{default:s((()=>[i("共"+u(o(G).num)+"间",1)])),_:1})])),_:1}),f(' <view class="mt-3 text-[#1A2336] text-[26rpx] font-bold">\r\n                        无早餐\r\n                    </view> ')])),_:1})):f("v-if",!0),n(q,{labelPosition:"left",ref:"form1",labelWidth:"90",labelStyle:{color:"#A3A3A3",fontSize:"14px"}},{default:s((()=>["hotel"==o(G).order_type?(r(!0),x(_,{key:0},m(o(G).buyer_info,((e,t)=>(r(),x(_,null,[e.name?(r(),a(O,{key:0,label:"联系人姓名",prop:"userInfo.name",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(e.name),1)])),_:2},1024)])),_:2},1024)):f("v-if",!0),e.id_card?(r(),a(O,{key:1,label:"身份证号",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(e.id_card),1)])),_:2},1024)])),_:2},1024)):f("v-if",!0)],64)))),256)):(r(),x(_,{key:1},[o(G).buyer_info.name?(r(),a(O,{key:0,label:"联系人姓名",prop:"userInfo.name",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(o(G).buyer_info.name),1)])),_:1})])),_:1})):f("v-if",!0),o(G).buyer_info.id_card?(r(),a(O,{key:1,label:"身份证号",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(o(G).buyer_info.id_card),1)])),_:1})])),_:1})):f("v-if",!0)],64)),o(G).mobile?(r(),a(O,{key:2,label:"联系电话",borderBottom:""},{default:s((()=>[n(I,{class:"border-style"},{default:s((()=>[i(u(o(G).mobile),1)])),_:1})])),_:1})):f("v-if",!0),o(G).order_no?(r(),a(O,{key:3,label:"订单编号",borderBottom:""},{default:s((()=>[n(I,{class:"border-style w-full !border-0 flex justify-between items-end"},{default:s((()=>[n(l,null,{default:s((()=>[i(u(o(G).order_no),1)])),_:1}),n(l,{class:"text-xs text-[#7D7C82]",onClick:t[2]||(t[2]=e=>o(j)(o(G).order_no))},{default:s((()=>[i("复制")])),_:1})])),_:1})])),_:1})):f("v-if",!0),o(G).create_time?(r(),a(O,{key:4,label:"下单时间",borderBottom:""},{default:s((()=>[n(I,{class:"border-style !border-0"},{default:s((()=>[i(u(o(G).create_time),1)])),_:1})])),_:1})):f("v-if",!0),o(G).pay_time?(r(),a(O,{key:5,label:"支付时间",borderBottom:""},{default:s((()=>[n(I,{class:"border-style !border-0"},{default:s((()=>[i(u(o(G).pay_time),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1},512)])),_:1}),n(I,{class:"h-[160rpx] w-full"}),n(I,{class:"flex justify-end items-center bg-white px-3 py-1 fixed left-0 right-0 bottom-0 z-10"},{default:s((()=>[n(I,{class:"flex flex-col items-center justify-center mr-auto",onClick:t[3]||(t[3]=e=>ee(o(G),"index"))},{default:s((()=>[n(l,{class:"nc-iconfont nc-icon-shouye-xiaolianV6xx text-[46rpx] text-[#333]"}),n(l,{class:"text-xs mt-[2rpx] font-scale"},{default:s((()=>[i("首页")])),_:1})])),_:1}),n(I,{class:"flex flex-wrap justify-end"},{default:s((()=>[(r(!0),x(_,null,m(o(G).order_status_info.member_action,((e,t)=>(r(),a(Y,{text:e.name,color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},type:"primary",onClick:t=>ee(o(G),e.key)},null,8,["text","onClick"])))),256)),o(G).is_enable_refund&&["","refund_refuse"].includes(o(G).refund_status)?(r(),a(Y,{key:0,text:"申请退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[4]||(t[4]=e=>(e=>{let t={order_id:e.order_id};M(t).then((e=>{J(P.value)}))})(o(G)))})):f("v-if",!0),o(G).refund_no?(r(),a(Y,{key:1,text:"查看退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[5]||(t[5]=e=>d(Q)?Q.value=!0:Q=!0)})):f("v-if",!0),o(G).refund_no&&"wait_refund"==o(G).refund_status?(r(),a(Y,{key:2,text:"取消退款",type:"primary",color:"var(--primary-color)",shape:"circle",customStyle:{lineHeight:"70rpx",margin:"16rpx 0rpx 16rpx 24rpx",color:"#fff",width:"200rpx",height:"70rpx",fontSize:"26rpx"},onClick:t[6]||(t[6]=e=>{return t=o(G),void N(t.refund_id).then((e=>{J(P.value)}));var t})})):f("v-if",!0)])),_:1})])),_:1}),n(le,{ref_key:"payRef",ref:Z,onClose:e.payClose},null,8,["onClose"]),n(se,{show:o(T),onClose:t[7]||(t[7]=e=>d(T)?T.value=!1:T=!1),closeable:!0},{default:s((()=>[n(I,{class:"text-center py-[30rpx] font-bold leading-none"},{default:s((()=>[n(l,null,{default:s((()=>[i("订单进度")])),_:1})])),_:1}),n(I,{class:"px-6 pb-5 pt-2"},{default:s((()=>[n(ae,{current:o(R),direction:"column"},{default:s((()=>[(r(!0),x(_,null,m(o(G).order_log,((e,t)=>(r(),a(re,{title:e.action,desc:e.action_time,key:t},null,8,["title","desc"])))),128))])),_:1},8,["current"])])),_:1})])),_:1},8,["show"]),n(se,{show:o(Q),onClose:t[8]||(t[8]=e=>d(Q)?Q.value=!1:Q=!1),closeable:!0},{default:s((()=>[o(U).refund_log?(r(),a(I,{key:0,class:"text-center py-[30rpx] font-bold leading-none"},{default:s((()=>[n(l,null,{default:s((()=>[i("退款进度")])),_:1})])),_:1})):f("v-if",!0),n(I,{class:"px-6 pb-5 pt-2"},{default:s((()=>[n(ae,{current:o(X),direction:"column"},{default:s((()=>[(r(!0),x(_,null,m(o(U).refund_log,((e,t)=>(r(),a(re,{title:e.action_name,desc:e.action_time,key:t},A({_:2},["refuse"==e.action?{name:"desc",fn:s((()=>[n(I,{class:"text-xs text-red"},{default:s((()=>[i("拒绝原因："+u(o(U).refuse_reason),1)])),_:1}),n(I,{class:"text-xs text-[#909193]"},{default:s((()=>[i(u(e.action_time),1)])),_:2},1024)])),key:"0"}:void 0,"completed"==e.action?{name:"desc",fn:s((()=>[n(I,{class:"text-xs text-red"},{default:s((()=>[i("退款方式：原路退款，退款金额："+u(o(U).money),1)])),_:1}),n(I,{class:"text-xs text-[#909193]"},{default:s((()=>[i(u(e.action_time),1)])),_:2},1024)])),key:"1"}:void 0]),1032,["title","desc"])))),128))])),_:1},8,["current"])])),_:1})])),_:1},8,["show"])])),_:1})),n(oe,{"bg-color":"rgb(248,248,248)",loading:o(K),fontSize:"16",color:"#333"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-fba7fd89"]]);export{K as default};
