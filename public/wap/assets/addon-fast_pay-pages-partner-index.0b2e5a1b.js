import{d as a,r as e,p as t,o,P as s,b as n,n as l,w as r,y as d,Q as i,t as u,F as p,q as _,bw as c,a as m,i as y,g as v,h as f}from"./index-7bf68536.js";import{_ as h}from"./u-loading-icon.b37701e7.js";import{_ as g}from"./u-popup.be4bfacd.js";import{g as j,b as w}from"./pay.d8c8791c.js";import{_ as b}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-transition.cdf87992.js";import"./u-icon.0c1c54c7.js";import"./u-safe-bottom.908eeae4.js";const S=b(a({__name:"index",setup(a){const b=e(null),S=e(!1),x=e(""),C=e(!1),O=e(!0),F=e(),I=e(),$=async()=>{var a,e;w({trade_type:null==(a=b.value)?void 0:a.trade_type,trade_id:null==(e=b.value)?void 0:e.trade_id,type:"fastpay_partner_wechatpay",openid:uni.getStorageSync("openid")||""}).then((a=>{var e,t;_()?(a.data.timestamp=a.data.timeStamp,delete a.data.timeStamp,c.pay({...a.data,success:()=>{k()},cancel:()=>{C.value=!1}})):(uni.setStorageSync("paymenting",{trade_type:null==(e=b.value)?void 0:e.trade_type,trade_id:null==(t=b.value)?void 0:t.trade_id}),location.href=a.data.h5_url),O.value=!1})).catch((()=>{C.value=!1}))},k=()=>{m({url:"/addon/fast_pay/pages/partner/result",param:{trade_id:I.value,trade_type:F.value},mode:"redirectTo"})};return t((a=>{a.trade_type&&a.trade_id?(F.value=a.trade_type,I.value=a.trade_id,(async(a,e)=>{j(a,e).then((a=>{let{data:e}=a;b.value=e,uni.$u.test.isEmpty(e)?u({title:p("pay.notObtainedInfo"),icon:"none"}):0!=e.money?(x.value=e.pay_type_list[0]?e.pay_type_list[0].key:"",S.value=!1,$()):k()})).catch((()=>{S.value=!1,O.value=!1,k()}))})(a.trade_type,a.trade_id)):uni.$u.toast("参数错误")})),(a,e)=>{const t=y,u=v(f("up-loading-icon"),h),p=v(f("up-popup"),g);return o(),s(i,null,[n(t,{style:l(a.themeColor())},null,8,["style"]),n(p,{round:10,show:O.value,onClose:a.close,onOpen:a.open,mode:"center"},{default:r((()=>[n(t,{class:"cardloading"},{default:r((()=>[n(u,{class:"mt-4 mb-2",show:"true",mode:"circle","inactive-color":"#29DB6F","timing-function":"linear"}),n(t,null,{default:r((()=>[d("正在支付")])),_:1})])),_:1})])),_:1},8,["show","onClose","onOpen"])],64)}}}),[["__scopeId","data-v-9e1ace89"]]);export{S as default};
