import{d as e,r as t,t as l,o,c as r,w as a,u as s,b as i,L as c,f as d,Y as u,I as n,J as p,K as x,a as f,a1 as g,g as _,h as v,D as m,i as h,a2 as b,y as k,z as y,l as w,Q as C,p as S,T as j,G as F,H as I,E as V,aK as N,m as E,e as z,v as A,n as L,a3 as B,a4 as O,C as R,F as T,j as M,a7 as D,s as U}from"./index-d8a8f699.js";import{_ as $}from"./u-icon.5ba98c98.js";import{_ as H}from"./u--image.2df700b8.js";import{_ as P}from"./tabbar.fdead755.js";import{_ as J}from"./u-loading-page.c740ef13.js";import{b as W,i as Y,c as K,j as G}from"./goods.69affd8d.js";import{M as Q}from"./mescroll-empty.2fe85dec.js";import{_ as X}from"./_plugin-vue_export-helper.1b428a4d.js";import{M as Z}from"./mescroll-body.f9302aea.js";import{u as q}from"./useMescroll.26ccf5de.js";import{_ as ee}from"./u-number-box.a80e7907.js";import{_ as te}from"./u-popup.0d48946e.js";import{u as le}from"./cart.d2c6bfc6.js";import{b as oe}from"./bind-mobile.63a8d6d0.js";import{c as re}from"./cloneDeep.ba6d1a83.js";import"./u-image.e646392b.js";import"./u-transition.db07fff7.js";import"./u-badge.d38c6915.js";import"./u-tabbar.5fed7184.js";import"./u-safe-bottom.a4431b09.js";import"./u-loading-icon.6808ae8c.js";import"./mescroll-i18n.49872024.js";import"./u-form.11d92cf8.js";import"./u-line.d86b0940.js";import"./sms-code.vue_vue_type_script_setup_true_lang.ce239318.js";import"./u-input.9468a367.js";import"./u-modal.3708081d.js";import"./u-checkbox-group.00090a01.js";import"./isArrayLike.512b2e7f.js";const ae=X(e({__name:"category-template-two-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const S=e;let j=S.config,F=S.categoryId;const I=t(""),V=t(!0);l((()=>{E()}));const N=t([]),E=()=>{V.value=!0,W().then((e=>{if(N.value=e.data,F)for(let t=0;t<N.value.length;t++){if(N.value[t].category_id==F){z.value=t;break}if(N.value[t].child_list)for(let e=0;e<N.value[t].child_list.length;e++)if(N.value[t].child_list[e].category_id==F){z.value=t;break}}V.value=!1})).catch((()=>{V.value=!1}))},z=t(0),A=()=>{I.value&&f({url:"/addon/shop/pages/goods/list",param:{goods_name:I.value}})};return(e,t)=>{const l=g,S=_(v("u-icon"),$),F=m,E=h,L=b,B=C,O=_(v("u--image"),H),R=_(v("tabbar"),P),T=_(v("u-loading-page"),J);return o(),r(E,{class:"bg-[#F4F6F8] min-h-screen"},{default:a((()=>[N.value.length?(o(),r(E,{key:0,class:"mescroll-box"},{default:a((()=>[s(j).search.control?(o(),r(E,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[106rpx] box-border"},{default:a((()=>[i(l,{class:c(["search-ipt pl-[32rpx] text-[24rpx]",{"pr-[106rpx]":I.value,"pr-[32rpx]":!I.value}]),type:"text",modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=e=>I.value=e),placeholder:s(j).search.title,onConfirm:A},null,8,["class","modelValue","placeholder"]),i(E,{class:"flex items-center h-[70rpx] absolute right-[56rpx] top-[18rpx] z-2"},{default:a((()=>[I.value?(o(),r(S,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:t[1]||(t[1]=e=>I.value="")})):d("v-if",!0),i(E,{class:"h-[70rpx] w-[40rpx] text-center leading-[70rpx]",onClick:u(A,["stop"])},{default:a((()=>[i(F,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx]"})])),_:1},8,["onClick"])])),_:1})])),_:1})):d("v-if",!0),i(E,{class:c(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[106rpx]":s(j).search.control}])},{default:a((()=>[i(L,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(E,{class:"bg-[#F4F6F8]"},{default:a((()=>[(o(!0),n(x,null,p(N.value,((e,t)=>(o(),r(E,{class:c(["tab-item truncate",{"tab-item-active":t==z.value,"rounded-br-[12rpx]":z.value-1===t,"rounded-tr-[12rpx]":z.value+1===t}]),key:t,onClick:e=>((e,t)=>{z.value=e})(t)},{default:a((()=>[i(E,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(L,{class:"h-[100vh]","scroll-y":!0},{default:a((()=>[i(E,{class:c(["pl-[202rpx] scroll-ios pt-[20rpx] pr-[20rpx]",{"!pt-[126rpx]":s(j).search.control}])},{default:a((()=>{var e,t;return[(null==(e=N.value[z.value])?void 0:e.child_list)&&!V.value?(o(),r(E,{key:0,class:"bg-[#fff] grid grid-cols-3 gap-x-[50rpx] gap-y-[32rpx] py-[33rpx] px-[23rpx] rounded-[16rpx]"},{default:a((()=>{var e;return[(o(!0),n(x,null,p(null==(e=N.value[z.value])?void 0:e.child_list,((e,t)=>(o(),r(E,{key:e.category_id,class:"",onClick:t=>{return l=e.category_id,void f({url:"/addon/shop/pages/goods/list",param:{curr_goods_category:l}});var l}},{default:a((()=>[i(O,{radius:"12rpx",width:"129rpx",height:"129rpx",src:s(w)(e.image?e.image:""),model:"aspectFill"},{error:a((()=>[i(B,{class:"rounded-[12rpx] overflow-hidden w-[129rpx] h-[129rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"]),i(E,{class:"text-[24rpx] text-center mt-[12rpx] leading-[34rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))]})),_:1})):d("v-if",!0),(null==(t=N.value[z.value])?void 0:t.child_list)||V.value?d("v-if",!0):(o(),r(E,{key:1,class:c(["flex justify-center w-[100%] rounded-[16rpx] flex items-center",{noData1:s(j).search.control,noData2:!s(j).search.control}])},{default:a((()=>[i(Q,{option:{tip:"暂无商品分类"}})])),_:1},8,["class"]))]})),_:1},8,["class"])])),_:1})])),_:1})):d("v-if",!0),i(R),N.value.length||V.value?d("v-if",!0):(o(),r(E,{key:1,class:"flex justify-center w-[100%] items-center justify-center h-[100vh]"},{default:a((()=>[i(Q,{option:{tip:"暂无商品分类"}})])),_:1})),i(T,{"bg-color":"rgb(248,248,248)",loading:V.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"])])),_:1})}}}),[["__scopeId","data-v-10a89e2e"]]),se=X(e({__name:"add-cart-popup",setup(e,{expose:l}){const f=le(),g=S((()=>f.cartList)),E=t(!1),z=t({skuId:"",name:[]}),A=t({}),L=t({}),B=t(1),O=()=>{E.value=!1},R=S((()=>{let e=JSON.parse(JSON.stringify(A.value));return Object.keys(e).length&&(Object.keys(z.value.name).length||(z.value.name=e.sku_spec_format.split(",")),e.goodsSpec.forEach(((e,t)=>{let l=e.spec_values.split(",");e.values=[],l.forEach(((l,o)=>{e.values[o]={},e.values[o].name=l,e.values[o].selected=!1,e.values[o].disabled=!1,z.value.name.forEach(((r,a)=>{a==t&&r==l&&(e.values[o].selected=!0)}))}))})),T(),e.skuList&&Object.keys(e.skuList).length&&e.skuList.forEach((e=>{e.sku_id==z.value.skuId&&(L.value=e)}))),e}));j((()=>L.value),((e,t)=>{g.value["goods_"+L.value.goods_id]&&g.value["goods_"+L.value.goods_id]["sku_"+L.value.sku_id]?(B.value=N(g.value["goods_"+L.value.goods_id]["sku_"+L.value.sku_id].num),L.value.cart_id=N(g.value["goods_"+L.value.goods_id]["sku_"+L.value.sku_id].id)):(B.value=1,L.value.cart_id="")}));const T=()=>{A.value.skuList.forEach(((e,t)=>{let l=e.sku_spec_format.split(",");z.value.name.every((e=>l.includes(e)))&&(z.value.skuId=e.sku_id)}))},M=()=>{if(0==B.value)f.reduce({id:L.value.cart_id||"",goods_id:L.value.goods_id,sale_price:L.value.sale_price,sku_id:L.value.sku_id});else{let e=0;e=R.value.goods.is_discount&&L.value.sale_price!=L.value.price?L.value.sale_price?L.value.sale_price:L.value.price:R.value.goods.member_discount&&F()&&L.value.member_price!=L.value.price&&L.value.member_price?L.value.member_price:L.value.price,f.increase({id:L.value.cart_id||"",goods_id:L.value.goods_id,sku_id:L.value.sku_id,stock:L.value.stock,sale_price:e,num:B.value},0,(()=>{I({title:"加入购物车成功",icon:"none"})}))}E.value=!1},D=e=>{let t="0.00";return t=R.value.goods.is_discount&&e.sale_price!=e.price?e.sale_price?e.sale_price:e.price:R.value.goods.member_discount&&F()&&e.member_price!=e.price&&e.member_price?e.member_price:e.price,t},U=e=>{let t="";return t=R.value.goods.is_discount&&e.sale_price!=e.price?"discount_price":R.value.goods.member_discount&&F()&&e.member_price!=e.price?"member_price":"",t};return l({open:e=>{(e=>{Y(e).then((t=>{A.value=t.data,z.value.sku_id=e,A.value.skuList&&Object.keys(A.value.skuList).length&&A.value.skuList.forEach((t=>{t.sku_id==e&&(L.value=t,z.value.name=t.sku_spec_format.split(","))})),E.value=!0}))})(e)}}),(e,t)=>{const l=C,f=_(v("u--image"),H),S=h,j=m,F=_(v("u-number-box"),ee),I=b,N=V,A=_(v("u-popup"),te);return o(),r(S,{onTouchmove:t[3]||(t[3]=u((()=>{}),["prevent","stop"]))},{default:a((()=>[i(A,{show:E.value,onClose:O,mode:"bottom"},{default:a((()=>[Object.keys(s(R)).length?(o(),r(S,{key:0,onTouchmove:t[2]||(t[2]=u((()=>{}),["prevent","stop"])),class:"rounded-t-[20rpx] overflow-hidden bg-[#fff] p-[32rpx] relative"},{default:a((()=>[i(S,{class:"flex mb-[58rpx]"},{default:a((()=>[i(S,{class:"rounded-[8rpx] overflow-hidden"},{default:a((()=>[i(f,{width:"180rpx",height:"180rpx",src:s(w)(L.value.sku_image),model:"aspectFill"},{error:a((()=>[i(l,{class:"w-[180rpx] h-[180rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:1},8,["src"])])),_:1}),i(S,{class:"flex flex-1 flex-col ml-[20rpx] py-[10rpx]"},{default:a((()=>[i(S,{class:"w-[100%]"},{default:a((()=>[i(S,{class:"text-[var(--price-text-color)] flex items-baseline"},{default:a((()=>[i(j,{class:"text-[28rpx] font-bold price-font mr-[4rpx]"},{default:a((()=>[k("￥")])),_:1}),i(j,{class:"text-[42rpx] font-bold price-font"},{default:a((()=>[k(y(parseFloat(D(L.value)).toFixed(2).split(".")[0]),1)])),_:1}),i(j,{class:"text-[28rpx] font-bold price-font"},{default:a((()=>[k("."+y(parseFloat(D(L.value)).toFixed(2).split(".")[1]),1)])),_:1}),"member_price"==U(L.value)?(o(),r(l,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0),"discount_price"==U(L.value)?(o(),r(l,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0)])),_:1}),i(S,{class:"text-[24rpx] leading-[32rpx] text-[#303133] mt-[12rpx]"},{default:a((()=>[k("库存"+y(L.value.stock)+y(s(R).goods.unit),1)])),_:1})])),_:1}),s(R).goodsSpec&&s(R).goodsSpec.length?(o(),r(S,{key:0,class:"w-[100%] mt-auto",style:{"max-height":"calc(204rpx - 126rpx)",overflow:"hidden"}},{default:a((()=>[i(j,{class:"text-[24rpx] leading-[30rpx] text-[#666]"},{default:a((()=>[k("已选规格："+y(L.value.sku_spec_format),1)])),_:1})])),_:1})):d("v-if",!0)])),_:1})])),_:1}),i(I,{class:"h-[500rpx] mb-[30rpx]","scroll-y":"true"},{default:a((()=>[(o(!0),n(x,null,p(s(R).goodsSpec,((e,t)=>(o(),r(S,{class:c({"mt-[36rpx]":0!=t}),key:t},{default:a((()=>[i(S,{class:"text-[26rpx] leading-[36rpx] mb-[24rpx]"},{default:a((()=>[k(y(e.spec_name),1)])),_:2},1024),i(S,{class:"flex flex-wrap"},{default:a((()=>[(o(!0),n(x,null,p(e.values,((e,l)=>(o(),r(S,{class:c(["box-border bg-[#f2f2f2] text-[24rpx] px-[44rpx] text-center h-[56rpx] leading-[52rpx] mr-[20rpx] mb-[20rpx] border-1 border-solid rounded-[50rpx] border-[#f2f2f2]",{"!border-[var(--primary-color)] text-[var(--primary-color)] !bg-[var(--primary-color-light)]":e.selected}]),key:l,onClick:l=>((e,t)=>{z.value.name[t]=e.name,B.value=1})(e,t)},{default:a((()=>[k(y(e.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1032,["class"])))),128)),i(S,{class:"flex justify-between items-center mt-[30rpx]"},{default:a((()=>[i(S,{class:"text-[26rpx]"},{default:a((()=>[k("购买数量")])),_:1}),s(g)["goods_"+L.value.goods_id]&&s(g)["goods_"+L.value.goods_id]["sku_"+L.value.sku_id]?(o(),r(F,{key:0,modelValue:B.value,"onUpdate:modelValue":t[0]||(t[0]=e=>B.value=e),min:0,max:L.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(j,{class:c(["text-[34rpx] nc-iconfont nc-icon-jianV6xx",{"!text-[#c8c9cc]":0===B.value}])},null,8,["class"])])),input:a((()=>[i(j,{class:"text-[#303133] text-[24rpx] mx-[10rpx] min-w-[56rpx] h-[38rpx] leading-[40rpx] text-center border-[1rpx] border-solid border-[#ddd] rounded-[4rpx]"},{default:a((()=>[k(y(B.value),1)])),_:1})])),plus:a((()=>[i(j,{class:c(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx",{"!text-[#c8c9cc]":B.value===L.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"])):(o(),r(F,{key:1,modelValue:B.value,"onUpdate:modelValue":t[1]||(t[1]=e=>B.value=e),min:1,max:L.value.stock,integer:"",step:1,"input-width":"98rpx","input-height":"54rpx"},{minus:a((()=>[i(j,{class:c(["text-[34rpx] nc-iconfont nc-icon-jianV6xx",{"!text-[#c8c9cc]":1===B.value}])},null,8,["class"])])),input:a((()=>[i(j,{class:"text-[#303133] text-[24rpx] mx-[10rpx] min-w-[56rpx] h-[38rpx] leading-[40rpx] text-center border-[1rpx] border-solid border-[#ddd] rounded-[4rpx]"},{default:a((()=>[k(y(B.value),1)])),_:1})])),plus:a((()=>[i(j,{class:c(["text-[34rpx] nc-iconfont nc-icon-jiahaoV6xx",{"!text-[#c8c9cc]":B.value===L.value.stock}])},null,8,["class"])])),_:1},8,["modelValue","max"]))])),_:1})])),_:1}),L.value.stock>0?(o(),r(N,{key:0,class:"!h-[72rpx] primary-btn-bg leading-[72rpx] text-[26rpx] rounded-[50rpx]",type:"primary",onClick:M},{default:a((()=>[k("确定")])),_:1})):(o(),r(N,{key:1,class:"!h-[72rpx] leading-[72rpx] text-[26rpx] text-[#fff] bg-[#ccc] rounded-[50rpx]"},{default:a((()=>[k("已售罄")])),_:1}))])),_:1})):d("v-if",!0)])),_:1},8,["show"])])),_:1})}}}),[["__scopeId","data-v-d9f70bc8"]]),ie=X(e({__name:"category-template-one-one",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const j=e,N=le();N.getList();const T=S((()=>N.cartList)),M=S((()=>N.totalNum)),D=S((()=>N.totalMoney)),U=E(),Y=S((()=>U.info)),{mescrollInit:G,getMescroll:X}=q(O,B);let ee=j.config,te=j.categoryId;const ae=t([]),ie=t(""),ce=t(!0),de=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const ue=e=>{de.value=!1,K({page:e.num,limit:e.size,keyword:"",goods_category:te,brand_id:"",label_ids:"",start_price:"",end_price:"",order:"price",sort:"desc"}).then((t=>{let l=t.data.data;1==e.num&&(ae.value=[]),ae.value=ae.value.concat(l),ce.value=!1,e.endSuccess(l.length),ae.value.length||(de.value=!0)})).catch((()=>{ce.value=!1,de.value=!0,e.endErr()}))},ne=e=>{f({url:"/addon/shop/pages/goods/detail",param:{goods_id:e}})};l((()=>{ve()}));const pe=t(""),xe=t(!1),fe=t(!1),ge=(e,t)=>{if(xe.value||fe.value)return!1;xe.value=!0,fe.value=!0;let l={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:je(e),stock:e.goodsSku.stock};e.id&&(l.num=e.num,l.id=e.id),N.increase(l,1,(()=>{fe.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),l=e.getBoundingClientRect().left,o=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;pe.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{pe.value=`top: ${o+e.offsetHeight/2-r.offsetHeight/2}px; left: ${l+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{pe.value="",xe.value=!1}),1020)}),100)},_e=t([]),ve=()=>{ce.value=!0,W().then((e=>{if(_e.value=e.data,te)for(let t=0;t<_e.value.length;t++){if(_e.value[t].category_id==te){me.value=t;break}if(_e.value[t].child_list)for(let e=0;e<_e.value[t].child_list.length;e++)if(_e.value[t].child_list[e].category_id==te){me.value=t;break}}else te=e.data[0].category_id;ce.value=!1})).catch((()=>{ce.value=!1}))},me=t(0),he=()=>{ie.value&&f({url:"/addon/shop/pages/goods/list",param:{goods_name:ie.value}})},be=t(null),ke=t(),ye=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return ne(e.goodsSku.goods_id);if("cart"!==ee.cart.event)return ne(e.goodsSku.goods_id);if(!Y.value)return R().setLoginBack({url:"/addon/shop/pages/goods/category"}),!1;if(uni.getStorageSync("isbindmobile"))return be.value.open(),!1;if(e.goodsSku.sku_spec_format)ke.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void I({title:"商品库存不足",icon:"none"});ge(e,t)}},we=()=>{f({url:"/addon/shop/pages/goods/cart"})},Ce=()=>{if(uni.getStorageSync("isbindmobile"))return be.value.open(),!1;if(!M.value)return void I({title:"还没有选择商品",icon:"none"});const e=[];Object.values(T.value).forEach((t=>{Object.keys(t).forEach((l=>{"totalNum"!=l&&"totalMoney"!=l&&e.push(t[l].id)}))})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/shop/pages/order/payment"})}})},Se=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},je=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const l=g,f=_(v("u-icon"),$),S=m,j=h,F=b,E=C,B=_(v("u--image"),H),O=V,R=_(v("u-loading-page"),J),U=_(v("tabbar"),P);return o(),r(j,{class:"min-h-screen"},{default:a((()=>[_e.value.length?(o(),r(j,{key:0,class:c(["mescroll-box bg-[#F4F6F8]",{cart:s(ee).cart.control&&"cart"===s(ee).cart.event,detail:!(s(ee).cart.control&&"cart"===s(ee).cart.event)}])},{default:a((()=>[i(Z,{ref:"mescrollRef",down:{use:!1},onInit:s(G),onUp:ue},{default:a((()=>[s(ee).search.control?(o(),r(j,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[106rpx] box-border"},{default:a((()=>[i(l,{class:c(["search-ipt pl-[32rpx] text-[24rpx]",{"pr-[106rpx]":ie.value,"pr-[32rpx]":!ie.value}]),type:"text",modelValue:ie.value,"onUpdate:modelValue":t[0]||(t[0]=e=>ie.value=e),placeholder:s(ee).search.title,onConfirm:he},null,8,["class","modelValue","placeholder"]),i(j,{class:"flex items-center h-[70rpx] absolute right-[56rpx] top-[18rpx] z-2"},{default:a((()=>[ie.value?(o(),r(f,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:t[1]||(t[1]=e=>ie.value="")})):d("v-if",!0),i(j,{class:"h-[70rpx] w-[40rpx] text-center leading-[70rpx]",onClick:u(he,["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx]"})])),_:1},8,["onClick"])])),_:1})])),_:1})):d("v-if",!0),i(j,{class:c(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[106rpx]":s(ee).search.control,"pb-[98rpx]":s(ee).cart.control&&"cart"===s(ee).cart.event}])},{default:a((()=>[i(F,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(j,{class:"bg-[#F4F6F8]"},{default:a((()=>[(o(!0),n(x,null,p(_e.value,((e,t)=>(o(),r(j,{class:c(["tab-item truncate",{"tab-item-active":t==me.value,"rounded-br-[12rpx]":me.value-1===t,"rounded-tr-[12rpx]":me.value+1===t}]),key:t,onClick:l=>((e,t)=>{me.value=e,te=t.category_id,ae.value=[],X().resetUpScroll()})(t,e)},{default:a((()=>[i(j,{class:"text-box px-[16rpx] truncate"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),i(j,{class:c(["flex justify-center flex-wrap pl-[182rpx] pb-[20rpx]",{" pt-[126rpx]":s(ee).search.control," pt-[20rpx]":!s(ee).search.control}])},{default:a((()=>[(o(!0),n(x,null,p(ae.value,((e,t)=>(o(),r(j,{key:e.goods_id,class:c(["w-[536rpx] box-border bg-white w-full flex mx-[16rpx] px-[24rpx] py-[20rpx] rounded-[12rpx]",{"mt-[16rpx]":t}]),onClick:u((t=>ne(e.goods_id)),["stop"])},{default:a((()=>[i(j,{class:"mr-[8rpx]"},{default:a((()=>[i(B,{width:"168rpx",height:"168rpx",radius:"12rpx",src:s(w)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(E,{class:"rounded-[12rpx] overflow-hidden w-[168rpx] h-[168rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"])])),_:2},1024),i(j,{class:"flex flex-1 ml-[8rpx] flex-wrap"},{default:a((()=>[i(j,{class:"w-[316rpx] max-h-[80rpx] text-[28rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),i(j,{class:"w-[316rpx] flex self-end items-end justify-between"},{default:a((()=>[i(j,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(S,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(S,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(je(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(S,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(je(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==Se(e)?(o(),r(E,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0),"discount_price"==Se(e)?(o(),r(E,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(T)["goods_"+e.goods_id]&&s(T)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(ee).cart.control&&"cart"===s(ee).cart.event?(o(),r(j,{key:0,class:"flex items-center"},{default:a((()=>[i(S,{class:"text-[44rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:u((t=>(e=>{if(fe.value)return!1;fe.value=!0,N.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{fe.value=!1}))})(s(T)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(S,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(T)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(S,{class:"text-[44rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:u((l=>((e,t,l)=>{if(parseInt(t.num)>=parseInt(t.stock))return void I({title:"商品库存不足",icon:"none"});let o=re(e);o.num=t.num,o.id=t.id,ge(o,l)})(e,s(T)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(ee).cart.event||"real"==e.goods_type?(o(),n(x,{key:1},[s(ee).cart.control&&"style-1"===s(ee).cart.style?(o(),r(j,{key:0,class:"h-[44rpx] relative"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"text-[#fff] bg-color h-[44rpx] text-[24rpx] px-[10px] leading-[44rpx] rounded-[22rpx]",onClick:u((l=>ye(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(ee).cart.text),1)])),_:2},1032,["id","onClick"]),s(T)["goods_"+e.goods_id]&&s(T)["goods_"+e.goods_id].totalNum?(o(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(T)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(T)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ee).cart.control&&"style-2"===s(ee).cart.style?(o(),r(j,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:u((l=>ye(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(T)["goods_"+e.goods_id]&&s(T)["goods_"+e.goods_id].totalNum?(o(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(T)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(T)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ee).cart.control&&"style-3"===s(ee).cart.style?(o(),r(j,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:u((l=>ye(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(T)["goods_"+e.goods_id]&&s(T)["goods_"+e.goods_id].totalNum?(o(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(T)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(T)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ee).cart.control&&"style-4"===s(ee).cart.style?(o(),r(j,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:u((l=>ye(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(T)["goods_"+e.goods_id]&&s(T)["goods_"+e.goods_id].totalNum?(o(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(T)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(T)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0)],64)):d("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),ae.value.length||ce.value||!de.value?d("v-if",!0):(o(),r(j,{key:0,class:c(["mx-[24rpx] w-[536rpx] rounded-[12rpx] flex items-center justify-center",{noData1:s(ee).search.control,noData2:!s(ee).search.control}])},{default:a((()=>[i(Q,{option:{tip:"暂无商品"}})])),_:1},8,["class"]))])),_:1},8,["class"]),i(se,{ref_key:"cartRef",ref:ke},null,512)])),_:1},8,["onInit"]),s(ee).cart.control&&"cart"===s(ee).cart.event?(o(),r(j,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios"},{default:a((()=>[i(j,{class:"flex items-center"},{default:a((()=>[i(j,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(j,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:u(we,["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(M)?(o(),r(j,{key:0,class:c(["absolute left-[50rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(M)>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)>99?"99+":s(M)),1)])),_:1},8,["class"])):d("v-if",!0)])),_:1}),i(S,{class:"text-[32rpx] font-500 text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(S,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(S,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(S,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(s(D)).toFixed(2).split(".")[0]),1)])),_:1}),i(S,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(s(D)).toFixed(2).split(".")[1]),1)])),_:1})])),_:1})])),_:1}),i(O,{class:"w-[180rpx] h-[66rpx] text-[28rpx] leading-[66rpx] !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",shape:"circle",onClick:Ce},{default:a((()=>[k("去结算")])),_:1})])),_:1})):d("v-if",!0)])),_:1},8,["class"])):d("v-if",!0),z(i(j,{style:L(pe.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[A,pe.value]]),_e.value.length||ce.value?d("v-if",!0):(o(),r(j,{key:1,class:"flex justify-center items-center w-[100%] h-[100vh]"},{default:a((()=>[i(Q,{option:{tip:"暂无商品分类"}})])),_:1})),i(R,{"bg-color":"rgb(248,248,248)",loading:ce.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"]),i(U),d(" 强制绑定手机号 "),i(oe,{ref_key:"bindMobileRef",ref:be},null,512)])),_:1})}}}),[["__scopeId","data-v-5eab16a0"]]),ce=X(e({__name:"category-template-two-two",props:{config:{type:Object,default:()=>({})},categoryId:{type:[String,Number],default:0}},setup(e){const j=e,N=le();N.getList();const M=S((()=>N.cartList)),D=S((()=>N.totalNum)),U=S((()=>N.totalMoney)),Y=E(),G=S((()=>Y.info)),{mescrollInit:X,getMescroll:ee}=q(O,B);let ae=j.config,ie=j.categoryId;const ce=t([]),de=t(""),ue=t(!0),ne=t(!1),pe=t(!1);t([]).value=uni.getStorageSync("shopCart")||[];const xe=e=>{ne.value=!1,K({page:e.num,limit:e.size,keyword:"",goods_category:ie,brand_id:"",label_ids:"",start_price:"",end_price:"",order:"price",sort:"desc"}).then((t=>{let l=t.data.data;1==e.num&&(ce.value=[]),ce.value=ce.value.concat(l),ue.value=!1,e.endSuccess(l.length),ce.value.length||(ne.value=!0)})).catch((()=>{ue.value=!1,ne.value=!0,e.endErr()}))},fe=e=>{f({url:"/addon/shop/pages/goods/detail",param:{goods_id:e}})};l((()=>{be()}));const ge=t(""),_e=t(!1),ve=t(!1),me=(e,t)=>{if(_e.value||ve.value)return!1;_e.value=!0,ve.value=!0;let l={goods_id:e.goodsSku.goods_id,sku_id:e.goodsSku.sku_id,sale_price:Ee(e),stock:e.goodsSku.stock};e.id&&(l.num=e.num,l.id=e.id),N.increase(l,1,(()=>{ve.value=!1})),setTimeout((()=>{const e=window.document.getElementById("animation-end"),l=e.getBoundingClientRect().left,o=e.getBoundingClientRect().top,r=window.document.getElementById(t),a=r.getBoundingClientRect().left,s=r.getBoundingClientRect().top;ge.value=`top: ${s}px; left: ${a}px;`,setTimeout((()=>{ge.value=`top: ${o+e.offsetHeight/2-r.offsetHeight/2}px; left: ${l+e.offsetWidth/2-r.offsetHeight/2}px; transition: all 0.8s; transform: rotate(-720deg);`}),20),setTimeout((()=>{ge.value="",_e.value=!1}),1020)}),100)};t({allActive:-1,data:{category_name:"全部",category_id:""}});const he=t([]),be=()=>{ue.value=!0,W().then((e=>{he.value=e.data;for(let t=0;t<he.value.length;t++)if(he.value[t].child_list){let e={category_name:"全部",category_id:he.value[t].category_id};he.value[t].child_list.unshift(e)}if(ie)for(let t=0;t<he.value.length;t++){if(he.value[t].category_id==ie){ke.value=t;break}if(he.value[t].child_list)for(let e=0;e<he.value[t].child_list.length;e++)if(he.value[t].child_list[e].category_id==ie){ke.value=t,ye.value=e;break}}else ie=e.data[0].category_id;ue.value=!1})).catch((()=>{ue.value=!1}))},ke=t(0),ye=t(0),we=(e,t)=>{ye.value=e,ie=t.category_id,pe.value=!1,ce.value=[],ee().resetUpScroll()},Ce=()=>{de.value&&f({url:"/addon/shop/pages/goods/list",param:{goods_name:de.value}})};T();const Se=t(null),je=t(),Fe=(e,t)=>{if("virtual"==e.goods_type&&"verify"==e.virtual_receive_type)return fe(e.goodsSku.goods_id);if("cart"!==ae.cart.event)return fe(e.goods_id);if(!G.value)return R().setLoginBack({url:"/addon/shop/pages/goods/category"}),!1;if(uni.getStorageSync("isbindmobile"))return Se.value.open(),!1;if(e.goodsSku.sku_spec_format)je.value.open(e.goodsSku.sku_id);else{if(parseInt(e.goodsSku.num||0)>=parseInt(e.goodsSku.stock))return void I({title:"商品库存不足",icon:"none"});me(e,t)}},Ie=()=>{f({url:"/addon/shop/pages/goods/cart"})},Ve=()=>{if(uni.getStorageSync("isbindmobile"))return Se.value.open(),!1;if(!D.value)return void I({title:"还没有选择商品",icon:"none"});const e=[];Object.values(M.value).forEach((t=>{Object.keys(t).forEach((l=>{"totalNum"!=l&&"totalMoney"!=l&&e.push(t[l].id)}))})),uni.setStorage({key:"orderCreateData",data:{cart_ids:e},success(){f({url:"/addon/shop/pages/order/payment"})}})},Ne=e=>{let t="";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?"discount_price":e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price?"member_price":"",t},Ee=e=>{let t="0.00";return t=e.is_discount&&e.goodsSku.sale_price!=e.goodsSku.price?e.goodsSku.sale_price?e.goodsSku.sale_price:e.goodsSku.price:e.member_discount&&F()&&e.goodsSku.member_price!=e.goodsSku.price&&e.goodsSku.member_price?e.goodsSku.member_price:e.goodsSku.price,t};return(e,t)=>{const l=g,f=_(v("u-icon"),$),S=m,j=h,F=b,E=_(v("u-popup"),te),B=C,O=_(v("u--image"),H),R=V,T=_(v("u-loading-page"),J),W=_(v("tabbar"),P);return o(),r(j,{class:"min-h-screen"},{default:a((()=>[he.value.length?(o(),r(j,{key:0,class:c(["mescroll-box bg-[#F4F6F8]",{cart:s(ae).cart.control&&"cart"===s(ae).cart.event,detail:!(s(ae).cart.control&&"cart"===s(ae).cart.event)}])},{default:a((()=>[i(Z,{ref:"mescrollRef",down:{use:!1},onInit:s(X),onUp:xe},{default:a((()=>{var e,g,_,v,m,h;return[s(ae).search.control?(o(),r(j,{key:0,class:"search-box z-10 bg-[#fff] fixed top-0 left-0 right-0 h-[106rpx] box-border"},{default:a((()=>[i(l,{class:c(["search-ipt pl-[32rpx] text-[24rpx]",{"pr-[106rpx]":de.value,"pr-[32rpx]":!de.value}]),type:"text",modelValue:de.value,"onUpdate:modelValue":t[0]||(t[0]=e=>de.value=e),placeholder:s(ae).search.title,onConfirm:Ce},null,8,["class","modelValue","placeholder"]),i(j,{class:"flex items-center h-[70rpx] absolute right-[56rpx] top-[18rpx] z-2"},{default:a((()=>[de.value?(o(),r(f,{key:0,name:"close-circle-fill",color:"#A5A6A6",size:"28rpx",onClick:t[1]||(t[1]=e=>de.value="")})):d("v-if",!0),i(j,{class:"h-[70rpx] w-[40rpx] text-center leading-[70rpx]",onClick:u(Ce,["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[32rpx]"})])),_:1},8,["onClick"])])),_:1})])),_:1})):d("v-if",!0),i(j,{class:c(["tabs-box z-2 fixed left-0 bg-[#fff] bottom-[50px] top-0",{"!top-[106rpx]":s(ae).search.control,"pb-[98rpx]":s(ae).cart.control&&"cart"===s(ae).cart.event}])},{default:a((()=>[i(F,{"scroll-y":!0,class:"scroll-height"},{default:a((()=>[i(j,{class:"bg-[#F4F6F8]"},{default:a((()=>[(o(!0),n(x,null,p(he.value,((e,t)=>(o(),r(j,{class:c(["tab-item truncate",{"tab-item-active ":t==ke.value,"rounded-br-[12rpx]":!(ke.value-1!==t||he.value[ke.value].child_list&&he.value[ke.value].child_list.length),"rounded-tr-[12rpx]":!(ke.value+1!==t||he.value[ke.value].child_list&&he.value[ke.value].child_list.length)}]),key:t,onClick:l=>((e,t)=>{ke.value=e,t.child_list&&t.child_list.length?we(0,t.child_list[0]):(ie=t.category_id,ce.value=[],ee().resetUpScroll())})(t,e)},{default:a((()=>[i(j,{class:"text-box truncate px-[24rpx]"},{default:a((()=>[k(y(e.category_name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["class"]),(null==(e=he.value[ke.value])?void 0:e.child_list)&&(null==(g=he.value[ke.value])?void 0:g.child_list.length)?(o(),r(j,{key:1,class:c(["flex justify-center items-center h-[92rpx] px-[24rpx] py-[20rpx] z-10 bg-white fixed left-[182rpx] right-0 box-border top-0",{"!top-[106rpx]":s(ae).search.control}])},{default:a((()=>[pe.value?(o(),n(x,{key:1},[i(j,{class:"flex-1 h-[48rpx] text-[22rpx] text-[#A5A6A6] pr-[24rpx] leading-[48rpx]"},{default:a((()=>[k("全部分类")])),_:1}),i(S,{class:"nc-iconfont nc-icon-shangV6xx-1 text-[30rpx]",onClick:t[3]||(t[3]=e=>pe.value=!1)})],64)):(o(),n(x,{key:0},[i(F,{"scroll-x":!0,"scroll-with-animation":"","scroll-into-view":"id"+(ye.value?ye.value-1:0),class:"flex-1 h-[49rpx] scroll-Y box-border pr-[24rpx] bg-white"},{default:a((()=>[i(j,{class:"flex items-center h-[48rpx] box-border"},{default:a((()=>{var e;return[(o(!0),n(x,null,p(null==(e=he.value[ke.value])?void 0:e.child_list,((e,t)=>(o(),r(S,{class:c(["flex-shrink-0 ml-[24rpx] px-[24rpx] h-[48rpx] text-[22rpx] leading-[44rpx] border-[2rpx] border-solid rounded-[24rpx] box-border",{"sub-tab-active text-color border-color":t===ye.value,"border-[#E2E2E2]":t!=ye.value}]),key:he.value[ke.value].category_id,id:"id"+t,onClick:l=>we(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","id","onClick"])))),128))]})),_:1})])),_:1},8,["scroll-into-view"]),i(j,{class:"nc-iconfont nc-icon-xiaV6xx text-[30rpx] w-[30rpx] h-[30rpx] text-center transform",onClick:t[2]||(t[2]=e=>pe.value=!0)})],64))])),_:1},8,["class"])):d("v-if",!0),i(j,{class:c(["labelPopup",{active:s(ae).search.control}])},{default:a((()=>[i(E,{show:pe.value,mode:"top",onClose:t[5]||(t[5]=e=>pe.value=!1)},{default:a((()=>[i(j,{class:"flex flex-wrap py-[24rpx]",onTouchmove:t[4]||(t[4]=u((()=>{}),["prevent","stop"]))},{default:a((()=>{var e;return[d(' <text\r\n\t\t\t\t\t\t\t\tclass="flex-shrink-0 w-[160rpx] ml-[22rpx] mb-[24rpx] text-center h-[48rpx] text-[22rpx] leading-[48rpx] border-[2rpx] border-solid rounded-[24rpx] box-border"\r\n\t\t\t\t\t\t\t\t:class="{ \'sub-tab-active text-color border-color\': initAll.allActive === subActive, \'border-[#E2E2E2]\': initAll.allActive != subActive }"\r\n\t\t\t\t\t\t\t\t @click="subMenuClick(initAll.allActive,initAll.data)">全部</text> '),(o(!0),n(x,null,p(null==(e=he.value[ke.value])?void 0:e.child_list,((e,t)=>(o(),r(S,{class:c(["flex-shrink-0 w-[160rpx] ml-[22rpx] mb-[24rpx] text-center h-[48rpx] text-[22rpx] leading-[48rpx] border-[2rpx] border-solid rounded-[24rpx] box-border",{"sub-tab-active text-color border-color":t===ye.value,"border-[#E2E2E2]":t!=ye.value}]),key:he.value[ke.value].category_id,onClick:l=>we(t,e)},{default:a((()=>[k(y(e.category_name),1)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1},8,["show"])])),_:1},8,["class"]),i(j,{class:c(["flex justify-center flex-wrap pl-[182rpx] pt-[20rpx] pb-[20rpx]",{"!pt-[218rpx]":s(ae).search.control&&(null==(_=he.value[ke.value])?void 0:_.child_list)&&(null==(v=he.value[ke.value])?void 0:v.child_list.length),"pt-[126rpx]":s(ae).search.control&&(!he.value[ke.value].child_list||!he.value[ke.value].child_list.length),"pt-[112rpx]":(null==(m=he.value[ke.value])?void 0:m.child_list)&&(null==(h=he.value[ke.value])?void 0:h.child_list.length)&&!s(ae).search.control}])},{default:a((()=>{var e,t,l,f;return[(o(!0),n(x,null,p(ce.value,((e,t)=>(o(),r(j,{key:e.goods_id,class:c(["w-[536rpx] box-border bg-white w-full flex mx-[16rpx] px-[24rpx] py-[20rpx] rounded-[12rpx]",{"mt-[16rpx]":t}]),onClick:u((t=>fe(e.goods_id)),["stop"])},{default:a((()=>[i(j,{class:"mr-[8rpx]"},{default:a((()=>[i(O,{width:"168rpx",height:"168rpx",radius:"12rpx",src:s(w)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:a((()=>[i(B,{class:"rounded-[12rpx] overflow-hidden w-[168rpx] h-[168rpx]",src:s(w)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"])])),_:2},1032,["src"])])),_:2},1024),i(j,{class:"flex flex-1 flex-wrap"},{default:a((()=>[i(j,{class:"w-[316rpx] max-h-[80rpx] text-[28rpx] leading-[40rpx] multi-hidden"},{default:a((()=>[k(y(e.goods_name),1)])),_:2},1024),i(j,{class:"w-[316rpx] flex self-end items-end justify-between"},{default:a((()=>[i(j,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(S,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(S,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(Ee(e)).toFixed(2).split(".")[0]),1)])),_:2},1024),i(S,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(Ee(e)).toFixed(2).split(".")[1]),1)])),_:2},1024),"member_price"==Ne(e)?(o(),r(B,{key:0,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/shop/VIP.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0),"discount_price"==Ne(e)?(o(),r(B,{key:1,class:"h-[24rpx] ml-[6rpx]",src:s(w)("addon/shop/discount.png"),mode:"heightFix"},null,8,["src"])):d("v-if",!0)])),_:2},1024),("real"==e.goods_type||"virtual"==e.goods_type&&"verify"!=e.virtual_receive_type)&&""===e.goodsSku.sku_spec_format&&s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id]&&s(ae).cart.control&&"cart"===s(ae).cart.event?(o(),r(j,{key:0,class:"flex items-center"},{default:a((()=>[i(S,{class:"text-[44rpx] text-color nc-iconfont nc-icon-jianshaoV6xx",onClick:u((t=>(e=>{if(ve.value)return!1;ve.value=!0,N.reduce({id:e.id,goods_id:e.goods_id,sku_id:e.sku_id,stock:e.stock,sale_price:e.sale_price,num:e.num},1,(()=>{ve.value=!1}))})(s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id])),["stop"])},null,8,["onClick"]),i(S,{class:"text-[#333] text-[24rpx] mx-[16rpx]"},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id].num),1)])),_:2},1024),i(S,{class:"text-[44rpx] text-color iconfont iconjiahao2fill",id:"itemCart"+t,onClick:u((l=>((e,t,l)=>{if(parseInt(t.num)>=parseInt(t.stock))return void I({title:"商品库存不足",icon:"none"});let o=re(e);o.num=t.num,o.id=t.id,me(o,l)})(e,s(M)["goods_"+e.goods_id]["sku_"+e.goodsSku.sku_id],"itemCart"+t)),["stop"])},null,8,["id","onClick"])])),_:2},1024)):"virtual"==e.goods_type&&"cart"!==s(ae).cart.event||"real"==e.goods_type?(o(),n(x,{key:1},[s(ae).cart.control&&"style-1"===s(ae).cart.style?(o(),r(j,{key:0,class:"h-[44rpx] relative pl-[20rpx]"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"text-[#fff] bg-color h-[44rpx] text-[24rpx] px-[10px] leading-[44rpx] rounded-[22rpx]",onClick:u((l=>Fe(e,"itemCart"+t)),["stop"])},{default:a((()=>[k(y(s(ae).cart.text),1)])),_:2},1032,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(o(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ae).cart.control&&"style-2"===s(ae).cart.style?(o(),r(j,{key:1,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-tianjiaV6xx text-[44rpx]",onClick:u((l=>Fe(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(o(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ae).cart.control&&"style-3"===s(ae).cart.style?(o(),r(j,{key:2,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(S,{id:"itemCart"+t,class:"text-color nc-iconfont nc-icon-gouwucheV6xx-2 !text-[44rpx]",onClick:u((l=>Fe(e,"itemCart"+t)),["stop"])},null,8,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(o(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0),s(ae).cart.control&&"style-4"===s(ae).cart.style?(o(),r(j,{key:3,class:"w-[44rpx] h-[44rpx] relative"},{default:a((()=>[i(j,{id:"itemCart"+t,class:"flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center",onClick:u((l=>Fe(e,"itemCart"+t)),["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[26rpx]"})])),_:2},1032,["id","onClick"]),s(M)["goods_"+e.goods_id]&&s(M)["goods_"+e.goods_id].totalNum?(o(),r(j,{key:0,class:c(["absolute right-[-16rpx] top-[-16rpx] rounded-[30rpx] h-[30rpx] min-w-[30rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border border-[2rpx] border-solid border-[#fff]",s(M)["goods_"+e.goods_id].totalNum>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(M)["goods_"+e.goods_id].totalNum),1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)):d("v-if",!0)],64)):d("v-if",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),ce.value.length||ue.value||!ne.value?d("v-if",!0):(o(),r(j,{key:0,class:c(["w-[536rpx] mx-[16rpx] rounded-[12rpx] flex items-center justify-center",{noData1:s(ae).search.control,noData2:!s(ae).search.control,child:(null==(e=he.value[ke.value])?void 0:e.child_list)&&(null==(t=he.value[ke.value])?void 0:t.child_list.length),noChild:!(null==(l=he.value[ke.value])?void 0:l.child_list)||!(null==(f=he.value[ke.value])?void 0:f.child_list.length)}])},{default:a((()=>[i(Q,{option:{tip:"暂无商品"}})])),_:1},8,["class"]))]})),_:1},8,["class"]),i(se,{ref_key:"cartRef",ref:je},null,512)]})),_:1},8,["onInit"]),s(ae).cart.control&&"cart"===s(ae).cart.event?(o(),r(j,{key:0,class:"bg-[#fff] z-10 flex justify-between items-center fixed left-0 right-0 bottom-[50px] box-solid px-[24rpx] py-[17rpx] mb-ios"},{default:a((()=>[i(j,{class:"flex items-center"},{default:a((()=>[i(j,{class:"w-[66rpx] h-[66rpx] mr-[27rpx] relative"},{default:a((()=>[i(j,{id:"animation-end",class:"w-[66rpx] h-[66rpx] rounded-[35rpx] bg-[var(--primary-color)] text-center leading-[70rpx]",onClick:u(Ie,["stop"])},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6mm1 text-[#fff] text-[32rpx]"})])),_:1},8,["onClick"]),s(D)?(o(),r(j,{key:0,class:c(["absolute left-[50rpx] top-[-10rpx] rounded-[28rpx] h-[28rpx] min-w-[28rpx] text-center leading-[30rpx] bg-[#FF4646] text-[#fff] text-[20rpx] font-500 box-border",s(D)>9?"px-[10rpx]":""])},{default:a((()=>[k(y(s(D)>99?"99+":s(D)),1)])),_:1},8,["class"])):d("v-if",!0)])),_:1}),i(S,{class:"text-[32rpx] font-500 text-[#333]"},{default:a((()=>[k("总计：")])),_:1}),i(S,{class:"text-[var(--price-text-color)] price-font"},{default:a((()=>[i(S,{class:"text-[26rpx] font-500"},{default:a((()=>[k("￥")])),_:1}),i(S,{class:"text-[36rpx] font-500"},{default:a((()=>[k(y(parseFloat(s(U)).toFixed(2).split(".")[0]),1)])),_:1}),i(S,{class:"text-[24rpx] font-500"},{default:a((()=>[k("."+y(parseFloat(s(U)).toFixed(2).split(".")[1]),1)])),_:1})])),_:1})])),_:1}),i(R,{class:"w-[180rpx] h-[66rpx] text-[28rpx] leading-[66rpx] !text-[#fff] m-0 rounded-full primary-btn-bg remove-border",shape:"circle",onClick:Ve},{default:a((()=>[k("去结算")])),_:1})])),_:1})):d("v-if",!0)])),_:1},8,["class"])):d("v-if",!0),z(i(j,{style:L(ge.value),class:"fixed z-999 flex items-center justify-center text-[#fff] bg-color h-[44rpx] w-[44rpx] rounded-[22rpx] text-center"},{default:a((()=>[i(S,{class:"nc-iconfont nc-icon-gouwucheV6xx-2 !text-[30rpx]"})])),_:1},8,["style"]),[[A,ge.value]]),he.value.length||ue.value?d("v-if",!0):(o(),r(j,{key:1,class:"flex justify-center items-center w-[100%]"},{default:a((()=>[i(Q,{option:{tip:"暂无商品分类"}})])),_:1})),i(T,{"bg-color":"rgb(248,248,248)",loading:ue.value,loadingText:"",fontSize:"16",color:"#303133"},null,8,["loading"]),i(W),d(" 强制绑定手机号 "),i(oe,{ref_key:"bindMobileRef",ref:Se},null,512)])),_:1})}}}),[["__scopeId","data-v-80a57bf3"]]),de=X(e({__name:"category",setup(e){const l=le(),s=t({}),i=t(0);return M((e=>{i.value=e.category_id||0,G().then((e=>{s.value=e.data,U({title:s.value.page_title})}))})),D((()=>{l.getList()})),(e,t)=>{const l=h;return o(),r(l,{style:L(e.themeColor())},{default:a((()=>[1===s.value.level&&"style-1"===s.value.template?(o(),r(ie,{key:0,class:"category",categoryId:i.value,config:s.value},null,8,["categoryId","config"])):d("v-if",!0),2===s.value.level&&"style-1"===s.value.template?(o(),r(ae,{key:1,categoryId:i.value,config:s.value},null,8,["categoryId","config"])):d("v-if",!0),2===s.value.level&&"style-2"===s.value.template?(o(),r(ce,{key:2,class:"category",categoryId:i.value,config:s.value},null,8,["categoryId","config"])):d("v-if",!0)])),_:1},8,["style"])}}}),[["__scopeId","data-v-40f04a9c"]]);export{de as default};
