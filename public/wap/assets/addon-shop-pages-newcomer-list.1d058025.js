import{d as e,r as a,a$ as t,j as s,p as l,cd as r,o,c as u,w as n,u as c,P as i,f as d,b as p,Q as m,y as x,n as f,z as _,a7 as v,A as g,a8 as h,a9 as y,B as b,i as k,D as w,g as j,h as F,a6 as C,C as E,E as T,R as z,a as D,G as I}from"./index-7bf68536.js";import{_ as M}from"./u-count-down.05562681.js";import{_ as A}from"./u-popup.be4bfacd.js";import{_ as N}from"./loading-page.vue_vue_type_script_setup_true_lang.124ad65f.js";import{a as R,b as S}from"./newcomer.7143eab6.js";import{M as H}from"./mescroll-body.b6d57b41.js";import{u as O}from"./useMescroll.26ccf5de.js";import{M as P}from"./mescroll-empty.fcefb74e.js";import{t as U}from"./topTabbar.f3f9eebd.js";import{_ as B}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-transition.cdf87992.js";import"./u-icon.0c1c54c7.js";import"./u-safe-bottom.908eeae4.js";import"./u-loading-page.566c330a.js";import"./u-loading-icon.b37701e7.js";import"./mescroll-i18n.14e7fe02.js";/* empty css                                                                       */const G=B(e({__name:"list",setup(e){const{mescrollInit:B,downCallback:G,getMescroll:L}=O(y,h),Q=a([]),V=a(null),$=a(!1),q=a(!0),J=t();let K={};U().setTopTabbarParam({title:"新人专享列表"}),s((()=>I(Number(K.height)+K.top+8)+30+"rpx;"));const W=a({}),X=e=>{W.value=e},Y=a(""),Z=a(!1),ee=()=>{Z.value=!1};l((async e=>{te()}));const ae=a({}),te=()=>{R().then((e=>{ae.value=e.data,ae.value&&ae.value.validity_time&&r(ae.value.validity_time),q.value=!1})).catch((()=>{q.value=!1}))},se=a(0),le=e=>{$.value=!1;let a={page:e.num,limit:e.size};S(a).then((a=>{se.value=a.data.is_join;let t=a.data.data,s=(new Date).getTime();Y.value=1e3*Number(a.data.validity_time)-s,1===Number(e.num)&&(Q.value=[]),Q.value=Q.value.concat(t),e.endSuccess(t.length),$.value=!0})).catch((()=>{$.value=!0,e.endErr()}))};return(e,a)=>{const t=b,s=k,l=w,r=j(F("up-count-down"),M),h=C,y=E,I=j(F("u-popup"),A),R=j(F("loading-page"),N);return o(),u(s,{class:"min-h-[100vh] bg-[#f6f6f6] overflow-hidden",style:f(e.themeColor())},{default:n((()=>[Object.keys(ae.value).length&&"active"==ae.value.active_status?(o(),u(H,{key:0,ref_key:"mescrollRef",ref:V,onInit:c(B),down:{use:!1},onUp:le},{default:n((()=>[q.value?d("v-if",!0):(o(),u(s,{key:0,class:"marketing-head"},{default:n((()=>[ae.value.banner_list&&ae.value.banner_list.length?(o(),u(t,{key:0,class:"w-[100%] h-[434rpx] -mt-[130rpx]",src:c(T)(ae.value.banner_list[0].imageUrl),mode:"aspectFill",onClick:a[0]||(a[0]=e=>c(J).toRedirect(ae.value.banner_list[0].toLink))},null,8,["src"])):(o(),i(m,{key:1},[d(" 占位作用 "),p(s,{class:"w-[100%] h-[434rpx] -mt-[130rpx]"})],2112)),ae.value.active_desc?(o(),u(s,{key:2,class:"side-tab !top-[30rpx]",onClick:a[1]||(a[1]=e=>Z.value=!0)},{default:n((()=>[p(l,{class:"iconfont iconxinrenV6xx icon"}),p(l,{class:"desc"},{default:n((()=>[x("活动规则")])),_:1})])),_:1})):d("v-if",!0),Y.value>0&&0==se.value&&null!=Y.value?(o(),u(s,{key:3,class:"time newcomer-time",style:f({"background-image":"url("+c(T)("addon/shop/newcomer/time_bg.png")+")"})},{default:n((()=>[p(l,{class:"text-[26rpx]"},{default:n((()=>[x("距结束还有：")])),_:1}),p(r,{class:"text-[#fff] min-w-[150rpx] text-[28rpx]",time:Y.value,format:"DD:HH:mm:ss",onChange:X},{default:n((()=>[p(s,{class:"flex"},{default:n((()=>[W.value.days&&W.value.days>0?(o(),u(s,{key:0,class:"text-[24rpx] flex items-center"},{default:n((()=>[p(l,{class:"min-w-[30rpx] text-right"},{default:n((()=>[x(_(W.value.days),1)])),_:1}),p(l,{class:"text-[20rpx]"},{default:n((()=>[x("天")])),_:1})])),_:1})):d("v-if",!0),p(s,{class:"text-[24rpx] flex items-center"},{default:n((()=>[W.value.hours?(o(),u(l,{key:0,class:"min-w-[30rpx] text-center"},{default:n((()=>[x(_(W.value.hours>=10?W.value.hours:"0"+W.value.hours),1)])),_:1})):(o(),u(l,{key:1,class:"min-w-[30rpx] text-center"},{default:n((()=>[x("00")])),_:1})),p(l,{class:"text-[20rpx]"},{default:n((()=>[x("时")])),_:1})])),_:1}),p(s,{class:"text-[24rpx] flex items-center"},{default:n((()=>[W.value.minutes?(o(),u(l,{key:0,class:"min-w-[30rpx] text-center"},{default:n((()=>[x(_(W.value.minutes>=10?W.value.minutes:"0"+W.value.minutes),1)])),_:1})):(o(),u(l,{key:1,class:"min-w-[30rpx] text-center"},{default:n((()=>[x("00")])),_:1})),p(l,{class:"text-[20rpx]"},{default:n((()=>[x("分")])),_:1})])),_:1}),p(s,{class:"text-[24rpx] flex items-center"},{default:n((()=>[W.value.seconds?(o(),u(l,{key:0,class:"min-w-[30rpx] text-center"},{default:n((()=>[x(_(W.value.seconds<10?"0"+W.value.seconds:W.value.seconds),1)])),_:1})):(o(),u(l,{key:1,class:"min-w-[30rpx] text-center"},{default:n((()=>[x("00")])),_:1})),p(l,{class:"text-[20rpx]"},{default:n((()=>[x("秒")])),_:1})])),_:1})])),_:1})])),_:1},8,["time"])])),_:1},8,["style"])):d("v-if",!0)])),_:1})),Q.value.length?(o(),u(s,{key:1,class:"marketing-list p-[20rpx] relative -mt-[50rpx]"},{default:n((()=>[(o(!0),i(m,null,v(Q.value,((e,a)=>(o(),u(s,{class:z(["bg-[#fff] flex rounded-[var(--rounded-mid)] p-[20rpx]",{"mb-[20rpx]":Q.value.length-1!=a}]),key:a,onClick:a=>{D({url:"/addon/shop/pages/goods/detail",param:{sku_id:e.goodsSku.sku_id,type:"newcomer_discount"}})}},{default:n((()=>[p(s,{class:"w-[250rpx] h-[250rpx] flex items-center justify-center"},{default:n((()=>[e.goods_cover?(o(),u(t,{key:0,class:"w-[250rpx] h-[250rpx] rounded-[var(--rounded-mid)]",src:c(T)(e.goods_cover_thumb_mid),mode:"aspectFill",onError:a=>e.goods_cover_thumb_mid="static/resource/images/diy/shop_default.jpg"},null,8,["src","onError"])):(o(),u(t,{key:1,class:"w-[250rpx] h-[250rpx] rounded-[var(--rounded-mid)]",src:c(T)("static/resource/images/diy/shop_default.jpg"),mode:"aspectFill"},null,8,["src"]))])),_:2},1024),p(s,{class:"flex flex-col flex-1 ml-[20rpx] pt-[4rpx]"},{default:n((()=>[p(s,{class:"text-[28rpx] multi-hidden leading-[1.3]"},{default:n((()=>[x(_(e.goods_name),1)])),_:2},1024),p(s,{class:"w-[400rpx] flex items-center justify-center"},{default:n((()=>[p(t,{class:"w-[400rpx] h-[106rpx] mt-[auto] mb-[10rpx]",src:c(T)("addon/shop/newcomer/subsidy.png"),mode:"aspectFit"},null,8,["src"])])),_:1}),p(s,{class:"flex items-center justify-center btn-wrap"},{default:n((()=>[p(s,{class:"flex items-center text-[#FFF3E0] relative z-4",style:f({background:"linear-gradient(to right, #FF8A04 0%, #ff1b1b 84%)"})},{default:n((()=>[p(l,{class:"text-[22rpx]"},{default:n((()=>[x("新人价")])),_:1}),p(l,{class:"text-[20rpx] ml-[6rpx] mr-[2rpx]"},{default:n((()=>[x("￥")])),_:1}),p(l,{class:"text-[36rpx] truncate max-w-[160rpx]"},{default:n((()=>[x(_(parseFloat(e.goodsSku.newcomer_price).toFixed(2)),1)])),_:2},1024)])),_:2},1032,["style"]),p(t,{class:"w-[26rpx] h-[54rpx]",src:c(T)("addon/shop/newcomer/btn_02.png"),mode:"heightFix"},null,8,["src"]),p(t,{class:"w-[84rpx] h-[54rpx] relative ml-[-5rpx] z-2",src:c(T)("addon/shop/newcomer/btn_03.png"),mode:"aspectFit"},null,8,["src"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):!Q.value.length&&$.value?(o(),u(P,{key:2,option:{tip:"暂无商品，请看看其他商品吧！",btnText:"去逛逛"},onEmptyclick:a[2]||(a[2]=e=>c(D)({url:"/addon/shop/pages/goods/list"}))})):d("v-if",!0)])),_:1},8,["onInit"])):d("v-if",!0),!q.value&&Object.keys(ae.value).length&&"active"!=ae.value.active_status?(o(),u(P,{key:1,option:{tip:"活动未开启,请看看其他商品吧！",btnText:"去逛逛"},onEmptyclick:a[3]||(a[3]=e=>c(D)({url:"/addon/shop/pages/index"}))})):d("v-if",!0),p(s,{onTouchmove:a[5]||(a[5]=g((()=>{}),["prevent","stop"]))},{default:n((()=>[p(I,{show:Z.value,onClose:ee,mode:"center",round:"var(--rounded-big)"},{default:n((()=>[p(s,{class:"w-[570rpx] px-[32rpx] popup-common center"},{default:n((()=>[p(s,{class:"title"},{default:n((()=>[x("活动规则")])),_:1}),ae.value.active_desc?(o(),u(h,{key:0,"scroll-y":!0,class:"px-[30rpx] box-border max-h-[260rpx]"},{default:n((()=>[(o(!0),i(m,null,v(ae.value.active_desc.split("\n"),(e=>(o(),u(s,{class:"text-[28rpx] leading-[40rpx] mb-[20rpx]"},{default:n((()=>[x(_(e),1)])),_:2},1024)))),256))])),_:1})):d("v-if",!0),p(s,{class:"btn-wrap !pt-[40rpx]"},{default:n((()=>[p(y,{class:"primary-btn-bg w-[480rpx] h-[70rpx] text-[26rpx] leading-[70rpx] rounded-[35rpx] !text-[#fff] font-500",onClick:a[4]||(a[4]=e=>Z.value=!1)},{default:n((()=>[x("我知道了")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1}),p(R,{loading:q.value},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-fbbd02ac"]]);export{G as default};
