import{d as e,r as a,p as t,a as r,o as s,c as o,w as l,b as i,u as d,O as n,a6 as u,P as p,f as c,n as m,a7 as _,a8 as f,t as x,i as v,a5 as h,g,h as b,Q as y,y as j,z as k,F as w,E as C,A as S,aS as z,c5 as M,D as U}from"./index-2882a2d8.js";import{_ as D}from"./u-icon.1104ad2f.js";import{_ as I}from"./u--image.d52c0594.js";import{_ as P}from"./u-code-input.d6deff6a.js";import{_ as E}from"./u-form-item.03ed7ff5.js";import{_ as F}from"./u--form.b2bc768e.js";import{_ as O}from"./u-modal.c146ecea.js";import{g as A,a as Q,b as R,T,f as B}from"./o2o.50b1eac4.js";import{c as L}from"./technician.dd4f2a12.js";import{M as N}from"./mescroll-body.e69cb222.js";import{M as W}from"./mescroll-empty.7f392528.js";import{u as Y}from"./useMescroll.26ccf5de.js";import{_ as $}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-image.46ebbbc1.js";import"./u-transition.4448d2e5.js";import"./u-line.d7ff94e2.js";/* empty css                                                               */import"./u-form.54744837.js";import"./u-loading-icon.a37f7e61.js";/* empty css                                                                       */import"./u-popup.2abbe959.js";import"./u-overlay.1a317a4e.js";import"./u-safe-bottom.f13b01b8.js";/* empty css                                                                */import"./mescroll-i18n.c2747603.js";/* empty css                                                                       */const q=$(e({__name:"list",setup(e){const{mescrollInit:$,downCallback:q,getMescroll:G}=Y(f,_);let H=a([]),J=a(!1),K=a(!1),V=a(""),X=a([]);t((e=>{V.value=e.order_status||"",Z()}));const Z=()=>{L().then((e=>{Object.keys(e.data).length?ee():r({url:"/addon/o2o/pages/index",mode:"reLaunch"})}))},ee=()=>{K.value=!0,X.value=[];X.value.push({name:"全部",status:""}),A().then((e=>{Object.values(e.data).forEach(((e,a)=>{X.value.push(e)})),K.value=!1})).catch((()=>{K.value=!1}))},ae=e=>{J.value=!1;let a={page:e.num,limit:e.size,order_status:V.value};Q(a).then((a=>{let t=a.data.data;1==e.num&&(H.value=[]),H.value=H.value.concat(t),e.endSuccess(t.length),J.value=!0})).catch((()=>{J.value=!0,e.endErr()}))};let te="";const re=e=>{M({title:"提示",content:"您确定要转单吗？",success:a=>{a.confirm&&T({order_id:e.order_id}).then((e=>{G().resetUpScroll()}))}})},se=a(!1),oe=a(""),le=e=>{oe.value=e},ie=()=>{if(""==oe.value)return void x({title:"请输入校验码",icon:"none",duration:1e3});let e={order_id:te,check_code:oe.value};R(e).then((e=>{se.value=!1,r({url:"/addon/o2o/pages/master/task/detail",param:{order_id:te}})})).catch((()=>{se.value=!1,r({url:"/addon/o2o/pages/master/task/detail",param:{order_id:te}})}))},de=e=>{B({order_id:e.order_id}).then((e=>{G().resetUpScroll()}))};return(e,a)=>{const t=v,_=h,f=U,x=g(b("u-icon"),D),M=g(b("u--image"),I),A=g(b("u-code-input"),P),Q=g(b("u-form-item"),E),R=g(b("u--form"),F),T=g(b("u-modal"),O);return s(),o(t,{style:m(e.themeColor())},{default:l((()=>[i(t,{class:"bg-[#f8f8f8] min-h-screen overflow-hidden"},{default:l((()=>[d(K)?c("v-if",!0):(s(),o(t,{key:0,class:"fixed left-0 top-0 right-0 z-10"},{default:l((()=>[i(_,{"scroll-x":"true",class:"scroll-Y box-border px-[24rpx] bg-white"},{default:l((()=>[i(t,{class:"flex whitespace-nowrap justify-around"},{default:l((()=>[(s(!0),n(p,null,u(d(X),(e=>(s(),o(t,{class:y(["text-sm leading-[90rpx]",{"class-select":d(V)===e.status.toString()}]),onClick:a=>{return t=e.status,V.value=t.toString(),H.value=[],void G().resetUpScroll();var t}},{default:l((()=>[j(k(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1})])),_:1})])),_:1})),i(N,{ref:"mescrollRef",top:"104rpx",onInit:d($),onDown:d(q),onUp:ae},{default:l((()=>[i(t,{class:"goods-wrap"},{default:l((()=>[(s(!0),n(p,null,u(d(H),((e,a)=>(s(),o(t,{key:a,class:"mb-[30rpx] bg-[#fff] rounded-md"},{default:l((()=>[i(t,{class:"goods-item",onClick:a=>{return t=e.order_id,void r({url:"/addon/o2o/pages/master/task/detail",param:{order_id:t}});var t}},{default:l((()=>[i(t,{class:"goods-head justify-between items-center"},{default:l((()=>[i(f,null,{default:l((()=>[j(k(d(w)("serviceDate"))+k(e.reserve_service_time),1)])),_:2},1024),i(f,{class:"text-[var(--primary-color)]"},{default:l((()=>[j(k(e.order_status_info.name),1)])),_:2},1024)])),_:2},1024),(s(!0),n(p,null,u(e.item,((e,a)=>(s(),o(t,{class:y({"mt-[20rpx]":a}),key:a},{default:l((()=>[i(t,{class:"order-goods-item flex"},{default:l((()=>[i(t,{class:"w-[160rpx] h-[160rpx] flex-2"},{default:l((()=>[i(M,{class:"rounded-[10rpx] overflow-hidden",width:"160rpx",height:"160rpx",src:d(C)(e.item_image?e.item_image:""),model:"aspectFill"},{error:l((()=>[i(x,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"])])),_:2},1024),i(t,{class:"ml-[20rpx] flex-1 flex flex-col justify-between"},{default:l((()=>[i(t,{class:"flex justify-between"},{default:l((()=>[i(f,{class:"max-h-[80rpx] w-[380rpx] text-[28rpx] leading-[40rpx] multi-hidden"},{default:l((()=>[j(k(e.item_name),1)])),_:2},1024),"custom"==e.item_type?(s(),o(f,{key:0,class:"shrink-0 ml-[10rpx] text-[24rpx] leading-[40rpx] text-[var(--primary-color)]"},{default:l((()=>[j(k(e.pay_time?d(w)("havePaid"):d(w)("notPaid")),1)])),_:2},1024)):c("v-if",!0)])),_:2},1024),i(t,{class:"text-[24rpx] mt-[20rpx] flex"},{default:l((()=>[i(f,{class:"text-[var(--primary-color)] rounded-[6rpx] py-[6rpx] bg-[var(--label-bg-color)] px-[10rpx]"},{default:l((()=>[j(k(e.item_type_name),1)])),_:2},1024)])),_:2},1024),i(t,{class:"text-[28rpx] mt-auto flex justify-between"},{default:l((()=>[i(f,{class:"px-[10rpx] py-[4rpx] text-[var(--price-text-color)] price-font"},{default:l((()=>[j("￥"+k(e.price),1)])),_:2},1024),i(f,{class:"text-[22rpx] ml-[20rpx]"},{default:l((()=>[j("x"+k(e.num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])))),128)),i(t,{class:"mt-[34rpx] flex justify-end"},{default:l((()=>[i(t,{class:"inline-block text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full",onClick:S((a=>{return t=e.taker_mobile,void z({phoneNumber:t});var t}),["stop"])},{default:l((()=>[j(k(d(w)("contact")),1)])),_:2},1032,["onClick"]),(s(!0),n(p,null,u(e.order_status_info.technician_action,((a,i)=>(s(),o(t,{key:i,class:"inline-block text-[26rpx] leading-[56rpx] px-[30rpx] border-[3rpx] border-solid border-[#999] rounded-full ml-[20rpx]",onClick:S((t=>{return s=e,void("transfer_order"==(o=a.key)?re(s):"start"==o?(te=s.order_id,se.value=!0):"finish"==o?de(s):"service_pay"==o&&r({url:"/addon/o2o/pages/master/task/add",param:{order_id:s.order_id}}));var s,o}),["stop"])},{default:l((()=>[j(k(a.name),1)])),_:2},1032,["onClick"])))),128))])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1}),!d(H).length&&d(J)?(s(),o(W,{key:0,option:{icon:d(C)("static/resource/images/empty.png"),tip:d(w)("nothingMore")}},null,8,["option"])):c("v-if",!0)])),_:1},8,["onInit","onDown"])])),_:1}),i(T,{show:se.value,showCancelButton:"true",onCancel:a[0]||(a[0]=e=>se.value=!1),onConfirm:ie,width:"500rpx"},{default:l((()=>[i(R,{labelPosition:"left",class:"!w-[100%]",labelWidth:"100rpx",labelStyle:{fontSize:"24rpx"}},{default:l((()=>[i(Q,{label:d(w)("checkCode")},{default:l((()=>[i(A,{maxlength:4,focus:!0,size:"50rpx",fontSize:"32rpx",onFinish:le})])),_:1},8,["label"])])),_:1})])),_:1},8,["show"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-b0bcc08d"]]);export{q as default};
