import{d as e,r as t,p as a,x as s,ah as o,o as l,c as r,w as c,b as n,f as i,A as u,y as x,n as d,P as h,a7 as p,Q as f,c3 as y,k as g,a as m,b5 as v,bb as _,D as S,a5 as C,i as k,z as b}from"./index-7bf68536.js";import{_ as H}from"./_plugin-vue_export-helper.1b428a4d.js";const V=H(e({__name:"search",setup(e){const H=t(""),V=t([]),j=t(!1);a((e=>{!uni.getStorageSync("goodsSearchHistory")&&uni.setStorageSync("goodsSearchHistory",[])})),s((()=>{z(),o((()=>{U()}))}));const z=()=>{V.value=uni.getStorageSync("goodsSearchHistory").reverse()},I=()=>{y({title:"提示",content:"确认删除全部历史记录？",confirmColor:g().themeColor["--primary-color"],success:e=>{e.confirm&&(uni.setStorageSync("goodsSearchHistory",[]),z())}})},R=()=>{let e=uni.getStorageSync("goodsSearchHistory"),t=[];e.length?(t=e.filter((e=>e!=H.value.trim())),t.push(H.value.trim())):t.push(H.value.trim()),uni.setStorageSync("goodsSearchHistory",t),m({url:"/addon/shop/pages/goods/list",param:{goods_name:encodeURIComponent(H.value)},mode:"navigateTo"})},U=()=>{v().in(this).select("#history-list").boundingClientRect((e=>{e&&e.height>2*_(70)+2*_(35)&&(j.value=!0)})).exec()};return(e,t)=>{const a=S,s=C,o=k;return l(),r(o,{style:d(e.themeColor())},{default:c((()=>[n(o,{class:"flex items-center px-[20rpx] h-[120rpx]"},{default:c((()=>[n(o,{class:"h-[68rpx] bg-[var(--temp-bg)] px-[30rpx] flex items-center rounded-[100rpx] flex-1"},{default:c((()=>[n(a,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[var(--text-color-light9)] text-[26rpx] mr-[18rpx]"}),n(s,{class:"text-[28rpx] flex-1",maxlength:"50",type:"text",modelValue:H.value,"onUpdate:modelValue":t[0]||(t[0]=e=>H.value=e),placeholder:"请搜索您想要的商品","confirm-type":"search",placeholderClass:"text-[var(--text-color-light9)] text-[28rpx]",onConfirm:R},null,8,["modelValue"]),H.value?(l(),r(a,{key:0,class:"nc-iconfont nc-icon-cuohaoV6xx1 text-[24rpx] text-[var(--text-color-light9)]",onClick:t[1]||(t[1]=e=>H.value="")})):i("v-if",!0)])),_:1}),n(a,{onClick:t[2]||(t[2]=u((e=>R()),["stop"])),class:"text-[26rpx] ml-[32rpx] -mb-[2rpx]"},{default:c((()=>[x("搜索")])),_:1})])),_:1}),n(o,{class:"search-content"},{default:c((()=>[i(" 历史搜索 "),V.value.length?(l(),r(o,{key:0,class:"history"},{default:c((()=>[n(o,{class:"history-box"},{default:c((()=>[n(o,{class:"history-top"},{default:c((()=>[n(o,{class:"title font-500"},{default:c((()=>[x("历史搜索")])),_:1}),n(o,{class:"icon nc-iconfont nc-icon-shanchu-yuangaizhiV6xx !text-[24rpx] text-[var(--text-color-light6)]",onClick:I})])),_:1}),n(o,{class:"history-bottom",id:"history-list",style:d({maxHeight:j.value?"148rpx":"100%"})},{default:c((()=>[(l(!0),h(f,null,p(V.value,((e,t)=>(l(),h(f,{key:t},[e?(l(),r(o,{key:0,class:"history-li",onClick:t=>{return a=e,H.value=a,void R();var a}},{default:c((()=>[n(o,null,{default:c((()=>[x(b(e),1)])),_:2},1024)])),_:2},1032,["onClick"])):i("v-if",!0)],64)))),128)),j.value?(l(),r(o,{key:0,class:"history-li history_more",onClick:t[3]||(t[3]=e=>j.value=!1)},{default:c((()=>[n(o,{class:"content-box"},{default:c((()=>[n(a,{class:"text-[30rpx] nc-iconfont nc-icon-xiaV6xx"})])),_:1})])),_:1})):i("v-if",!0)])),_:1},8,["style"])])),_:1})])),_:1})):i("v-if",!0)])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-df946775"]]);export{V as default};
