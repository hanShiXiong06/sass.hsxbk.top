import{d as ee,x as ae,n as G,r as I,f as te,h as g,c as k,e as l,w as r,a as i,t as p,u as o,i as u,q as s,P,c6 as C,b4 as E,s as T,A as se,B as w,R as f,bs as oe,_ as le,av as re,E as ne,J as ie,K as de,bM as pe,bN as me,L as ce,a0 as ue,aD as _e,aE as ge,I as he,aq as fe,aa as be,ac as ye,T as Pe,U as xe}from"./index-17984968.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                 *//* empty css                        *//* empty css                    *//* empty css                *//* empty css                *//* empty css                       *//* empty css                  *//* empty css                          *//* empty css                 */import"./el-form-item-4ed993c7.js";import{_ as R}from"./goods_default-995568ac.js";import{g as ve}from"./category-02c806c6.js";import{g as ke,d as Ce,c as Ee,f as Te}from"./goods-db78f22e.js";import{_ as we}from"./goods-spread-popup.vue_vue_type_script_setup_true_lang-8135b8cc.js";/* empty css                  *//* empty css                   */import"./browser-a1ac24ac.js";const Ve={class:"main-container"},Ne={class:"flex justify-between items-center"},$e={class:"text-page-title"},De={class:"region-input"},Ue=["placeholder"],Se=i("span",{class:"separator"},"-",-1),Be=["placeholder"],Ge={class:"region-input"},Ie=["placeholder"],Re=i("span",{class:"separator"},"-",-1),Le=["placeholder"],Me={class:"mt-[10px]"},ze={class:"flex items-center"},Fe={class:"w-[60px] max-h-[60px]"},je={class:"min-w-[60px] h-[60px] flex items-center justify-center"},Ke=i("div",{class:"image-slot"},[i("img",{class:"w-[60px] h-[60px]",src:R})],-1),Ye={key:1,class:"w-[60px] h-[60px]",src:R,fit:"contain"},qe={class:"ml-2"},He=["title"],Oe={key:0},Ae={key:1},Je={class:"mt-[16px] flex justify-end"},Na=ee({__name:"list",setup(Qe){const L=ae().meta.title,a=G({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{goods_name:"",goods_category:"",status:"",create_time:"",start_sale_num:"",end_sale_num:"",start_price:"",end_price:"",order:"",sort:""}}),$=I(),V=G([]);(async(n=null)=>{ve().then(t=>{const d=t.data;if(d){const y=[];d.forEach(m=>{const x=[];m.children&&m.children.forEach(v=>{x.push({value:v.category_id,label:v.category_name})}),y.push({value:m.category_id,label:m.category_name,children:x})}),V.splice(0,V.length,...y)}})})();const b={required:/[\S]+/,number:/^\d{0,10}$/,digit:/^\d{0,10}(.?\d{0,2})$/,special:/^\d{0,10}(.?\d{0,3})$/},c=(n=1)=>{if(a.searchParam.start_sale_num&&!b.digit.test(a.searchParam.start_sale_num)){f({type:"warning",message:`${s("startSaleNumTips")}`});return}if(a.searchParam.end_sale_num&&!b.digit.test(a.searchParam.end_sale_num)){f({type:"warning",message:`${s("endSaleNumTips")}`});return}if(Number(a.searchParam.start_sale_num)>Number(a.searchParam.end_sale_num)){f({type:"warning",message:`${s("o2oSaleNumTips")}`});return}if(a.searchParam.start_price&&!b.digit.test(a.searchParam.start_price)){f({type:"warning",message:`${s("startPriceTips")}`});return}if(a.searchParam.end_price&&!b.digit.test(a.searchParam.end_price)){f({type:"warning",message:`${s("endPriceTips")}`});return}if(Number(a.searchParam.start_price)>Number(a.searchParam.end_price)){f({type:"warning",message:`${s("o2oPriceTips")}`});return}a.loading=!0,a.page=n;const t=oe(a.searchParam);ke({page:a.page,limit:a.limit,...t}).then(d=>{a.loading=!1,a.data=d.data.data,a.total=d.data.total}).catch(()=>{a.loading=!1})};c();const D=te(),M=n=>{let t="";n.order=="ascending"?t="asc":n.order=="descending"&&(t="desc"),t&&(a.searchParam.order=n.prop,a.searchParam.sort=t),c()},z=()=>{D.push("/o2o/goods/edit")},F=n=>{D.push("/o2o/goods/edit?id="+n.goods_id)},U=I(null),j=n=>{U.value.show(n)},K=n=>{le.confirm(s("o2oGoodsDeleteTips"),s("warning"),{confirmButtonText:s("confirm"),cancelButtonText:s("cancel"),type:"warning"}).then(()=>{Ce(n).then(()=>{c()}).catch(()=>{})})},S=(n,t)=>{Ee({goods_id:n.goods_id,status:t}).then(()=>{c()})},Y=re((n,t)=>{if(isNaN(n)||!b.number.test(n)){f({type:"warning",message:`${s("sortTips")}`});return}Te({goods_id:t.goods_id,sort:n}).then(d=>{})}),q=n=>{a.searchParam.status=n,c()},H=n=>{n&&(n.resetFields(),a.searchParam.end_sale_num="",a.searchParam.end_price="",c())};return(n,t)=>{const d=ne,y=ie,m=de,x=pe,v=me,O=ce,B=ue,N=_e,A=ge,J=he,Q=fe,h=be,W=ye,X=Pe,Z=xe;return g(),k("div",Ve,[l(B,{class:"box-card !border-none",shadow:"never"},{default:r(()=>[i("div",Ne,[i("span",$e,p(o(L)),1),l(d,{type:"primary",class:"w-[100px]",onClick:z},{default:r(()=>[u(p(o(s)("addGoods")),1)]),_:1})]),l(B,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:r(()=>[l(O,{inline:!0,model:a.searchParam,ref_key:"searchFormRef",ref:$},{default:r(()=>[l(m,{label:o(s)("goodsName"),prop:"goods_name"},{default:r(()=>[l(y,{modelValue:a.searchParam.goods_name,"onUpdate:modelValue":t[0]||(t[0]=e=>a.searchParam.goods_name=e),modelModifiers:{trim:!0},placeholder:o(s)("goodsNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(m,{label:o(s)("categoryId"),prop:"goods_category"},{default:r(()=>[l(x,{class:"input-width",modelValue:a.searchParam.goods_category,"onUpdate:modelValue":t[1]||(t[1]=e=>a.searchParam.goods_category=e),options:V,clearable:"",props:{value:"value",label:"label",emitPath:!1}},null,8,["modelValue","options"])]),_:1},8,["label"]),l(m,{label:o(s)("createTime"),prop:"create_time"},{default:r(()=>[l(v,{modelValue:a.searchParam.create_time,"onUpdate:modelValue":t[2]||(t[2]=e=>a.searchParam.create_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":o(s)("startDate"),"end-placeholder":o(s)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(m,{label:o(s)("saleNum"),prop:"start_sale_num"},{default:r(()=>[i("div",De,[P(i("input",{type:"text",placeholder:o(s)("startSaleNumPlaceholder"),maxlength:"10","onUpdate:modelValue":t[3]||(t[3]=e=>a.searchParam.start_sale_num=e),onKeyup:t[4]||(t[4]=e=>o(C)(e))},null,40,Ue),[[E,a.searchParam.start_sale_num]]),Se,P(i("input",{type:"text",placeholder:o(s)("endSaleNumPlaceholder"),maxlength:"10","onUpdate:modelValue":t[5]||(t[5]=e=>a.searchParam.end_sale_num=e),onKeyup:t[6]||(t[6]=e=>o(C)(e))},null,40,Be),[[E,a.searchParam.end_sale_num]])])]),_:1},8,["label"]),l(m,{label:o(s)("skuPrice"),prop:"start_price"},{default:r(()=>[i("div",Ge,[P(i("input",{type:"text",placeholder:o(s)("startPricePlaceholder"),maxlength:"10","onUpdate:modelValue":t[7]||(t[7]=e=>a.searchParam.start_price=e),onKeyup:t[8]||(t[8]=e=>o(C)(e))},null,40,Ie),[[E,a.searchParam.start_price]]),Re,P(i("input",{type:"text",placeholder:o(s)("endPricePlaceholder"),maxlength:"10","onUpdate:modelValue":t[9]||(t[9]=e=>a.searchParam.end_price=e),onKeyup:t[10]||(t[10]=e=>o(C)(e))},null,40,Le),[[E,a.searchParam.end_price]])])]),_:1},8,["label"]),l(m,null,{default:r(()=>[l(d,{type:"primary",onClick:t[11]||(t[11]=e=>c())},{default:r(()=>[u(p(o(s)("search")),1)]),_:1}),l(d,{onClick:t[12]||(t[12]=e=>H($.value))},{default:r(()=>[u(p(o(s)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(A,{modelValue:a.searchParam.status,"onUpdate:modelValue":t[13]||(t[13]=e=>a.searchParam.status=e),class:"goods-tabs",onTabChange:q},{default:r(()=>[l(N,{label:o(s)("all"),name:""},null,8,["label"]),l(N,{label:o(s)("statusOn"),name:"1"},null,8,["label"]),l(N,{label:o(s)("statusOff"),name:"0"},null,8,["label"])]),_:1},8,["modelValue"]),i("div",Me,[P((g(),T(W,{data:a.data,size:"large",ref:"goodsListTableRef",onSortChange:M},{empty:r(()=>[i("span",null,p(a.loading?"":o(s)("emptyData")),1)]),default:r(()=>[l(h,{label:o(s)("goodsInfo"),"show-overflow-tooltip":!0,"min-width":"240",align:"left"},{default:r(({row:e})=>[i("div",ze,[i("div",Fe,[i("div",je,[e.goods_cover?(g(),T(J,{key:0,class:"w-[60px] h-[60px]",src:o(se)(e.goods_cover),fit:"contain"},{error:r(()=>[Ke]),_:2},1032,["src"])):(g(),k("img",Ye))])]),i("div",qe,[i("div",null,[i("a",{href:"javascript:;",class:"flex-1 multi-hidden",title:e.goods_name},p(e.goods_name),9,He)]),i("div",null,[l(Q,null,{default:r(()=>[u(p(e.buy_type_name),1)]),_:2},1024)])])])]),_:1},8,["label"]),l(h,{prop:"price",label:o(s)("price"),"min-width":"120",sortable:"custom"},{default:r(({row:e})=>[i("span",null,"ï¿¥"+p(e.price),1)]),_:1},8,["label"]),l(h,{prop:"sale_num",label:o(s)("saleNum"),"min-width":"120",sortable:"custom"},null,8,["label"]),l(h,{prop:"status",label:o(s)("status"),"min-width":"120"},{default:r(({row:e})=>[e.status==1?(g(),k("span",Oe,p(o(s)("tooUp")),1)):w("",!0),e.status==0?(g(),k("span",Ae,p(o(s)("tooDown")),1)):w("",!0)]),_:1},8,["label"]),l(h,{prop:"sort",label:o(s)("sort"),"min-width":"120",sortable:"custom"},{default:r(({row:e})=>[l(y,{modelValue:e.sort,"onUpdate:modelValue":_=>e.sort=_,class:"!w-[70px]",maxlength:"10",onInput:_=>o(Y)(_,e)},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1},8,["label"]),l(h,{prop:"create_time",label:o(s)("createTime"),"min-width":"150"},null,8,["label"]),l(h,{label:o(s)("operation"),fixed:"right",align:"right","min-width":"240"},{default:r(({row:e})=>[l(d,{type:"primary",link:"",onClick:_=>j(e)},{default:r(()=>[u(p(o(s)("spreadGoods")),1)]),_:2},1032,["onClick"]),e.status==0?(g(),T(d,{key:0,type:"primary",link:"",onClick:_=>S(e,1)},{default:r(()=>[u(p(o(s)("up")),1)]),_:2},1032,["onClick"])):w("",!0),e.status==1?(g(),T(d,{key:1,type:"primary",link:"",onClick:_=>S(e,0)},{default:r(()=>[u(p(o(s)("down")),1)]),_:2},1032,["onClick"])):w("",!0),l(d,{type:"primary",link:"",onClick:_=>F(e)},{default:r(()=>[u(p(o(s)("edit")),1)]),_:2},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:_=>K(e.goods_id)},{default:r(()=>[u(p(o(s)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[Z,a.loading]]),i("div",Je,[l(X,{"current-page":a.page,"onUpdate:current-page":t[14]||(t[14]=e=>a.page=e),"page-size":a.limit,"onUpdate:page-size":t[15]||(t[15]=e=>a.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:a.total,onSizeChange:t[16]||(t[16]=e=>c()),onCurrentChange:c},null,8,["current-page","page-size","total"])])])]),_:1}),l(we,{ref_key:"goodsSpreadPopupRef",ref:U},null,512)])}}});export{Na as default};
