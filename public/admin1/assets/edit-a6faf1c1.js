import{d as fe,bB as ge,x as xe,f as he,r as h,n as J,a5 as be,bs as we,Y as ye,h as c,c as g,e as l,w as i,a,t as m,u as o,q as s,F as C,Q as D,s as w,i as $,B as k,aX as Q,v as Ce,V as M,aY as K,A as ke,_ as ee,au as oe,X as Ve,ak as ze,aI as Te,E as Ee,bD as Pe,by as Me,bz as Ie,S as Se,ab as qe,K as Be,bx as De,bt as $e,az as Ue,aA as Ne,L as je,a0 as Fe,a1 as Le,p as Re,g as Oe}from"./index-17984968.js";/* empty css                  *//* empty css                   *//* empty css                *//* empty css                *//* empty css                       *//* empty css                 *//* empty css                        *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                     *//* empty css                         */import{_ as Ae}from"./index.vue_vue_type_script_setup_true_lang-8e50df98.js";/* empty css               *//* empty css                  *//* empty css                  *//* empty css                */import{_ as Xe}from"./edit-draw-80ba7b43.js";import{_ as Ye}from"./edit-headimg-452b63dd.js";import{_ as Ge}from"./edit-image-fa493005.js";import{_ as He}from"./edit-nickname-6a58a79d.js";import{_ as We}from"./edit-page-94ba9cad.js";import{_ as Ze}from"./edit-qrcode-d4a90492.js";import{_ as Je}from"./edit-text-877eca70.js";import{_ as Qe}from"./preview-draw-c18cc57d.js";import{_ as Ke}from"./preview-headimg-acb9e431.js";import{_ as eo}from"./preview-image-22a56cde.js";import{_ as oo}from"./preview-nickname-df582507.js";import{_ as to}from"./preview-qrcode-25e52155.js";import{_ as no}from"./preview-text-4c2fbd4d.js";import{_ as lo}from"./edit-goods-image-34cf6b44.js";import{_ as ao}from"./edit-goods-market-price-9ef0e3d0.js";import{_ as so}from"./edit-goods-name-d8c96bb5.js";import{_ as io}from"./edit-goods-price-acb3ba18.js";import{_ as ro}from"./preview-goods-image-5308c27a.js";import{_ as po}from"./preview-goods-market-price-6b399580.js";import{_ as co}from"./preview-goods-name-c9802b75.js";import{_ as mo}from"./preview-goods-price-9cb3a9fc.js";import{u as uo}from"./poster-12fdd106.js";import{i as _o,g as vo,e as fo,a as go,b as xo}from"./poster-bfb8b509.js";import{_ as ho}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-0ce1f7fc.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-c5bcb8a9.js";import"./attachment-a816d3ef.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-8693344a.js";/* empty css                      *//* empty css                    *//* empty css                 *//* empty css                 *//* empty css               *//* empty css               *//* empty css                    *//* empty css                         */import"./index.vue_vue_type_script_setup_true_lang-5615c67a.js";/* empty css                   */import"./sortable.esm-be94e56d.js";/* empty css                  */import"./default_headimg-a897263d.js";import"./goods_default-664bb559.js";const O=I=>(Re("data-v-20efc807"),I=I(),Oe(),I),bo={class:"main-container flex-1"},wo={class:"pl-[5px] text-[14px]"},yo={class:"text-white ml-[10px] mr-[20px] flex items-center"},Co=O(()=>a("span",{class:"mr-[5px] text-[rgba(255,255,255,.5)]"},"｜",-1)),ko={class:"mr-[5px] text-[14px]"},Vo={class:"text-white mr-[10px] text-base"},zo=O(()=>a("div",{class:"flex-1"},null,-1)),To={class:"full-container flex flex-row flex-1 bg-page"},Eo={class:"component-list w-[290px]"},Po={class:"flex flex-row flex-wrap"},Mo=["title","onClick"],Io={class:"block text-[12px] truncate"},So={class:"preview-wrap flex-1 relative mt-[20px]"},qo={class:"diy-view-wrap w-[360px] shadow-lg mx-auto"},Bo={class:"content-wrap"},Do={class:"title-wrap text-center text-[14px]"},$o={class:"preview-block relative"},Uo={class:"quick-action absolute text-center -right-[70px] top-[20px] w-[42px] rounded shadow-md"},No=["id","onMousedown","onClick"],jo=["onMousedown"],Fo=["onMousedown"],Lo=["onMousedown"],Ro=["onMousedown"],Oo={class:"edit-attribute-wrap w-[400px]"},Ao={class:"card-header flex justify-between items-center"},Xo={class:"title flex-1"},Yo={class:"edit-component-wrap"},Go={class:"edit-attr-item-wrap"},Ho={class:"mb-[10px]"},Wo=O(()=>a("div",{class:"my-[10px]"},null,-1)),Zo={class:"ml-[92px] mb-[18px] text-sm text-gray-400"},Jo={key:0},Qo=["src"],Ko=fe({__name:"edit",setup(I){ge("setLayout")("decorate");const e=uo(),_=xe(),te=he();_.query.id=_.query.id||0,_.query.type=_.query.type||"",_.query.name=_.query.name||"",_.query.back=_.query.back||"/site/poster/list";const S=_.query.back,q=h(""),A=h(""),V=h([]),X=J([]);h("");const Y=h(X),ne=p=>{},le=h(!0),ae=()=>{le.value?(location.href=`${location.origin}${S}`,te.push(S)):ee.confirm(s("leavePageTitleTips"),s("leavePageContentTips"),{confirmButtonText:s("confirm"),cancelButtonText:s("cancel"),type:"warning",autofocus:!1}).then(()=>{location.href=`${location.origin}${S}`}).catch(()=>{})},G=Object.assign({"./components/edit-draw.vue":Xe,"./components/edit-headimg.vue":Ye,"./components/edit-image.vue":Ge,"./components/edit-nickname.vue":He,"./components/edit-page.vue":We,"./components/edit-qrcode.vue":Ze,"./components/edit-text.vue":Je,"./components/preview-draw.vue":Qe,"./components/preview-headimg.vue":Ke,"./components/preview-image.vue":eo,"./components/preview-nickname.vue":oo,"./components/preview-qrcode.vue":to,"./components/preview-text.vue":no}),H=Object.assign({"/src/addon/shop/views/poster/components/edit-goods-image.vue":lo,"/src/addon/shop/views/poster/components/edit-goods-market-price.vue":ao,"/src/addon/shop/views/poster/components/edit-goods-name.vue":so,"/src/addon/shop/views/poster/components/edit-goods-price.vue":io,"/src/addon/shop/views/poster/components/preview-goods-image.vue":ro,"/src/addon/shop/views/poster/components/preview-goods-market-price.vue":po,"/src/addon/shop/views/poster/components/preview-goods-name.vue":co,"/src/addon/shop/views/poster/components/preview-goods-price.vue":mo});H&&Object.assign(G,H);const U={};for(const[p,t]of Object.entries(G)){const r=p.split("/").pop().split(".")[0];U[r]=t.default}const z=J([]),se=()=>{vo({addon:e.addon,type:e.type}).then(p=>{p.data&&z.splice(0,z.length,...p.data)})};be(()=>q.value,(p,t)=>{A.value=t});const ie=p=>{if(e.value.length)ee.confirm(s("changeTemplatePosterTips"),s("warning"),{confirmButtonText:s("confirm"),cancelButtonText:s("cancel"),type:"warning"}).then(()=>{if(e.changeCurrentIndex(-99),p!==""){let t=z[p].data;e.global=t.global,t.value.length&&(e.value=t.value)}else e.init()}).catch(()=>{q.value=A.value});else if(p!==""){let t=z[p].data;e.global=t.global,t.value.length&&(e.value=t.value)}else e.init()};_o({id:_.query.id,type:_.query.type,name:_.query.name}).then(async p=>{const t=p.data;if(e.init(),e.id=t.id,e.name=t.name,e.channel=t.channel,e.status=t.status,e.isDefault=t.is_default,e.addon=t.addon,e.type=t.type,e.typeName=t.poster_type.name,t.value){const v=t.value;e.global=v.global,v.value.length&&(e.value=v.value)}V.value=t.component;for(const v in V.value){X.push(v);for(const r in V.value[v].list){const f=we(V.value[v].list[r]);f.id=e.generateRandom(),f.componentName=r,f.componentTitle=f.title,delete f.title,delete f.icon,e.components.push(f)}}se()});const b=h(!1),re=p=>{if(!e.verify()||b.value)return;b.value=!0,e.value.forEach((r,f)=>{const T=document.getElementById(r.id);if(T&&(r.width=T.offsetWidth,r.height=T.offsetHeight,r.type=="draw")){let E=[r.x*2,r.y*2],F=[(r.x+r.width)*2,r.y*2],x=[(r.x+r.width)*2,(r.y+r.height)*2],L=[r.x*2,(r.y+r.height)*2];r.points=[E,F,x,L]}delete r.verify});let t={id:e.id,name:e.name,type:e.type,status:e.status,is_default:e.isDefault,channel:e.channel,addon:e.addon,value:JSON.stringify({global:oe(e.global),value:oe(e.value)})};(e.id?fo:go)(t).then(r=>{b.value=!1,r.code==1&&(e.id?b.value=!1:location.href=`${location.origin}${S}`,p&&p(r.data.id))}).catch(()=>{b.value=!1})},N=h(!1),j=h(""),pe=()=>{b.value||(b.value=!0,xo({id:e.id,type:e.type}).then(p=>{p.data&&(j.value=p.data,N.value=!0),b.value=!1}))};return(p,t)=>{const v=ye("ArrowLeft"),r=Ve,f=ze,T=Te,E=Ee,F=Pe,x=Ae,L=Me,ce=Ie,R=Se,P=qe,y=Be,B=De,W=$e,de=Ue,me=Ne,ue=je,_e=Fe,ve=Le;return c(),g("div",bo,[l(F,{class:"flex items-center h-[60px] bg-primary px-[20px]"},{default:i(()=>[a("div",{class:"text-white cursor-pointer flex items-center",onClick:ae},[l(r,{size:"14"},{default:i(()=>[l(v)]),_:1}),a("span",wo,m(o(s)("back")),1)]),a("div",yo,[Co,a("span",ko,m(o(s)("decorating"))+"："+m(o(e).typeName),1)]),a("div",null,[a("span",Vo,m(o(s)("templatePosterPlaceholder")),1),l(T,{size:"small",modelValue:q.value,"onUpdate:modelValue":t[0]||(t[0]=n=>q.value=n),class:"w-[180px]",placeholder:o(s)("templatePosterPlaceholder"),onChange:ie},{default:i(()=>[l(f,{label:o(s)("templatePosterEmpty"),value:""},null,8,["label"]),(c(!0),g(C,null,D(z,(n,u)=>(c(),w(f,{label:n.name,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),zo,o(e).id?(c(),w(E,{key:0,onClick:t[1]||(t[1]=n=>pe())},{default:i(()=>[$(m(o(s)("preview")),1)]),_:1})):k("",!0),l(E,{onClick:t[2]||(t[2]=n=>re())},{default:i(()=>[$(m(o(s)("save")),1)]),_:1})]),_:1}),a("div",To,[a("div",Eo,[l(R,{class:"px-[10px]"},{default:i(()=>[l(ce,{modelValue:Y.value,"onUpdate:modelValue":t[3]||(t[3]=n=>Y.value=n),onChange:ne},{default:i(()=>[(c(!0),g(C,null,D(V.value,(n,u)=>(c(),w(L,{key:u,title:n.title,name:u},{default:i(()=>[a("ul",Po,[(c(!0),g(C,null,D(n.list,(d,Z)=>(c(),g("li",{key:Z,class:"w-2/6 text-center cursor-pointer h-[65px]",title:d.title,onClick:ot=>o(e).addComponent(Z,d)},[d.icon?(c(),w(x,{key:0,name:d.icon,size:"20px",class:"inline-block mt-[3px]"},null,8,["name"])):(c(),w(x,{key:1,name:"iconfont-iconkaifazujian",size:"20px",class:"inline-block mt-[3px]"})),a("span",Io,m(d.title),1)],8,Mo))),128))])]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])]),_:1})]),a("div",So,[l(R,null,{default:i(()=>[l(E,{class:"page-btn absolute right-[20px]",onClick:t[4]||(t[4]=n=>o(e).changeCurrentIndex(-99))},{default:i(()=>[$(m(o(s)("posterSet")),1)]),_:1}),a("div",qo,[a("div",{class:"preview-head bg-no-repeat bg-center bg-cover cursor-pointer h-[64px]",onClick:t[5]||(t[5]=n=>o(e).changeCurrentIndex(-99))},[a("div",Bo,[a("div",Do,m(o(e).name),1)])]),a("div",$o,[a("ul",Uo,[l(P,{effect:"light",content:o(s)("moveUpComponentZIndex"),placement:"right"},{default:i(()=>[l(x,{name:"iconfont-iconjiantoushang",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).moveUpComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:o(s)("moveDownComponentZIndex"),placement:"right"},{default:i(()=>[l(x,{name:"iconfont-iconjiantouxia",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).moveDownComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:o(s)("copyComponent"),placement:"right"},{default:i(()=>[l(x,{name:"iconfont-iconcopy-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).copyComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:o(s)("delComponent"),placement:"right"},{default:i(()=>[l(x,{name:"iconfont-icondelete-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).delComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:o(s)("resetComponent"),placement:"right"},{default:i(()=>[l(x,{name:"iconfont-iconloader-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:o(e).resetComponent},null,8,["onClick"])]),_:1},8,["content"])]),a("div",{class:"preview-iframe",style:Q(o(e).getGlobalStyle()),onClick:t[6]||(t[6]=n=>o(e).changeCurrentIndex(-99))},[(c(!0),g(C,null,D(o(e).value,(n,u)=>(c(),g("div",{class:Ce(["item-wrap area-box select-none max-w-[360px] cursor-move",{selected:o(e).currentIndex==u}]),id:n.id,key:n.id,style:Q({top:n.y+"px",left:n.x+"px",zIndex:n.zIndex,transform:"rotate("+n.angle+"deg)"}),onMousedown:d=>o(e).mouseDown(d,n.id,u),onClick:M(d=>o(e).changeCurrentIndex(u,n),["stop"])},[(c(),w(K(U["preview-"+n.path]),{value:n},null,8,["value"])),a("span",{class:"box1",onMousedown:M(d=>o(e).resizeMouseDown(d,n,u),["stop"])},null,40,jo),a("span",{class:"box2",onMousedown:M(d=>o(e).resizeMouseDown(d,n,u),["stop"])},null,40,Fo),a("span",{class:"box3",onMousedown:M(d=>o(e).resizeMouseDown(d,n,u),["stop"])},null,40,Lo),a("span",{class:"box4",onMousedown:M(d=>o(e).resizeMouseDown(d,n,u),["stop"])},null,40,Ro)],46,No))),128))],4)])])]),_:1})]),a("div",Oo,[l(R,null,{default:i(()=>[l(_e,{class:"box-card",shadow:"never"},{header:i(()=>[a("div",Ao,[a("span",Xo,m(o(e).currentIndex==-99?o(s)("posterSet"):o(e).editComponent.componentTitle),1)])]),default:i(()=>[a("div",Yo,[o(e).currentComponent?(c(),w(K(U[o(e).currentComponent]),{key:0,value:o(e).value[o(e).currentIndex]},{common:i(()=>[a("div",Go,[a("h3",Ho,m(o(s)("componentStyleTitle")),1),l(ue,{"label-width":"80px",class:"px-[10px]"},{default:i(()=>[l(y,{label:o(s)("zIndex")},{default:i(()=>[a("span",null,m(o(e).editComponent.zIndex),1)]),_:1},8,["label"]),l(y,{label:o(s)("coordinate")},{default:i(()=>[l(B,{modelValue:o(e).editComponent.x,"onUpdate:modelValue":t[7]||(t[7]=n=>o(e).editComponent.x=n),"show-input":"",size:"small",class:"ml-[10px]",min:0,max:o(e).getMaxX()},null,8,["modelValue","max"]),Wo,l(B,{modelValue:o(e).editComponent.y,"onUpdate:modelValue":t[8]||(t[8]=n=>o(e).editComponent.y=n),"show-input":"",size:"small",class:"ml-[10px]",min:0,max:o(e).getMaxY()},null,8,["modelValue","max"])]),_:1},8,["label"]),a("div",Zo,m(o(s)("coordinateTips")),1),o(e).editComponent.type=="text"?(c(),g(C,{key:0},[l(y,{label:o(s)("textFontSize")},{default:i(()=>[l(B,{modelValue:o(e).editComponent.fontSize,"onUpdate:modelValue":t[9]||(t[9]=n=>o(e).editComponent.fontSize=n),"show-input":"",size:"small",class:"ml-[10px]",min:14,max:36},null,8,["modelValue"])]),_:1},8,["label"]),l(y,{label:o(s)("textColor")},{default:i(()=>[l(W,{modelValue:o(e).editComponent.fontColor,"onUpdate:modelValue":t[10]||(t[10]=n=>o(e).editComponent.fontColor=n)},null,8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0),o(e).editComponent.type=="image"?(c(),w(y,{key:1,label:o(s)("width")},{default:i(()=>[l(B,{modelValue:o(e).editComponent.width,"onUpdate:modelValue":t[11]||(t[11]=n=>o(e).editComponent.width=n),"show-input":"",size:"small",class:"ml-[10px]",min:30,max:o(e).getMaxWidth()},null,8,["modelValue","max"])]),_:1},8,["label"])):k("",!0),o(e).editComponent.type=="draw"?(c(),g(C,{key:2},[l(y,{label:o(s)("drawType")},{default:i(()=>[l(me,{modelValue:o(e).editComponent.drawType,"onUpdate:modelValue":t[12]||(t[12]=n=>o(e).editComponent.drawType=n)},{default:i(()=>[l(de,{label:"Polygon"},{default:i(()=>[$(m(o(s)("polygon")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(y,{label:o(s)("bgColor")},{default:i(()=>[l(W,{modelValue:o(e).editComponent.bgColor,"onUpdate:modelValue":t[13]||(t[13]=n=>o(e).editComponent.bgColor=n)},null,8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0)]),_:1})])]),_:1},8,["value"])):k("",!0)])]),_:1})]),_:1})])]),l(ve,{modelValue:N.value,"onUpdate:modelValue":t[14]||(t[14]=n=>N.value=n),title:o(s)("previewDialogTitle"),width:"400px",height:"640px"},{default:i(()=>[j.value?(c(),g("div",Jo,[a("img",{src:o(ke)(j.value),class:"w-[360px] h-[640px]"},null,8,Qo)])):k("",!0)]),_:1},8,["modelValue","title"])])}}});const vn=ho(Ko,[["__scopeId","data-v-20efc807"]]);export{vn as default};
