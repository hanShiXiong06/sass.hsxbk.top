import{d as de,x as ce,f as pe,r as f,n as _e,l as fe,q as l,h as c,c as P,e as s,w as o,a as u,t as m,u as a,i as p,F as w,Q as D,s as L,P as ge,A as ve,cV as be,bp as U,B as N,R as he,bs as xe,_ as O,E as ye,J as ke,K as Pe,ak as Le,aI as Ce,bN as Ve,L as Ee,a0 as Fe,aa as Ae,I as we,ac as De,T as Se,a1 as Te,U as Re}from"./index-17984968.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                        *//* empty css                        *//* empty css                *//* empty css                *//* empty css                       *//* empty css                  */import"./el-form-item-4ed993c7.js";import{_ as Y}from"./default_headimg-a897263d.js";import{g as Be,c as je,f as $e,h as ze,i as Ie,j as M}from"./agent-d310b69a.js";import{_ as Ue}from"./fenxiao-of-select-popup.vue_vue_type_script_setup_true_lang-91e983de.js";import"./fenxiao-75a63893.js";const Ne={class:"main-container"},Oe={class:"flex justify-between items-center"},Me={class:"text-page-title"},Ye=["onClick"],qe={class:"min-w-[50px] h-[50px] flex items-center justify-center"},He=u("div",{class:"image-slot"},[u("img",{class:"w-[50px] h-[50px]",src:Y})],-1),Je={key:1,class:"w-[50px] h-[50px]",src:Y,fit:"contain"},Ke={class:"ml-2"},Qe=["title"],Ge={class:"text-primary text-[12px]"},We={class:"cursor-pointer price-wrap"},Xe={class:"mt-[16px] flex justify-end"},Ze={key:0,class:"mr-[10px]"},ea={class:"dialog-footer"},Aa=de({__name:"list",setup(aa){const q=ce(),S=pe(),H=q.meta.title,T=f();let C=f([]),E=!1;const R=(n=!1)=>{if(E)return!1;E=!0,Be().then(t=>{let i=[];C.value=[],t.data.length&&(t.data.forEach((g,v)=>{let b={};b.label=g.name,b.value=g.level_id,i.push(b)}),C.value=i),E=!1,n&&he({message:l("refreshSuccess"),type:"success"})})};R(),f("");let F=f([]);(()=>{je().then(n=>{let t=[];if(F.value=[],Object.keys(n.data).length){for(let i in n.data){let g={};g.label=n.data[i],g.value=i,t.push(g)}F.value=t}})})();const J=n=>{n&&(r.searchParam.search="",r.searchParam.agent_level="",r.searchParam.agent_time=[],r.searchParam.agent_status="",n.resetFields(),h())},r=_e({page:1,limit:10,total:0,loading:!1,data:[],searchParam:{search:"",agent_level:"",agent_time:[],agent_status:""}}),h=(n=1)=>{r.loading=!0,r.page=n;const t=xe(r.searchParam);$e({page:r.page,limit:r.limit,...t}).then(i=>{r.data=i.data.data,r.total=i.data.total,r.loading=!1})};h();const B=f(null),K=()=>{const n=S.resolve({path:"/shop_fenxiao/agent/level/config"});window.open(n.href)};let j=f(),_=f(!1),k=f(!1),d=f({agent_level:"",member_id:"",member_name:"",status:""});const Q=()=>{B.value.show()},G=n=>{d.value.member_name=n.member.nickname||n.member.username,d.value.member_id=n.member_id},W=fe(()=>({member_id:[{required:!0,message:l("selectFenxiaoPlaceholder"),trigger:"blur"}],agent_level:[{required:!0,message:l("selectAgentLevelPlaceholder"),trigger:"blur"}]})),X=()=>{d.value.agent_level="",d.value.member_id="",d.value.member_name="",_.value=!0,k.value=!1},Z=n=>{d.value.agent_level=n.agentLevel.level_id,d.value.member_id=n.member_id,d.value.member_name=n.member.nickname||n.member.username,_.value=!0,k.value=!0};let V=f(!1);const ee=async n=>{V.value||!n||await n.validate(async t=>{if(t){V.value=!0;const i=d.value;(k.value?ze:Ie)(i).then(v=>{V.value=!1,_.value=!1,h()}).catch(()=>{V.value=!1})}})};let x=!1,ae=n=>{n.agent_status==1?te(n.member_id):ne(n.member_id)};const te=n=>{O.confirm(l("freezeAgentTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{if(x)return;x=!0;let t={};t.member_id=n,t.status=2,M(t).then(()=>{h(),x=!1}).catch(()=>{x=!1})})},le=n=>{let t=S.resolve(`/shop_fenxiao/detail?id=${n}`);window.open(t.href," blank")},ne=n=>{O.confirm(l("normalAgentTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{if(x)return;x=!0;let t={};t.member_id=n,t.status=1,M(t).then(()=>{h(),x=!1}).catch(()=>{x=!1})})};return(n,t)=>{const i=ye,g=ke,v=Pe,b=Le,A=Ce,se=Ve,$=Ee,z=Fe,y=Ae,oe=we,re=De,ie=Se,me=Te,ue=Re;return c(),P("div",Ne,[s(z,{class:"card !border-none",shadow:"never"},{default:o(()=>[u("div",Oe,[u("span",Me,m(a(H)),1),s(i,{type:"primary",onClick:X},{default:o(()=>[p(m(a(l)("addAgent")),1)]),_:1})]),s(z,{class:"card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:o(()=>[s($,{inline:!0,model:r.searchParam,ref_key:"searchFormRef",ref:T},{default:o(()=>[s(v,{label:a(l)("memberInfo")},{default:o(()=>[s(g,{modelValue:r.searchParam.search,"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchParam.search=e),placeholder:a(l)("fenxiaoNamePlaceholder"),maxlength:"60"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(v,{label:a(l)("agentLevel")},{default:o(()=>[s(A,{modelValue:r.searchParam.agent_level,"onUpdate:modelValue":t[1]||(t[1]=e=>r.searchParam.agent_level=e),placeholder:a(l)("selectAgentLevelPlaceholder")},{default:o(()=>[s(b,{label:a(l)("all"),value:""},null,8,["label"]),(c(!0),P(w,null,D(a(C),e=>(c(),L(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(v,{label:a(l)("fenxiaoState")},{default:o(()=>[s(A,{modelValue:r.searchParam.agent_status,"onUpdate:modelValue":t[2]||(t[2]=e=>r.searchParam.agent_status=e),placeholder:a(l)("fenxiaoStatePlaceholder")},{default:o(()=>[s(b,{label:a(l)("all"),value:""},null,8,["label"]),(c(!0),P(w,null,D(a(F),e=>(c(),L(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(v,{label:a(l)("createTime")},{default:o(()=>[s(se,{modelValue:r.searchParam.agent_time,"onUpdate:modelValue":t[3]||(t[3]=e=>r.searchParam.agent_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":a(l)("startDate"),"end-placeholder":a(l)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),s(v,null,{default:o(()=>[s(i,{type:"primary",onClick:t[4]||(t[4]=e=>h())},{default:o(()=>[p(m(a(l)("search")),1)]),_:1}),s(i,{onClick:t[5]||(t[5]=e=>J(T.value))},{default:o(()=>[p(m(a(l)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),ge((c(),L(re,{data:r.data,size:"large",ref:"goodsListTableRef"},{empty:o(()=>[u("span",null,m(r.loading?"":a(l)("emptyData")),1)]),default:o(()=>[s(y,{type:"selection",width:"55"}),s(y,{prop:"fenxiao_info",label:a(l)("fenxiaoInfo"),"min-width":"200"},{default:o(({row:e})=>[u("div",{class:"flex items-center cursor-pointer",onClick:I=>le(e.member_id)},[u("div",qe,[e.member&&e.member.headimg?(c(),L(oe,{key:0,class:"w-[50px] h-[50px]",src:a(ve)(e.member.headimg),fit:"contain"},{error:o(()=>[He]),_:2},1032,["src"])):(c(),P("img",Je))]),u("div",Ke,[u("span",{title:e.member&&e.member.nickname,class:"multi-hidden"},m(e.member&&e.member.nickname||e.member&&e.member.username),9,Qe),u("span",Ge,m(e.member&&e.member.mobile),1)])],8,Ye)]),_:1},8,["label"]),s(y,{label:a(l)("agentLevel"),"min-width":"120"},{default:o(({row:e})=>[u("div",We,[u("span",null,m(e.agentLevel?e.agentLevel.name:"--"),1)])]),_:1},8,["label"]),s(y,{prop:"agent_commission",label:a(l)("agentCommission"),"min-width":"100"},{default:o(({row:e})=>[p(m(a(be)(e.agent_commission)),1)]),_:1},8,["label"]),s(y,{prop:"create_time",label:a(l)("createTime"),"min-width":"120"},{default:o(({row:e})=>[p(m(e.agent_time||"--"),1)]),_:1},8,["label"]),s(y,{prop:"sort",label:a(l)("currentState"),"min-width":"100"},{default:o(({row:e})=>[p(m(e.agent_status_name),1)]),_:1},8,["label"]),s(y,{label:a(l)("operation"),fixed:"right",align:"right","min-width":"120"},{default:o(({row:e})=>[s(i,{type:"primary",link:"",onClick:I=>Z(e)},{default:o(()=>[p(m(a(l)("edit")),1)]),_:2},1032,["onClick"]),s(i,{type:"primary",link:"",onClick:I=>a(ae)(e)},{default:o(()=>[p(m(e.agent_status==1?a(l)("freeze"):a(l)("normal")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[ue,r.loading]]),u("div",Xe,[s(ie,{"current-page":r.page,"onUpdate:current-page":t[6]||(t[6]=e=>r.page=e),"page-size":r.limit,"onUpdate:page-size":t[7]||(t[7]=e=>r.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:r.total,onSizeChange:t[8]||(t[8]=e=>h()),onCurrentChange:h},null,8,["current-page","page-size","total"])])]),_:1}),s(me,{modelValue:a(_),"onUpdate:modelValue":t[13]||(t[13]=e=>U(_)?_.value=e:_=e),title:a(k)?a(l)("editAgent"):a(l)("addAgent"),width:"450px","close-on-press-escape":!1,"destroy-on-close":!0,"close-on-click-modal":!1},{footer:o(()=>[u("span",ea,[s(i,{onClick:t[11]||(t[11]=e=>U(_)?_.value=!1:_=!1)},{default:o(()=>[p(m(a(l)("cancel")),1)]),_:1}),s(i,{type:"primary",onClick:t[12]||(t[12]=e=>ee(a(j)))},{default:o(()=>[p(m(a(l)("confirm")),1)]),_:1})])]),default:o(()=>[s($,{ref_key:"agentInfoRef",ref:j,model:a(d),rules:a(W),"label-width":"110px"},{default:o(()=>[s(v,{label:a(l)("fenxiao"),prop:a(k)?"":"member_id"},{default:o(()=>[a(d).member_name?(c(),P("span",Ze,m(a(d).member_name),1)):N("",!0),a(k)?N("",!0):(c(),L(i,{key:1,type:"primary",onClick:Q},{default:o(()=>[p(m(a(l)("selectFenxiao")),1)]),_:1}))]),_:1},8,["label","prop"]),s(v,{label:a(l)("agentLevel"),prop:"agent_level"},{default:o(()=>[s(A,{modelValue:a(d).agent_level,"onUpdate:modelValue":t[9]||(t[9]=e=>a(d).agent_level=e),placeholder:a(l)("selectAgentLevelPlaceholder")},{default:o(()=>[(c(!0),P(w,null,D(a(C),e=>(c(),L(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),u("span",{class:"text-[var(--el-color-primary)] ml-[10px] cursor-pointer",onClick:t[10]||(t[10]=e=>R(!0))},"刷新"),u("span",{class:"text-[var(--el-color-primary)] ml-[10px] cursor-pointer",onClick:K},"添加")]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),s(Ue,{ref_key:"fenxiaoOfSelectPopupRef",ref:B,title:a(l)("fenxiaoSelectPricePopupTitle"),params:{is_agent:0},onLoad:G},null,8,["title"])])}}});export{Aa as default};
