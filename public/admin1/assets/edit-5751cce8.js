import{d as me,x as ye,f as fe,r as h,n as J,l as Q,q as a,P as H,h as d,c as u,a as y,u as r,t as _,e as l,w as s,F as D,Q as E,s as b,i as g,bZ as ge,c6 as X,B as S,v as ve,aD as he,aE as we,J as be,K as ke,c_ as Ve,L as Ce,a0 as Pe,E as xe,c$ as De,az as Ee,aA as Ue,bN as Te,a1 as $e,U as Re,p as Se,g as qe}from"./index-17984968.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                       *//* empty css                 *//* empty css                    *//* empty css                         *//* empty css                *//* empty css                */import{_ as Ne}from"./index.vue_vue_type_script_setup_true_lang-a8924ef7.js";import Fe from"./index-0ce1f7fc.js";/* empty css                     */import"./el-form-item-4ed993c7.js";/* empty css                    */import{a0 as Me,a1 as Ye,a2 as Be,a3 as Le,a4 as je,a5 as We}from"./tourism-ed22e76b.js";import{_ as ze}from"./_plugin-vue_export-helper-c27b6911.js";import"./index.vue_vue_type_style_index_0_lang-c5bcb8a9.js";import"./attachment-a816d3ef.js";import"./index.vue_vue_type_script_setup_true_lang-8693344a.js";/* empty css                        *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                      *//* empty css                    *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css               *//* empty css                    */import"./index.vue_vue_type_script_setup_true_lang-5615c67a.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-8e50df98.js";/* empty css                */import"./sortable.esm-be94e56d.js";const q=U=>(Se("data-v-54c81806"),U=U(),qe(),U),Ie={class:"main-container"},Ae={class:"detail-head"},Ke=q(()=>y("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1)),Oe={class:"ml-[1px]"},Ze=q(()=>y("span",{class:"adorn"},"|",-1)),Ge={key:0,class:"right"},Je={key:1,class:"right"},Qe={key:0},He={class:"fixed-footer-wrap"},Xe={class:"fixed-footer"},et={key:1},tt=["onClick"],at={key:0},lt={class:"text-right text-gray-400 text-[14px] mt-[15px]"},ot={key:1},rt=q(()=>y("p",{class:"text-right text-gray-400 text-[14px] mt-[15px]"},"0.00￥",-1)),st=[rt],dt={key:1,class:"w-full h-full"},it={class:"text-gray-400"},nt={key:0},ut={class:"text-right text-gray-400 text-[14px] mt-[15px]"},ct={key:1},pt=q(()=>y("p",{class:"text-right text-gray-400 text-[14px] mt-[15px]"},"0.00￥",-1)),_t=[pt],mt={class:"dialog-footer"},yt=me({__name:"edit",setup(U){const ee=ye(),te=fe(),N=parseInt(ee.query.id),k=h(!1),V=h("first"),L={way_id:0,way_name:"",start_city:"",end_city:"",way_character:"",fee_desc:"",group_buy_type:"",way_theme:"",travel_type:"",way_traffic:"",goods_id:0,stock:"",goods_cover:"",goods_image:"",price:"",buy_info:""},o=J({...L}),j=h([]);(async()=>{j.value=await(await Me()).data.data})();const T=(n,e)=>{o[n]==e?o[n]="":o[n]=e};N&&(async(n=0)=>{Object.assign(o,L);const e=await(await Ye(n)).data;Object.keys(o).forEach(i=>{e[i]!=null&&(o[i]=e[i])}),e.goods&&Object.keys(o).forEach(i=>{e.goods[i]!=null&&(o[i]=e.goods[i])}),o.way_id=n,I(o.goods_id)})(N);const W=h(),ae=(n,e,i)=>{const P=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/;e===""?i(new Error(a("wayPricePlaceholder"))):parseFloat(e)===0?i(new Error(a("wayPricePlaceholder1"))):parseFloat(e)>9999999999e-2?i(new Error(a("pricePlaceholder3"))):P.test(e)?i():i(new Error(a("wayPricePlaceholder2")))},le=(n,e,i)=>{o.goods_cover==""?i(new Error(a("wayCoverPlaceholder"))):i()},oe=Q(()=>({way_name:[{required:!0,message:a("wayTitlePlaceholder"),trigger:"blur"}],goods_cover:[{required:!0,validator:le,trigger:"blur"}],stock:[{required:!0,message:a("wayStockPlaceholder"),trigger:"blur"}],price:[{required:!0,validator:ae,trigger:"blur"}],start_city:[{required:!0,message:a("startCityPlaceholder"),trigger:"blur"}],end_city:[{required:!0,message:a("endCityPlaceholder"),trigger:"blur"}]})),re=async n=>{k.value||!n||await n.validate(async e=>{if(e){k.value=!0;const i=o;(o.way_id?Be:Le)(i).then(f=>{k.value=!1,f.code>=0&&o.way_id==0?(o.way_id=f.data.way_id,o.goods_id=f.data.goods_id,V.value="second"):history.back()}).catch(()=>{k.value=!1})}})},se=()=>{history.back()},de=n=>{const e=parseInt(new Date().getTime()/1e3)+"",i=parseInt(new Date(n.day).getTime()/1e3)+"";return e-60*60*24<i},C=h(!1),ie=n=>{C.value=!0,c.start_date=n.day,c.is_set=1,c.price="",c.end_date="",v.value[n.day]&&(c.price=v.value[n.day].price)},c=J({is_set:1,start_date:"",end_date:"",price:""}),F=h(!1),z=h(),ne=Q(()=>({price:[{required:!0,message:a("saleArrPricePlaceholder"),trigger:"blur"},{trigger:"blur",validator:(n,e,i)=>{e<=0?i(new Error(a("saleArrPriceNotZeroTips"))):i()}}]})),ue=async n=>{F.value||!n||await n.validate(async e=>{e&&(F.value=!0,c.goods_id=o.goods_id,je(c).then(i=>{I(o.goods_id),C.value=!1,F.value=!1}))})},v=h([]),I=(n=0)=>{We({goods_id:n}).then(e=>{v.value=e.data})};return(n,e)=>{const i=he,P=we,f=be,p=ke,$=Ve,A=Fe,M=Ne,K=Ce,Y=Pe,R=xe,ce=De,O=Ee,pe=Ue,Z=Te,_e=$e,G=Re;return H((d(),u("div",Ie,[y("div",Ae,[y("div",{class:"left",onClick:e[0]||(e[0]=t=>r(te).push({path:"/tourism/product/way/way"}))},[Ke,y("span",Oe,_(r(a)("returnToPreviousPage")),1),Ze,r(N)?(d(),u("span",Ge,_(r(a)("editWay")),1)):(d(),u("span",Je,_(r(a)("addWay")),1))])]),l(Y,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[l(P,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),class:"demo-tabs"},{default:s(()=>[l(i,{label:r(a)("basicData"),name:"first"},null,8,["label"]),l(i,{label:r(a)("priceCalendar"),name:"second",disabled:!o.way_id},null,8,["label","disabled"])]),_:1},8,["modelValue"]),V.value=="first"?(d(),u("div",Qe,[l(Y,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[l(K,{model:o,"label-width":"90px",ref_key:"formRef",ref:W,rules:r(oe),class:"page-form"},{default:s(()=>[l(p,{label:r(a)("wayName"),prop:"way_name"},{default:s(()=>[l(f,{modelValue:o.way_name,"onUpdate:modelValue":e[2]||(e[2]=t=>o.way_name=t),modelModifiers:{trim:!0},clearable:"",placeholder:r(a)("wayNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),(d(!0),u(D,null,E(j.value,(t,x)=>(d(),u("div",{key:x},[x=="group_buy_type"?(d(),b(p,{key:0,label:r(a)("groupBuyType")},{default:s(()=>[(d(!0),u(D,null,E(t,(w,m)=>(d(),u("span",{key:m},[l($,{style:{"margin-right":"8px"},checked:m==o.group_buy_type,onChange:B=>T("group_buy_type",m)},{default:s(()=>[g(_(w),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"])):x=="travel_type"?(d(),b(p,{key:1,label:r(a)("travelType")},{default:s(()=>[(d(!0),u(D,null,E(t,(w,m)=>(d(),u("span",{key:m},[l($,{style:{"margin-right":"8px"},checked:m==o.travel_type,onChange:B=>T("travel_type",m)},{default:s(()=>[g(_(w),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"])):x=="way_theme"?(d(),b(p,{key:2,label:r(a)("wayTheme")},{default:s(()=>[(d(!0),u(D,null,E(t,(w,m)=>(d(),u("span",{key:m},[l($,{style:{"margin-right":"8px"},checked:m==o.way_theme,onChange:B=>T("way_theme",m)},{default:s(()=>[g(_(w),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"])):(d(),b(p,{key:3,label:r(a)("wayTraffic")},{default:s(()=>[(d(!0),u(D,null,E(t,(w,m)=>(d(),u("span",{key:m},[l($,{style:{"margin-right":"8px"},checked:m==o.way_traffic,onChange:B=>T("way_traffic",m)},{default:s(()=>[g(_(w),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"]))]))),128)),l(p,{label:r(a)("wayCover"),prop:"goods_cover"},{default:s(()=>[l(A,{modelValue:o.goods_cover,"onUpdate:modelValue":e[3]||(e[3]=t=>o.goods_cover=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(p,{label:r(a)("wayImages"),prop:"goods_images"},{default:s(()=>[l(A,{modelValue:o.goods_image,"onUpdate:modelValue":e[4]||(e[4]=t=>o.goods_image=t),limit:"10"},null,8,["modelValue"])]),_:1},8,["label"]),l(p,{label:r(a)("wayStock"),prop:"stock"},{default:s(()=>[l(f,{modelValue:o.stock,"onUpdate:modelValue":e[5]||(e[5]=t=>o.stock=t),modelModifiers:{trim:!0},clearable:"",placeholder:r(a)("wayStockPlaceholder"),class:"input-width",onKeyup:e[6]||(e[6]=t=>r(ge)(t))},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:r(a)("wayPrice"),prop:"price"},{default:s(()=>[l(f,{modelValue:o.price,"onUpdate:modelValue":e[7]||(e[7]=t=>o.price=t),modelModifiers:{trim:!0},clearable:"",placeholder:r(a)("wayPricePlaceholder"),class:"input-width",onKeyup:e[8]||(e[8]=t=>r(X)(t))},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:r(a)("startCity"),prop:"start_city"},{default:s(()=>[l(f,{modelValue:o.start_city,"onUpdate:modelValue":e[9]||(e[9]=t=>o.start_city=t),modelModifiers:{trim:!0},clearable:"",placeholder:r(a)("startCityPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:r(a)("endCity"),prop:"end_city"},{default:s(()=>[l(f,{modelValue:o.end_city,"onUpdate:modelValue":e[10]||(e[10]=t=>o.end_city=t),modelModifiers:{trim:!0},clearable:"",placeholder:r(a)("endCityPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:r(a)("buyDesc")},{default:s(()=>[l(M,{modelValue:o.buy_info,"onUpdate:modelValue":e[11]||(e[11]=t=>o.buy_info=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(p,{label:r(a)("feeDesc")},{default:s(()=>[l(M,{modelValue:o.fee_desc,"onUpdate:modelValue":e[12]||(e[12]=t=>o.fee_desc=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(p,{label:r(a)("wayCharacter")},{default:s(()=>[l(M,{modelValue:o.way_character,"onUpdate:modelValue":e[13]||(e[13]=t=>o.way_character=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1}),y("div",He,[y("div",Xe,[l(R,{type:"primary",onClick:e[14]||(e[14]=t=>re(W.value))},{default:s(()=>[g(_(r(a)("save")),1)]),_:1}),l(R,{onClick:e[15]||(e[15]=t=>se())},{default:s(()=>[g(_(r(a)("returnToPreviousPage")),1)]),_:1})])])])):S("",!0),V.value=="second"?(d(),u("div",et,[l(Y,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[l(ce,null,{"date-cell":s(({data:t})=>[de(t)==!0?(d(),u("div",{key:0,class:ve(["w-full h-full",t.isSelected?"is-selected":""]),onClick:x=>ie(t)},[y("p",null,_(t.day.split("-").slice(1).join("-")),1),v.value&&v.value[t.day]?(d(),u("div",at,[y("p",lt,_(v.value[t.day].price)+"￥",1)])):(d(),u("div",ot,st))],10,tt)):(d(),u("div",dt,[y("p",it,_(t.day.split("-").slice(1).join("-")),1),v.value&&v.value[t.day]?(d(),u("div",nt,[y("p",ut,_(v.value[t.day].price)+"￥",1)])):(d(),u("div",ct,_t))]))]),_:1})]),_:1})])):S("",!0)]),_:1}),l(_e,{modelValue:C.value,"onUpdate:modelValue":e[23]||(e[23]=t=>C.value=t),title:r(a)("editPrice"),width:"400px","destroy-on-close":!0},{footer:s(()=>[y("span",mt,[l(R,{onClick:e[21]||(e[21]=t=>C.value=!1)},{default:s(()=>[g(_(r(a)("cancel")),1)]),_:1}),l(R,{type:"primary",onClick:e[22]||(e[22]=t=>ue(z.value))},{default:s(()=>[g(_(r(a)("confirm")),1)]),_:1})])]),default:s(()=>[H((d(),b(K,{model:c,"label-width":"90px",ref_key:"formRulesRef",ref:z,rules:r(ne),class:"page-form"},{default:s(()=>[l(p,{label:r(a)("daySetting"),class:"items-center"},{default:s(()=>[l(pe,{modelValue:c.is_set,"onUpdate:modelValue":e[16]||(e[16]=t=>c.is_set=t),class:"ml-4 input-width"},{default:s(()=>[l(O,{label:1,size:"large"},{default:s(()=>[g(_(c.start_date),1)]),_:1}),l(O,{label:2,size:"large"},{default:s(()=>[g(_(r(a)("dateRange")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),c.is_set==2?(d(),b(p,{key:0,label:r(a)("startDate"),class:"input-width"},{default:s(()=>[l(Z,{type:"date",modelValue:c.start_date,"onUpdate:modelValue":e[17]||(e[17]=t=>c.start_date=t),placeholder:r(a)("startDate"),"value-format":"YYYY-MM-DD"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):S("",!0),c.is_set==2?(d(),b(p,{key:1,label:r(a)("endDate"),class:"input-width"},{default:s(()=>[l(Z,{type:"date",modelValue:c.end_date,"onUpdate:modelValue":e[18]||(e[18]=t=>c.end_date=t),placeholder:r(a)("endDate"),"value-format":"YYYY-MM-DD"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):S("",!0),l(p,{label:r(a)("wayPrice"),class:"input-width",prop:"price"},{default:s(()=>[l(f,{modelValue:c.price,"onUpdate:modelValue":e[19]||(e[19]=t=>c.price=t),clearable:"",placeholder:r(a)("wayPricePlaceholder"),class:"input-width",onKeyup:e[20]||(e[20]=t=>r(X)(t))},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[G,k.value]])]),_:1},8,["modelValue","title"])])),[[G,k.value]])}}});const sa=ze(yt,[["__scopeId","data-v-54c81806"]]);export{sa as default};
