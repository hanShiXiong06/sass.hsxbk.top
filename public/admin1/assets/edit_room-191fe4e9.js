import{d as _e,x as fe,f as ge,r as b,n as L,l as O,q as t,h as m,c as _,a as u,u as l,t as p,e as s,w as d,c6 as A,bZ as Z,F as G,Q as J,s as P,i as v,B as D,v as be,P as ve,aD as he,aE as ye,J as xe,K as Ve,c_ as we,L as ke,a0 as Pe,E as De,c$ as Ce,az as Ee,aA as Re,bN as Fe,a1 as Ue,U as Ie,p as Ne,g as Se}from"./index-17984968.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                       *//* empty css                 *//* empty css                    *//* empty css                         *//* empty css                *//* empty css                */import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-a8924ef7.js";import Te from"./index-0ce1f7fc.js";/* empty css                     */import"./el-form-item-4ed993c7.js";/* empty css                    */import{i as $e,j as qe,k as je,l as ze,r as Ye,m as Be}from"./tourism-ed22e76b.js";import{_ as Ke}from"./_plugin-vue_export-helper-c27b6911.js";import"./index.vue_vue_type_style_index_0_lang-c5bcb8a9.js";import"./attachment-a816d3ef.js";import"./index.vue_vue_type_script_setup_true_lang-8693344a.js";/* empty css                        *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                      *//* empty css                    *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css               *//* empty css                    */import"./index.vue_vue_type_script_setup_true_lang-5615c67a.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-8e50df98.js";/* empty css                */import"./sortable.esm-be94e56d.js";const C=w=>(Ne("data-v-738eff11"),w=w(),Se(),w),Le={class:"main-container"},Oe={class:"detail-head"},Ae=C(()=>u("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1)),Ze={class:"ml-[1px]"},Ge=C(()=>u("span",{class:"adorn"},"|",-1)),Je={key:0,class:"right"},Qe={key:1,class:"right"},He={key:0},We={class:"w-full"},Xe={class:"text-[12px] text-[#999]"},eo={class:"text-[12px] text-[#999] pl-2"},oo={class:"text-[12px] text-[#999] pl-2"},to={class:"text-[12px] text-[#999] pl-2"},lo={class:"fixed-footer-wrap"},ao={class:"fixed-footer"},so={key:1},ro=["onClick"],io={key:0},no={class:"text-right text-gray-400 text-[14px] mt-[15px]"},uo={key:1},mo=C(()=>u("p",{class:"text-right text-gray-400 text-[14px] mt-[15px]"},"0.00￥",-1)),po=[mo],co={key:1},_o={class:"text-gray-400"},fo={key:0},go={class:"text-right text-gray-400 text-[14px] mt-[15px]"},bo={key:1},vo=C(()=>u("p",{class:"text-right text-gray-400 text-[14px] mt-[15px]"},"0.00￥",-1)),ho=[vo],yo={class:"dialog-footer"},xo=_e({__name:"edit_room",setup(w){const I=fe(),Q=ge(),N=parseInt(I.query.hotel_id),E=parseInt(I.query.id),h=b(!1),y=b("first"),H=i=>{const e=parseInt(new Date().getTime()/1e3)+"",r=parseInt(new Date(i.day).getTime()/1e3)+"";return e-60*60*24<r},x=b(!1),W=i=>{n.start_date=i.day,n.is_set=1,n.end_date="",n.price="",x.value=!0,g.value[i.day]&&(n.price=g.value[i.day].price)},n=L({is_set:1,start_date:"",end_date:"",price:""}),S={goods_id:0,hotel_id:0,goods_name:"",goods_type:"",goods_no:"",goods_image:"",goods_cover:"",buy_content:"",goods_content:"",goods_attribute:[],price:"",is_vip:0,stock:"",room_bed:"",room_area:"",room_stay:"",room_floor:"",buy_info:"",image_thumb_small:""},a=L({...S});E&&(async(i=0)=>{Object.assign(a,S);const e=await(await $e(i)).data;Object.keys(a).forEach(r=>{e[r]!=null&&r!="goods_attribute"&&(a[r]=e[r]),r=="goods_attribute"&&e[r]!=null&&(a[r]=e[r].split(",")),r=="image_thumb_small"&&e[r]!=null&&(a[r]=e[r].join(","))}),a.goods_id=i,$(a.goods_id)})(E);const M=b(),X=(i,e,r)=>{const V=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/;e===""?r(new Error(t("pricePlaceholder"))):parseFloat(e)===0?r(new Error(t("pricePlaceholder1"))):parseFloat(e)>9999999999e-2?r(new Error(t("pricePlaceholder3"))):V.test(e)?r():r(new Error(t("pricePlaceholder2")))},ee=O(()=>({goods_name:[{required:!0,message:t("goodsNamePlaceholder"),trigger:"blur"}],stock:[{required:!0,message:t("stockPlaceholder"),trigger:"blur"}],goods_cover:[{required:!0,message:t("goodsCoverPlaceholder"),trigger:"blur"}],price:[{required:!0,validator:X,trigger:"blur"}],goods_image:[{required:!0,validator:oe,trigger:"blur"}]})),oe=(i,e,r)=>{a.goods_cover==""?r(new Error(t("goodsImagePlaceholder"))):r()},te=async i=>{h.value||!i||await i.validate(async e=>{if(e){h.value=!0,typeof a.goods_attribute=="object"&&(a.goods_attribute=a.goods_attribute.join(",")),a.hotel_id=N;const r=a;(a.goods_id?qe:je)(r).then(f=>{f.code>=0&&a.goods_id==0?(a.goods_id=f.data.id,y.value="second"):history.back(),h.value=!1}).catch(()=>{h.value=!1})}})},R=b(!1),T=b(),le=O(()=>({price:[{required:!0,message:t("saleArrPricePlaceholder"),trigger:"blur"},{trigger:"blur",validator:(i,e,r)=>{e<=0?r(new Error(t("saleArrPriceNotZeroTips"))):parseFloat(e)>9999999999e-2?r(new Error(t("pricePlaceholder3"))):r()}}]})),ae=async i=>{R.value||!i||await i.validate(async e=>{e&&(R.value=!0,n.goods_id=a.goods_id,ze(n).then(r=>{$(a.goods_id),x.value=!1,R.value=!1}))})},se=()=>{history.back()},g=b([]),$=(i=0)=>{Ye({goods_id:i}).then(e=>{g.value=e.data})},q=b([]);(()=>{Be().then(i=>{q.value=i.data})})();const re=i=>{a.goods_attribute.length<=0?a.goods_attribute.push(i):a.goods_attribute.indexOf(i)!=-1?a.goods_attribute.splice(a.goods_attribute.indexOf(i),1):a.goods_attribute.push(i)};return(i,e)=>{const r=he,V=ye,f=xe,c=Ve,de=we,ie=Te,j=Me,z=ke,F=Pe,k=De,ne=Ce,Y=Ee,ue=Re,B=Fe,me=Ue,pe=Ie;return m(),_("div",Le,[u("div",Oe,[u("div",{class:"left",onClick:e[0]||(e[0]=o=>l(Q).push(`/tourism/product/hotel/room?id=${l(N)}`))},[Ae,u("span",Ze,p(l(t)("returnToPreviousPage")),1)]),Ge,l(E)?(m(),_("span",Je,p(l(t)("editRoom")),1)):(m(),_("span",Qe,p(l(t)("addRoom")),1))]),s(F,{class:"box-card !border-none",shadow:"never"},{default:d(()=>[s(V,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=o=>y.value=o),class:"demo-tabs"},{default:d(()=>[s(r,{label:l(t)("basicData"),name:"first"},null,8,["label"]),s(r,{label:l(t)("priceCalendar"),name:"second",disabled:!a.goods_id},null,8,["label","disabled"])]),_:1},8,["modelValue"]),y.value=="first"?(m(),_("div",He,[s(F,{class:"box-card !border-none",shadow:"never"},{default:d(()=>[s(z,{model:a,"label-width":"180px",ref_key:"formRef",ref:M,rules:l(ee),class:"page-form"},{default:d(()=>[s(c,{label:l(t)("goodsName"),prop:"goods_name"},{default:d(()=>[s(f,{modelValue:a.goods_name,"onUpdate:modelValue":e[2]||(e[2]=o=>a.goods_name=o),modelModifiers:{trim:!0},clearable:"",placeholder:l(t)("goodsNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(c,{label:l(t)("price"),prop:"price"},{default:d(()=>[u("div",We,[s(f,{modelValue:a.price,"onUpdate:modelValue":e[3]||(e[3]=o=>a.price=o),modelModifiers:{trim:!0},clearable:"",placeholder:l(t)("pricePlaceholder"),class:"input-width",onKeyup:e[4]||(e[4]=o=>l(A)(o))},null,8,["modelValue","placeholder"])]),u("div",Xe,p(l(t)("priceIllustrate")),1)]),_:1},8,["label"]),s(c,{label:l(t)("stock"),prop:"stock"},{default:d(()=>[s(f,{modelValue:a.stock,"onUpdate:modelValue":e[5]||(e[5]=o=>a.stock=o),modelModifiers:{trim:!0},clearable:"",placeholder:l(t)("stockPlaceholder"),class:"input-width",onKeyup:e[6]||(e[6]=o=>l(Z)(o))},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),(m(!0),_(G,null,J(q.value,(o,K)=>(m(),P(c,{label:o.name,key:K},{default:d(()=>[(m(!0),_(G,null,J(o.attr,(U,ce)=>(m(),_("span",{key:ce},[s(de,{style:{"margin-right":"8px"},checked:a.goods_attribute.indexOf(U[0])!=-1,onChange:ko=>re(U[0])},{default:d(()=>[v(p(U[0]),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"]))),128)),s(c,{label:l(t)("bedSize")},{default:d(()=>[s(f,{modelValue:a.room_bed,"onUpdate:modelValue":e[7]||(e[7]=o=>a.room_bed=o),modelModifiers:{trim:!0},clearable:"",placeholder:l(t)("bedSizePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),u("span",eo,p(l(t)("roomBedFormat")),1)]),_:1},8,["label"]),s(c,{label:l(t)("roomSize")},{default:d(()=>[s(f,{modelValue:a.room_area,"onUpdate:modelValue":e[8]||(e[8]=o=>a.room_area=o),modelModifiers:{trim:!0},placeholder:l(t)("roomSizePlaceholder"),class:"input-width",onKeyup:e[9]||(e[9]=o=>l(Z)(o))},{append:d(()=>[v("㎡")]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(c,{label:l(t)("memberNum")},{default:d(()=>[s(f,{modelValue:a.room_stay,"onUpdate:modelValue":e[10]||(e[10]=o=>a.room_stay=o),modelModifiers:{trim:!0},clearable:"",placeholder:l(t)("memberNumPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),u("span",oo,p(l(t)("roomStayFormat")),1)]),_:1},8,["label"]),s(c,{label:l(t)("floor")},{default:d(()=>[s(f,{modelValue:a.room_floor,"onUpdate:modelValue":e[11]||(e[11]=o=>a.room_floor=o),modelModifiers:{trim:!0},clearable:"",placeholder:l(t)("floorPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),u("span",to,p(l(t)("roomFloorFormat")),1)]),_:1},8,["label"]),s(c,{label:l(t)("goodsImage"),prop:"goods_image"},{default:d(()=>[s(ie,{modelValue:a.goods_cover,"onUpdate:modelValue":e[12]||(e[12]=o=>a.goods_cover=o)},null,8,["modelValue"])]),_:1},8,["label"]),s(c,{label:l(t)("goodsContent")},{default:d(()=>[s(j,{modelValue:a.goods_content,"onUpdate:modelValue":e[13]||(e[13]=o=>a.goods_content=o)},null,8,["modelValue"])]),_:1},8,["label"]),s(c,{label:l(t)("buyDesc")},{default:d(()=>[s(j,{modelValue:a.buy_info,"onUpdate:modelValue":e[14]||(e[14]=o=>a.buy_info=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1}),u("div",lo,[u("div",ao,[s(k,{type:"primary",onClick:e[15]||(e[15]=o=>te(M.value))},{default:d(()=>[v(p(l(t)("save")),1)]),_:1}),s(k,{onClick:e[16]||(e[16]=o=>se())},{default:d(()=>[v(p(l(t)("returnToPreviousPage")),1)]),_:1})])])])):D("",!0),y.value=="second"?(m(),_("div",so,[s(F,{class:"box-card !border-none",shadow:"never"},{default:d(()=>[s(ne,{ref:"calendar"},{"date-cell":d(({data:o})=>[H(o)==!0?(m(),_("div",{key:0,class:be(["w-full h-full",o.isSelected?"is-selected":""]),onClick:K=>W(o)},[u("p",null,p(o.day.split("-").slice(1).join("-")),1),g.value&&g.value[o.day]?(m(),_("div",io,[u("p",no,p(g.value[o.day].price)+"￥",1)])):(m(),_("div",uo,po))],10,ro)):(m(),_("div",co,[u("p",_o,p(o.day.split("-").slice(1).join("-")),1),g.value&&g.value[o.day]?(m(),_("div",fo,[u("p",go,p(g.value[o.day].price)+"￥",1)])):(m(),_("div",bo,ho))]))]),_:1},512)]),_:1})])):D("",!0)]),_:1}),s(me,{modelValue:x.value,"onUpdate:modelValue":e[24]||(e[24]=o=>x.value=o),title:l(t)("editPrice"),width:"400px","destroy-on-close":!0},{footer:d(()=>[u("span",yo,[s(k,{onClick:e[22]||(e[22]=o=>x.value=!1)},{default:d(()=>[v(p(l(t)("cancel")),1)]),_:1}),s(k,{type:"primary",onClick:e[23]||(e[23]=o=>ae(T.value))},{default:d(()=>[v(p(l(t)("confirm")),1)]),_:1})])]),default:d(()=>[ve((m(),P(z,{model:n,"label-width":"90px",ref_key:"formRulesRef",ref:T,rules:l(le),class:"page-form"},{default:d(()=>[s(c,{label:l(t)("daySetting"),class:"items-center"},{default:d(()=>[s(ue,{modelValue:n.is_set,"onUpdate:modelValue":e[17]||(e[17]=o=>n.is_set=o),class:"ml-4 input-width"},{default:d(()=>[s(Y,{label:1,size:"large"},{default:d(()=>[v(p(n.start_date),1)]),_:1}),s(Y,{label:2,size:"large"},{default:d(()=>[v(p(l(t)("dateRange")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),n.is_set==2?(m(),P(c,{key:0,label:l(t)("startDate"),class:"input-width"},{default:d(()=>[s(B,{type:"date",modelValue:n.start_date,"onUpdate:modelValue":e[18]||(e[18]=o=>n.start_date=o),placeholder:l(t)("startDate"),"value-format":"YYYY-MM-DD"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):D("",!0),n.is_set==2?(m(),P(c,{key:1,label:l(t)("endDate"),class:"input-width"},{default:d(()=>[s(B,{type:"date",modelValue:n.end_date,"onUpdate:modelValue":e[19]||(e[19]=o=>n.end_date=o),placeholder:l(t)("endDate"),"value-format":"YYYY-MM-DD"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):D("",!0),s(c,{label:l(t)("price"),prop:"price",class:"input-width"},{default:d(()=>[s(f,{modelValue:n.price,"onUpdate:modelValue":e[20]||(e[20]=o=>n.price=o),clearable:"",placeholder:l(t)("pricePlaceholder"),class:"input-width",onKeyup:e[21]||(e[21]=o=>l(A)(o))},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[pe,h.value]])]),_:1},8,["modelValue","title"])])}}});const ct=Ke(xo,[["__scopeId","data-v-738eff11"]]);export{ct as default};
