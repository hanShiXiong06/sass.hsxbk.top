import{d as ie,x as se,f as ne,r as L,n as j,aQ as re,cm as de,l as ue,q as i,h as d,c as m,a as _,u as s,t as v,e as o,w as r,F as V,Q as k,s as M,i as E,B as T,cN as ce,cK as H,cO as me,a5 as pe,cP as _e,aD as he,aE as fe,J as ve,K as be,ak as ge,aI as ye,E as Ve,c_ as ke,L as we,a0 as xe,p as Ce,g as Pe}from"./index-17984968.js";/* empty css                *//* empty css                *//* empty css                     */import{_ as Le}from"./index.vue_vue_type_script_setup_true_lang-a8924ef7.js";/* empty css                  */import Me from"./index-0ce1f7fc.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                    */import{c as Ee,e as Fe,f as Se,h as Te}from"./tourism-ed22e76b.js";import{_ as Ae}from"./_plugin-vue_export-helper-c27b6911.js";import"./index.vue_vue_type_style_index_0_lang-c5bcb8a9.js";/* empty css                  *//* empty css                   */import"./attachment-a816d3ef.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-8693344a.js";/* empty css                        *//* empty css                      *//* empty css                    *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css               *//* empty css                    *//* empty css                         */import"./index.vue_vue_type_script_setup_true_lang-5615c67a.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-8e50df98.js";/* empty css                */import"./sortable.esm-be94e56d.js";const A=w=>(Ce("data-v-fe898521"),w=w(),Pe(),w),De={class:"main-container"},Ie={class:"detail-head"},Ue=A(()=>_("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1)),qe={class:"ml-[1px]"},Oe=A(()=>_("span",{class:"adorn"},"|",-1)),Ne={key:0,class:"right"},je={key:1,class:"right"},He={key:0},Re=A(()=>_("div",{class:"mt-4"},[_("div",{id:"TxMap",class:"map-item w-[800px] h-[500px]"})],-1)),Be={key:1},$e={key:2},ze={class:"fixed-footer-wrap"},Ge={class:"fixed-footer"},Ke=ie({__name:"edit_hotel",setup(w){const R=se(),B=ne(),g=L("first"),b=j({province:[],city:[],district:[]});(()=>{ce(1).then(l=>{b.province=l.data})})();const D=l=>{Object.keys(l).length==0?l.id=e.province_id:(e.province_id=l.id,e.province_name=l.name),H(l.id).then(t=>{b.city=t.data})},I=l=>{Object.keys(l).length==0?l.id=e.city_id:(e.city_id=l.id,e.city_name=l.name),H(l.id).then(t=>{b.district=t.data})},$=l=>{e.district_id=l.id,e.district_name=l.name},z=()=>{e.province_id&&e.city_id&&e.district_id&&e.address&&(e.full_address=e.province_name+e.city_name+e.district_name+e.address,me({address:e.full_address}).then(l=>{e.latitude=l.data.result.location.lat,e.longitude=l.data.result.location.lng}))};let y=null;const G=()=>{let l=e.latitude,t=e.longitude;e.latitude==0&&(l="39.90469"),e.longitude==0&&(t="116.40717");const n=new window.TMap.LatLng(l,t);y=new window.TMap.Map("TxMap",{center:n,zoom:17,viewMode:"2D",showControl:!0}),y.on("click",h=>{const c={lat:h.latLng.getLat().toFixed(6),lng:h.latLng.getLng().toFixed(6)};K(c.lat,c.lng,1),p.updateGeometries({id:"shop",position:h.latLng})});const p=new window.TMap.MultiMarker({id:"marker-layer",map:y,minimumClusterSize:1});p.updateGeometries({id:"shop",position:n}),y.on("idle",()=>{pe(()=>e.latitude,(h,c)=>{const u=new window.TMap.LatLng(e.latitude,e.longitude);y.panTo(u,1),p.updateGeometries({id:"shop",position:u})})})};re(()=>{const l=document.createElement("script");de().then(t=>{l.type="text/javascript",l.src="https://map.qq.com/api/gljs?v=1.exp&key="+t.data.key,document.body.appendChild(l)}),l.onload=()=>{setTimeout(()=>{G()},500)}});const K=(l,t,n)=>{_e({location:l+","+t}).then(p=>{e.province_name=p.data.result.address_component.province,e.city_name=p.data.result.address_component.city,e.district_name=p.data.result.address_component.district,n==1&&(e.address=p.data.result.formatted_addresses.recommend,e.full_address=e.province_name+e.city_name+e.district_name+e.address,e.latitude=l,e.longitude=t)})},U=L([]);(()=>{Ee().then(l=>{U.value=l.data})})();const Q=l=>{e.hotel_attribute.length<=0?e.hotel_attribute.push(l):e.hotel_attribute.indexOf(l)!=-1?e.hotel_attribute.splice(e.hotel_attribute.indexOf(l),1):e.hotel_attribute.push(l)},x=parseInt(R.query.id),C=L(!1),q={hotel_id:0,hotel_name:"",hotel_star:"",hotel_tag:"",hotel_cover:"",hotel_images:"",hotel_attribute:[],province_id:"",province_name:"",city_id:"",city_name:"",district_id:"",district_name:"",address:"",longitude:0,latitude:0,hotel_desc:"",price:"",full_address:""},e=j({...q});x&&(async(l=0)=>{Object.assign(e,q);const t=await(await Fe(l)).data;Object.keys(e).forEach(n=>{t[n]!=null&&n!="hotel_attribute"&&(e[n]=t[n]),n=="hotel_attribute"&&t[n]!=null&&(e[n]=t[n].split(","))}),e.hotel_id=l,e.province_id>0&&D({}),e.city_id>0&&I({})})(x);const O=L(),J=ue(()=>({hotel_name:[{required:!0,message:i("hotelNamePlaceholder"),trigger:"blur"}],hotel_star:[{required:!0,message:i("starRatingPlaceholder"),trigger:"blur"}],hotel_cover:[{required:!0,validator:X,trigger:"blur"}],address_area:[{required:!0,validator:W,trigger:"blur"}],address:[{required:!0,message:i("hotelAddressDetailPlaceholder"),trigger:"blur"}]})),W=(l,t,n)=>{(e.province_name==""||e.city_name==""||e.district_name=="")&&n(new Error(i("hotelAddressPlaceholder"))),n()},X=(l,t,n)=>{e.hotel_cover==""&&n(new Error(i("hotelCoverPlaceholder"))),n()},Y=async l=>{C.value||!l||await l.validate(async t=>{t&&(C.value=!0,e.hotel_attribute=e.hotel_attribute.join(","),(x?Se:Te)(e).then(h=>{C.value=!1,history.back()}).catch(()=>{C.value=!1}))})},Z=()=>{history.back()};return(l,t)=>{const n=he,p=fe,h=ve,c=be,u=ge,P=ye,N=Me,F=Ve,ee=Le,te=ke,le=we,ae=xe;return d(),m("div",De,[_("div",Ie,[_("div",{class:"left",onClick:t[0]||(t[0]=a=>s(B).push("/tourism/product/hotel/hotel"))},[Ue,_("span",qe,v(s(i)("returnToPreviousPage")),1)]),Oe,s(x)?(d(),m("span",Ne,v(s(i)("editHotel")),1)):(d(),m("span",je,v(s(i)("addHotel")),1))]),o(ae,{class:"box-card !border-none",shadow:"never"},{default:r(()=>[o(p,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=a=>g.value=a),class:"demo-tabs"},{default:r(()=>[o(n,{label:s(i)("basicInformation"),name:"first"},null,8,["label"]),o(n,{label:s(i)("hotelIntroduce"),name:"introduce"},null,8,["label"]),o(n,{label:s(i)("hotelPeriphery"),name:"periphery"},null,8,["label"])]),_:1},8,["modelValue"]),o(le,{model:e,"label-width":"120px",ref_key:"formRef",ref:O,rules:s(J),class:"page-form"},{default:r(()=>[g.value=="first"?(d(),m("div",He,[o(c,{label:s(i)("hotelName"),prop:"hotel_name"},{default:r(()=>[o(h,{modelValue:e.hotel_name,"onUpdate:modelValue":t[2]||(t[2]=a=>e.hotel_name=a),modelModifiers:{trim:!0},clearable:"",placeholder:s(i)("hotelNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(c,{label:s(i)("starRating"),prop:"hotel_star"},{default:r(()=>[o(P,{modelValue:e.hotel_star,"onUpdate:modelValue":t[3]||(t[3]=a=>e.hotel_star=a),clearable:"",class:"input-width"},{default:r(()=>[o(u,{label:s(i)("oneStar"),value:1},null,8,["label"]),o(u,{label:s(i)("twoStar"),value:2},null,8,["label"]),o(u,{label:s(i)("threeStar"),value:3},null,8,["label"]),o(u,{label:s(i)("fourStar"),value:4},null,8,["label"]),o(u,{label:s(i)("fiveStar"),value:5},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),o(c,{label:s(i)("hotelLabel")},{default:r(()=>[o(h,{modelValue:e.hotel_tag,"onUpdate:modelValue":t[4]||(t[4]=a=>e.hotel_tag=a),modelModifiers:{trim:!0},clearable:"",placeholder:s(i)("hotelLabelPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(c,{label:s(i)("hotelCover"),prop:"hotel_cover"},{default:r(()=>[o(N,{modelValue:e.hotel_cover,"onUpdate:modelValue":t[5]||(t[5]=a=>e.hotel_cover=a)},null,8,["modelValue"])]),_:1},8,["label"]),o(c,{label:s(i)("hotelImages")},{default:r(()=>[o(N,{modelValue:e.hotel_images,"onUpdate:modelValue":t[6]||(t[6]=a=>e.hotel_images=a),limit:"10"},null,8,["modelValue"])]),_:1},8,["label"]),o(c,{label:s(i)("hotelAddress"),prop:"address_area"},{default:r(()=>[o(P,{modelValue:e.province_name,"onUpdate:modelValue":t[7]||(t[7]=a=>e.province_name=a),"value-key":"id",clearable:"",class:"w-[200px]",onChange:D},{default:r(()=>[o(u,{label:s(i)("provincePlaceholder"),value:""},null,8,["label"]),(d(!0),m(V,null,k(b.province,(a,f)=>(d(),M(u,{key:f,label:a.name,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(P,{modelValue:e.city_name,"onUpdate:modelValue":t[8]||(t[8]=a=>e.city_name=a),"value-key":"id",clearable:"",class:"w-[200px] ml-3",onChange:I},{default:r(()=>[o(u,{label:s(i)("cityPlaceholder"),value:""},null,8,["label"]),(d(!0),m(V,null,k(b.city,(a,f)=>(d(),M(u,{key:f,label:a.name,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(P,{modelValue:e.district_name,"onUpdate:modelValue":t[9]||(t[9]=a=>e.district_name=a),"value-key":"id",clearable:"",class:"w-[200px] ml-3",onChange:$},{default:r(()=>[o(u,{label:s(i)("districtPlaceholder"),value:""},null,8,["label"]),(d(!0),m(V,null,k(b.district,(a,f)=>(d(),M(u,{key:f,label:a.name,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),o(c,{label:s(i)("hotelAddressDetail"),prop:"address"},{default:r(()=>[_("div",null,[_("div",null,[o(h,{modelValue:e.address,"onUpdate:modelValue":t[10]||(t[10]=a=>e.address=a),modelModifiers:{trim:!0},clearable:"",placeholder:s(i)("hotelAddressDetailPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),o(F,{class:"ml-3",onClick:z},{default:r(()=>[E(v(s(i)("search")),1)]),_:1})]),Re])]),_:1},8,["label"])])):T("",!0),g.value=="introduce"?(d(),m("div",Be,[o(c,{label:s(i)("hotelIntroduce")},{default:r(()=>[o(ee,{modelValue:e.hotel_desc,"onUpdate:modelValue":t[11]||(t[11]=a=>e.hotel_desc=a)},null,8,["modelValue"])]),_:1},8,["label"])])):T("",!0),g.value=="periphery"?(d(),m("div",$e,[(d(!0),m(V,null,k(U.value,(a,f)=>(d(),M(c,{label:a.name,key:f},{default:r(()=>[(d(!0),m(V,null,k(a.attr,(S,oe)=>(d(),m("span",{key:oe},[o(te,{style:{"margin-right":"8px"},checked:e.hotel_attribute.indexOf(S[0])!=-1,onChange:Xe=>Q(S[0])},{default:r(()=>[E(v(S[0]),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"]))),128))])):T("",!0)]),_:1},8,["model","rules"])]),_:1}),_("div",ze,[_("div",Ge,[o(F,{type:"primary",onClick:t[12]||(t[12]=a=>Y(O.value))},{default:r(()=>[E(v(s(i)("save")),1)]),_:1}),o(F,{onClick:t[13]||(t[13]=a=>Z())},{default:r(()=>[E(v(s(i)("cancel")),1)]),_:1})])])])}}});const Ut=Ae(Ke,[["__scopeId","data-v-fe898521"]]);export{Ut as default};
