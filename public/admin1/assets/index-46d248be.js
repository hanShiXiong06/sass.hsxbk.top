import{N as h,d as re,r as _,l as S,aQ as ue,Y as ie,h as c,s as D,w as t,e as l,u as f,q as V,i as s,a as v,t as y,c as g,F as M,Q as U,B as de,R as ce,az as pe,aA as me,K as _e,E as fe,X as ve,cG as we,aB as Ce,c7 as ke,a0 as ye,J as ge,cH as Ve,L as he,p as be,g as xe}from"./index-17984968.js";/* empty css                *//* empty css                  *//* empty css                   *//* empty css                 *//* empty css                *//* empty css                          *//* empty css                    *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                       *//* empty css                 *//* empty css                   */import{_ as Ee}from"./_plugin-vue_export-helper-c27b6911.js";function De(r){return h.get("detail_form/category_list",{params:r})}function Me(r){return h.delete(`detail_form/category_list/${r}`,{showErrorMessage:!0,showSuccessMessage:!0})}function Ue(r){return h.post("detail_form/category_list",r,{showErrorMessage:!0,showSuccessMessage:!0})}function $e(r){return h.delete(`detail_form/list/${r}`,{showErrorMessage:!0,showSuccessMessage:!0})}function Oe(r){return h.put(`detail_form/list/${r.id}`,r,{showErrorMessage:!0,showSuccessMessage:!0})}function Se(r){return h.post("detail_form/list",r,{showErrorMessage:!0,showSuccessMessage:!0})}const K=r=>(be("data-v-19374382"),r=r(),xe(),r),Ie={class:"ml-[10px]"},Le={class:"cursor-pointer text-success"},Fe=K(()=>v("h4",null,"产品质检",-1)),Ke={key:0},Be=K(()=>v("i",{class:"order-0 iconfont icontuodong vues-rank mr-[8px]"},null,-1)),Ae={class:"flex justify-between w-100"},ze={class:"flex justify-between"},Ne=re({__name:"index",emits:["updateAnswers"],setup(r,{emit:B}){const n=_({check:!1,tips:"",appearance:[],feature:[],innerDrawer:!1,innerDrawer1:!1,currentKey:""}),p=_([{key:"appearance",title:"外观质检",options:[{title:"屏幕",options:[{name:"无划痕"},{name:"有划痕"}],answer:""}]},{key:"feature",title:"功能质检",options:[{title:"屏幕",options:[{name:"无划痕"},{name:"有划痕"}],answer:""}]}]);S(()=>(console.log($.value),p.value.filter(o=>o.key===n.value.currentKey))),_([]);const i=_({title:"",options:[{name:""},{name:""}],answer:"",sort:""}),b=_({key:"",title:""}),A=o=>{n.value.currentKey=o,n.value.innerDrawer=!0},z=async o=>{await Me(o),await x()},N=async o=>{await $e(o.id),await x()},j=()=>{const o=p.value.map(e=>({title:e.title,options:e.options.map(w=>({title:w.title,answer:w.answer,color:"#f00"}))}));B("updateAnswers",o),ce.success("质检已完成"),n.value.check=!1,n.value.tips="已完成质检"};ue(async()=>{await x()});const q=()=>{n.value.tips=""},P=()=>{n.value.innerDrawer=!1},G=()=>{i.value.options.push({name:""})},I=()=>{n.value.innerDrawer=!1,i.value.title="",i.value.options=[{name:""},{name:""}]},R=async o=>{const e={...i.value,category_id:n.value.currentKey,id:o};e.options=e.options.map(w=>w.name).toString(),delete e.answer,o?await Oe(e):await Se(e),await x(),I()},Q=async()=>{const o={...b.value,options:[{name:""},{name:""}]};await Ue({...o}),await x(),n.value.innerDrawer1=!1},x=async()=>{const o=await De();p.value=o.data},H=o=>{i.value.options.splice(o,1)},J=()=>{p.value.forEach(o=>{o.options.forEach(e=>{e.answer=[e.options[0]]})})},L=_(null),T=o=>{L.value=o.id,n.value.innerDrawer=!0,i.value.title=o.title,i.value.sort=o.sort,n.value.currentKey=o.category_id,i.value.options=o.options.map(e=>({name:e}))},X=o=>{p.value[o].options.forEach(e=>{e.answer=[]})},Y=S(()=>p.value.map(o=>({title:o.title,id:o.key}))),W=S(()=>(console.log($),$)),$=_(0),Z=o=>{};return _([]),(o,e)=>{const w=pe,ee=me,C=_e,u=fe,te=ie("CircleCloseFilled"),le=ve,F=we,oe=Ce,ae=ke,ne=ye,E=ge,O=Ve,se=he;return c(),D(se,{"label-width":"150px"},{default:t(()=>[l(C,{label:f(V)("质检选项")},{default:t(()=>[l(ee,{modelValue:n.value.check,"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.check=a)},{default:t(()=>[l(w,{label:0,onClick:q},{default:t(()=>[s("不质检")]),_:1}),l(w,{label:1},{default:t(()=>[s("质检")]),_:1})]),_:1},8,["modelValue"]),v("div",Ie,[v("span",Le,y(n.value.tips),1)])]),_:1},8,["label"]),l(O,{modelValue:n.value.check,"onUpdate:modelValue":e[10]||(e[10]=a=>n.value.check=a),title:"质检",direction:"rtl",size:"80%"},{header:t(({close:a})=>[Fe,l(u,{onClick:J},{default:t(()=>[s("一键全选")]),_:1}),l(u,{onClick:e[1]||(e[1]=m=>n.value.innerDrawer1=!0)},{default:t(()=>[s("添加质检大类")]),_:1}),l(u,{onClick:j},{default:t(()=>[s("确认质检完成")]),_:1}),l(u,{type:"danger",onClick:a},{default:t(()=>[l(le,{class:"el-icon--left"},{default:t(()=>[l(te)]),_:1}),s(" Close ")]),_:2},1032,["onClick"])]),default:t(()=>[(c(!0),g(M,null,U(f(Y),a=>(c(),D(u,{onClick:m=>Z(a)},{default:t(()=>[s(y(a.title),1)]),_:2},1032,["onClick"]))),256)),s(" "+y(f(W))+" ",1),n.value.check?(c(),g("div",Ke,[(c(!0),g(M,null,U(p.value,(a,m)=>(c(),g("div",{class:"question",key:m},[l(ne,null,{default:t(()=>[v("div",null,[s(y(p.value[m].title)+" ",1),l(u,{onClick:d=>A(a.category_id)},{default:t(()=>[s("添加质检项")]),_:2},1032,["onClick"]),l(F,{title:"确定要删除吗?",onConfirm:d=>z(a.key)},{reference:t(()=>[l(u,null,{default:t(()=>[s("删除"+y(p.value[m].title)+"类",1)]),_:2},1024)]),_:2},1032,["onConfirm"]),l(u,{onClick:d=>X(m)},{default:t(()=>[s("一键取消")]),_:2},1032,["onClick"])]),(c(!0),g(M,null,U(p.value[m].options,d=>(c(),D(C,{key:d.title},{label:t(()=>[Be,v("text",null,y(d.title),1)]),default:t(()=>[v("div",Ae,[l(ae,{modelValue:d.answer,"onUpdate:modelValue":k=>d.answer=k,min:0,max:1},{default:t(()=>[(c(!0),g(M,null,U(d.options,k=>(c(),D(oe,{label:k,key:k},{default:t(()=>[s(y(k),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),v("div",ze,[l(u,{type:"default",size:"small",onClick:k=>T(d)},{default:t(()=>[s("修改")]),_:2},1032,["onClick"]),l(F,{title:"确定要删除吗?",onConfirm:k=>N({key:m,id:d.id})},{reference:t(()=>[l(u,{type:"danger",size:"small"},{default:t(()=>[s("删除")]),_:1})]),_:2},1032,["onConfirm"])])])]),_:2},1024))),128))]),_:2},1024)]))),128)),l(O,{modelValue:n.value.innerDrawer,"onUpdate:modelValue":e[6]||(e[6]=a=>n.value.innerDrawer=a),title:"添加质检项","append-to-body":!0,"before-close":P,size:"75%"},{default:t(()=>[l(C,{label:f(V)("属性:")},{default:t(()=>[l(E,{modelValue:i.value.title,"onUpdate:modelValue":e[2]||(e[2]=a=>i.value.title=a),style:{width:"240px"},placeholder:"请输入属性"},null,8,["modelValue"])]),_:1},8,["label"]),l(C,{label:f(V)("选项:")},{default:t(()=>[(c(!0),g(M,null,U(i.value.options,(a,m)=>(c(),D(E,{modelValue:a.name,"onUpdate:modelValue":d=>a.name=d,key:m,style:{width:"240px"},placeholder:"请输入参数值"},null,8,["modelValue","onUpdate:modelValue"]))),128)),l(u,{onClick:G},{default:t(()=>[s("+")]),_:1}),l(u,{onClick:e[3]||(e[3]=a=>H(i.value.options.length-1))},{default:t(()=>[s("移除末尾")]),_:1})]),_:1},8,["label"]),l(C,{label:f(V)("排序:")},{default:t(()=>[l(E,{modelValue:i.value.sort,"onUpdate:modelValue":e[4]||(e[4]=a=>i.value.sort=a),style:{width:"240px"},placeholder:"排序"},null,8,["modelValue"])]),_:1},8,["label"]),l(u,{onClick:e[5]||(e[5]=a=>R(L.value))},{default:t(()=>[s("确认添加")]),_:1}),l(u,{onClick:I},{default:t(()=>[s("取消")]),_:1})]),_:1},8,["modelValue"]),l(O,{modelValue:n.value.innerDrawer1,"onUpdate:modelValue":e[9]||(e[9]=a=>n.value.innerDrawer1=a)},{default:t(()=>[l(C,{label:f(V)("类名:")},{default:t(()=>[l(E,{modelValue:b.value.title,"onUpdate:modelValue":e[7]||(e[7]=a=>b.value.title=a),style:{width:"240px"},placeholder:"Please input"},null,8,["modelValue"])]),_:1},8,["label"]),l(C,{label:f(V)("key:")},{default:t(()=>[l(E,{modelValue:b.value.key,"onUpdate:modelValue":e[8]||(e[8]=a=>b.value.key=a),style:{width:"240px"},placeholder:"Please input"},null,8,["modelValue"]),l(u,{onClick:Q},{default:t(()=>[s("+")]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])])):de("",!0)]),_:1},8,["modelValue"])]),_:1})}}});const at=Ee(Ne,[["__scopeId","data-v-19374382"]]);export{at as default};
