import{d as P,r as g,n as F,h,s as w,w as c,a as s,e as r,i as E,t as m,u as i,q as d,R as L,ae as G,A as U,c as D,B as V,ax as $,ad as A,W as I,E as O,X as R,Y as q}from"./index-99f00cf3.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                        *//* empty css                    *//* empty css                */import{f as W,h as X,i as Y}from"./vipcard-cf1e419a.js";const H={class:"flex"},J={class:"w-[150px] border-0 border-solid border-r-[1px] border-[#eee]"},K={class:"ml-5 flex-1"},M={class:"flex"},Q={class:"w-[100px] h-[100px]"},Z=["src"],ee={class:"flex flex flex-col ml-2"},ae={key:0},te={key:1},oe={class:"mt-[16px] flex justify-end"},le={class:"dialog-footer"},Ee=P({__name:"card-goods-select",emits:["complete"],setup(se,{expose:k,emit:z}){const _=g(!1),x=g(!1),y=g([]);(async()=>{const o=await(await W({type:2})).data;o.length?o.forEach((e,n)=>{const l={};l.label=e.category_name,l.category_id=e.category_id,e.children.length&&(l.children=[],e.children.forEach((f,b)=>{const p={};p.label=f.category_name,p.category_id=f.category_id,l.children.push(p)})),y.value.push(l)}):y.value=[]})();const B={children:"children",label:"label",category_id:"category_id"},N=o=>{a.searchParam.category_id=o.category_id,u()},a=F({page:1,limit:4,total:0,loading:!0,data:[],searchParam:{category_id:""}}),u=(o=1)=>{a.loading=!0,a.page=o,X({page:a.page,limit:a.limit,...a.searchParam}).then(e=>{a.loading=!1,a.data=e.data.data,a.total=e.data.total}).catch(()=>{a.loading=!1})};u();const C=g([]),S=o=>{C.value=o},T=()=>{z("complete",C.value)},v=g([]);return k({showDialog:_,setFormData:async(o=null)=>{if(x.value=!1,o){const e=await(await Y(o.category_id)).data;if(e&&Object.keys(formData).forEach(n=>{e[n]!=null&&(formData[n]=e[n])}),formData.category_id>0)for(let n in v.value)formData.category_id==v.value[n].category_id&&v.value.splice(n,1)}}}),(o,e)=>{const n=$,l=A,f=I,b=O,p=R,j=q;return h(),w(p,{modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=t=>_.value=t),title:i(d)("addVipcardGoods"),width:"800px","destroy-on-close":!0},{footer:c(()=>[s("span",le,[r(b,{onClick:e[3]||(e[3]=t=>_.value=!1)},{default:c(()=>[E(m(i(d)("cancel")),1)]),_:1}),r(b,{type:"primary",loading:x.value,onClick:e[4]||(e[4]=t=>T())},{default:c(()=>[E(m(i(d)("confirm")),1)]),_:1},8,["loading"])])]),default:c(()=>[s("div",H,[s("div",J,[r(n,{data:y.value,props:B,accordion:"",onNodeClick:N},null,8,["data"])]),s("div",K,[L((h(),w(i(G),{ref:"multipleTableRef",style:{width:"100%"},onSelectionChange:S,data:a.data,size:"large",height:"450"},{default:c(()=>[r(l,{type:"selection",width:"55"}),r(l,{label:i(d)("goodsInfo"),"min-width":"240",align:"left"},{default:c(({row:t})=>[s("div",M,[s("div",Q,[s("img",{class:"max-w-[100%] max-h-[100%]",src:i(U)(t.cover_thumb_small)},null,8,Z)]),s("div",ee,[s("span",null,m(t.goods_name),1)])])]),_:1},8,["label"]),r(l,{prop:"price",label:i(d)("price"),"min-width":"120"},null,8,["label"]),r(l,{prop:"status",label:i(d)("status"),"min-width":"120"},{default:c(({row:t})=>[t.status==1?(h(),D("span",ae,m(i(d)("up")),1)):V("",!0),t.status==0?(h(),D("span",te,m(i(d)("down")),1)):V("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[j,a.loading]]),s("div",oe,[r(f,{"current-page":a.page,"onUpdate:current-page":e[0]||(e[0]=t=>a.page=t),"page-size":a.limit,"onUpdate:page-size":e[1]||(e[1]=t=>a.limit=t),layout:"total, sizes, prev, pager, next, jumper",total:a.total,onSizeChange:e[2]||(e[2]=t=>u()),onCurrentChange:u},null,8,["current-page","page-size","total"])])])])]),_:1},8,["modelValue","title"])}}});export{Ee as _};
