import{d as S,x as $,r as h,n as j,f as q,h as m,c as u,e as l,w as r,a as n,t as d,u as t,q as o,F as C,T,s as v,i as b,R as H,A as D,K as O,L as A,bO as K,ac as W,aD as G,E as J,M as Q,a7 as X,ad as Z,ae as ee,W as ae,Y as te}from"./index-99f00cf3.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                *//* empty css                  *//* empty css                       */import"./el-form-item-4ed993c7.js";import{m as le,a as oe,n as se}from"./vipcard-cf1e419a.js";const re={class:"main-container"},ne={class:"flex justify-between items-center"},de={class:"text-page-title"},ie={class:"mt-[10px]"},me={class:"flex"},ce=["src"],pe={class:"flex flex flex-col ml-2"},ue={class:"flex"},_e=["src"],fe={class:"flex flex flex-col ml-2"},be={key:0},ge={key:1},he={class:"mt-[16px] flex justify-end"},Se=S({__name:"record_list",setup(ve){const y=$(),R=parseInt(y.query.id),N=y.meta.title,x=h([]),w=h([]);(async()=>{x.value=await(await le()).data,w.value=await(await oe()).data})();const a=j({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{create_time:"",card_no:"",status:"",card_type:""}}),k=h(),_=(c=1)=>{a.loading=!0,a.page=c,se({page:a.page,limit:a.limit,goods_id:R,...a.searchParam}).then(s=>{a.loading=!1,a.data=s.data.data,a.total=s.data.total}).catch(()=>{a.loading=!1})};_();const F=q(),z=c=>{F.push("/vipcard/goods/card/record_info?id="+c.card_id)};return(c,s)=>{const U=O,p=A,B=K,P=W,V=G,g=J,I=Q,E=X,i=Z,M=ee,Y=ae,L=te;return m(),u("div",re,[l(E,{class:"box-card !border-none",shadow:"never"},{default:r(()=>[n("div",ne,[n("span",de,d(t(N)),1)]),l(E,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:r(()=>[l(I,{inline:!0,model:a.searchParam,ref_key:"searchFormRef",ref:k},{default:r(()=>[l(p,{label:t(o)("orderNo")},{default:r(()=>[l(U,{modelValue:a.searchParam.order_no,"onUpdate:modelValue":s[0]||(s[0]=e=>a.searchParam.order_no=e),placeholder:t(o)("orderNoPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:t(o)("createTime")},{default:r(()=>[l(B,{modelValue:a.searchParam.create_time,"onUpdate:modelValue":s[1]||(s[1]=e=>a.searchParam.create_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":t(o)("startDate"),"end-placeholder":t(o)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(p,{label:t(o)("status")},{default:r(()=>[l(V,{modelValue:a.searchParam.status,"onUpdate:modelValue":s[2]||(s[2]=e=>a.searchParam.status=e),"collapse-tags":"",clearable:"",placeholder:t(o)("statusPlaceholder"),class:"input-width"},{default:r(()=>[(m(!0),u(C,null,T(x.value,(e,f)=>(m(),v(P,{label:e.name,value:e.status,key:f},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:t(o)("cardType")},{default:r(()=>[l(V,{modelValue:a.searchParam.card_type,"onUpdate:modelValue":s[3]||(s[3]=e=>a.searchParam.card_type=e),"collapse-tags":"",clearable:"",placeholder:t(o)("cardTypePlaceholder"),class:"input-width"},{default:r(()=>[(m(!0),u(C,null,T(w.value,(e,f)=>(m(),v(P,{label:e.name,value:e.type,key:f},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,null,{default:r(()=>[l(g,{type:"primary",onClick:s[4]||(s[4]=e=>_())},{default:r(()=>[b(d(t(o)("search")),1)]),_:1}),l(g,{onClick:s[5]||(s[5]=e=>c.resetForm(k.value))},{default:r(()=>[b(d(t(o)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),n("div",ie,[H((m(),v(M,{data:a.data,size:"large"},{empty:r(()=>[n("span",null,d(a.loading?"":t(o)("emptyData")),1)]),default:r(()=>[l(i,{label:t(o)("orderNo"),"min-width":"200",align:"left"},{default:r(({row:e})=>[b(d(e.order.order_no),1)]),_:1},8,["label"]),l(i,{label:t(o)("cardInfo"),"min-width":"240",align:"left"},{default:r(({row:e})=>[n("div",me,[n("img",{class:"w-[50px] h-[50px] min-w-[50px]",src:t(D)(e.goods.cover_thumb_small)},null,8,ce),n("div",pe,[n("span",null,d(e.goods.goods_name),1)])])]),_:1},8,["label"]),l(i,{label:t(o)("memberInfo"),"min-width":"200",align:"left"},{default:r(({row:e})=>[n("div",ue,[n("img",{class:"w-[50px] h-[50px] min-w-[50px]",src:t(D)(e.member.headimg)},null,8,_e),n("div",fe,[n("span",null,d(e.member.nickname),1),n("span",null,d(e.member.mobile),1)])])]),_:1},8,["label"]),l(i,{prop:"card_type_name",label:t(o)("cardType"),"min-width":"120"},null,8,["label"]),l(i,{label:t(o)("useNum"),"min-width":"100",align:"left"},{default:r(({row:e})=>[e.card_type!=c.timecard?(m(),u("span",be,d(e.total_use_num)+" / "+d(e.total_num),1)):(m(),u("span",ge,d(e.total_use_num)+" / "+d(t(o)("timecard")),1))]),_:1},8,["label"]),l(i,{prop:"status_name",label:t(o)("status"),"min-width":"150"},null,8,["label"]),l(i,{prop:"create_time",label:t(o)("createTime"),"min-width":"150"},null,8,["label"]),l(i,{label:t(o)("operation"),fixed:"right",align:"right","min-width":"100"},{default:r(({row:e})=>[l(g,{type:"primary",link:"",onClick:f=>z(e)},{default:r(()=>[b(d(t(o)("detail")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[L,a.loading]]),n("div",he,[l(Y,{"current-page":a.page,"onUpdate:current-page":s[6]||(s[6]=e=>a.page=e),"page-size":a.limit,"onUpdate:page-size":s[7]||(s[7]=e=>a.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:a.total,onSizeChange:s[8]||(s[8]=e=>_()),onCurrentChange:_},null,8,["current-page","page-size","total"])])])]),_:1})])}}});export{Se as default};
