import{d as X,x as Z,r as w,n as ee,f as te,h as p,c as h,e as l,w as n,a as d,t as r,u as o,i as m,q as t,F as S,T as C,s as v,R as ae,A as le,B as oe,b9 as F,j as U,U as se,a5 as Y,E as ne,K as ie,L as re,ab as pe,aC as de,bO as ue,M as me,a7 as ce,ac as _e,ak as fe,bi as ge,ad as he,W as ve,Y as be}from"./index-6f32d09b.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                    *//* empty css                        *//* empty css                *//* empty css                *//* empty css                       */import"./el-form-item-4ed993c7.js";import{_ as xe}from"./site_logo-5ed68b79.js";import{m as ye,w as we,x as ke,y as Pe,z as Se,A as Ce}from"./site-fcb739f6.js";import{_ as Ve}from"./edit-site.vue_vue_type_script_setup_true_lang-b6b66c71.js";import{g as De}from"./addon-acc2191c.js";/* empty css                  *//* empty css                   *//* empty css                  */import"./member_head-d9fd7b2c.js";import"./user-663e1a09.js";const Ee={class:"main-container"},Te={class:"flex justify-between items-center"},Ie={class:"text-page-title"},Le={class:"mt-[20px]"},$e={class:"flex items-center"},Be=["src"],Fe={key:1,class:"w-[50px] h-[50px] mr-[10px]",src:xe,alt:""},Ue={class:"flex flex flex-col"},Ye={class:"flex items-center"},ze={class:"flex flex flex-col"},Me={key:0},Ne={key:1},je=d("span",{class:"el-dropdown-link ml-[12px] h-[20px] leading-[24px] text-[var(--el-color-primary)]"}," 更多 ",-1),Oe={class:"flex flex-col py-[5px] px-[10px]"},Re={class:"mt-[16px] flex justify-end"},yt=X({__name:"list",setup(Ae){const V=Z(),z=V.meta.title,b=w({all:[]}),D=w([]),s=ee({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{keywords:"",group_id:"",app:"all",status:"",site_domain:"",create_time:[],expire_time:[]}});s.searchParam.status=V.query.id||"",(async()=>{const i=await(await ye({})).data;b.value.all=i,i.forEach((a,u)=>{b.value[a.app]||(b.value[a.app]=[]),b.value[a.app].push(a)})})(),(async()=>{D.value=await(await we()).data})();const E=w(),M=i=>{i&&(i.resetFields(),_())},N=()=>{s.searchParam.group_id=""},T=w([]);De().then(({data:i})=>{T.value=i}).catch();const _=(i=1)=>{s.loading=!0,s.page=i,s.searchParam.app=s.searchParam.app=="all"?"":s.searchParam.app,ke({page:s.page,limit:s.limit,...s.searchParam}).then(a=>{s.loading=!1,s.data=a.data.data,s.total=a.data.total}).catch(()=>{s.loading=!1})};_();const j=te(),y=w(null),O=i=>{y.value.setFormData(),y.value.showDialog=!0},R=i=>{j.push({path:"/admin/site/info",query:{id:i.site_id}})},A=i=>{y.value.setFormData(i),y.value.showDialog=!0},I=(i=0)=>{if(window.localStorage.setItem("site.token",F()),window.localStorage.setItem("site.comparisonTokenStorage",F()),window.localStorage.setItem("site.userinfo",JSON.stringify(U().userInfo)),i){const a=U().userInfo;if(a.is_super_admin!=null&&!a.is_super_admin&&(a.site_ids||[]).indexOf(i)==-1){se({message:t("noPermission"),type:"warning"});return}window.localStorage.setItem("site.siteId",i),window.localStorage.setItem("site.comparisonSiteIdStorage",i),window.open(`${location.origin}/site/`)}else window.open(`${location.origin}/home/index`)},H=(i,a)=>{i==1&&Y.confirm(t("closeSiteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{Pe({site_id:a}).then(u=>{_()})}),i==3&&Se({site_id:a}).then(u=>{_()})},q=i=>{Y.confirm(t("siteDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{Ce(i.site_id).then(a=>{_()}).catch(()=>{})})};return(i,a)=>{const u=ne,L=ie,g=re,x=pe,k=de,$=ue,G=me,B=ce,f=_e,P=fe,J=ge,K=he,W=ve,Q=be;return p(),h("div",Ee,[l(B,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[d("div",Te,[d("span",Ie,r(o(z)),1),d("div",null,[l(u,{type:"primary",class:"w-[100px]",onClick:O},{default:n(()=>[m(r(o(t)("addSite")),1)]),_:1}),l(u,{type:"default",class:"w-[100px]",onClick:a[0]||(a[0]=e=>I())},{default:n(()=>[m(r(o(t)("toSite")),1)]),_:1})])]),l(B,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:n(()=>[l(G,{inline:!0,model:s.searchParam,ref_key:"searchFormRef",ref:E},{default:n(()=>[l(g,{label:o(t)("siteInfo"),prop:"keywords"},{default:n(()=>[l(L,{modelValue:s.searchParam.keywords,"onUpdate:modelValue":a[1]||(a[1]=e=>s.searchParam.keywords=e),placeholder:o(t)("siteNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:o(t)("siteDomain"),prop:"site_domain"},{default:n(()=>[l(L,{modelValue:s.searchParam.site_domain,"onUpdate:modelValue":a[2]||(a[2]=e=>s.searchParam.site_domain=e),placeholder:o(t)("siteDomainPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:o(t)("app"),prop:"app_id"},{default:n(()=>[l(k,{modelValue:s.searchParam.app,"onUpdate:modelValue":a[3]||(a[3]=e=>s.searchParam.app=e),clearable:"",onChange:N,placeholder:o(t)("appIdPlaceholder"),class:"input-width"},{default:n(()=>[l(x,{label:o(t)("selectPlaceholder"),value:"all"},null,8,["label"]),(p(!0),h(S,null,C(Object.values(T.value),(e,c)=>(p(),v(x,{label:e.title,value:e.key,key:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:o(t)("groupId"),prop:"group_id"},{default:n(()=>[l(k,{modelValue:s.searchParam.group_id,"onUpdate:modelValue":a[4]||(a[4]=e=>s.searchParam.group_id=e),clearable:"",placeholder:o(t)("groupIdPlaceholder"),class:"input-width"},{default:n(()=>[l(x,{label:o(t)("selectPlaceholder"),value:""},null,8,["label"]),(p(!0),h(S,null,C(b.value.all,(e,c)=>(p(),v(x,{label:e.group_name,value:e.group_id,key:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:o(t)("status"),prop:"status"},{default:n(()=>[l(k,{modelValue:s.searchParam.status,"onUpdate:modelValue":a[5]||(a[5]=e=>s.searchParam.status=e),clearable:"",placeholder:o(t)("groupIdPlaceholder"),class:"input-width"},{default:n(()=>[l(x,{label:o(t)("selectPlaceholder"),value:""},null,8,["label"]),(p(!0),h(S,null,C(D.value,(e,c)=>(p(),v(x,{label:e,value:c,key:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:o(t)("createTime"),prop:"create_time"},{default:n(()=>[l($,{modelValue:s.searchParam.create_time,"onUpdate:modelValue":a[6]||(a[6]=e=>s.searchParam.create_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":o(t)("startDate"),"end-placeholder":o(t)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(g,{label:o(t)("expireTime"),prop:"expire_time"},{default:n(()=>[l($,{modelValue:s.searchParam.expire_time,"onUpdate:modelValue":a[7]||(a[7]=e=>s.searchParam.expire_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":o(t)("startDate"),"end-placeholder":o(t)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(g,null,{default:n(()=>[l(u,{type:"primary",onClick:a[8]||(a[8]=e=>_())},{default:n(()=>[m(r(o(t)("search")),1)]),_:1}),l(u,{onClick:a[9]||(a[9]=e=>M(E.value))},{default:n(()=>[m(r(o(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),d("div",Le,[ae((p(),v(K,{data:s.data,size:"large"},{empty:n(()=>[d("span",null,r(s.loading?"":o(t)("emptyData")),1)]),default:n(()=>[l(f,{prop:"site_id",label:o(t)("siteId"),width:"100","show-overflow-tooltip":!0},null,8,["label"]),l(f,{label:o(t)("siteInfo"),width:"300",align:"left"},{default:n(({row:e})=>[d("div",$e,[e.logo?(p(),h("img",{key:0,class:"w-[50px] h-[50px] mr-[10px]",src:o(le)(e.logo),alt:""},null,8,Be)):(p(),h("img",Fe)),d("div",Ue,[d("span",null,r(e.site_name||""),1)])])]),_:1},8,["label"]),l(f,{label:o(t)("manager"),width:"150",align:"left"},{default:n(({row:e})=>[d("div",Ye,[d("div",ze,[d("span",null,r(e.admin.username||""),1)])])]),_:1},8,["label"]),l(f,{prop:"group_name",label:o(t)("groupId"),width:"150","show-overflow-tooltip":!0},null,8,["label"]),l(f,{prop:"site_domain",label:o(t)("siteDomain"),width:"150","show-overflow-tooltip":!0},null,8,["label"]),l(f,{prop:"create_time",label:o(t)("createTime"),width:"250","show-overflow-tooltip":!0},null,8,["label"]),l(f,{prop:"expire_time",label:o(t)("expireTime"),width:"250","show-overflow-tooltip":!0},{default:n(({row:e})=>[e.expire_time==0?(p(),h("div",Me,"永久")):(p(),h("div",Ne,r(e.expire_time),1))]),_:1},8,["label"]),l(f,{label:o(t)("status"),width:"100",align:"center"},{default:n(({row:e})=>[e.status==1?(p(),v(P,{key:0,class:"ml-2",type:"success"},{default:n(()=>[m(r(e.status_name),1)]),_:2},1024)):e.status==3?(p(),v(P,{key:1,class:"ml-2",type:"error"},{default:n(()=>[m(r(e.status_name),1)]),_:2},1024)):(p(),v(P,{key:2,class:"ml-2",type:"error"},{default:n(()=>[m(r(e.status_name),1)]),_:2},1024))]),_:1},8,["label"]),l(f,{label:o(t)("operation"),"min-width":"210",align:"right",fixed:"right"},{default:n(({row:e})=>[e.status==1||e.status==3?(p(),v(u,{key:0,type:"primary",link:"",onClick:c=>H(e.status,e.site_id)},{default:n(()=>[m(r(e.status==1?o(t)("closeTxt"):o(t)("openTxt")),1)]),_:2},1032,["onClick"])):oe("",!0),l(u,{type:"primary",link:"",onClick:c=>I(e.site_id)},{default:n(()=>[m(r(o(t)("toSite")),1)]),_:2},1032,["onClick"]),l(J,null,{dropdown:n(()=>[d("div",Oe,[l(u,{type:"primary",link:"",onClick:c=>A(e)},{default:n(()=>[m(r(o(t)("edit")),1)]),_:2},1032,["onClick"]),l(u,{type:"primary",class:"mt-[5px] !ml-[0]",link:"",onClick:c=>q(e)},{default:n(()=>[m(r(o(t)("delete")),1)]),_:2},1032,["onClick"]),l(u,{type:"primary",class:"mt-[5px] !ml-[0]",link:"",onClick:c=>R(e)},{default:n(()=>[m(r(o(t)("info")),1)]),_:2},1032,["onClick"])])]),default:n(()=>[je]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[Q,s.loading]]),d("div",Re,[l(W,{"current-page":s.page,"onUpdate:current-page":a[10]||(a[10]=e=>s.page=e),"page-size":s.limit,"onUpdate:page-size":a[11]||(a[11]=e=>s.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:s.total,onSizeChange:a[12]||(a[12]=e=>_()),onCurrentChange:_},null,8,["current-page","page-size","total"])])])]),_:1}),l(Ve,{ref_key:"addSiteDialog",ref:y,onComplete:a[13]||(a[13]=e=>_())},null,512)])}}});export{yt as default};
