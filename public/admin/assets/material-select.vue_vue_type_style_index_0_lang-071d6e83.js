import{d as G,r as v,n as T,h as n,c as h,a as o,b as R,e as c,w as u,i as x,t as y,u as m,q as b,F as z,T as O,s as k,A as w,R as q,a0 as A,ao as S,U as J,aI as W,E as X,J as H,V as K,W as Q,X as Y}from"./index-6f32d09b.js";/* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  */import{_ as Z}from"./index.vue_vue_type_script_setup_true_lang-0724e2f9.js";/* empty css                 *//* empty css                        *//* empty css                  */import{g as ee,i as te}from"./material-a1349d7e.js";const le={class:"w-full h-full"},ae={class:"flex flex-row items-center group-list"},ie={class:"flex flex-wrap"},oe=["onClick"],se={class:"absolute z-[1] flex items-center justify-center w-full h-full inset-0 bg-black bg-opacity-60"},re={class:"file-box-active absolute z-[1] bottom-0 right-0 w-full h-full"},ne={class:"absolute bottom-[2px] right-[2px] text-white z-[2] leading-none"},ce={class:"flex justify-between items-center"},ue={class:"dialog-footer"},Oe=G({__name:"material-select",props:{limit:{type:Number,default:1}},emits:["confirm"],setup(P,{expose:V,emit:$}){const d=P,p=v(!1),a=T({page:1,limit:20,total:0,loading:!0,data:[],searchParam:{group_id:""}}),F=()=>{p.value=!0,L()},C=v([]);(()=>{ee({}).then(t=>{const e=t.data;e&&(C.value=e)})})();const E=t=>{a.searchParam.group_id=t,f()},f=(t=1)=>{a.loading=!0,a.page=t,te({page:a.page,limit:a.limit,...a.searchParam}).then(e=>{a.loading=!1,a.data=e.data.data,a.data.forEach(i=>{i.image_list=[],i.image_list.push(w(i.url))}),a.total=e.data.total}).catch(()=>{a.loading=!1})};f();const s=v({}),r=v([]),B=t=>{let e=r.value.indexOf(t);return e==-1?0:e+1},D=t=>{if(s.value[t.material_id])delete s.value[t.material_id],r.value.splice(r.value.indexOf(t.material_id),1);else{const e=Object.keys(S(s.value)),i=e.length;if(d.limit==1&&i==d.limit)delete s.value[e[0]],r.value.splice(r.value.indexOf(e[0]),1);else if(d.limit&&i>=d.limit){J.info(b("upload.triggerUpperLimit"));return}s.value[t.material_id]=S(t),r.value.push(t.material_id)}},I=()=>{p.value=!1;let t=s.value||{},e=r.value||{},i=[];Object.values(e).forEach((_,j)=>{for(let g in t)_==g&&i.push(W(t[g]))}),$("confirm",d.limit==1?i[0]??null:i)},L=()=>{s.value={},r.value=[]};return V({showDialog:p}),(t,e)=>{const i=X,_=H,j=Z,g=K,M=Q,U=Y;return n(),h("div",le,[o("div",{onClick:F,class:"cursor-pointer w-full h-full flex flex-col justify-center items-center"},[R(t.$slots,"default")]),c(U,{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=l=>p.value=l),title:m(b)("selectMaterial"),width:"1070px",class:"material-dialog","destroy-on-close":!0},{footer:u(()=>[o("div",ce,[c(M,{"current-page":a.page,"onUpdate:current-page":e[1]||(e[1]=l=>a.page=l),"page-size":a.limit,"onUpdate:page-size":e[2]||(e[2]=l=>a.limit=l),layout:"total, sizes, prev, pager, next, jumper",total:a.total,onSizeChange:e[3]||(e[3]=l=>f()),onCurrentChange:f},null,8,["current-page","page-size","total"]),o("span",ue,[c(i,{onClick:e[4]||(e[4]=l=>p.value=!1)},{default:u(()=>[x(y(m(b)("cancel")),1)]),_:1}),c(i,{type:"primary",onClick:I},{default:u(()=>[x(y(m(b)("confirm")),1)]),_:1})])])]),default:u(()=>[o("div",ae,[c(i,{type:a.searchParam.group_id==""?"primary":"",onClick:e[0]||(e[0]=l=>E(""))},{default:u(()=>[x("全部")]),_:1},8,["type"]),(n(!0),h(z,null,O(C.value,l=>(n(),k(i,{key:l.group_id,type:a.searchParam.group_id==l.group_id?"primary":"",onClick:N=>E(l.group_id)},{default:u(()=>[x(y(l.group_name),1)]),_:2},1032,["type","onClick"]))),128))]),c(g,{class:"!h-[40vh]"},{default:u(()=>[o("div",ie,[(n(!0),h(z,null,O(a.data,(l,N)=>(n(),h("div",{class:"w-[247.50px] mb-[10px] mx-[5px]",key:l.material_id},[o("div",{class:"material-wrap w-full rounded cursor-pointer overflow-hidden relative flex items-center justify-center h-[120px]",onClick:de=>D(l)},[t.operate?(n(),k(_,{key:0,src:m(w)(l.url),fit:"contain"},null,8,["src"])):(n(),k(_,{key:1,src:m(w)(l.url),fit:"contain"},null,8,["src"])),q(o("div",se,[c(j,{name:"element Select",color:"#fff",size:"40px"}),o("div",re,[o("span",ne,y(B(l.material_id)),1)])],512),[[A,s.value[l.material_id]]])],8,oe)]))),128))])]),_:1})]),_:1},8,["modelValue","title"])])}}});export{Oe as _};
