import{d as D,x as C,f as E,r as d,l as S,n as U,h as g,c as R,R as q,s as A,w as s,e as a,u as m,a as f,i as _,t as B,q as N,aW as F,a7 as P,K as $,L as J,M as L,E as O,Y as K}from"./index-5a756a51.js";/* empty css                   *//* empty css                  *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                *//* empty css                 */import{a as M,c as T,b as W,d as Y}from"./config-a16c4254.js";const j={class:"main-container"},z={class:"!border-none mt-4",shadow:"never",style:{width:"640px"}},G={class:"fixed-footer-wrap"},H={class:"fixed-footer"},ue=D({__name:"index",setup(Q){const b=C(),k=E();b.meta.title,d();const v=d(!1),l=d(!0),w=async()=>{l.value=!0;try{await T(),k.push("/channel/weapp/code")}catch{}finally{l.value=!1}},y=d();(()=>{let i="00",e="-1";localStorage.getItem("admin.userinfo")&&(i=JSON.parse(localStorage.getItem("admin.userinfo")).uid),localStorage.getItem("site.userinfo")&&(e=JSON.parse(localStorage.getItem("site.userinfo")).uid),i===e&&(v.value=!0)})();const V=S(()=>({pub_id:[{required:!0,message:"聚推客pub_id必须填写",trigger:"blur"}],api_key:[{required:!0,message:"聚推客apikey必须填写",trigger:"blur"}],mapi_key:[{required:!0,message:"蚂蚁星球apikey必须填写",trigger:"blur"}],secret:[{required:!0,message:"蚂蚁星球secret必须填写",trigger:"blur"}]})),t=U({...{pub_id:"",api_key:"",mapi_key:"",secret:"",site_key:""}});(async()=>{l.value=!0;const i=await W();for(const e in t)t[e]=i.data[e];l.value=!1})();const h=async i=>{l.value||!i||await i.validate(async e=>{e&&(l.value=!0,Y(t).then(p=>{l.value=!1}).catch(()=>{l.value=!1}))})};return(i,e)=>{const u=F,p=P,r=$,n=J,x=L,c=O,I=K;return g(),R("div",j,[q((g(),A(x,{model:t,"label-width":"140px",ref_key:"formRef",ref:y,rules:m(V),class:"page-form"},{default:s(()=>[a(p,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[a(p,{class:"!border-none",shadow:"never",style:{width:"640px"}},{default:s(()=>[a(u,{type:"warning",title:"请完善接口信息为自己后台信息",closable:!1,"show-icon":""})]),_:1}),a(n,{label:"聚推客pub_id",prop:"pub_id"},{default:s(()=>[a(r,{modelValue:t.pub_id,"onUpdate:modelValue":e[0]||(e[0]=o=>t.pub_id=o),placeholder:"聚推客pub_id后台身份ID",class:"input-width",clearable:""},null,8,["modelValue"])]),_:1}),a(n,{label:"聚推客apikey",prop:"api_key"},{default:s(()=>[a(r,{modelValue:t.api_key,"onUpdate:modelValue":e[1]||(e[1]=o=>t.api_key=o),placeholder:"聚推客apikey",class:"input-width",clearable:""},null,8,["modelValue"])]),_:1}),a(n,{label:"蚂蚁星球apikey",prop:"mapi_key"},{default:s(()=>[a(r,{modelValue:t.mapi_key,"onUpdate:modelValue":e[2]||(e[2]=o=>t.mapi_key=o),placeholder:"蚂蚁星球apikey",class:"input-width",clearable:""},null,8,["modelValue"])]),_:1}),a(n,{label:"蚂蚁星球secret",prop:"secret"},{default:s(()=>[a(r,{modelValue:t.secret,"onUpdate:modelValue":e[3]||(e[3]=o=>t.secret=o),placeholder:"蚂蚁星球secret",class:"input-width",clearable:""},null,8,["modelValue"])]),_:1}),a(n,{label:"站点key",prop:"site_key"},{default:s(()=>[a(r,{disabled:"true",modelValue:t.site_key,"onUpdate:modelValue":e[4]||(e[4]=o=>t.site_key=o),placeholder:"站点key",class:"input-width",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[I,l.value]]),f("div",z,[a(u,{type:"info",title:"请先在渠道-微信小程序里面配置好小程序APPID、密钥和上传密钥，小程序需要关闭白名单或者放行IP；这里上传的小程序带插件，没有申请插件会自动尝试申请",closable:!1,"show-icon":""}),a(c,{loading:l.value,class:"mb-6 ml-6",type:"primary",plain:"",onClick:e[5]||(e[5]=o=>m(M)())},{default:s(()=>[_(" 申请小程序插件 ")]),_:1},8,["loading"]),a(c,{loading:l.value,class:"mb-6 ml-6",type:"primary",onClick:e[6]||(e[6]=o=>w())},{default:s(()=>[_(" 云上传小程序 ")]),_:1},8,["loading"])]),f("div",G,[f("div",H,[a(c,{type:"primary",loading:l.value,onClick:e[7]||(e[7]=o=>h(y.value))},{default:s(()=>[_(B(m(N)("confirm")),1)]),_:1},8,["loading"])])])])}}});export{ue as default};
