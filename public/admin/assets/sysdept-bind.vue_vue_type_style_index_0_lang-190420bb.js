import{d as P,r as i,Q as S,n as j,l as q,q as u,h as d,s as _,w as o,a as E,e as f,br as k,i as y,t as h,u as r,R as z,c as L,F as M,T as Q,A as X,cy as Y,ab as $,aC as G,L as H,M as J,E as K,X as W,Y as Z}from"./index-2a89d409.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                  */import{_ as ee}from"./member_head-d9fd7b2c.js";import{c as te,d as ae}from"./data_scope-a8bd6013.js";import{g as le}from"./user-cea0f08d.js";const se={class:"flex items-center"},oe={key:1,src:ee,alt:"",class:"mr-[10px] w-[24px]"},re={class:"dialog-footer"},Le=P({__name:"sysdept-bind",props:{menuTree:{type:Array,default:[]}},emits:["complete"],setup(U,{expose:B,emit:F}){const C=U;let l=i(!1);const s=i(!1),b=i([]);S(()=>C.menuTree,async e=>{b.value=[{dept_name:"顶级",dept_id:0}],b.value.push(...e)});const v={dept_id:""},m=j({...v}),w=i(),V=q(()=>({uid:[{validator:(e,t,n)=>{!m.uid&&c.value===""?n(new Error(u("managerPlaceholder"))):n()},trigger:"blur"}]})),c=i(""),D=i([]);(()=>{le({}).then(({data:e})=>{D.value=e}).catch()})();const N=e=>{c.value=e},R=async e=>{if(s.value||!e)return;let t=ae;await e.validate(async n=>{if(n){s.value=!0;let p=m;p.uid=c.value,t(p).then(g=>{s.value=!1,l.value=!1,F("complete")}).catch(g=>{s.value=!1})}})};return B({showDialog:l,setFormData:async(e=null)=>{if(v.dept_id=e.dept_id,Object.assign(m,v),s.value=!0,e){const t=await(await te(e.dept_id)).data;c.value=t}s.value=!1}}),(e,t)=>{const n=Y,p=$,g=G,T=H,A=J,x=K,I=W,O=Z;return d(),_(I,{modelValue:r(l),"onUpdate:modelValue":t[2]||(t[2]=a=>k(l)?l.value=a:l=a),title:r(u)("bindUserDept"),width:"50%",class:"diy-dialog-wrap","destroy-on-close":!0},{footer:o(()=>[E("span",re,[f(x,{onClick:t[0]||(t[0]=a=>k(l)?l.value=!1:l=!1)},{default:o(()=>[y(h(r(u)("cancel")),1)]),_:1}),f(x,{type:"primary",loading:s.value,onClick:t[1]||(t[1]=a=>R(w.value))},{default:o(()=>[y(h(r(u)("confirm")),1)]),_:1},8,["loading"])])]),default:o(()=>[z((d(),_(A,{model:m,"label-width":"120px",ref_key:"formRef",ref:w,rules:r(V),class:"page-form"},{default:o(()=>[f(T,{label:r(u)("userName"),prop:"uid"},{default:o(()=>[f(g,{"model-value":c.value,placeholder:r(u)("accountNumberPlaceholder"),class:"input-width",filterable:"",clearable:"",multiple:"","default-first-option":!0,onChange:N},{default:o(()=>[(d(!0),L(M,null,Q(D.value,a=>(d(),_(p,{key:a.uid,label:a.username,value:a.uid},{default:o(()=>[E("div",se,[a.head_img?(d(),_(n,{key:0,src:r(X)(a.head_img),size:"small",class:"mr-[10px]"},null,8,["src"])):(d(),L("img",oe)),y(" "+h(a.username),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["model-value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[O,s.value]])]),_:1},8,["modelValue","title"])}}});export{Le as _};
