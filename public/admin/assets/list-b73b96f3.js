import{d as oe,x as re,f as se,r as b,n as $,h as p,c as f,e,w as n,a as d,t as c,u as o,q as l,F as I,T as O,s as S,i as k,R as ne,B as w,A as ie,a3 as de,a5 as ce,ab as me,aC as pe,K as _e,L as ue,bO as fe,E as he,M as be,a7 as ye,ax as ge,ay as xe,ac as ve,ad as ke,aa as we,W as Ce,Y as Ve}from"./index-6f32d09b.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                    *//* empty css                *//* empty css                *//* empty css                  *//* empty css                       */import"./el-form-item-4ed993c7.js";import{_ as Te,a as Pe,b as De,d as Ee,c as Se}from"./order-notes.vue_vue_type_style_index_0_lang-9ebb2bab.js";import{_ as Ne}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                  *//* empty css                   */const Fe={class:"main-container"},Be={class:"flex justify-between items-center"},Ue={class:"text-page-title"},Me={class:"table-body min-h-[150px]"},Ye={key:0},ze={class:"flex items-center justify-between bg-[#f7f8fa] mt-[10px] border-[#e4e7ed] border-solid border-b-[1px] px-3 h-[35px] text-[12px] text-[#666]"},$e={class:"ml-5"},Ie={key:0,class:"ml-5"},Oe={class:"flex cursor-pointer"},Re={class:"flex items-center min-w-[50px] mr-[10px]"},je=["src"],Ae={key:1,class:"w-[50px] h-[50px]",src:"",alt:""},Le={class:"flex flex-col"},qe={class:"multi-hidden text-[14px]"},He={class:"flex flex-col"},Ge={class:"text-[13px]"},Ke={class:"text-[13px] mt-[5px]"},We={class:"text-[14px]"},Je={class:"text-[14px]"},Qe={class:"flex flex-col"},Xe=["onClick"],Ze={class:"text-[14px]"},ea={key:0,class:"text-[14px]"},aa={key:0,class:"text-[14px] min-h-[30px] leading-[30px] px-3 bg-[#fff0e5] text-[#ff7f5b]"},ta={class:"mr-[5px]"},la={class:"mt-[16px] flex justify-end"},oa=oe({__name:"list",setup(ra){const T=re(),N=se(),R=T.meta.title,F=b(T.query.status||""),j=b([]),B=b([]);(async()=>{j.value=await(await Pe()).data,B.value=await(await De()).data})();const a=$({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{search_type:"order_no",search_name:"",nickname:"",pay_type:"",status:T.query.status||"",create_time:[],pay_time:[]}}),U=b(),y=$({}),P=b(null),C=b(!1),A=()=>{if(C.value){C.value=!1;for(const s in a.data)P.value[s].clearSelection(),delete y["order_"+a.data[s].order_id]}else{C.value=!0;for(const s in a.data){let t=!1;for(const _ in a.data[s].order_gift_card)a.data[s].order_gift_card[_].status==1&&(P.value[s].toggleRowSelection(a.data[s].order_gift_card[_],!0),t=!0);t&&(y["order_"+a.data[s].order_id]=de(a.data[s]))}}},L=(s,t)=>{let _=!1,x=null;for(let u=0;u<a.data.length;u++)if(a.data[u].order_id==t.order_id){x=a.data[u];break}for(let u=0;u<s.length;u++)if(s[u].order_id==t.order_id){_=!0;break}_?y["order_"+t.order_id]=x:delete y["order_"+t.order_id]},q=(s,t)=>!0,h=(s=1)=>{a.loading=!0,a.page=s,Ee({page:a.page,limit:a.limit,...a.searchParam}).then(t=>{a.loading=!1,a.data=t.data.data.map(_=>(_.order_gift_card=[_],_)),a.total=t.data.total}).catch(()=>{a.loading=!1})};h();const H=s=>{a.searchParam.status=s,C.value=!1;for(let t in y)delete y[t];h()},G=s=>{s&&(s.resetFields(),h())},K=s=>{N.push("/shop_giftcard/order/detail?order_id="+s.order_id)},D=b(null),W=s=>{D.value.setFormData(s),D.value.showDialog=!0},J=s=>{const t=N.resolve({path:"/member/detail",query:{id:s}});window.open(t.href,"_blank")},Q=s=>{ce.confirm(l("orderCloseTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{Se(s.order_id).then(()=>{h()})})};return(s,t)=>{const _=me,x=pe,u=_e,g=ue,M=fe,v=he,X=be,Y=ye,V=ge,Z=xe,m=ve,z=ke,ee=we,ae=Ce,te=Ve;return p(),f("div",Fe,[e(Y,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[d("div",Be,[d("span",Ue,c(o(R)),1)]),e(Y,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:n(()=>[e(X,{inline:!0,model:a.searchParam,ref_key:"searchFormRef",ref:U},{default:n(()=>[e(g,{label:o(l)("orderInfo"),prop:"search_name"},{default:n(()=>[e(x,{modelValue:a.searchParam.search_type,"onUpdate:modelValue":t[0]||(t[0]=r=>a.searchParam.search_type=r),clearable:"",class:"input-item"},{default:n(()=>[e(_,{label:o(l)("orderNo"),value:"order_no"},null,8,["label"]),e(_,{label:o(l)("outTradeNo"),value:"out_trade_no"},null,8,["label"])]),_:1},8,["modelValue"]),e(u,{class:"input-item ml-3",modelValue:a.searchParam.search_name,"onUpdate:modelValue":t[1]||(t[1]=r=>a.searchParam.search_name=r),modelModifiers:{trim:!0},maxlength:"20"},null,8,["modelValue"])]),_:1},8,["label"]),e(g,{label:o(l)("memberInfo"),prop:"nickname"},{default:n(()=>[e(u,{class:"w-[200px]",modelValue:a.searchParam.nickname,"onUpdate:modelValue":t[2]||(t[2]=r=>a.searchParam.nickname=r),modelModifiers:{trim:!0},placeholder:o(l)("memberInfoPlaceholder"),maxlength:"20"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(g,{label:o(l)("payType"),prop:"pay_type"},{default:n(()=>[e(x,{modelValue:a.searchParam.pay_type,"onUpdate:modelValue":t[3]||(t[3]=r=>a.searchParam.pay_type=r),clearable:"",class:"input-item"},{default:n(()=>[(p(!0),f(I,null,O(B.value,(r,E)=>(p(),S(_,{key:E,label:r.name,value:r.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(g,{label:o(l)("createTime"),prop:"create_time"},{default:n(()=>[e(M,{modelValue:a.searchParam.create_time,"onUpdate:modelValue":t[4]||(t[4]=r=>a.searchParam.create_time=r),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":o(l)("startDate"),"end-placeholder":o(l)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),e(g,{label:o(l)("payTime"),prop:"pay_time"},{default:n(()=>[e(M,{modelValue:a.searchParam.pay_time,"onUpdate:modelValue":t[5]||(t[5]=r=>a.searchParam.pay_time=r),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":o(l)("startDate"),"end-placeholder":o(l)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),e(g,null,{default:n(()=>[e(v,{type:"primary",onClick:t[6]||(t[6]=r=>h())},{default:n(()=>[k(c(o(l)("search")),1)]),_:1}),e(v,{onClick:t[7]||(t[7]=r=>G(U.value))},{default:n(()=>[k(c(o(l)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Z,{modelValue:F.value,"onUpdate:modelValue":t[8]||(t[8]=r=>F.value=r),class:"demo-tabs",onTabChange:H},{default:n(()=>[e(V,{label:o(l)("all"),name:""},null,8,["label"]),e(V,{label:o(l)("toBePaid"),name:"1"},null,8,["label"]),e(V,{label:o(l)("completed"),name:"2"},null,8,["label"]),e(V,{label:o(l)("closed"),name:"-1"},null,8,["label"])]),_:1},8,["modelValue"]),d("div",null,[e(z,{data:a.data,size:"large",class:"table-top",onSelectAll:A},{default:n(()=>[e(m,{type:"selection",width:"40"}),e(m,{label:o(l)("giftCard"),"min-width":"200"},null,8,["label"]),e(m,{label:o(l)("cardNumber"),"min-width":"120"},null,8,["label"]),e(m,{label:o(l)("cardRightType"),"min-width":"120"},null,8,["label"]),e(m,{label:o(l)("orderMoney"),"min-width":"120"},null,8,["label"]),e(m,{label:o(l)("buyInfo"),"min-width":"120"},null,8,["label"]),e(m,{label:o(l)("orderStatus"),"min-width":"100"},null,8,["label"]),e(m,{label:o(l)("payTime"),"min-width":"120"},null,8,["label"]),e(m,{label:o(l)("operation"),fixed:"right",align:"right","min-width":"120"},null,8,["label"])]),_:1},8,["data"]),ne((p(),f("div",Me,[a.loading?w("",!0):(p(),f("div",Ye,[a.data.length?(p(!0),f(I,{key:0},O(a.data,(r,E)=>(p(),f("div",{key:E},[d("div",ze,[d("div",null,[d("span",null,c(o(l)("orderNo"))+"："+c(r.order_no),1),d("span",$e,c(o(l)("createTime"))+"："+c(r.create_time),1),r.pay?(p(),f("span",Ie,c(o(l)("payType"))+"："+c(r.pay.type_name),1)):w("",!0)]),d("div",null,[e(v,{type:"primary",link:"",onClick:i=>K(r)},{default:n(()=>[k(c(o(l)("info")),1)]),_:2},1032,["onClick"]),e(v,{type:"primary",link:"",onClick:i=>W(r)},{default:n(()=>[k(c(o(l)("notes")),1)]),_:2},1032,["onClick"])])]),e(z,{data:r.order_gift_card,size:"large","show-header":!1,ref_for:!0,ref_key:"multipleTable",ref:P,onSelect:L},{default:n(()=>[e(m,{type:"selection",width:"40",selectable:q}),e(m,{"min-width":"200"},{default:n(({row:i})=>[d("div",Oe,[d("div",Re,[i.card_cover?(p(),f("img",{key:0,class:"w-[50px] h-[50px]",src:o(ie)(i.card_cover),alt:""},null,8,je)):(p(),f("img",Ae))]),d("div",Le,[d("p",qe,c(i.body),1)])])]),_:1}),e(m,{"min-width":"120"},{default:n(({row:i})=>[d("div",He,[d("span",Ge,"￥"+c(i.card_price),1),d("span",Ke,c(i.num)+c(o(l)("piece")),1)])]),_:1}),e(m,{"min-width":"120"},{default:n(({row:i})=>[d("span",We,c(i.card_right_type_name),1)]),_:1}),e(m,{"min-width":"120"},{default:n(({row:i})=>[d("span",Je,"￥"+c(i.order_money),1)]),_:1}),e(m,{"min-width":"120"},{default:n(({row:i})=>[d("div",Qe,[d("span",{class:"text-[12px] text-primary cursor-pointer",onClick:le=>J(i.member.member_id)},c(i.member.nickname),9,Xe)])]),_:1}),e(m,{"min-width":"100"},{default:n(({row:i})=>[d("span",Ze,c(i.status_name),1)]),_:1}),e(m,{"min-width":"120"},{default:n(({row:i})=>[i.pay_time!=0?(p(),f("span",ea,c(i.pay_time),1)):w("",!0)]),_:1}),e(m,{align:"right","min-width":"120"},{default:n(({row:i})=>[i.status==1?(p(),S(v,{key:0,type:"primary",link:"",onClick:le=>Q(i)},{default:n(()=>[k(c(o(l)("orderClose")),1)]),_:2},1032,["onClick"])):w("",!0)]),_:1})]),_:2},1032,["data"]),r.shop_remark?(p(),f("div",aa,[d("span",ta,c(o(l)("notes"))+"：",1),d("span",null,c(r.shop_remark),1)])):w("",!0)]))),128)):(p(),S(ee,{key:1,"image-size":1,description:o(l)("emptyData")},null,8,["description"]))]))])),[[te,a.loading]]),d("div",la,[e(ae,{"current-page":a.page,"onUpdate:current-page":t[9]||(t[9]=r=>a.page=r),"page-size":a.limit,"onUpdate:page-size":t[10]||(t[10]=r=>a.limit=r),layout:"total, sizes, prev, pager, next, jumper",total:a.total,onSizeChange:t[11]||(t[11]=r=>h()),onCurrentChange:h},null,8,["current-page","page-size","total"])])])]),_:1}),e(Te,{ref_key:"orderNotesDialog",ref:D,onComplete:h},null,512)])}}});const Na=Ne(oa,[["__scopeId","data-v-13e6fe17"]]);export{Na as default};
