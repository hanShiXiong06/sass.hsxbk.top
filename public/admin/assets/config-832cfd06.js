import{d as H,x as W,f as X,r as g,l as ee,q as t,h as f,c as y,R as le,u as e,s as F,w as p,e as i,a as n,t as s,i as h,F as P,T as k,c1 as N,ca as j,B as D,U as b,as as oe,at as te,L as ae,K as re,bO as ne,au as se,cb as de,E as ie,a6 as pe,M as ue,Y as ce,p as me,g as _e}from"./index-f7a01263.js";/* empty css                   *//* empty css                     *//* empty css                *//* empty css                  *//* empty css                          *//* empty css                    *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                       *//* empty css                 */import{g as fe,a as ve,b as xe,s as ye}from"./sale-76e32896.js";import{_ as we}from"./_plugin-vue_export-helper-c27b6911.js";const B=V=>(me("data-v-33621d04"),V=V(),_e(),V),ge={class:"main-container"},he={class:"text text-[14px] leading-[25px]"},be={key:0,class:"flex flex-col"},Ve=B(()=>n("span",{class:"text-[#666] ml-[5px]"},"日",-1)),Ce={class:"text-[#999] text-[12px]"},Se={key:1,class:"flex flex-col"},Te={class:"text-[#999] text-[12px]"},Ee={key:2,class:"flex flex-col items-center"},Fe={class:"flex flex-col mb-[5px]"},Pe=B(()=>n("span",{class:"text-[#666] ml-[5px]"},"日",-1)),ke={class:"text-[#999] text-[12px]"},Ne={class:"text-[#999] text-[12px]"},De={class:"flex items-center"},Oe={key:0,class:"flex items-center ml-[10px] text-[#666]"},Ue={class:"ml-[10px]"},$e={class:"flex flex-col"},Ie={key:0,class:"flex flex-col w-[500px] mb-[10px]"},Me={class:"border-0 mb-[10px] border-solid border-b-[1px] border-[var(--el-border-color-lighter)] flex justify-between"},Re=["onClick"],je={class:"flex items-center pl-[30px]"},Be={class:"flex items-center"},Je={class:"flex items-center mt-[10px] pl-[30px]"},Ke={class:"flex items-center"},Le={class:"fixed-footer-wrap"},qe={class:"fixed-footer"},Qe=H({__name:"config",setup(V){const J=W();X(),J.meta.title;let l=g({is_open:"1",period_type:"month",period:"",send_type:"active",condition:[],reward:[{end:1,reward:{commission:1}}]}),m=g({type:[],content:{order_money:0}}),w=g({index:0}),O=g(!0),T=g();(()=>{fe().then(a=>{l.value.is_open=a.data.is_open,l.value.period=a.data.period,l.value.period_type=a.data.period_type,l.value.send_type=a.data.send_type,l.value.reward=a.data.reward,w.value.index=l.value.reward.length,l.value.condition=a.data.condition||{},m.value.type=Object.keys(l.value.condition),m.value.content=JSON.parse(JSON.stringify(l.value.condition)),O.value=!1})})();let U=g({});(()=>{ve().then(a=>{U.value=a.data})})();let $=g({});(()=>{xe().then(a=>{$.value=a.data})})();const K=a=>{l.value.period="",setTimeout(()=>{a&&a.clearValidate("period")})},L=a=>{let o={end:1,reward:{commission:1}};Object.keys(l.value.reward).length&&(o.end=parseFloat(l.value.reward[a-1].end)+1),l.value.reward.push(o),w.value.index=++w.value.index},q=a=>{l.value.reward.splice(a,1),w.value.index=--w.value.index},Q=(a,o)=>{let d=a<0||a>=0&&o<=0?0:l.value.reward[a-1].end,u=a+1>=l.value.reward.length?"--":l.value.reward[a+1].end;if(!/^[1-9]\d*$/.test(o))return b.error(`${t("rewardTips5")}`),l.value.reward[a].end=1,!1;if(parseFloat(d)>=parseFloat(o))return b.error(`${t("rewardTips3")}${d}`),l.value.reward[a].end=parseFloat(d)+1,!1;if(u!="--"&&parseFloat(u)<=parseFloat(o))return b.error(`${t("rewardTips4")}${u}`),l.value.reward[a].end=parseFloat(u)-1,!1},A=(a,o)=>{if(isNaN(o)||o=="")return b.error(`${t("correctNumber")}`),l.value.reward[a].reward.commission=1,!1;if(parseFloat(o)<0)return b.error(`${t("moreThanZero")}`),l.value.reward[a].reward.commission=1,!1},G=ee(()=>({period:[{validator:(a,o,d)=>{l.value.period_type=="year"&&!l.value.period&&d(new Error(t("fillDatePlaceholder")));let u=/^(?:30|31|[1-2]?[0-9])$/;(l.value.period_type=="month"||l.value.period_type=="quarter")&&(o<=0||!u.test(o))&&d(new Error(t("correctNumber1"))),d()},trigger:["blur","change"]}],condition:[{validator:(a,o,d)=>{m.value.type.length||d(new Error(t("selectConditionPlaceholder"))),m.value.type.forEach((u,c)=>{m.value.content[u]||d(new Error(t("fillConditionPlaceholder"))),u=="order_money"&&m.value.content[u]<=0&&d(new Error(t("orderMoneyPlaceholder")))}),d()},trigger:["blur","change"]}],reward:[{validator:(a,o,d)=>{const u=c=>{let x=parseFloat(c);if(typeof x!="number"||isNaN(x))return!1;const C=x.toString(),S=C.indexOf(".");return S===-1?!0:C.length-S-1<=2};l.value.reward.length&&Number(l.value.is_open)&&l.value.reward.forEach((c,x)=>{(c.reward.commission<=0||!u(c.reward.commission))&&d(new Error(t("rewardCommissionPlaceholder")))}),d()},trigger:["blur"]}]}));let E=g(!1);const Y=async a=>{E.value||!a||await a.validate(async o=>{if(o){let d={};m.value.type.forEach((c,x)=>{m.value.content[c]!=null&&(d[c]=m.value.content[c])}),l.value.condition=JSON.parse(JSON.stringify(d));let u=JSON.parse(JSON.stringify(l.value));ye(u).then(c=>{E.value=!1}).catch(()=>{E.value=!1})}})};return(a,o)=>{const d=oe,u=te,c=ae,x=re,C=ne,S=se,I=de,M=ie,R=pe,Z=ue,z=ce;return f(),y("div",ge,[le((f(),F(R,{class:"card !border-none",shadow:"never"},{default:p(()=>[i(Z,{class:"page-form",model:e(l),"label-width":"180px",rules:e(G),ref_key:"formRef",ref:T},{default:p(()=>[n("div",he,s(e(t)("baseTitle")),1),i(R,{class:"card !border-none",shadow:"never"},{default:p(()=>[i(c,{label:e(t)("isEnable")},{default:p(()=>[i(u,{modelValue:e(l).is_open,"onUpdate:modelValue":o[0]||(o[0]=r=>e(l).is_open=r)},{default:p(()=>[i(d,{label:"1"},{default:p(()=>[h(s(e(t)("are")),1)]),_:1}),i(d,{label:"0"},{default:p(()=>[h(s(e(t)("no")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),i(c,{label:e(t)("salePeriodType")},{default:p(()=>[i(u,{modelValue:e(l).period_type,"onUpdate:modelValue":o[1]||(o[1]=r=>e(l).period_type=r),onChange:o[2]||(o[2]=r=>K(e(T)))},{default:p(()=>[(f(!0),y(P,null,k(e(U),(r,_)=>(f(),F(d,{key:_,label:_},{default:p(()=>[h(s(r),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),i(c,{label:e(t)("salePeriod"),prop:"period"},{default:p(()=>[e(l).period_type=="month"?(f(),y("div",be,[n("div",null,[i(x,{class:"!w-[214px]",modelValue:e(l).period,"onUpdate:modelValue":o[3]||(o[3]=r=>e(l).period=r),placeholder:e(t)("monthDatePlaceholder"),onKeyup:o[4]||(o[4]=r=>e(N)(r)),maxlength:"2"},null,8,["modelValue","placeholder"]),Ve]),n("span",Ce,s(e(t)("monthQuarterPlaceholder")),1)])):e(l).period_type=="year"?(f(),y("div",Se,[i(C,{modelValue:e(l).period,"onUpdate:modelValue":o[5]||(o[5]=r=>e(l).period=r),type:"date",placeholder:e(t)("selectDatePlaceholder"),class:"!w-[214px]",format:"MM-DD","value-format":"MM-DD"},null,8,["modelValue","placeholder"]),n("span",Te,s(e(t)("yearQuarterPlaceholder")),1)])):(f(),y("div",Ee,[n("div",Fe,[n("div",null,[i(x,{class:"!w-[214px]",modelValue:e(l).period,"onUpdate:modelValue":o[6]||(o[6]=r=>e(l).period=r),placeholder:e(t)("monthDatePlaceholder"),onKeyup:o[7]||(o[7]=r=>e(N)(r)),maxlength:"2"},null,8,["modelValue","placeholder"]),Pe]),n("span",ke,s(e(t)("quarterPlaceholder")),1),n("span",Ne,s(e(t)("monthQuarterPlaceholder")),1)])]))]),_:1},8,["label"]),i(c,{label:e(t)("saleSendType")},{default:p(()=>[i(u,{modelValue:e(l).send_type,"onUpdate:modelValue":o[8]||(o[8]=r=>e(l).send_type=r)},{default:p(()=>[(f(!0),y(P,null,k(e($),(r,_)=>(f(),F(d,{key:_,label:_},{default:p(()=>[h(s(r),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),i(c,{label:e(t)("condition"),prop:"condition"},{default:p(()=>[i(I,{modelValue:e(m).type,"onUpdate:modelValue":o[11]||(o[11]=r=>e(m).type=r)},{default:p(()=>[i(S,{label:"order_money",class:"!h-[auto] !flex !items-center"},{default:p(()=>[n("div",De,[n("span",null,s(e(t)("orderMoney")),1),e(m).type.indexOf("order_money")>-1?(f(),y("div",Oe,[i(x,{modelValue:e(m).content.order_money,"onUpdate:modelValue":o[9]||(o[9]=r=>e(m).content.order_money=r),clearable:"",class:"!w-[100px]",maxlength:"60",onKeyup:o[10]||(o[10]=r=>e(j)(r))},null,8,["modelValue"]),n("span",Ue,s(e(t)("orderMoneyTips1")),1)])):D("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),i(c,{label:e(t)("reward"),prop:"reward"},{default:p(()=>[n("div",$e,[(f(!0),y(P,null,k(e(w).index,(r,_)=>(f(),y("div",{key:r},[e(l).reward[_]?(f(),y("div",Ie,[n("div",Me,[n("span",null,s(r)+s(e(t)("rewardTips1")),1),e(w).index>1?(f(),y("span",{key:0,onClick:v=>q(_),class:"text-[var(--el-color-primary)] cursor-pointer"},s(e(t)("delete")),9,Re)):D("",!0)]),n("div",je,[n("span",null,s(e(t)("rewardIndex")),1),n("div",Be,[n("span",null,s(e(t)("rewardIndexTips1")),1),i(x,{modelValue:e(l).reward[_].end,"onUpdate:modelValue":v=>e(l).reward[_].end=v,clearable:"",class:"!w-[100px] mx-[8px]",onKeyup:o[12]||(o[12]=v=>e(N)(v)),onChange:v=>Q(_,v)},null,8,["modelValue","onUpdate:modelValue","onChange"]),n("span",null,s(e(t)("rewardIndexTips2")),1)])]),n("div",Je,[n("span",null,s(e(t)("rewardContent")),1),n("div",Ke,[n("span",null,s(e(t)("rewardContentTips1")),1),i(x,{modelValue:e(l).reward[_].reward.commission,"onUpdate:modelValue":v=>e(l).reward[_].reward.commission=v,clearable:"",onChange:v=>A(_,v),class:"!w-[100px] mx-[8px]",onKeyup:o[13]||(o[13]=v=>e(j)(v))},null,8,["modelValue","onUpdate:modelValue","onChange"]),n("span",null,s(e(t)("rewardContentTips2")),1)])])])):D("",!0)]))),128)),i(M,{class:"mt-[15px] w-[120px] ml-[30px]",type:"primary",onClick:o[14]||(o[14]=r=>L(e(w).index))},{default:p(()=>[h(s(e(t)("rewardTips2"))+s(e(w).index+1)+s(e(t)("rewardTips1")),1)]),_:1})])]),_:1},8,["label"])]),_:1})]),_:1},8,["model","rules"])]),_:1})),[[z,e(O)]]),n("div",Le,[n("div",qe,[i(M,{type:"primary",onClick:o[15]||(o[15]=r=>Y(e(T)))},{default:p(()=>[h(s(e(t)("save")),1)]),_:1})])])])}}});const pl=we(Qe,[["__scopeId","data-v-33621d04"]]);export{pl as default};
