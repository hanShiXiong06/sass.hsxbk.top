import{d as Y,f as H,x as J,r as _,n as O,a2 as X,h as T,c as Z,e as a,w as s,a as c,t as i,u as r,i as g,q as t,R as ee,s as te,a5 as B,U as R,aq as ae,E as oe,K as ne,L as le,M as se,a7 as re,aw as ie,ad as de,a1 as ce,aa as me,ae as pe,W as ue,Y as _e}from"./index-99f00cf3.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  */import{K as ge,L as fe,M as he,N as be}from"./marketing-47e9cfd6.js";const ve={class:"main-container"},ke={class:"flex justify-between items-center"},xe={class:"text-page-title"},ye={class:"mb-[10px] flex items-center"},Ce={style:{display:"inline-flex","align-items":"center"}},we={class:"mr-[5px]"},Ee={class:"mt-[16px] flex justify-end"},Ae=Y({__name:"list",setup(Te){const k=H(),V=J().meta.title,f=_(!1),x=_(),o=O({page:1,limit:10,total:0,loading:!1,data:[],searchParam:{name:"",order:"",sort:""}}),d=(n=1)=>{o.loading=!0,o.page=n,ge({page:o.page,limit:o.limit,...o.searchParam}).then(e=>{o.loading=!1,o.data=e.data.data,o.total=e.data.total}).catch(()=>{o.loading=!1})},N=n=>{n&&(n.resetFields(),o.searchParam.name="",d())},P=()=>{k.push("/shop/marketing/goods_rank/edit")},S=n=>{k.push("/shop/marketing/goods_rank/edit?rank_id="+n.rank_id)},$=n=>{B.confirm(t("deleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{fe(n).then(()=>{d()}).catch(()=>{})})},z=n=>{let e="";n.order=="ascending"?e="asc":n.order=="descending"&&(e="desc"),e&&(o.searchParam.order=n.prop,o.searchParam.sort=e),d()},h=_(),b=_(!1),D=n=>{b.value=!1,y.value.toggleAllSelection()},y=_(),u=_([]),F=n=>{u.value=n,h.value=!1,u.value.length>0&&u.value.length<o.data.length?b.value=!0:b.value=!1,u.value.length==o.data.length&&(h.value=!0)},L=()=>{if(u.value.length==0){R({type:"warning",message:`${t("batchEmptySelectedGoodsTips")}`});return}B.confirm(t("batchGoodsDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{if(f.value)return;f.value=!0;const n=[];u.value.forEach(e=>{n.push(e.rank_id)}),he({rank_id:n}).then(()=>{d(),f.value=!1}).catch(()=>{f.value=!1})})},U={number:/^\d{0,10}$/,digit:/^\d{0,10}(.?\d{0,2})$/},G=ae((n,e)=>{if(isNaN(n)||!U.number.test(n)){R({type:"warning",message:`${t("sortTips")}`});return}n>99999999&&(e.sort=99999999),be({rank_id:e.rank_id,sort:n}).then(p=>{d()})});return d(),(n,e)=>{const p=oe,C=ne,w=le,I=se,E=re,M=ie,m=de,j=X("QuestionFilled"),q=ce,K=me,Q=pe,A=ue,W=_e;return T(),Z("div",ve,[a(E,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[c("div",ke,[c("span",xe,i(r(V)),1),a(p,{type:"primary",onClick:P},{default:s(()=>[g(i(r(t)("addRanking")),1)]),_:1})]),a(E,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:s(()=>[a(I,{inline:!0,model:o.searchParam,ref_key:"searchFormRef",ref:x},{default:s(()=>[a(w,{label:r(t)("rankName"),prop:"rankName"},{default:s(()=>[a(C,{modelValue:o.searchParam.name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.searchParam.name=l),modelModifiers:{trim:!0},placeholder:r(t)("ramkkNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(w,null,{default:s(()=>[a(p,{type:"primary",onClick:e[1]||(e[1]=l=>d())},{default:s(()=>[g(i(r(t)("search")),1)]),_:1}),a(p,{onClick:e[2]||(e[2]=l=>N(x.value))},{default:s(()=>[g(i(r(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),c("div",null,[c("div",ye,[a(M,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=l=>h.value=l),size:"large",class:"px-[14px]",onChange:D,indeterminate:b.value},null,8,["modelValue","indeterminate"]),a(p,{onClick:L,size:"small"},{default:s(()=>[g(i(r(t)("batchDeletion")),1)]),_:1})]),ee((T(),te(Q,{data:o.data,size:"large",ref_key:"goodBamkListTableRef",ref:y,onSortChange:z,onSelectionChange:F},{empty:s(()=>[c("span",null,i(o.loading?"":r(t)("emptyData")),1)]),default:s(()=>[a(m,{type:"selection",width:"55"}),a(m,{prop:"name",label:r(t)("rankName"),"min-width":"130"},null,8,["label"]),a(m,{prop:"show_goods_num",label:r(t)("showGoodsNum"),"min-width":"130"},null,8,["label"]),a(m,{prop:"goods_source_name",label:r(t)("goodsSource"),"min-width":"130"},null,8,["label"]),a(m,{prop:"rule_type_name",label:r(t)("ruleType"),"min-width":"130"},null,8,["label"]),a(m,{prop:"sort","min-width":"120","show-overflow-tooltip":!0,sortable:"custom"},{header:s(()=>[c("div",Ce,[c("span",we,i(r(t)("sort")),1),a(K,{class:"box-item",effect:"light",content:r(t)("sortRules"),placement:"top"},{default:s(()=>[a(q,{color:"#666"},{default:s(()=>[a(j)]),_:1})]),_:1},8,["content"])])]),default:s(({row:l})=>[a(C,{modelValue:l.sort,"onUpdate:modelValue":v=>l.sort=v,modelModifiers:{number:!0},class:"w-[70px]",maxlength:"8",onBlur:v=>r(G)(l.sort,l)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:1}),a(m,{prop:"create_time",label:r(t)("createTime"),"min-width":"150",sortable:"custom"},{default:s(({row:l})=>[c("div",null,i(l.create_time),1)]),_:1},8,["label"]),a(m,{label:r(t)("operation"),fixed:"right",align:"right","min-width":"120"},{default:s(({row:l})=>[a(p,{type:"primary",link:"",onClick:v=>S(l)},{default:s(()=>[g(i(r(t)("edit")),1)]),_:2},1032,["onClick"]),a(p,{type:"primary",link:"",onClick:v=>$(l.rank_id)},{default:s(()=>[g(i(r(t)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[W,o.loading]]),c("div",Ee,[a(A,{"current-page":o.page,"onUpdate:current-page":e[4]||(e[4]=l=>o.page=l),"page-size":o.limit,"onUpdate:page-size":e[5]||(e[5]=l=>o.limit=l),layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:e[6]||(e[6]=l=>d()),onCurrentChange:d},null,8,["current-page","page-size","total"])])])]),_:1})])}}});export{Ae as default};
