import{d as J,x as H,f as W,r as D,n as E,l as X,q as o,aJ as Y,cq as Z,h as u,c as v,a as c,t as _,u as s,e as r,w as n,c1 as ee,F as k,T as M,s as P,i as L,cQ as te,cN as F,cR as ae,Q as le,cS as oe,U as se,K as re,L as de,aa as ie,aB as ne,E as ce,M as me,a6 as ue,p as pe,g as _e}from"./index-f7a01263.js";/* empty css                *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  */import ge from"./index-e6c6f5a6.js";import{r as fe,t as ve,u as be}from"./delivery-3ed9abb1.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-0595c85c.js";/* empty css                  *//* empty css                   */import"./attachment-893e498c.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-473c7dda.js";/* empty css                      *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css               *//* empty css                    *//* empty css                    */import"./el-dropdown-item-4ed993c7.js";import"./index.vue_vue_type_script_setup_true_lang-a36ce1b6.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-73e73d1c.js";import"./sortable.esm-be94e56d.js";const T=y=>(pe("data-v-dff5ec22"),y=y(),_e(),y),ye={class:"main-container"},we={class:"detail-head"},Ve=T(()=>c("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1)),xe={class:"ml-[1px]"},ke=T(()=>c("span",{class:"adorn"},"|",-1)),Me={key:0,class:"right"},Pe={key:1,class:"right"},Le={class:"text-[12px] text-[#999]"},Te=T(()=>c("div",{class:"mt-4"},[c("div",{id:"TxMap",class:"map-item w-[800px] h-[500px]"})],-1)),Ce={class:"fixed-footer-wrap"},qe={class:"fixed-footer"},Se=J({__name:"store_edit",setup(y){const I=H(),C=W(),w=parseInt(I.query.id),V=D(!1),q={store_id:0,store_name:"",store_desc:"",store_logo:"",store_mobile:"",province_id:0,province_name:"",city_id:0,city_name:"",district_id:0,district_name:"",address:"",full_address:"",longitude:"",latitude:"",trade_time:""},e=E({...q});w&&(async(a=0)=>{Object.assign(e,q);const t=await(await fe(a)).data;Object.keys(e).forEach(i=>{t[i]!=null&&(e[i]=t[i])})})(w);const S=D(),U=X(()=>({store_name:[{required:!0,message:o("storeNamePlaceholder"),trigger:"blur"}],store_logo:[{required:!0,message:o("storeLogoPlaceholder"),trigger:"blur"}],store_mobile:[{required:!0,message:o("storeMobilePlaceholder"),trigger:"blur"}],province_id:[{required:!0,message:o("provinceIdPlaceholder"),trigger:"blur"}],city_id:[{required:!0,message:o("cityIdPlaceholder"),trigger:"blur"}],district_id:[{required:!0,message:o("districtIdPlaceholder"),trigger:"blur"}],address_area:[{required:!0,validator:B,trigger:"blur"}],address:[{required:!0,message:o("storeAddressDetailPlaceholder"),trigger:"blur"}],trade_time:[{required:!0,message:o("tradeTimePlaceholder"),trigger:"blur"}]})),B=(a,t,i)=>{(e.province_name==""||e.city_name==""||e.district_name=="")&&i(new Error(o("storeAddressPlaceholder"))),i()},N=async a=>{V.value||!a||await a.validate(async t=>{t&&(V.value=!0,(w?ve:be)(e).then(p=>{V.value=!1,C.push("/shop/order/delivery/store")}).catch(()=>{V.value=!1}))})},g=E({province:[],city:[],district:[]});(()=>{te(1).then(a=>{g.province=a.data})})();const j=a=>{Object.keys(a).length==0?a.id=e.province_id:(e.province_id=a.id,e.province_name=a.name),F(a.id).then(t=>{g.city=t.data})},O=a=>{Object.keys(a).length==0?a.id=e.city_id:(e.city_id=a.id,e.city_name=a.name),F(a.id).then(t=>{g.district=t.data})},R=a=>{e.district_id=a.id,e.district_name=a.name},z=()=>{e.province_id&&e.city_id&&e.district_id&&e.address&&(e.full_address=e.province_name+e.city_name+e.district_name+e.address,ae({address:e.full_address}).then(a=>{e.latitude=a.data.result.location.lat,e.longitude=a.data.result.location.lng}))};let b;const G=()=>{let a=e.latitude,t=e.longitude;e.latitude==0&&(a="39.90469"),e.longitude==0&&(t="116.40717");const i=new window.TMap.LatLng(a,t);b=new window.TMap.Map("TxMap",{center:i,zoom:17,viewMode:"2D",showControl:!0}),b.on("click",p=>{const m={lat:p.latLng.getLat().toFixed(6),lng:p.latLng.getLng().toFixed(6)};$(m.lat,m.lng,1),d.updateGeometries({id:"shop",position:p.latLng})});const d=new window.TMap.MultiMarker({id:"marker-layer",map:b,minimumClusterSize:1});d.updateGeometries({id:"shop",position:i}),b.on("idle",()=>{le(()=>e.latitude,(p,m)=>{const f=new window.TMap.LatLng(e.latitude,e.longitude);b.panTo(f,1),d.updateGeometries({id:"shop",position:f})})})};Y(()=>{const a=document.createElement("script");Z().then(t=>{a.type="text/javascript",a.src="https://map.qq.com/api/gljs?v=1.exp&key="+t.data.key,document.body.appendChild(a)}),a.onload=()=>{setTimeout(()=>{G()},500)}});const $=(a,t,i)=>{oe({location:a+","+t}).then(d=>{d.data.result?(e.province_name=d.data.result.address_component.province,e.city_name=d.data.result.address_component.city,e.district_name=d.data.result.address_component.district,i==1&&(e.address=d.data.result.formatted_addresses.recommend,e.full_address=e.province_name+e.city_name+e.district_name+e.address,e.latitude=a,e.longitude=t)):se({type:"warning",message:d.data.message})})},A=()=>{C.push("/shop/order/delivery/store")};return(a,t)=>{const i=re,d=de,p=ge,m=ie,f=ne,x=ce,K=me,Q=ue;return u(),v("div",ye,[c("div",we,[c("div",{class:"left",onClick:t[0]||(t[0]=l=>A())},[Ve,c("span",xe,_(s(o)("returnToPreviousPage")),1)]),ke,s(w)?(u(),v("span",Me,_(s(o)("updateStore")),1)):(u(),v("span",Pe,_(s(o)("addStore")),1))]),r(Q,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[r(K,{model:e,"label-width":"140px",ref_key:"formRef",ref:S,rules:s(U),class:"page-form"},{default:n(()=>[r(d,{label:s(o)("storeName"),prop:"store_name"},{default:n(()=>[r(i,{modelValue:e.store_name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.store_name=l),modelModifiers:{trim:!0},clearable:"",placeholder:s(o)("storeNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(d,{label:s(o)("storeDesc")},{default:n(()=>[r(i,{modelValue:e.store_desc,"onUpdate:modelValue":t[2]||(t[2]=l=>e.store_desc=l),modelModifiers:{trim:!0},type:"textarea",rows:"4",clearable:"",placeholder:s(o)("storeDescPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(d,{label:s(o)("storeLogo")},{default:n(()=>[r(p,{modelValue:e.store_logo,"onUpdate:modelValue":t[3]||(t[3]=l=>e.store_logo=l)},null,8,["modelValue"])]),_:1},8,["label"]),r(d,{label:s(o)("storeMobile"),prop:"store_mobile"},{default:n(()=>[r(i,{modelValue:e.store_mobile,"onUpdate:modelValue":t[4]||(t[4]=l=>e.store_mobile=l),modelModifiers:{trim:!0},clearable:"",placeholder:s(o)("storeMobilePlaceholder"),class:"input-width",onKeyup:t[5]||(t[5]=l=>s(ee)(l)),onBlur:t[6]||(t[6]=l=>e.store_mobile=l.target.value)},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(d,{label:s(o)("tradeTime"),prop:"trade_time"},{default:n(()=>[c("div",null,[r(i,{modelValue:e.trade_time,"onUpdate:modelValue":t[7]||(t[7]=l=>e.trade_time=l),modelModifiers:{trim:!0},clearable:"",placeholder:s(o)("tradeTimePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),c("p",Le,_(s(o)("tradeTimeTips")),1)])]),_:1},8,["label"]),r(d,{label:s(o)("storeAddress"),prop:"address_area"},{default:n(()=>[r(f,{modelValue:e.province_name,"onUpdate:modelValue":t[8]||(t[8]=l=>e.province_name=l),"value-key":"id",clearable:"",class:"w-[200px]",onChange:j},{default:n(()=>[r(m,{label:s(o)("provincePlaceholder"),value:""},null,8,["label"]),(u(!0),v(k,null,M(g.province,(l,h)=>(u(),P(m,{key:h,label:l.name,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),r(f,{modelValue:e.city_name,"onUpdate:modelValue":t[9]||(t[9]=l=>e.city_name=l),"value-key":"id",clearable:"",class:"w-[200px] ml-3",onChange:O},{default:n(()=>[r(m,{label:s(o)("cityPlaceholder"),value:""},null,8,["label"]),(u(!0),v(k,null,M(g.city,(l,h)=>(u(),P(m,{key:h,label:l.name,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),r(f,{modelValue:e.district_name,"onUpdate:modelValue":t[10]||(t[10]=l=>e.district_name=l),"value-key":"id",clearable:"",class:"w-[200px] ml-3",onChange:R},{default:n(()=>[r(m,{label:s(o)("districtPlaceholder"),value:""},null,8,["label"]),(u(!0),v(k,null,M(g.district,(l,h)=>(u(),P(m,{key:h,label:l.name,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),r(d,{label:s(o)("storeAddressDetail"),prop:"address"},{default:n(()=>[c("div",null,[c("div",null,[r(i,{modelValue:e.address,"onUpdate:modelValue":t[11]||(t[11]=l=>e.address=l),modelModifiers:{trim:!0},clearable:"",placeholder:s(o)("storeAddressDetailPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),r(x,{class:"ml-3",onClick:z},{default:n(()=>[L(_(s(o)("search")),1)]),_:1})]),Te])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1}),c("div",Ce,[c("div",qe,[r(x,{type:"primary",onClick:t[12]||(t[12]=l=>N(S.value))},{default:n(()=>[L(_(s(o)("save")),1)]),_:1}),r(x,{onClick:t[13]||(t[13]=l=>A())},{default:n(()=>[L(_(s(o)("cancel")),1)]),_:1})])])])}}});const pt=he(Se,[["__scopeId","data-v-dff5ec22"]]);export{pt as default};
