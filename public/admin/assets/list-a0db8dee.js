import{d as ue,x as de,f as ce,r as v,n as pe,l as _e,q as t,h as c,c as P,e as o,w as s,a as u,t as m,u as l,i as p,F as w,T as D,s as L,R as fe,A as ge,c$ as ve,B as I,U as be,a3 as he,a5 as O,E as xe,K as ye,L as ke,ab as Pe,aC as Le,bO as Ce,M as Ee,a7 as Ve,ac as Fe,J as Ae,ad as we,W as De,X as Se,Y as Te}from"./index-2a89d409.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                        *//* empty css                        *//* empty css                *//* empty css                *//* empty css                       *//* empty css                  */import"./el-form-item-4ed993c7.js";import{_ as N}from"./member_head-d9fd7b2c.js";import{g as Re,c as $e,f as Be,h as je,i as ze,j as M}from"./agent-17ea308f.js";import{_ as Ue}from"./fenxiao-of-select-popup.vue_vue_type_script_setup_true_lang-f80071d8.js";import"./fenxiao-1539816f.js";const Ie={class:"main-container"},Oe={class:"flex justify-between items-center"},Me={class:"text-page-title"},Ne=["onClick"],Ye={class:"min-w-[50px] h-[50px] flex items-center justify-center"},qe=u("div",{class:"image-slot"},[u("img",{class:"w-[50px] h-[50px] rounded-full",src:N,alt:""})],-1),He={key:1,class:"w-[50px] h-[50px] rounded-full",src:N,alt:""},Je={class:"ml-2"},Ke=["title"],We={class:"text-primary text-[12px]"},Xe={class:"cursor-pointer price-wrap"},Ge={class:"mt-[16px] flex justify-end"},Qe={key:0,class:"mr-[10px]"},Ze={class:"dialog-footer"},Fa=ue({__name:"list",setup(ea){const Y=de(),S=ce(),q=Y.meta.title,T=v(),C=v([]);let V=!1;const R=(n=!1)=>{if(V)return!1;V=!0,Re().then(a=>{let i=[];C.value=[],a.data.length&&(a.data.forEach((_,f)=>{let g={};g.label=_.name,g.value=_.level_id,i.push(g)}),C.value=i),V=!1,n&&be({message:t("refreshSuccess"),type:"success"})})};R();const F=v([]);(()=>{$e().then(n=>{let a=[];if(F.value=[],Object.keys(n.data).length){for(let i in n.data){let _={};_.label=n.data[i],_.value=i,a.push(_)}F.value=a}})})();const H=n=>{n&&(r.searchParam.search="",r.searchParam.agent_level="",r.searchParam.agent_time=[],r.searchParam.agent_status="",n.resetFields(),b())},r=pe({page:1,limit:10,total:0,loading:!1,data:[],searchParam:{search:"",agent_level:"",agent_time:[],agent_status:""}}),b=(n=1)=>{r.loading=!0,r.page=n;const a=he(r.searchParam);Be({page:r.page,limit:r.limit,...a}).then(i=>{r.data=i.data.data,r.total=i.data.total,r.loading=!1})};b();const $=v(null),J=()=>{const n=S.resolve({path:"/shop_fenxiao/agent/level/config"});window.open(n.href)};let B=v();const y=v(!1),k=v(!1),d=v({agent_level:"",member_id:"",member_name:"",status:""}),K=()=>{$.value.show()},W=n=>{d.value.member_name=n.member.nickname||n.member.username,d.value.member_id=n.member_id},X=_e(()=>({member_id:[{required:!0,message:t("selectFenxiaoPlaceholder"),trigger:"blur"}],agent_level:[{required:!0,message:t("selectAgentLevelPlaceholder"),trigger:"blur"}]})),G=()=>{d.value.agent_level="",d.value.member_id="",d.value.member_name="",y.value=!0,k.value=!1},Q=n=>{d.value.agent_level=n.agentLevel.level_id,d.value.member_id=n.member_id,d.value.member_name=n.member.nickname||n.member.username,y.value=!0,k.value=!0},E=v(!1),Z=async n=>{E.value||!n||await n.validate(async a=>{if(a){E.value=!0;const i=d.value;(k.value?je:ze)(i).then(f=>{E.value=!1,y.value=!1,b()}).catch(()=>{E.value=!1})}})};let h=!1;const ee=n=>{n.agent_status==1?ae(n.member_id):le(n.member_id)},ae=n=>{O.confirm(t("freezeAgentTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{if(h)return;h=!0;let a={};a.member_id=n,a.status=2,M(a).then(()=>{b(),h=!1}).catch(()=>{h=!1})})},te=n=>{let a=S.resolve(`/shop_fenxiao/detail?id=${n}`);window.open(a.href," blank")},le=n=>{O.confirm(t("normalAgentTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{if(h)return;h=!0;let a={};a.member_id=n,a.status=1,M(a).then(()=>{b(),h=!1}).catch(()=>{h=!1})})};return(n,a)=>{const i=xe,_=ye,f=ke,g=Pe,A=Le,ne=Ce,j=Ee,z=Ve,x=Fe,oe=Ae,se=we,re=De,ie=Se,me=Te;return c(),P("div",Ie,[o(z,{class:"card !border-none",shadow:"never"},{default:s(()=>[u("div",Oe,[u("span",Me,m(l(q)),1),o(i,{type:"primary",onClick:G},{default:s(()=>[p(m(l(t)("addAgent")),1)]),_:1})]),o(z,{class:"card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:s(()=>[o(j,{inline:!0,model:r.searchParam,ref_key:"searchFormRef",ref:T},{default:s(()=>[o(f,{label:l(t)("memberInfo")},{default:s(()=>[o(_,{modelValue:r.searchParam.search,"onUpdate:modelValue":a[0]||(a[0]=e=>r.searchParam.search=e),placeholder:l(t)("memberInfoPlaceholder"),maxlength:"60"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(f,{label:l(t)("agentLevel")},{default:s(()=>[o(A,{modelValue:r.searchParam.agent_level,"onUpdate:modelValue":a[1]||(a[1]=e=>r.searchParam.agent_level=e),placeholder:l(t)("selectAgentLevelPlaceholder")},{default:s(()=>[o(g,{label:l(t)("all"),value:""},null,8,["label"]),(c(!0),P(w,null,D(C.value,e=>(c(),L(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(f,{label:l(t)("fenxiaoState")},{default:s(()=>[o(A,{modelValue:r.searchParam.agent_status,"onUpdate:modelValue":a[2]||(a[2]=e=>r.searchParam.agent_status=e),placeholder:l(t)("fenxiaoStatePlaceholder")},{default:s(()=>[o(g,{label:l(t)("all"),value:""},null,8,["label"]),(c(!0),P(w,null,D(F.value,e=>(c(),L(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(f,{label:l(t)("createTime")},{default:s(()=>[o(ne,{modelValue:r.searchParam.agent_time,"onUpdate:modelValue":a[3]||(a[3]=e=>r.searchParam.agent_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":l(t)("startDate"),"end-placeholder":l(t)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),o(f,null,{default:s(()=>[o(i,{type:"primary",onClick:a[4]||(a[4]=e=>b())},{default:s(()=>[p(m(l(t)("search")),1)]),_:1}),o(i,{onClick:a[5]||(a[5]=e=>H(T.value))},{default:s(()=>[p(m(l(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),fe((c(),L(se,{data:r.data,size:"large",ref:"goodsListTableRef"},{empty:s(()=>[u("span",null,m(r.loading?"":l(t)("emptyData")),1)]),default:s(()=>[o(x,{type:"selection",width:"55"}),o(x,{prop:"fenxiao_info",label:l(t)("fenxiaoInfo"),"min-width":"200"},{default:s(({row:e})=>[u("div",{class:"flex items-center cursor-pointer",onClick:U=>te(e.member_id)},[u("div",Ye,[e.member&&e.member.headimg?(c(),L(oe,{key:0,class:"w-[50px] h-[50px]",src:l(ge)(e.member.headimg),fit:"contain"},{error:s(()=>[qe]),_:2},1032,["src"])):(c(),P("img",He))]),u("div",Je,[u("span",{title:e.member&&e.member.nickname,class:"multi-hidden"},m(e.member&&e.member.nickname||e.member&&e.member.username),9,Ke),u("span",We,m(e.member&&e.member.mobile),1)])],8,Ne)]),_:1},8,["label"]),o(x,{label:l(t)("agentLevel"),"min-width":"120"},{default:s(({row:e})=>[u("div",Xe,[u("span",null,m(e.agentLevel?e.agentLevel.name:"--"),1)])]),_:1},8,["label"]),o(x,{prop:"agent_commission",label:l(t)("agentCommission"),"min-width":"100"},{default:s(({row:e})=>[p(m(l(ve)(e.agent_commission)),1)]),_:1},8,["label"]),o(x,{prop:"create_time",label:l(t)("createTime"),"min-width":"120"},{default:s(({row:e})=>[p(m(e.agent_time||"--"),1)]),_:1},8,["label"]),o(x,{prop:"sort",label:l(t)("currentState"),"min-width":"100"},{default:s(({row:e})=>[p(m(e.agent_status_name),1)]),_:1},8,["label"]),o(x,{label:l(t)("operation"),fixed:"right",align:"right","min-width":"120"},{default:s(({row:e})=>[o(i,{type:"primary",link:"",onClick:U=>Q(e)},{default:s(()=>[p(m(l(t)("edit")),1)]),_:2},1032,["onClick"]),o(i,{type:"primary",link:"",onClick:U=>ee(e)},{default:s(()=>[p(m(e.agent_status==1?l(t)("freeze"):l(t)("normal")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[me,r.loading]]),u("div",Ge,[o(re,{"current-page":r.page,"onUpdate:current-page":a[6]||(a[6]=e=>r.page=e),"page-size":r.limit,"onUpdate:page-size":a[7]||(a[7]=e=>r.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:r.total,onSizeChange:a[8]||(a[8]=e=>b()),onCurrentChange:b},null,8,["current-page","page-size","total"])])]),_:1}),o(ie,{modelValue:y.value,"onUpdate:modelValue":a[13]||(a[13]=e=>y.value=e),title:k.value?l(t)("editAgent"):l(t)("addAgent"),width:"450px","close-on-press-escape":!1,"destroy-on-close":!0,"close-on-click-modal":!1},{footer:s(()=>[u("span",Ze,[o(i,{onClick:a[11]||(a[11]=e=>y.value=!1)},{default:s(()=>[p(m(l(t)("cancel")),1)]),_:1}),o(i,{type:"primary",onClick:a[12]||(a[12]=e=>Z(l(B)))},{default:s(()=>[p(m(l(t)("confirm")),1)]),_:1})])]),default:s(()=>[o(j,{ref_key:"agentInfoRef",ref:B,model:d.value,rules:l(X),"label-width":"110px"},{default:s(()=>[o(f,{label:l(t)("fenxiao"),prop:k.value?"":"member_id"},{default:s(()=>[d.value.member_name?(c(),P("span",Qe,m(d.value.member_name),1)):I("",!0),k.value?I("",!0):(c(),L(i,{key:1,type:"primary",onClick:K},{default:s(()=>[p(m(l(t)("selectFenxiao")),1)]),_:1}))]),_:1},8,["label","prop"]),o(f,{label:l(t)("agentLevel"),prop:"agent_level"},{default:s(()=>[o(A,{modelValue:d.value.agent_level,"onUpdate:modelValue":a[9]||(a[9]=e=>d.value.agent_level=e),placeholder:l(t)("selectAgentLevelPlaceholder")},{default:s(()=>[(c(!0),P(w,null,D(C.value,e=>(c(),L(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),u("span",{class:"text-[var(--el-color-primary)] ml-[10px] cursor-pointer",onClick:a[10]||(a[10]=e=>R(!0))},"刷新"),u("span",{class:"text-[var(--el-color-primary)] ml-[10px] cursor-pointer",onClick:J},"添加")]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),o(Ue,{ref_key:"fenxiaoOfSelectPopupRef",ref:$,title:l(t)("fenxiaoSelectPricePopupTitle"),params:{is_agent:0},onLoad:W},null,8,["title"])])}}});export{Fa as default};
