import{d as N,r as u,n as O,l as S,q as t,h as m,s as _,w as r,a as g,e as s,i as y,t as D,u as o,R as Y,B as j,c as E,F,T as I,K as $,L as H,ac as K,aD as J,bO as X,M as z,E as A,X as G,Y as Q}from"./index-99f00cf3.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                  */import"./el-form-item-4ed993c7.js";import{I as W,J as Z,K as ee,L as ae,M as le}from"./vipcard-cf1e419a.js";const te={class:"input-width"},oe={class:"dialog-footer"},we=N({__name:"add-reserve",emits:["complete"],setup(re,{expose:L,emit:x}){const c=u(!1),i=u(!1),b={reserve_id:"",mobile:"",member_id:"",reserve_name:"",reserve_date:"",goods_id:"",remark:"",technician_id:""},l=O({...b}),h=u(),R=S(()=>({member_id:[{required:!0,message:t("memberIdPlaceholder"),trigger:"blur"}],reserve_date:[{required:!0,message:t("arrivalTimePlaceholder"),trigger:"blur"}],goods_id:[{required:!0,message:t("reserveItemPlaceholder"),trigger:["blur","change"]}],technician_id:[{required:!0,message:t("technicianPlaceholder"),trigger:["blur","change"]}],reserve_name:[{required:!0,message:t("memberNamePlaceholder"),trigger:"blur"}]})),v=u({}),T=n=>{W({mobile:n}).then(e=>{v.value=Object.keys(e.data).length?e.data:{},l.member_id=v.value.member_id||"",l.reserve_name=v.value.nickname||""})},V=u([]);(()=>{Z({}).then(n=>{V.value=n.data})})();const U=async n=>{if(i.value||!n)return;const e=l.reserve_id?ee:ae;await n.validate(async p=>{p&&(i.value=!0,e(l).then(f=>{i.value=!1,c.value=!1,x("complete")}).catch(()=>{i.value=!1}))})},k=u([]);return L({showDialog:c,setFormData:async(n=null)=>{k.value=await(await le()).data,Object.assign(l,b),n&&n&&Object.keys(l).forEach(e=>{n[e]!=null&&(l[e]=n[e])}),i.value=!1}}),(n,e)=>{const p=$,d=H,f=K,P=J,q=X,B=z,w=A,C=G,M=Q;return m(),_(C,{modelValue:c.value,"onUpdate:modelValue":e[9]||(e[9]=a=>c.value=a),title:l.reserve_id?o(t)("updateReserve"):o(t)("addReserve"),width:"500px","destroy-on-close":!0},{footer:r(()=>[g("span",oe,[s(w,{onClick:e[7]||(e[7]=a=>c.value=!1)},{default:r(()=>[y(D(o(t)("cancel")),1)]),_:1}),s(w,{type:"primary",loading:i.value,onClick:e[8]||(e[8]=a=>U(h.value))},{default:r(()=>[y(D(o(t)("confirm")),1)]),_:1},8,["loading"])])]),default:r(()=>[Y((m(),_(B,{model:l,"label-width":"90px",ref_key:"formRef",ref:h,rules:o(R),class:"page-form"},{default:r(()=>[l.reserve_id?j("",!0):(m(),_(d,{key:0,label:o(t)("phone"),prop:"phone"},{default:r(()=>[s(p,{modelValue:l.mobile,"onUpdate:modelValue":e[1]||(e[1]=a=>l.mobile=a),placeholder:o(t)("phonePlaceholder"),class:"input-width"},{append:r(()=>[g("span",{class:"iconfont iconsousuo text-[#a3a6ab] cursor-pointer",onClick:e[0]||(e[0]=a=>T(l.mobile))})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])),s(d,{label:o(t)("client"),prop:"reserve_name"},{default:r(()=>[s(p,{modelValue:l.reserve_name,"onUpdate:modelValue":e[2]||(e[2]=a=>l.reserve_name=a),disabled:"",placeholder:o(t)("clientPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(d,{label:o(t)("reserveItem"),prop:"goods_id"},{default:r(()=>[s(P,{modelValue:l.goods_id,"onUpdate:modelValue":e[3]||(e[3]=a=>l.goods_id=a),class:"input-width",placeholder:o(t)("reserveItemPlaceholder")},{default:r(()=>[(m(!0),E(F,null,I(V.value,a=>(m(),_(f,{key:a.goods_id,label:a.goods_name,value:a.goods_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(d,{label:o(t)("technician"),prop:"technician_id"},{default:r(()=>[s(P,{modelValue:l.technician_id,"onUpdate:modelValue":e[4]||(e[4]=a=>l.technician_id=a),class:"input-width",placeholder:o(t)("technicianPlaceholder")},{default:r(()=>[(m(!0),E(F,null,I(k.value,a=>(m(),_(f,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(d,{label:o(t)("arrivalTime"),prop:"reserve_date"},{default:r(()=>[g("div",te,[s(q,{modelValue:l.reserve_date,"onUpdate:modelValue":e[5]||(e[5]=a=>l.reserve_date=a),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:o(t)("arrivalTimePlaceholder")},null,8,["modelValue","placeholder"])])]),_:1},8,["label"]),s(d,{label:o(t)("remark")},{default:r(()=>[s(p,{modelValue:l.remark,"onUpdate:modelValue":e[6]||(e[6]=a=>l.remark=a),rows:2,type:"textarea",placeholder:o(t)("remarkPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[M,i.value]])]),_:1},8,["modelValue","title"])}}});export{we as _};
