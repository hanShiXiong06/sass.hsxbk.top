import{d as we,x as he,f as Ve,r as w,n as I,l as ee,q as a,R as te,h as d,c,e as l,w as s,u as o,F as D,T as E,s as b,i as f,t as p,b_ as ke,c8 as ae,a as y,B as k,v as xe,U as Pe,aQ as Ce,a7 as De,ax as Ee,ay as Ue,K as Te,L as Re,d1 as Se,at as $e,au as Me,ab as qe,aC as Fe,M as Le,E as Ne,d2 as Ye,bO as Be,X as je,Y as Ie,p as Oe,g as We}from"./index-6f32d09b.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                    *//* empty css                    *//* empty css                */import{_ as ze}from"./index.vue_vue_type_script_setup_true_lang-edd497b7.js";/* empty css               *//* empty css                  *//* empty css                  *//* empty css                       *//* empty css                 */import Ae from"./index-4df26bee.js";/* empty css                     */import"./el-form-item-4ed993c7.js";/* empty css                    *//* empty css                *//* empty css                   *//* empty css                       */import{a2 as Ke,a3 as Ge,a4 as He,a5 as Qe,a6 as Xe,a7 as Ze}from"./tourism-dc4cc108.js";import{j as Je}from"./poster-11e724dc.js";import{_ as et}from"./_plugin-vue_export-helper-c27b6911.js";import"./index.vue_vue_type_style_index_0_lang-972988e5.js";import"./attachment-503e95ee.js";import"./index.vue_vue_type_script_setup_true_lang-bee7eaa7.js";/* empty css                        *//* empty css                      *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css               *//* empty css                    */import"./el-dropdown-item-4ed993c7.js";import"./index.vue_vue_type_script_setup_true_lang-ad575143.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-0724e2f9.js";import"./sortable.esm-be94e56d.js";const le=S=>(Oe("data-v-04a889af"),S=S(),We(),S),tt={class:"main-container"},at={key:0},lt={key:0,class:"text-[12px] text-[#999] leading-[20px]"},ot={key:1,class:"text-[12px] text-[#999] leading-[20px]"},rt={class:"ml-[10px]"},st={class:"fixed-footer-wrap"},dt={class:"fixed-footer"},it={key:1},nt=["onClick"],ut={key:0},pt={class:"text-right text-gray-400 text-[14px] mt-[15px]"},ct={key:1},mt=le(()=>y("p",{class:"text-right text-gray-400 text-[14px] mt-[15px]"},"0.00￥",-1)),_t=[mt],ft={key:1,class:"w-full h-full"},yt={class:"text-gray-400"},gt={key:0},bt={class:"text-right text-gray-400 text-[14px] mt-[15px]"},vt={key:1},wt=le(()=>y("p",{class:"text-right text-gray-400 text-[14px] mt-[15px]"},"0.00￥",-1)),ht=[wt],Vt={class:"dialog-footer"},kt=we({__name:"edit",setup(S){const oe=he(),O=Ve(),F=parseInt(oe.query.id),x=w(!1),U=w("first"),W={way_id:0,way_name:"",start_city:"",end_city:"",way_character:"",fee_desc:"",group_buy_type:"",way_theme:"",travel_type:"",way_traffic:"",goods_id:0,stock:"",goods_cover:"",goods_image:"",price:"",buy_info:"",member_discount:"",poster_id:""},r=I({...W}),z=w([]);(async()=>{z.value=await(await Ke()).data.data})();const $=(i,e)=>{r[i]==e?r[i]="":r[i]=e};F&&(async(i=0)=>{Object.assign(r,W);const e=await(await Ge(i)).data;Object.keys(r).forEach(n=>{e[n]!=null&&(r[n]=e[n])}),e.goods&&Object.keys(r).forEach(n=>{e.goods[n]!=null&&(r[n]=e.goods[n])}),r.way_id=i,H(r.goods_id)})(F);const A=w(),re=(i,e,n)=>{const v=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/;e===""?n(new Error(a("wayPricePlaceholder"))):parseFloat(e)===0?n(new Error(a("wayPricePlaceholder1"))):parseFloat(e)>9999999999e-2?n(new Error(a("pricePlaceholder3"))):v.test(e)?n():n(new Error(a("wayPricePlaceholder2")))},se=(i,e,n)=>{r.goods_cover==""?n(new Error(a("wayCoverPlaceholder"))):n()},de=ee(()=>({way_name:[{required:!0,message:a("wayTitlePlaceholder"),trigger:"blur"}],goods_cover:[{required:!0,validator:se,trigger:"blur"}],stock:[{required:!0,message:a("wayStockPlaceholder"),trigger:"blur"}],price:[{required:!0,validator:re,trigger:"blur"}],start_city:[{required:!0,message:a("startCityPlaceholder"),trigger:"blur"}],end_city:[{required:!0,message:a("endCityPlaceholder"),trigger:"blur"}]})),ie=async i=>{x.value||!i||await i.validate(async e=>{if(e){x.value=!0;const n=r;(r.way_id?He:Qe)(n).then(P=>{x.value=!1,P.code>=0&&r.way_id==0?(r.way_id=P.data.way_id,r.goods_id=P.data.goods_id,U.value="second"):history.back()}).catch(()=>{x.value=!1})}})},L=I([]),ne=()=>{const i=O.resolve({path:"/poster/list"});window.open(i.href)},K=(i=!1)=>{Je({type:"tourism_way"}).then(e=>{const n=e.data;n&&(L.splice(0,L.length,...n),i&&Pe({message:a("refreshSuccess"),type:"success"}))})};K();const ue=()=>{history.back()},pe=i=>{const e=parseInt(new Date().getTime()/1e3)+"",n=parseInt(new Date(i.day).getTime()/1e3)+"";return e-60*60*24<n},T=w(!1),ce=i=>{T.value=!0,u.start_date=i.day,u.is_set=1,u.price="",u.end_date="",u.member_price=1,g.value[i.day]&&(u.price=g.value[i.day].price,u.member_price=g.value[i.day].member_price)},u=I({is_set:1,start_date:"",end_date:"",price:"",member_price:1}),N=w(!1),G=w(),me=ee(()=>({price:[{required:!0,message:a("saleArrPricePlaceholder"),trigger:"blur"},{trigger:"blur",validator:(i,e,n)=>{e<=0?n(new Error(a("saleArrPriceNotZeroTips"))):n()}}]})),_e=async i=>{N.value||!i||await i.validate(async e=>{e&&(N.value=!0,u.goods_id=r.goods_id,Xe(u).then(n=>{H(r.goods_id),T.value=!1,N.value=!1}))})},g=w([]),H=(i=0)=>{Ze({goods_id:i}).then(e=>{g.value=e.data})};return(i,e)=>{const n=Ce,v=De,P=Ee,fe=Ue,C=Te,m=Re,M=Se,Q=Ae,h=$e,Y=Me,ye=qe,ge=Fe,B=ze,X=Le,q=Ne,be=Ye,Z=Be,ve=je,J=Ie;return te((d(),c("div",tt,[l(v,{class:"card !border-none mb-[15px]",shadow:"never"},{default:s(()=>[l(n,{content:o(F)?o(a)("editWay"):o(a)("addWay"),icon:i.ArrowLeft,onBack:e[0]||(e[0]=t=>o(O).push({path:"/tourism/product/way/way"}))},null,8,["content","icon"])]),_:1}),l(v,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[l(fe,{modelValue:U.value,"onUpdate:modelValue":e[1]||(e[1]=t=>U.value=t),class:"demo-tabs"},{default:s(()=>[l(P,{label:o(a)("basicData"),name:"first"},null,8,["label"]),l(P,{label:o(a)("priceCalendar"),name:"second",disabled:!r.way_id},null,8,["label","disabled"])]),_:1},8,["modelValue"]),U.value=="first"?(d(),c("div",at,[l(v,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[l(X,{model:r,"label-width":"90px",ref_key:"formRef",ref:A,rules:o(de),class:"page-form"},{default:s(()=>[l(m,{label:o(a)("wayName"),prop:"way_name"},{default:s(()=>[l(C,{modelValue:r.way_name,"onUpdate:modelValue":e[2]||(e[2]=t=>r.way_name=t),modelModifiers:{trim:!0},clearable:"",placeholder:o(a)("wayNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),(d(!0),c(D,null,E(z.value,(t,R)=>(d(),c("div",{key:R},[R=="group_buy_type"?(d(),b(m,{key:0,label:o(a)("groupBuyType")},{default:s(()=>[(d(!0),c(D,null,E(t,(V,_)=>(d(),c("span",{key:_},[l(M,{style:{"margin-right":"8px"},checked:_==r.group_buy_type,onChange:j=>$("group_buy_type",_)},{default:s(()=>[f(p(V),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"])):R=="travel_type"?(d(),b(m,{key:1,label:o(a)("travelType")},{default:s(()=>[(d(!0),c(D,null,E(t,(V,_)=>(d(),c("span",{key:_},[l(M,{style:{"margin-right":"8px"},checked:_==r.travel_type,onChange:j=>$("travel_type",_)},{default:s(()=>[f(p(V),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"])):R=="way_theme"?(d(),b(m,{key:2,label:o(a)("wayTheme")},{default:s(()=>[(d(!0),c(D,null,E(t,(V,_)=>(d(),c("span",{key:_},[l(M,{style:{"margin-right":"8px"},checked:_==r.way_theme,onChange:j=>$("way_theme",_)},{default:s(()=>[f(p(V),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"])):(d(),b(m,{key:3,label:o(a)("wayTraffic")},{default:s(()=>[(d(!0),c(D,null,E(t,(V,_)=>(d(),c("span",{key:_},[l(M,{style:{"margin-right":"8px"},checked:_==r.way_traffic,onChange:j=>$("way_traffic",_)},{default:s(()=>[f(p(V),1)]),_:2},1032,["checked","onChange"])]))),128))]),_:2},1032,["label"]))]))),128)),l(m,{label:o(a)("wayCover"),prop:"goods_cover"},{default:s(()=>[l(Q,{modelValue:r.goods_cover,"onUpdate:modelValue":e[3]||(e[3]=t=>r.goods_cover=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(m,{label:o(a)("wayImages"),prop:"goods_images"},{default:s(()=>[l(Q,{modelValue:r.goods_image,"onUpdate:modelValue":e[4]||(e[4]=t=>r.goods_image=t),limit:"10"},null,8,["modelValue"])]),_:1},8,["label"]),l(m,{label:o(a)("wayStock"),prop:"stock"},{default:s(()=>[l(C,{modelValue:r.stock,"onUpdate:modelValue":e[5]||(e[5]=t=>r.stock=t),modelModifiers:{trim:!0},clearable:"",placeholder:o(a)("wayStockPlaceholder"),class:"input-width",onKeyup:e[6]||(e[6]=t=>o(ke)(t))},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(m,{label:o(a)("wayPrice"),prop:"price"},{default:s(()=>[l(C,{modelValue:r.price,"onUpdate:modelValue":e[7]||(e[7]=t=>r.price=t),modelModifiers:{trim:!0},clearable:"",placeholder:o(a)("wayPricePlaceholder"),class:"input-width",onKeyup:e[8]||(e[8]=t=>o(ae)(t))},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(m,{label:o(a)("startCity"),prop:"start_city"},{default:s(()=>[l(C,{modelValue:r.start_city,"onUpdate:modelValue":e[9]||(e[9]=t=>r.start_city=t),modelModifiers:{trim:!0},clearable:"",placeholder:o(a)("startCityPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(m,{label:o(a)("endCity"),prop:"end_city"},{default:s(()=>[l(C,{modelValue:r.end_city,"onUpdate:modelValue":e[10]||(e[10]=t=>r.end_city=t),modelModifiers:{trim:!0},clearable:"",placeholder:o(a)("endCityPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(m,{label:o(a)("memberDiscount")},{default:s(()=>[y("div",null,[l(Y,{modelValue:r.member_discount,"onUpdate:modelValue":e[11]||(e[11]=t=>r.member_discount=t)},{default:s(()=>[l(h,{label:""},{default:s(()=>[f(p(o(a)("nonparticipation")),1)]),_:1}),l(h,{label:"discount"},{default:s(()=>[f(p(o(a)("discount")),1)]),_:1}),l(h,{label:"fixed_discount"},{default:s(()=>[f(p(o(a)("fixedDiscount")),1)]),_:1})]),_:1},8,["modelValue"]),r.member_discount=="discount"?(d(),c("div",lt,p(o(a)("discountHint")),1)):k("",!0),r.member_discount=="fixed_discount"?(d(),c("div",ot,p(o(a)("fixedDiscountHint")),1)):k("",!0)])]),_:1},8,["label"]),l(m,{label:o(a)("poster")},{default:s(()=>[l(ge,{modelValue:r.poster_id,"onUpdate:modelValue":e[12]||(e[12]=t=>r.poster_id=t),placeholder:o(a)("posterPlaceholder"),clearable:""},{default:s(()=>[(d(!0),c(D,null,E(L,t=>(d(),b(ye,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),y("div",rt,[y("span",{class:"cursor-pointer text-primary mr-[10px]",onClick:e[13]||(e[13]=t=>K(!0))},p(o(a)("refresh")),1),y("span",{class:"cursor-pointer text-primary",onClick:ne},p(o(a)("addGoodsPoster")),1)])]),_:1},8,["label"]),l(m,{label:o(a)("buyDesc")},{default:s(()=>[l(B,{modelValue:r.buy_info,"onUpdate:modelValue":e[14]||(e[14]=t=>r.buy_info=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(m,{label:o(a)("feeDesc")},{default:s(()=>[l(B,{modelValue:r.fee_desc,"onUpdate:modelValue":e[15]||(e[15]=t=>r.fee_desc=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(m,{label:o(a)("wayCharacter")},{default:s(()=>[l(B,{modelValue:r.way_character,"onUpdate:modelValue":e[16]||(e[16]=t=>r.way_character=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1}),y("div",st,[y("div",dt,[l(q,{type:"primary",onClick:e[17]||(e[17]=t=>ie(A.value))},{default:s(()=>[f(p(o(a)("save")),1)]),_:1}),l(q,{onClick:e[18]||(e[18]=t=>ue())},{default:s(()=>[f(p(o(a)("returnToPreviousPage")),1)]),_:1})])])])):k("",!0),U.value=="second"?(d(),c("div",it,[l(v,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[l(be,null,{"date-cell":s(({data:t})=>[pe(t)==!0?(d(),c("div",{key:0,class:xe(["w-full h-full",t.isSelected?"is-selected":""]),onClick:R=>ce(t)},[y("p",null,p(t.day.split("-").slice(1).join("-")),1),g.value&&g.value[t.day]?(d(),c("div",ut,[y("p",pt,p(g.value[t.day].price)+"￥",1)])):(d(),c("div",ct,_t))],10,nt)):(d(),c("div",ft,[y("p",yt,p(t.day.split("-").slice(1).join("-")),1),g.value&&g.value[t.day]?(d(),c("div",gt,[y("p",bt,p(g.value[t.day].price)+"￥",1)])):(d(),c("div",vt,ht))]))]),_:1})]),_:1})])):k("",!0)]),_:1}),l(ve,{modelValue:T.value,"onUpdate:modelValue":e[27]||(e[27]=t=>T.value=t),title:o(a)("editPrice"),width:"400px","destroy-on-close":!0},{footer:s(()=>[y("span",Vt,[l(q,{onClick:e[25]||(e[25]=t=>T.value=!1)},{default:s(()=>[f(p(o(a)("cancel")),1)]),_:1}),l(q,{type:"primary",onClick:e[26]||(e[26]=t=>_e(G.value))},{default:s(()=>[f(p(o(a)("confirm")),1)]),_:1})])]),default:s(()=>[te((d(),b(X,{model:u,"label-width":"90px",ref_key:"formRulesRef",ref:G,rules:o(me),class:"page-form"},{default:s(()=>[l(m,{label:o(a)("daySetting"),class:"items-center"},{default:s(()=>[l(Y,{modelValue:u.is_set,"onUpdate:modelValue":e[19]||(e[19]=t=>u.is_set=t),class:"ml-4 input-width"},{default:s(()=>[l(h,{label:1,size:"large"},{default:s(()=>[f(p(u.start_date),1)]),_:1}),l(h,{label:2,size:"large"},{default:s(()=>[f(p(o(a)("dateRange")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),u.is_set==2?(d(),b(m,{key:0,label:o(a)("startDate"),class:"input-width"},{default:s(()=>[l(Z,{type:"date",modelValue:u.start_date,"onUpdate:modelValue":e[20]||(e[20]=t=>u.start_date=t),placeholder:o(a)("startDate"),"value-format":"YYYY-MM-DD"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):k("",!0),u.is_set==2?(d(),b(m,{key:1,label:o(a)("endDate"),class:"input-width"},{default:s(()=>[l(Z,{type:"date",modelValue:u.end_date,"onUpdate:modelValue":e[21]||(e[21]=t=>u.end_date=t),placeholder:o(a)("endDate"),"value-format":"YYYY-MM-DD"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):k("",!0),l(m,{label:o(a)("wayPrice"),class:"input-width",prop:"price"},{default:s(()=>[l(C,{modelValue:u.price,"onUpdate:modelValue":e[22]||(e[22]=t=>u.price=t),clearable:"",placeholder:o(a)("wayPricePlaceholder"),class:"input-width",onKeyup:e[23]||(e[23]=t=>o(ae)(t))},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r.member_discount!=""?(d(),b(m,{key:2,label:o(a)("memberPrice"),prop:"member_price",class:"items-center"},{default:s(()=>[l(Y,{modelValue:u.member_price,"onUpdate:modelValue":e[24]||(e[24]=t=>u.member_price=t),class:"ml-4 input-width"},{default:s(()=>[l(h,{label:1,size:"large"},{default:s(()=>[f(p(o(a)("involved")),1)]),_:1}),l(h,{label:0,size:"large"},{default:s(()=>[f(p(o(a)("noInvolved")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])):k("",!0)]),_:1},8,["model","rules"])),[[J,x.value]])]),_:1},8,["modelValue","title"])])),[[J,x.value]])}}});const ya=et(kt,[["__scopeId","data-v-04a889af"]]);export{ya as default};
