import{d as Q,x as X,n as ee,r as u,f as te,h,c as ae,e as t,w as r,u as n,i as c,t as s,q as a,a as k,R as oe,s as w,B as D,a5 as le,U as M,aR as ne,E as ie,a7 as re,K as se,L as de,bO as ce,M as me,aw as pe,ad as ue,ae as ge,W as _e,Y as fe}from"./index-99f00cf3.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                       *//* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                *//* empty css                   *//* empty css                       */import{Y as ve,Z as be,_ as he}from"./tourism-22ca545e.js";import ke from"./goods-member-price-popup-fe6b24f7.js";import ye from"./goods-day-member-price-popup-105af5e3.js";import{A as Pe}from"./member-470daffe.js";/* empty css                  *//* empty css                   *//* empty css                       *//* empty css                 */import"./_plugin-vue_export-helper-c27b6911.js";const Ce={class:"main-container"},xe={class:"mt-[10px]"},Ee={class:"mb-[10px] flex items-center"},we={class:"mt-[16px] flex justify-end"},lt=Q({__name:"ticket",setup(Te){const T=X(),R=T.meta.title,y=parseInt(T.query.id),l=ee({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{goods_name:"",create_time:""}}),S=u(),m=(o=1)=>{l.loading=!0,l.page=o,ve({scenic_id:y,page:l.page,limit:l.limit,...l.searchParam}).then(e=>{l.loading=!1,l.data=e.data.data,l.total=e.data.total}).catch(()=>{l.loading=!1})};m();const P=te(),B=()=>{P.push("/tourism/product/scenic/edit_ticket?scenic_id="+y)},z=o=>{P.push("/tourism/product/scenic/edit_ticket?scenic_id="+y+"&id="+o.goods_id)},A=o=>{le.confirm(a("tourismScenicDeleteTips"),a("warning"),{confirmButtonText:a("confirm"),cancelButtonText:a("cancel"),type:"warning"}).then(()=>{be(o).then(()=>{m()}).catch(()=>{})})},F=o=>{o&&(o.resetFields(),m())},L=(o,e)=>{he({status:o,goods_id:e}).then(()=>{m()})},_=u([]);(()=>{Pe().then(o=>{_.value=o.data?o.data:[]})})();const C=u(null),N=o=>{C.value.show(o,_.value)},I=()=>{if(p.value.length==0){M({type:"warning",message:`${a("batchEmptySelectedGoodsTips")}`});return}const o=[];p.value.forEach(e=>{o.push(e.goods_id)}),C.value.show({goods_id:o.toString(),goods_type:"scenic"},_.value)},V=u(null),U=()=>{if(p.value.length==0){M({type:"warning",message:`${a("batchEmptySelectedGoodsTips")}`});return}const o=[];p.value.forEach(e=>{o.push(e.goods_id)}),V.value.show({goods_id:o.toString()},_.value)},f=u(),v=u(!1),Y=o=>{v.value=!1,$.value.toggleAllSelection()},$=u(),p=u([]),H=o=>{p.value=o,f.value=!1,p.value.length>0&&p.value.length<l.data.length?v.value=!0:v.value=!1,p.value.length==l.data.length&&(f.value=!0)};return(o,e)=>{const j=ne,d=ie,x=re,q=se,E=de,G=ce,K=me,O=pe,g=ue,W=ge,Z=_e,J=fe;return h(),ae("div",Ce,[t(x,{class:"card !border-none mb-[15px] relative",shadow:"never"},{default:r(()=>[t(j,{content:n(R),icon:o.ArrowLeft,onBack:e[0]||(e[0]=i=>n(P).push({path:"/tourism/product/scenic/scenic"}))},null,8,["content","icon"]),t(d,{type:"primary",class:"w-[100px] absolute right-[20px] top-[15px]",onClick:B},{default:r(()=>[c(s(n(a)("addTicket")),1)]),_:1})]),_:1}),t(x,{class:"box-card !border-none",shadow:"never"},{default:r(()=>[t(x,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:r(()=>[t(K,{inline:!0,model:l.searchParam,ref_key:"searchFormRef",ref:S},{default:r(()=>[t(E,{label:n(a)("ticketName"),prop:"goods_name"},{default:r(()=>[t(q,{modelValue:l.searchParam.goods_name,"onUpdate:modelValue":e[1]||(e[1]=i=>l.searchParam.goods_name=i),placeholder:n(a)("scenicNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(E,{label:n(a)("createTime"),prop:"create_time"},{default:r(()=>[t(G,{modelValue:l.searchParam.create_time,"onUpdate:modelValue":e[2]||(e[2]=i=>l.searchParam.create_time=i),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":n(a)("startDate"),"end-placeholder":n(a)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),t(E,null,{default:r(()=>[t(d,{type:"primary",onClick:e[3]||(e[3]=i=>m())},{default:r(()=>[c(s(n(a)("search")),1)]),_:1}),t(d,{onClick:e[4]||(e[4]=i=>F(S.value))},{default:r(()=>[c(s(n(a)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),k("div",xe,[k("div",Ee,[t(O,{modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=i=>f.value=i),size:"large",class:"px-[14px]",onChange:Y,indeterminate:v.value},null,8,["modelValue","indeterminate"]),t(d,{onClick:e[6]||(e[6]=i=>I()),size:"small"},{default:r(()=>[c(s(n(a)("memberPrice")),1)]),_:1}),t(d,{onClick:e[7]||(e[7]=i=>U()),size:"small"},{default:r(()=>[c(s(n(a)("dayMemberPrice")),1)]),_:1})]),oe((h(),w(W,{data:l.data,size:"large",ref_key:"goodsListTableRef",ref:$,onSelectionChange:H},{empty:r(()=>[k("span",null,s(l.loading?"":n(a)("emptyData")),1)]),default:r(()=>[t(g,{type:"selection",width:"55"}),t(g,{prop:"goods_name",label:n(a)("ticketName"),"min-width":"120"},null,8,["label"]),t(g,{prop:"price",label:n(a)("ticketPrice"),"min-width":"120"},null,8,["label"]),t(g,{prop:"stock",label:n(a)("ticketStock"),"min-width":"120"},null,8,["label"]),t(g,{prop:"status_name",label:n(a)("status"),"min-width":"120"},null,8,["label"]),t(g,{prop:"create_time",label:n(a)("createTime"),"min-width":"170"},null,8,["label"]),t(g,{label:n(a)("operation"),fixed:"right","min-width":"150",align:"right"},{default:r(({row:i})=>[i.status==1?(h(),w(d,{key:0,type:"primary",link:"",onClick:b=>L(0,i.goods_id)},{default:r(()=>[c(s(n(a)("down")),1)]),_:2},1032,["onClick"])):D("",!0),i.status==0?(h(),w(d,{key:1,type:"primary",link:"",onClick:b=>L(1,i.goods_id)},{default:r(()=>[c(s(n(a)("up")),1)]),_:2},1032,["onClick"])):D("",!0),t(d,{type:"primary",link:"",onClick:b=>N(i)},{default:r(()=>[c(s(n(a)("memberPrice")),1)]),_:2},1032,["onClick"]),t(d,{type:"primary",link:"",onClick:b=>z(i)},{default:r(()=>[c(s(n(a)("edit")),1)]),_:2},1032,["onClick"]),t(d,{type:"primary",link:"",onClick:b=>A(i.goods_id)},{default:r(()=>[c(s(n(a)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[J,l.loading]]),k("div",we,[t(Z,{"current-page":l.page,"onUpdate:current-page":e[8]||(e[8]=i=>l.page=i),"page-size":l.limit,"onUpdate:page-size":e[9]||(e[9]=i=>l.limit=i),layout:"total, sizes, prev, pager, next, jumper",total:l.total,onSizeChange:e[10]||(e[10]=i=>m()),onCurrentChange:m},null,8,["current-page","page-size","total"])])])]),_:1}),t(ke,{ref_key:"memberPricePopupRef",ref:C,onLoad:m},null,512),t(ye,{ref_key:"memberDayPricePopupRef",ref:V,onLoad:m},null,512)])}}});export{lt as default};
