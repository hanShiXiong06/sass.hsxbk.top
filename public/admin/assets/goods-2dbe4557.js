import{O as T,d as xe,r as d,f as ke,x as we,n as k,a2 as w,h as m,c as y,e as s,w as n,u as l,q as o,F as D,T as F,s as C,a as i,R as E,c8 as $,b6 as V,i as S,t as h,B as A,U as c,a3 as X,aW as Ce,K as Ee,L as Se,bF as Te,ab as Ne,aC as $e,E as Ve,M as Le,a7 as Ie,ac as Re,a1 as Ue,ad as De,W as Fe,Y as Ae,p as Oe,g as ze}from"./index-37fee5a0.js";/* empty css                   */import{_ as Be}from"./index.vue_vue_type_script_setup_true_lang-430da1b4.js";/* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                *//* empty css                  *//* empty css                          *//* empty css                 */import"./el-form-item-4ed993c7.js";/* empty css                 */import{e as Me,a as Ge}from"./goods-938c8919.js";import{A as Ke}from"./member-c2705b96.js";import{_ as je}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                  *//* empty css                   */function qe(_){return T.get("phone_shop/goods",{params:_})}function Je(){return T.get("phone_shop/goods/type")}function We(_){return T.get("phone_shop/goods/label/list",{params:_})}function Ye(_){return T.get("phone_shop/goods/brand/list",{params:_})}function He(){return T.get("phone_shop/goods/tree")}const O=_=>(Oe("data-v-3d024927"),_=_(),ze(),_),Qe={class:"main-container"},Xe={class:"region-input"},Ze=["placeholder"],ea=O(()=>i("span",{class:"separator"},"-",-1)),aa=["placeholder"],ta={class:"region-input"},oa=["placeholder"],sa=O(()=>i("span",{class:"separator"},"-",-1)),ra=["placeholder"],la={class:"mt-[10px]"},na=["onClick"],ia=O(()=>i("div",{class:"min-w-[70px] h-[70px] flex items-center justify-center"},null,-1)),da={class:"ml-2"},pa=["title"],ca={class:"text-primary text-[12px]"},ua=["onClick"],ma=["onClick"],_a={key:0},ga={key:1},ha={class:"mt-[16px] flex justify-end"},fa=xe({__name:"goods",setup(_){const z=d(!1);(()=>{let r="00",a="-1";localStorage.getItem("admin.userinfo")&&(r=JSON.parse(localStorage.getItem("admin.userinfo")).uid),localStorage.getItem("site.userinfo")&&(a=JSON.parse(localStorage.getItem("site.userinfo")).uid),r===a&&(z.value=!0)})();const B=d(),L=d(!1),Z=()=>{L.value=!1,u()},ee=async()=>{L.value=!0,B.value=!0},ae=async()=>{oe(),M.push("/setting/export")},te=async()=>{Me(e)},oe=(r=1)=>{if(e.searchParam.start_sale_num&&!f.digit.test(e.searchParam.start_sale_num)){c({type:"warning",message:`${o("startSaleNumTips")}`});return}if(e.searchParam.end_sale_num&&!f.digit.test(e.searchParam.end_sale_num)){c({type:"warning",message:`${o("endSaleNumTips")}`});return}if(Number(e.searchParam.start_sale_num)>Number(e.searchParam.end_sale_num)){c({type:"warning",message:`${o("shopSaleNumTips")}`});return}if(e.searchParam.start_price&&!f.digit.test(e.searchParam.start_price)){c({type:"warning",message:`${o("startPriceTips")}`});return}if(e.searchParam.end_price&&!f.digit.test(e.searchParam.end_price)){c({type:"warning",message:`${o("endPriceTips")}`});return}if(Number(e.searchParam.start_price)>Number(e.searchParam.end_price)){c({type:"warning",message:`${o("shopPriceTips")}`});return}e.loading=!0,e.page=r;const a=X(e.searchParam);Ge({page:e.page,limit:e.limit,...a}).then(g=>{e.loading=!1,u()}).catch(()=>{e.loading=!1})},M=ke();we().meta.title,d(!1);const e=k({page:1,limit:100,total:0,loading:!0,data:[],searchParam:{goods_name:"",goods_category:[],goods_type:"",brand_id:"",label_ids:"",start_sale_num:"",end_sale_num:"",start_price:"",end_price:"",status:"1",order:"",sort:""}}),v=d(),f={number:/^\d{0,10}$/,digit:/^\d{0,10}(.?\d{0,2})$/},I=k([]),G=k([]),K=k([]),j=k([]);(()=>{He().then(r=>{const a=r.data;if(a){const g=[];a.forEach(b=>{const p=[];p.push({value:b.category_id,label:"全部"}),b.child_list&&b.child_list.forEach(N=>{p.push({value:N.category_id,label:N.category_name})}),g.push({value:b.category_id,label:b.category_name,children:p})}),I.splice(0,I.length,...g)}}),Je().then(r=>{const a=r.data;if(a)for(const g in a)G.push(a[g])}),Ye({}).then(r=>{const a=r.data;a&&K.push(...a)}),We({}).then(r=>{const a=r.data;a&&j.push(...a)})})(),d(),d(!1);const se=d();d([]);const re=r=>{const a=M.resolve({path:"/preview/wap",query:{page:`/addon/phone_shop/pages/goods/detail?goods_id=${r.goods_id}`}});window.open(a.href)},le=r=>{let a="";r.order=="ascending"?a="asc":r.order=="descending"&&(a="desc"),a&&(e.searchParam.order=r.prop,e.searchParam.sort=a),u()},u=(r=1)=>{if(e.searchParam.start_sale_num&&!f.digit.test(e.searchParam.start_sale_num)){c({type:"warning",message:`${o("startSaleNumTips")}`});return}if(e.searchParam.end_sale_num&&!f.digit.test(e.searchParam.end_sale_num)){c({type:"warning",message:`${o("endSaleNumTips")}`});return}if(Number(e.searchParam.start_sale_num)>Number(e.searchParam.end_sale_num)){c({type:"warning",message:`${o("shopSaleNumTips")}`});return}if(e.searchParam.start_price&&!f.digit.test(e.searchParam.start_price)){c({type:"warning",message:`${o("startPriceTips")}`});return}if(e.searchParam.end_price&&!f.digit.test(e.searchParam.end_price)){c({type:"warning",message:`${o("endPriceTips")}`});return}if(Number(e.searchParam.start_price)>Number(e.searchParam.end_price)){c({type:"warning",message:`${o("shopPriceTips")}`});return}e.loading=!0,e.page=r;const a=X(e.searchParam);qe({page:e.page,limit:e.limit,...a}).then(g=>{e.loading=!1,e.data=g.data.data,e.total=g.data.total}).catch(()=>{e.loading=!1})};u();const q=d(null),ne=r=>{q.value.show(r)},J=d(null),ie=r=>{J.value.show(r)},de=d(null),pe=d([]);(()=>{Ke().then(r=>{pe.value=r.data?r.data:[]})})();const ce=d(null),ue=r=>{r&&(r.resetFields(),e.searchParam.start_price="",e.searchParam.end_price="",e.searchParam.start_sale_num="",e.searchParam.end_sale_num="",u())};return(r,a)=>{const g=Ce,b=Ee,p=Se,N=Te,R=Ne,U=$e,x=Ve,me=Le,W=Ie,P=Re,Y=w("EditPen"),H=Ue,_e=De,ge=Fe,he=Be,fe=w("goods-stock-edit-popup"),be=w("goods-price-edit-popup"),Pe=w("goods-spread-popup"),ye=w("goods-member-price-popup"),ve=Ae;return m(),y("div",Qe,[s(W,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[s(g,{type:"info",title:"说明:如有大量数据请分批导出或者联系管理员导出",closable:!1,"show-icon":""}),s(W,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:n(()=>[s(me,{inline:!0,model:e.searchParam,ref_key:"searchFormRef",ref:v},{default:n(()=>[s(p,{label:l(o)("goodsName"),prop:"goods_name"},{default:n(()=>[s(b,{modelValue:e.searchParam.goods_name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.searchParam.goods_name=t),modelModifiers:{trim:!0},placeholder:l(o)("goodsNamePlaceholder"),maxlength:"60"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(p,{label:l(o)("goodsCategory"),prop:"goods_category"},{default:n(()=>[s(N,{modelValue:e.searchParam.goods_category,"onUpdate:modelValue":a[1]||(a[1]=t=>e.searchParam.goods_category=t),options:I,placeholder:l(o)("goodsCategoryPlaceholder"),clearable:"",props:{value:"value",label:"label",emitPath:!1}},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),s(p,{label:l(o)("goodsType"),prop:"goods_type"},{default:n(()=>[s(U,{modelValue:e.searchParam.goods_type,"onUpdate:modelValue":a[2]||(a[2]=t=>e.searchParam.goods_type=t),placeholder:l(o)("goodsTypePlaceholder"),clearable:""},{default:n(()=>[(m(!0),y(D,null,F(G,t=>(m(),C(R,{key:t.type,label:t.name,value:t.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(p,{label:l(o)("brand"),prop:"brand_id"},{default:n(()=>[s(U,{modelValue:e.searchParam.brand_id,"onUpdate:modelValue":a[3]||(a[3]=t=>e.searchParam.brand_id=t),placeholder:l(o)("brandPlaceholder"),clearable:""},{default:n(()=>[(m(!0),y(D,null,F(K,t=>(m(),C(R,{key:t.brand_id,label:t.brand_name,value:t.brand_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(p,{label:l(o)("labelIds"),prop:"label_ids"},{default:n(()=>[s(U,{modelValue:e.searchParam.label_ids,"onUpdate:modelValue":a[4]||(a[4]=t=>e.searchParam.label_ids=t),placeholder:l(o)("labelIdsPlaceholder"),clearable:""},{default:n(()=>[(m(!0),y(D,null,F(j,t=>(m(),C(R,{key:t.label_id,label:t.label_name,value:t.label_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(p,{label:l(o)("saleNum"),prop:"sale_num"},{default:n(()=>[i("div",Xe,[E(i("input",{type:"text",placeholder:l(o)("startSaleNumPlaceholder"),maxlength:"10","onUpdate:modelValue":a[5]||(a[5]=t=>e.searchParam.start_sale_num=t),onKeyup:a[6]||(a[6]=t=>l($)(t))},null,40,Ze),[[V,e.searchParam.start_sale_num,void 0,{trim:!0}]]),ea,E(i("input",{type:"text",placeholder:l(o)("endSaleNumPlaceholder"),maxlength:"10","onUpdate:modelValue":a[7]||(a[7]=t=>e.searchParam.end_sale_num=t),onKeyup:a[8]||(a[8]=t=>l($)(t))},null,40,aa),[[V,e.searchParam.end_sale_num,void 0,{trim:!0}]])])]),_:1},8,["label"]),s(p,{label:l(o)("skuPrice"),prop:"sku_price"},{default:n(()=>[i("div",ta,[E(i("input",{type:"text",placeholder:l(o)("startPricePlaceholder"),maxlength:"10","onUpdate:modelValue":a[9]||(a[9]=t=>e.searchParam.start_price=t),onKeyup:a[10]||(a[10]=t=>l($)(t))},null,40,oa),[[V,e.searchParam.start_price,void 0,{trim:!0}]]),sa,E(i("input",{type:"text",placeholder:l(o)("endPricePlaceholder"),maxlength:"10","onUpdate:modelValue":a[11]||(a[11]=t=>e.searchParam.end_price=t),onKeyup:a[12]||(a[12]=t=>l($)(t))},null,40,ra),[[V,e.searchParam.end_price,void 0,{trim:!0}]])])]),_:1},8,["label"]),s(p,null,{default:n(()=>[s(x,{onClick:a[13]||(a[13]=t=>ue(v.value))},{default:n(()=>[S(h(l(o)("reset")),1)]),_:1}),s(x,{type:"primary",onClick:a[14]||(a[14]=t=>u())},{default:n(()=>[S(h(l(o)("search")),1)]),_:1}),z.value==!0?(m(),C(x,{key:0,plain:"",type:"primary",onClick:a[15]||(a[15]=t=>ee(v.value))},{default:n(()=>[S("全部导出")]),_:1})):A("",!0),s(x,{type:"primary",onClick:a[16]||(a[16]=t=>ae(v.value))},{default:n(()=>[S("列表导出")]),_:1}),s(x,{type:"primary",onClick:a[17]||(a[17]=t=>te(v.value))},{default:n(()=>[S("商品报价列表导出")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),i("div",la,[E((m(),C(_e,{data:e.data,size:"large",ref_key:"goodsListTableRef",ref:se,onSortChange:le},{empty:n(()=>[i("span",null,h(e.loading?"":l(o)("emptyData")),1)]),default:n(()=>[s(P,{prop:"goods_id",label:l(o)("goodsInfo"),"min-width":"300"},{default:n(({row:t})=>[i("div",{class:"flex items-center cursor-pointer",onClick:Q=>re(t)},[ia,i("div",da,[i("span",{title:t.goods_name,class:"multi-hidden"},h(t.goods_name),9,pa),i("span",ca,h(t.goods_type_name),1)])],8,na)]),_:1},8,["label"]),s(P,{prop:"price",label:l(o)("skuPrice"),"min-width":"120",align:"right",sortable:"custom"},{default:n(({row:t})=>[i("div",{class:"cursor-pointer price-wrap",onClick:Q=>ne(t)},[i("span",null,"￥"+h(t.goodsSku.price),1),s(H,{class:"icon-wrap ml-[5px] invisible"},{default:n(()=>[s(Y)]),_:1})],8,ua)]),_:1},8,["label"]),s(P,{prop:"stock",label:l(o)("stock"),"min-width":"120",sortable:"custom"},{default:n(({row:t})=>[i("div",{class:"cursor-pointer stock-wrap",onClick:Q=>ie(t)},[i("span",null,h(t.stock),1),s(H,{class:"icon-wrap ml-[5px] invisible"},{default:n(()=>[s(Y)]),_:1})],8,ma)]),_:1},8,["label"]),s(P,{prop:"sale_num",label:l(o)("saleNum"),"min-width":"100",sortable:"custom"},null,8,["label"]),s(P,{prop:"status",label:l(o)("status"),"min-width":"100"},{default:n(({row:t})=>[t.status==1?(m(),y("div",_a,h(l(o)("statusOn")),1)):A("",!0),t.status==0?(m(),y("div",ga,h(l(o)("statusOff")),1)):A("",!0)]),_:1},8,["label"]),s(P,{prop:"create_time",label:l(o)("createTime"),"min-width":"150",sortable:"custom"},{default:n(({row:t})=>[i("div",null,h(t.create_time),1)]),_:1},8,["label"])]),_:1},8,["data"])),[[ve,e.loading]]),i("div",ha,[s(ge,{"current-page":e.page,"onUpdate:current-page":a[18]||(a[18]=t=>e.page=t),"page-size":e.limit,"onUpdate:page-size":a[19]||(a[19]=t=>e.limit=t),layout:"total, sizes, prev, pager, next, jumper","page-sizes":[100,200,300,400,1e3],total:e.total,onSizeChange:a[20]||(a[20]=t=>u()),onCurrentChange:u},null,8,["current-page","page-size","total"])])])]),_:1}),s(he,{ref_key:"exportSureDialog",ref:B,show:L.value,type:"spdr_export_goods",searchParam:e.searchParam,onClose:Z},null,8,["show","searchParam"]),s(fe,{ref_key:"goodsStockEditPopupRef",ref:J,onLoad:u},null,512),s(be,{ref_key:"goodsPriceEditPopupRef",ref:q,onLoad:u},null,512),s(Pe,{ref_key:"goodsSpreadPopupRef",ref:de},null,512),s(ye,{ref_key:"memberPricePopupRef",ref:ce,onLoad:u},null,512)])}}});const Wa=je(fa,[["__scopeId","data-v-3d024927"]]);export{Wa as default};
