import{d as ee,x as te,n as j,r as v,f as ae,l as le,q as n,h as u,c as V,e as l,w as o,a as p,t as m,u as i,i as c,F as C,T as E,s as f,R as S,B as T,cC as oe,cD as ne,cE as ie,cF as se,cG as re,cH as me,a5 as de,cI as ue,E as pe,aW as ce,ab as fe,aC as _e,L as ye,M as ve,a7 as ge,ac as be,ad as ke,W as we,K as he,at as Ve,au as xe,X as Ce,Y as Ee}from"./index-6f32d09b.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                       *//* empty css                 *//* empty css                 *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                  */import{_ as Te}from"./cron-info.vue_vue_type_script_setup_true_lang-d9244de6.js";const De={class:"main-container"},Fe={class:"flex justify-between items-center mb-[20px]"},Ue={class:"text-page-title"},Pe={class:"flex items-center"},Re={class:"mt-2"},Be={class:"flex justify-between"},Le={class:"mt-[20px]"},$e={class:"mt-[16px] flex justify-end"},ze={class:"flex"},Ne={class:"input-width flex items-center text-sm"},Oe={class:"dialog-footer"},pt=ee({__name:"schedule",setup(je){const q=te().meta.title,s=j({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{type:"",status:"all"}}),D=v([]),U=v([]),P=v([]),R=v(),A=r=>{r&&(r.resetFields(),y())};(async()=>{D.value=await(await oe()).data,U.value=await(await ne()).data,P.value=await(await ie()).data})();const y=(r=1)=>{s.loading=!0,s.page=r,se({page:s.page,limit:s.limit,...s.searchParam}).then(a=>{s.loading=!1,s.data=a.data.data,s.total=a.data.total}).catch(()=>{s.loading=!1})};y(),ae();const k=v(!1),e=j({...{id:0,key:"",status:2,time:{type:"min",week:"",day:"",hour:"",min:""}}}),B=v(),I=()=>{e.id=0,e.key="",e.status=2,e.time.type="min",e.time.week="",e.time.day="",e.time.hour="",e.time.min="",k.value=!0},W=le(()=>({key:[{required:!0,message:n("titlePlaceholder"),trigger:"blur"}],timeDate:[{required:!0,validator:G,trigger:"blur"}]})),G=(r,a,d)=>e.time.type=="min"&&e.time.min!=""||e.time.type=="week"&&e.time.week!=""&&e.time.hour!=""&&e.time.min!=""||e.time.type=="month"&&e.time.day!=""&&e.time.hour!=""&&e.time.min!=""||e.time.type=="day"&&e.time.day!=""&&e.time.hour!=""&&e.time.min!=""||e.time.type=="hour"&&e.time.hour!=""&&e.time.min!=""?d():d(new Error(n("cronTimeTips"))),x=v(!1),M=async r=>{x.value||!r||await r.validate(async a=>{if(a){x.value=!0;const d=e;(e.id>0?re:me)(d).then(_=>{x.value=!1,k.value=!1,y()}).catch(()=>{x.value=!1})}})},H=r=>{e.id=r.id,e.key=r.key,e.status=r.status,e.time=r.time,k.value=!0},K=r=>{de.confirm(n("cronDeleteTips"),n("warning"),{confirmButtonText:n("confirm"),cancelButtonText:n("cancel"),type:"warning"}).then(()=>{ue(r).then(()=>{y()}).catch(()=>{})})},X=v(null);return(r,a)=>{const d=pe,L=ce,_=fe,w=_e,b=ye,$=ve,z=ge,h=be,Y=ke,J=we,F=he,N=Ve,Q=xe,Z=Ce,O=Ee;return u(),V("div",De,[l(z,{class:"box-card !border-none",shadow:"never"},{default:o(()=>[p("div",Fe,[p("span",Ue,m(i(q)),1),l(d,{type:"primary",onClick:I},{default:o(()=>[c(m(i(n)("addCron")),1)]),_:1})]),l(L,{type:"info"},{default:o(()=>[p("div",Pe,[p("div",null,[p("p",null,m(i(n)("cronTipsOne")),1),p("p",Re,m(i(n)("cronTipsTwo")),1)])])]),_:1}),l(z,{class:"box-card !border-none mb-[10px] table-search-wrap",shadow:"never"},{default:o(()=>[p("div",Be,[l($,{inline:!0,model:s.searchParam,ref_key:"searchFormRef",ref:R},{default:o(()=>[l(b,{label:i(n)("title"),prop:"key"},{default:o(()=>[l(w,{modelValue:s.searchParam.key,"onUpdate:modelValue":a[0]||(a[0]=t=>s.searchParam.key=t),placeholder:"全部",filterable:"",remote:"",clearable:"","remote-method":r.getAddonDevelopFn},{default:o(()=>[l(_,{label:"全部",value:"all"}),(u(!0),V(C,null,E(D.value,t=>(u(),f(_,{key:t.key,label:t.name,value:t.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue","remote-method"])]),_:1},8,["label"]),l(b,{label:i(n)("status"),prop:"status"},{default:o(()=>[l(w,{modelValue:s.searchParam.status,"onUpdate:modelValue":a[1]||(a[1]=t=>s.searchParam.status=t),placeholder:"全部",filterable:"",remote:"",clearable:"","remote-method":r.getAddonDevelopFn},{default:o(()=>[l(_,{label:"全部",value:"all"}),l(_,{label:"启用",value:"1"}),l(_,{label:"关闭",value:"0"})]),_:1},8,["modelValue","remote-method"])]),_:1},8,["label"]),l(b,null,{default:o(()=>[l(d,{type:"primary",onClick:a[2]||(a[2]=t=>y())},{default:o(()=>[c(m(i(n)("search")),1)]),_:1}),l(d,{onClick:a[3]||(a[3]=t=>A(R.value))},{default:o(()=>[c(m(i(n)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),p("div",Le,[S((u(),f(Y,{data:s.data,size:"large"},{empty:o(()=>[p("span",null,m(s.loading?"":i(n)("emptyData")),1)]),default:o(()=>[l(h,{prop:"name",label:i(n)("title"),"min-width":"150"},null,8,["label"]),l(h,{prop:"key",label:i(n)("key"),"min-width":"150"},null,8,["label"]),l(h,{label:i(n)("crondType"),"min-width":"150"},{default:o(({row:t})=>[c(m(t.crontab_content),1)]),_:1},8,["label"]),l(h,{prop:"status_name",label:i(n)("openStatus"),"min-width":"100"},null,8,["label"]),l(h,{label:i(n)("operation"),align:"right",fixed:"right",width:"130"},{default:o(({row:t})=>[l(d,{type:"primary",link:"",onClick:g=>H(t)},{default:o(()=>[c(m(i(n)("edit")),1)]),_:2},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:g=>K(t.id)},{default:o(()=>[c(m(i(n)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[O,s.loading]]),p("div",$e,[l(J,{"current-page":s.page,"onUpdate:current-page":a[4]||(a[4]=t=>s.page=t),"page-size":s.limit,"onUpdate:page-size":a[5]||(a[5]=t=>s.limit=t),layout:"total, sizes, prev, pager, next, jumper",total:s.total,onSizeChange:a[6]||(a[6]=t=>y()),onCurrentChange:y},null,8,["current-page","page-size","total"])])])]),_:1}),l(Te,{ref_key:"cronDialog",ref:X,onComplete:y},null,512),l(Z,{modelValue:k.value,"onUpdate:modelValue":a[15]||(a[15]=t=>k.value=t),title:i(n)("editCron"),width:"750px","destroy-on-close":!0},{footer:o(()=>[p("span",Oe,[l(d,{type:"primary",onClick:a[14]||(a[14]=t=>M(B.value))},{default:o(()=>[c(m(i(n)("confirm")),1)]),_:1})])]),default:o(()=>[S((u(),f($,{model:e,"label-width":"110px",ref_key:"formRef",ref:B,rules:i(W),class:"page-form"},{default:o(()=>[l(b,{label:i(n)("cronTemplate"),class:"items-center",prop:"key"},{default:o(()=>[l(w,{modelValue:e.key,"onUpdate:modelValue":a[7]||(a[7]=t=>e.key=t)},{default:o(()=>[(u(!0),V(C,null,E(D.value,t=>(u(),f(_,{key:t.key,label:t.name,value:t.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(b,{label:i(n)("cronTime"),prop:"timeDate"},{default:o(()=>[l(w,{modelValue:e.time.type,"onUpdate:modelValue":a[8]||(a[8]=t=>e.time.type=t),class:"w-[150px]"},{default:o(()=>[(u(!0),V(C,null,E(U.value,(t,g)=>(u(),f(_,{key:g,label:t,value:g},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),p("div",ze,[e.time.type=="week"?(u(),f(w,{key:0,modelValue:e.time.week,"onUpdate:modelValue":a[9]||(a[9]=t=>e.time.week=t),class:"ml-2 w-[120px]"},{default:o(()=>[(u(!0),V(C,null,E(P.value,(t,g)=>(u(),f(_,{key:g,label:t,value:g},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):T("",!0),["month","day"].indexOf(e.time.type)!=-1?(u(),f(F,{key:1,modelValue:e.time.day,"onUpdate:modelValue":a[10]||(a[10]=t=>e.time.day=t),class:"ml-2 w-[120px]"},{append:o(()=>[c(m(i(n)("day")),1)]),_:1},8,["modelValue"])):T("",!0),["month","day","hour","week"].indexOf(e.time.type)!=-1?(u(),f(F,{key:2,modelValue:e.time.hour,"onUpdate:modelValue":a[11]||(a[11]=t=>e.time.hour=t),class:"ml-2 w-[120px]"},{append:o(()=>[c(m(i(n)("hour")),1)]),_:1},8,["modelValue"])):T("",!0),["month","day","hour","week","min"].indexOf(e.time.type)!=-1?(u(),f(F,{key:3,modelValue:e.time.min,"onUpdate:modelValue":a[12]||(a[12]=t=>e.time.min=t),class:"ml-2 w-[120px]"},{append:o(()=>[c(m(i(n)("min")),1)]),_:1},8,["modelValue"])):T("",!0)])]),_:1},8,["label"]),l(b,{label:i(n)("isopen")},{default:o(()=>[p("div",Ne,[l(Q,{modelValue:e.status,"onUpdate:modelValue":a[13]||(a[13]=t=>e.status=t)},{default:o(()=>[l(N,{label:1},{default:o(()=>[c(m(i(n)("yes")),1)]),_:1}),l(N,{label:2},{default:o(()=>[c(m(i(n)("no")),1)]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[O,r.loading]])]),_:1},8,["modelValue","title"])])}}});export{pt as default};
