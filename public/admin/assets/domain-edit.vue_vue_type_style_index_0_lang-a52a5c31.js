import{O as v,d as N,r as f,n as O,l as j,q as l,Q as M,h as m,s as g,w as o,a as _,e as r,i as w,t as b,u as s,R as T,c as L,F as P,T as R,K as G,L as K,au as Q,av as X,M as Y,E as z,X as A,Y as H}from"./index-99f00cf3.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                       *//* empty css                 */import"./el-form-item-4ed993c7.js";/* empty css                 */function fe(n){return v.get("hlwoauth/domain",{params:n})}function J(n){return v.get(`hlwoauth/domain/${n}`)}function W(n){return v.post("hlwoauth/domain",n,{showErrorMessage:!0,showSuccessMessage:!0})}function Z(n){return v.put(`hlwoauth/domain/${n.id}`,n,{showErrorMessage:!0,showSuccessMessage:!0})}function _e(n){return v.delete(`hlwoauth/domain/${n}`,{showErrorMessage:!0,showSuccessMessage:!0})}const ee=_("div",{class:"help-text text-gray-400 text-sm mt-[5px]"},[_("p",null,"静默授权：不弹出授权页面，直接跳转，只能获取用户openid。"),_("p",null,"弹出授权：弹出授权页面，可通过openid拿到昵称、性别、所在地。并且， 即使在未关注的情况下，只要用户授权，也能获取其信息。")],-1),ae=_("div",{class:"help-text text-gray-400 text-sm mt-[5px]"},"填写授权成功后回调的地址，例如：https://www.example.com/oauth/callback",-1),te={class:"dialog-footer"},ve=N({__name:"domain-edit",emits:["complete"],setup(n,{expose:B,emit:U}){const p=f(!1),u=f(!1),D={id:"",name:"",domain:"",scope:"snsapi_base",auth_url:"",number:"0",status:"1"},a=O({...D}),E=f(),$=j(()=>({name:[{required:!0,message:l("namePlaceholder"),trigger:"blur"}],domain:[{required:!0,message:l("domainPlaceholder"),trigger:"blur"}]})),q=async i=>{if(u.value||!i)return;const e=a.id?Z:W;await i.validate(async d=>{d&&(u.value=!0,e(a).then(h=>{u.value=!1,p.value=!1,U("complete")}).catch(h=>{u.value=!1}))})},V=f([{value:"1",name:"启用"},{value:"0",name:"禁用"}]);M(()=>V.value,()=>{a.status=V.value[0].value});const x=f([{value:"snsapi_base",name:"静默授权"},{value:"snsapi_userinfo",name:"弹出授权"}]);return M(()=>x.value,()=>{a.scope=x.value[0].value}),B({showDialog:p,setFormData:async(i=null)=>{if(Object.assign(a,D),u.value=!0,i){const e=await(await J(i.id)).data;e&&Object.keys(a).forEach(d=>{e[d]!=null&&(a[d]=e[d])})}u.value=!1}}),(i,e)=>{const d=G,c=K,h=Q,k=X,C=Y,F=z,S=A,I=H;return m(),g(S,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=t=>p.value=t),title:a.id?s(l)("updateDomain"):s(l)("addDomain"),width:"600px",class:"diy-dialog-wrap","destroy-on-close":!0},{footer:o(()=>[_("span",te,[r(F,{onClick:e[4]||(e[4]=t=>p.value=!1)},{default:o(()=>[w(b(s(l)("cancel")),1)]),_:1}),r(F,{type:"primary",loading:u.value,onClick:e[5]||(e[5]=t=>q(E.value))},{default:o(()=>[w(b(s(l)("confirm")),1)]),_:1},8,["loading"])])]),default:o(()=>[T((m(),g(C,{model:a,"label-width":"120px",ref_key:"formRef",ref:E,rules:s($),class:"page-form"},{default:o(()=>[r(c,{label:s(l)("name"),prop:"name"},{default:o(()=>[r(d,{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.name=t),clearable:"",placeholder:s(l)("namePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(c,{label:s(l)("scope"),prop:"scope"},{default:o(()=>[r(k,{modelValue:a.scope,"onUpdate:modelValue":e[1]||(e[1]=t=>a.scope=t),placeholder:s(l)("scopePlaceholder")},{default:o(()=>[(m(!0),L(P,null,R(x.value,(t,y)=>(m(),g(h,{key:y,label:t.value},{default:o(()=>[w(b(t.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","placeholder"]),ee]),_:1},8,["label"]),r(c,{label:s(l)("domain"),prop:"domain"},{default:o(()=>[r(d,{modelValue:a.domain,"onUpdate:modelValue":e[2]||(e[2]=t=>a.domain=t),type:"textarea",clearable:"",placeholder:s(l)("domainPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),ae]),_:1},8,["label"]),r(c,{label:s(l)("status"),prop:"status"},{default:o(()=>[r(k,{modelValue:a.status,"onUpdate:modelValue":e[3]||(e[3]=t=>a.status=t),placeholder:s(l)("statusPlaceholder")},{default:o(()=>[(m(!0),L(P,null,R(V.value,(t,y)=>(m(),g(h,{key:y,label:t.value},{default:o(()=>[w(b(t.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[I,u.value]])]),_:1},8,["modelValue","title"])}}});export{ve as _,_e as d,fe as g};
