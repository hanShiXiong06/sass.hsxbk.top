import{d as I,f as O,x as q,n as H,r as x,h as d,c as h,e as l,w as n,a as c,t as i,u as a,i as m,q as t,F as J,T as K,s as f,R as W,A as Q,B as T,a4 as V,E as X,K as Z,L as ee,aa as te,aB as ae,bO as oe,M as le,a6 as ne,J as se,ab as ie,ac as re,W as ce,Y as de}from"./index-f7a01263.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                 *//* empty css                        *//* empty css                *//* empty css                     *//* empty css                       *//* empty css                  */import{_ as w}from"./goods_default-664bb559.js";import{_ as pe}from"./goods-spread-popup.vue_vue_type_script_setup_true_lang-50a69427.js";import{a as me,b as ue,y as _e,z as ge}from"./marketing-fa8c56a7.js";/* empty css                  *//* empty css                   */import"./browser-a1ac24ac.js";const he={class:"main-container"},fe={class:"flex justify-between items-center mb-[5px]"},ve={class:"text-page-title"},xe={class:"mt-[10px]"},be={class:"flex items-center cursor-pointer"},ye={class:"min-w-[60px] h-[60px] flex items-center justify-center"},ke=c("div",{class:"image-slot"},[c("img",{class:"w-[60px] h-[60px]",src:w})],-1),Ee={key:1,class:"w-[70px] h-[60px]",src:w,fit:"contain"},Ce={class:"ml-2"},Pe=["title"],Te={key:0},Ve={key:1},we={class:"mt-[16px] flex justify-end"},ot=I({__name:"goods_list",setup(Be){const b=O(),B=q().meta.title,o=H({page:1,limit:10,total:0,loading:!1,data:[],searchParam:{names:"",status:"",create_time:[]}}),y=x(),u=(r=1)=>{o.loading=!0,o.page=r,me({page:o.page,limit:o.limit,...o.searchParam}).then(s=>{o.loading=!1,o.data=s.data.data,o.total=s.data.total}).catch(()=>{o.loading=!1})};u();const k=x([]);(()=>{ue().then(r=>{k.value=r.data})})();const F=()=>{b.push("/shop/marketing/exchange/goods_add")},S=r=>{b.push({path:"/shop/marketing/exchange/goods_edit",query:{id:r}})},E=x(null),D=r=>{E.value.show(r,"point")},C=(r,s)=>{V.confirm(s?t("upTips"):t("downTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{_e({id:r,status:s}).then(()=>{u()}).catch(()=>{})})},$=r=>{V.confirm(t("deleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{ge(r).then(()=>{u()}).catch(()=>{})})},A=r=>{r&&(r.resetFields(),u())};return(r,s)=>{const p=X,z=Z,v=ee,N=te,R=ae,U=oe,L=le,P=ne,M=se,g=ie,Y=re,j=ce,G=de;return d(),h("div",he,[l(P,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[c("div",fe,[c("span",ve,i(a(B)),1),l(p,{type:"primary",onClick:F},{default:n(()=>[m(i(a(t)("addGoods")),1)]),_:1})]),l(P,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:n(()=>[l(L,{inline:!0,model:o.searchParam,ref_key:"searchFormRef",ref:y},{default:n(()=>[l(v,{label:a(t)("goodsName"),prop:"names"},{default:n(()=>[l(z,{modelValue:o.searchParam.names,"onUpdate:modelValue":s[0]||(s[0]=e=>o.searchParam.names=e),modelModifiers:{trim:!0},placeholder:a(t)("goodsNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(v,{label:a(t)("status"),prop:"status"},{default:n(()=>[l(R,{modelValue:o.searchParam.status,"onUpdate:modelValue":s[1]||(s[1]=e=>o.searchParam.status=e),clearable:"",placeholder:a(t)("statusPlaceholder"),class:"input-item"},{default:n(()=>[(d(!0),h(J,null,K(k.value,(e,_)=>(d(),f(N,{key:_,label:e,value:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(v,{label:a(t)("createTime"),prop:"create_time"},{default:n(()=>[l(U,{modelValue:o.searchParam.create_time,"onUpdate:modelValue":s[2]||(s[2]=e=>o.searchParam.create_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":a(t)("startDate"),"end-placeholder":a(t)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(v,null,{default:n(()=>[l(p,{type:"primary",onClick:s[3]||(s[3]=e=>u())},{default:n(()=>[m(i(a(t)("search")),1)]),_:1}),l(p,{onClick:s[4]||(s[4]=e=>A(y.value))},{default:n(()=>[m(i(a(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),c("div",xe,[W((d(),f(Y,{data:o.data,size:"large"},{empty:n(()=>[c("span",null,i(o.loading?"":a(t)("emptyData")),1)]),default:n(()=>[l(g,{label:a(t)("goods"),"min-width":"130"},{default:n(({row:e})=>[c("div",be,[c("div",ye,[e.goods_cover_thumb_small?(d(),f(M,{key:0,class:"w-[60px] h-[60px]",src:a(Q)(e.goods_cover_thumb_small),fit:"contain"},{error:n(()=>[ke]),_:2},1032,["src"])):(d(),h("img",Ee))]),c("div",Ce,[c("span",{title:e.names,class:"multi-hidden"},i(e.names),9,Pe)])])]),_:1},8,["label"]),l(g,{label:a(t)("exchangePrice"),"min-width":"130"},{default:n(({row:e})=>[e.point?(d(),h("p",Te,i(e.point)+i(a(t)("pointUnit")),1)):T("",!0),e.price?(d(),h("p",Ve,i(e.price)+i(a(t)("priceUnit")),1)):T("",!0)]),_:1},8,["label"]),l(g,{label:a(t)("redeemedAndSurplus"),"min-width":"130"},{default:n(({row:e})=>[c("span",null,i(e.total_exchange_num)+"/"+i(e.stock),1)]),_:1},8,["label"]),l(g,{prop:"create_time",label:a(t)("createTime"),"min-width":"150"},{default:n(({row:e})=>[c("div",null,i(e.create_time),1)]),_:1},8,["label"]),l(g,{prop:"status_name",label:a(t)("status"),"min-width":"130"},null,8,["label"]),l(g,{label:a(t)("operation"),fixed:"right",align:"right","min-width":"160"},{default:n(({row:e})=>[l(p,{type:"primary",link:"",onClick:_=>S(e.id)},{default:n(()=>[m(i(a(t)("edit")),1)]),_:2},1032,["onClick"]),l(p,{type:"primary",link:"",onClick:_=>D(e)},{default:n(()=>[m(i(a(t)("spreadGoods")),1)]),_:2},1032,["onClick"]),e.status?(d(),f(p,{key:0,type:"primary",link:"",onClick:_=>C(e.id,0)},{default:n(()=>[m(i(a(t)("down")),1)]),_:2},1032,["onClick"])):(d(),f(p,{key:1,type:"primary",link:"",onClick:_=>C(e.id,1)},{default:n(()=>[m(i(a(t)("up")),1)]),_:2},1032,["onClick"])),l(p,{type:"primary",link:"",onClick:_=>$(e.id)},{default:n(()=>[m(i(a(t)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[G,o.loading]]),c("div",we,[l(j,{"current-page":o.page,"onUpdate:current-page":s[5]||(s[5]=e=>o.page=e),"page-size":o.limit,"onUpdate:page-size":s[6]||(s[6]=e=>o.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:s[7]||(s[7]=e=>u()),onCurrentChange:u},null,8,["current-page","page-size","total"])])])]),_:1}),l(pe,{ref_key:"goodsSpreadPopupRef",ref:E},null,512)])}}});export{ot as default};
