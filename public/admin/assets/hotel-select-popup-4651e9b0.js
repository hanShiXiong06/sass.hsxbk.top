import{d as q,l as D,r as y,n as k,q as l,h as E,c as K,a as i,b as W,e as s,w as r,i as f,t as p,u as o,R as b,a0 as w,s as X,A as J,a3 as Q,a$ as Z,U as T,E as ee,K as te,L as le,bO as ae,M as oe,ac as se,ad as ne,W as ie,X as re,Y as pe}from"./index-2a89d409.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                       *//* empty css                  */import"./el-form-item-4ed993c7.js";import{g as de}from"./tourism-4aef9104.js";import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";const me={class:"inline-block ml-[10px] text-[14px]"},ue={class:"text-primary mx-[2px]"},_e={class:"flex items-center"},he={class:"min-w-[60px] h-[60px] flex items-center justify-center"},fe=["src"],ge=["title"],ve={class:"mt-[16px] flex"},xe={class:"flex items-center flex-1"},Se={class:"layui-table-bottom-left-container mr-[10px]"},be={class:"text-primary mx-[2px]"},Pe={class:"dialog-footer"},ye=q({__name:"hotel-select-popup",props:{modelValue:{type:String,default:""},max:{type:Number,default:0},min:{type:Number,default:0}},emits:["update:modelValue"],setup($,{expose:N,emit:H}){const m=$,_=D({get(){return m.modelValue},set(a){H("update:modelValue",a)}}),g=y(!1),d=k({}),h=D(()=>Object.keys(d).length),t=k({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{hotel_name:"",create_time:"",goods_type:"room"}}),C=y(),S=y(),R=(a,e)=>{let c=!1;for(let u=0;u<a.length;u++)if(a[u].hotel_id==e.hotel_id){c=!0;break}c?d["hotel_"+e.hotel_id]=e:delete d["hotel_"+e.hotel_id]},z=a=>{a.length?a.forEach(e=>{d["hotel_"+e.hotel_id]=e}):t.data.forEach(e=>{delete d["hotel_"+e.hotel_id]})},x=(a=1,e=null)=>{t.loading=!0,t.page=a;const c=Q(t.searchParam);de({page:t.page,limit:t.limit,...c}).then(u=>{t.loading=!1,t.data=u.data.data,t.total=u.data.total,e&&e(),V()}).catch(()=>{t.loading=!1})},V=()=>{Z(()=>{if(S.value)for(let a=0;a<t.data.length;a++)S.value.toggleRowSelection(t.data[a],!1),d["hotel_"+t.data[a].hotel_id]&&S.value.toggleRowSelection(t.data[a],!0)})},A=a=>{a&&(a.resetFields(),x())},B=()=>{x(1,()=>{if(_.value){const a=[];for(let e=0;e<t.data.length;e++)_.value.indexOf(t.data[e].hotel_id)!=-1&&(a.push(t.data[e].hotel_id),d["hotel_"+t.data[e].hotel_id]=t.data[e]||{});_.value=a}}),g.value=!0},F=()=>{for(const a in d)delete d[a];V()},G=k({1:l("oneStar"),2:l("twoStar"),3:l("threeStar"),4:l("fourStar"),5:l("fiveStar")}),I=()=>{if(m.min&&h.value<m.min){T({type:"warning",message:`${l("hotelSelectPopupGoodsMinTip")}${m.min}${l("goodsSelectPopupPiece")}`});return}if(m.max&&m.max>0&&h.value&&h.value>m.max){T({type:"warning",message:`${l("hotelSelectPopupGoodsMaxTip")}${m.max}${l("goodsSelectPopupPiece")}`});return}const a=[];for(const e in d)a.push(parseInt(e.replace("hotel_","")));_.value.splice(0,_.value.length,...a),g.value=!1};return N({showDialog:g,selectHotel:d,selectGoodsNum:h}),(a,e)=>{const c=ee,u=te,P=le,L=ae,M=oe,v=se,U=ne,j=ie,Y=re,O=pe;return E(),K("div",null,[i("div",{onClick:B},[W(a.$slots,"default",{},()=>[s(c,null,{default:r(()=>[f(p(o(l)("hotelSelectPopupAllHotel")),1)]),_:1}),b(i("div",me,[i("span",null,p(o(l)("goodsSelectPopupSelect")),1),i("span",ue,p(o(_).length),1),i("span",null,p(o(l)("goodsSelectPopupPiece")),1)],512),[[w,o(_).length]])],!0)]),s(Y,{modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=n=>g.value=n),title:o(l)("hotelSelectPopupSelectGoodsDialog"),width:"1000px","close-on-press-escape":!1,"destroy-on-close":!0,"close-on-click-modal":!1},{footer:r(()=>[i("span",Pe,[s(c,{onClick:e[7]||(e[7]=n=>g.value=!1)},{default:r(()=>[f(p(o(l)("cancel")),1)]),_:1}),s(c,{type:"primary",onClick:I},{default:r(()=>[f(p(o(l)("confirm")),1)]),_:1})])]),default:r(()=>[s(M,{inline:!0,model:t.searchParam,ref_key:"searchFormRef",ref:C},{default:r(()=>[s(P,{label:o(l)("hotelNameSelectPopup"),prop:"hotel_name",class:"form-item-wrap"},{default:r(()=>[s(u,{modelValue:t.searchParam.hotel_name,"onUpdate:modelValue":e[0]||(e[0]=n=>t.searchParam.hotel_name=n),placeholder:o(l)("hotelNameSelectPopupPlaceholder"),maxlength:"60"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(P,{label:o(l)("createTime"),prop:"create_time",class:"form-item-wrap"},{default:r(()=>[s(L,{modelValue:t.searchParam.create_time,"onUpdate:modelValue":e[1]||(e[1]=n=>t.searchParam.create_time=n),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":o(l)("startDate"),"end-placeholder":o(l)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),s(P,{class:"form-item-wrap"},{default:r(()=>[s(c,{type:"primary",onClick:e[2]||(e[2]=n=>x())},{default:r(()=>[f(p(o(l)("search")),1)]),_:1}),s(c,{onClick:e[3]||(e[3]=n=>A(C.value))},{default:r(()=>[f(p(o(l)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"]),b((E(),X(U,{data:t.data,size:"large",ref_key:"scenicListTableRef",ref:S,"max-height":"400",onSelect:R,onSelectAll:z},{empty:r(()=>[i("span",null,p(t.loading?"":o(l)("emptyData")),1)]),default:r(()=>[s(v,{type:"selection",width:"55"}),s(v,{"show-overflow-tooltip":!0,label:o(l)("hotelInfo"),"min-width":"180",align:"left"},{default:r(({row:n})=>[i("div",_e,[i("div",he,[i("img",{class:"max-w-[60px] max-h-[60px]",src:o(J)(n.cover_thumb_small)},null,8,fe)]),i("a",{href:"javascript:;",title:n.hotel_name,class:"multi-hidden ml-2"},p(n.hotel_name),9,ge)])]),_:1},8,["label"]),s(v,{prop:"hotel_star",label:o(l)("hotelStar"),"min-width":"100"},{default:r(({row:n})=>[f(p(G[n.hotel_star]),1)]),_:1},8,["label"]),s(v,{prop:"full_address",label:o(l)("fullAddress"),"min-width":"150"},null,8,["label"]),s(v,{prop:"hotel_status_name",label:o(l)("hotelStatus"),"min-width":"100"},null,8,["label"]),s(v,{prop:"create_time",label:o(l)("goodsSelectPopupCreateTime"),"min-width":"120"},null,8,["label"])]),_:1},8,["data"])),[[O,t.loading]]),i("div",ve,[i("div",xe,[b(i("div",Se,[i("span",null,p(o(l)("goodsSelectPopupBeforeTip")),1),i("span",be,p(o(h)),1),i("span",null,p(o(l)("hotelSelectPopupAfterTip")),1)],512),[[w,o(h)]]),b(s(c,{type:"primary",link:"",onClick:F},{default:r(()=>[f(p(o(l)("goodsSelectPopupClearGoods")),1)]),_:1},512),[[w,o(h)]])]),s(j,{"current-page":t.page,"onUpdate:current-page":e[4]||(e[4]=n=>t.page=n),"page-size":t.limit,"onUpdate:page-size":e[5]||(e[5]=n=>t.limit=n),layout:"total, sizes, prev, pager, next, jumper",total:t.total,onSizeChange:e[6]||(e[6]=n=>x()),onCurrentChange:x},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue","title"])])}}});const Ye=ce(ye,[["__scopeId","data-v-b6d8a17c"]]);export{Ye as default};
